/**** v6.4.14, build: 01/08/2021 ****/
!function(e,t){function n(e,t){if(n.hooks[e])return t?n.hooks[e].apply(null,t):n.hooks[e].apply();if(0===e.indexOf("draw(")||0===e.indexOf("place_")){sr(e);return!0}var r=n.wildcardHooks;for(var i in r)if(new RegExp(i).test(e))return r[i](e,t);return!1}function r(e){return navigator.userAgent.indexOf(e)}function i(){var e,t,n,r,i,a=ha.gJsonCache&&ha.gJsonCache.schlib,o=pn("getSpiceCmdFromCanvas"),s=[".tran",".ac",".op",".tf",".dc",".noise"],c=!1,l=!1;if(o){o=o.split("\r\n");for(var d=0;d<o.length;d++){n=o[d].trim().toLowerCase().split(" ")[0];if(s.indexOf(n)>=0){".tran"==n&&(c=!0);".op"==n&&(l=!0)}}if(a)for(var u in a)if(j(a,u)){e=a[u]&&a[u].head&&a[u].head.c_para;if(!e)return;e=Wa.c_paraToJson(e);t=e?e.spiceSymbolName:"";switch(t){case"MULTIMETER":if(!c&&!l)return"There is a multimeter in the circuit that needs to be simulated using the emulation command .tran or .op";break;case"OSCILLOSCOPE":if(!c)return"An oscilloscope exists in the circuit and needs to be simulated using the simulation command .tran";break;case"VPULSE":r=a[u].annotation||{};i=Object.keys(r);for(d=0;d<i.length;d+=1)if("N"===r[i[d]].mark&&"PULSE()"===r[i[d]].string)return"Spice symbols's attributes can't be empty."}}}}function a(e){var t=v("part(annotation)");if(t){for(var n=t.cloneNode(!0),r=m('.shapeBox g[id^="frame_lib_"]'),i=0;i<r.length;i++)w(r[i],"display","none");var a=Wa.svg.getBBox(Ji);for(i=0;i<r.length;i++)N(r[i],"display");var o=a.x,s=a.y+a.height;w(n,"c_origin",o+","+s);w(n,"c_shapetype","group");w(n,"c_etype","pinpart");N(n,"display");var c=n.firstChild;if("spice"!=w(c,"type")){w(c,"font-size","36pt");var l=Wa.svg.getBBox(c).height;w(c,"x",o);w(c,"y",s+l);w(c,"fill","#000000");w(c,"type","spice");w(c,"font-style","italic")}c.innerHTML=e;Ji.appendChild(n);Rt(n);ha.updateOne(n);La.save(["add",n.id])}}function o(e){for(var t,n,r,i,a,o,s,c=ha.gJsonCache.schlib||{},l=Object.keys(c),d=0,u=l.length,h={},f=[],p=e||"OSCILLOSCOPE";d<u;d+=1){i=l[d];r=c[i];t=r.annotation;n=Object.keys(t);o=Wa.c_paraToJson(r.head.c_para);if(o.spiceSymbolName===p.toUpperCase())for(a=0;a<n.length;a+=1)if("P"===t[n[a]].mark){s=t[n[a]].string;h[s]=i;f.push(s);break}}return{prefixArray:f,prefixObject:h}}function s(){var e,t,n,r,i,a,o=ha.gJsonCache&&ha.gJsonCache.schlib,s=0,c=0,l={onlydc:!1,cycle:0};if(!o)return l;for(var d in o)if(j(o,d)){e=o[d]&&o[d].head&&o[d].head.c_para;if(!e)continue;e=Wa.c_paraToJson(e);t=e&&e.spicePre;n=t?pn("getSpiceCmdKey",[t]):"";n="model"==n?e.spiceSymbolName:n;if(!n)continue;r=ki([v(d)]);c++;switch(n){case"Current":case"Voltage":"IDC"!=e.spiceSymbolName&&"VDC"!=e.spiceSymbolName||s++;a=r?pn("convertFreToHz",[r.Freq])||1/pn("convertFreToHz",[r.Tperiod]):0;i=i||a;i=Math.min(i,a)||i;break;case"FUNCTIONGENERATOR":case"DIGITALCLOCK":a=r?pn("convertFreToHz",[r.Frequency]):0;i=i||a;i=Math.min(i,a)||i;break;case"WATTMETER":l.time="110m";return l}}l.onlydc=0!==s&&s==c;i&&(l.cycle=Wa.toFixed(1/i,4));return l}function c(e,t,n){var r,i=Wa.c_paraToJson(w(e,"c_para")),a=(i.spicePre,i.spiceSymbolName);if((0===t.indexOf("Value")||0===t.indexOf("Time"))&&"Value"!==t){t.indexOf("Time")>-1&&(r=2*Number(t.split("e")[1])-2);t.indexOf("Value")>-1&&(r=2*Number(t.split("e")[1])-1);t="PWL"+t.substring(0,t.length-1)}switch(t){case"Voltage type":case"Current type":var o="Voltage type"===t?"Voltage_Source_V":"Current_Source_I",s=1==w(e,"locked"),c=w(e,"c_origin").split(",").map(function(e){return+e}),h=[e.id,Wa.node.getRefId(e)];n="Behavioral Source"===n?o+"_Behavioral_Source":o+n;d(n,c,h,s);if("Voltage_Source_VDC"===n||"Current_Source_IDC"===n){var p=Zt()[0];Ei(An("name",p),"1");ha.updateOne(p)}break;case"DC Value":Ei(An("name",e),n);break;case"DC offset":u(e,a,0,n);break;case"Freq":"FUNCTIONGENERATOR"===a?Ai(e,t,n):u(e,a,2,n);break;case"Tdelay":r="PULSE"===a.substr(1)?2:3;u(e,a,r,n);break;case"Theta":case"Tfall":case"Fall Delay":case"Signal Freq":u(e,a,4,n);break;case"Phi":case"Ton":case"Fall Tau":u(e,a,5,n);break;case"Vinitial":case"Value":"I_Behavioral_Source"===a||"V_Behavioral_Source"===a?Ei(An("name",e),n):u(e,a,0,n);break;case"Von":case"Vpulsed":case"Amplitude":if("Amplitude"===t&&"FUNCTIONGENERATOR"===a){l(e,i,t,n);Ai(e,t,n)}else u(e,a,1,n);break;case"Trise":case"Rise Tau":case"Modulation Index":u(e,a,3,n);break;case"Tperiod":u(e,a,6,n);break;case"Rise Delay":case"Carrier Freq":u(e,a,2,n);break;case"PWLValue":case"PWLTime":u(e,a,r,n);break;case"Model":case"Resistance":case"Inductance":Ei(An("name",e),n);break;case"Voltage gain":case"Current gain":case"Transconductance":case"Transresistance":case"Ratio":Ei(An("name",e),n);break;case"K":var g=[];e.childNodes.forEach(function(e){"part_annotation"===w(e,"c_partid")&&g.push(e)});g[2]&&Ei(g[2],n+"%");Ai(e,t,n);break;case"State":if("SPDT"===a||"SPST"===a){n="spice.open"===n?"Open":"Close";var y,x,v,m=e.childNodes.filter(function(e){return"polyline"===e.tagName})[0],_=w(e,"c_rotation"),b=vt(m),S=function(e,t){var n,r,i=L('path[c_helper_type="arc1"]',e),a=w(i,"d").split(" "),o=[+a[1],+a[2]];if(De(t[0].x,t[0].y,o[0],o[1])<De(t[1].x,t[1].y,o[0],o[1])){n=t[0];r=t[1]}else{n=t[1];r=t[0]}return{close:n,remote:r}}(e,b),C="SPST"===a?9:10,M=Math.abs;switch(_){case"270":case"90":x=S.remote.x+C;v=S.remote.x-C;"Close"===n?M(S.close.x-x)>M(S.close.x-v)?S.remote.x-=C:S.remote.x+=C:M(S.close.x-x)>M(S.close.x-v)?S.remote.x+=C:S.remote.x-=C;break;default:x=S.remote.y+C;v=S.remote.y-C;"Close"===n?M(S.close.y-x)>M(S.close.y-v)?S.remote.y-=C:S.remote.y+=C:M(S.close.y-x)>M(S.close.y-v)?S.remote.y+=C:S.remote.y-=C}y=H([S.close,S.remote]);w(m,"points",y)}else{g=[];e.childNodes.forEach(function(e){"part_annotation"===w(e,"c_partid")&&g.push(e)});var N="high"===n?"1":"0";g[2]&&Ei(g[2],N)}Ai(e,t,n);break;case"Frequency":var P=["DIGITALCLOCK","FUSE","DELAY_FUSE","XTALFAST"];a&&P.indexOf(a)>-1?Ei(An("name",e),n):"FUNCTIONGENERATOR"===a&&l(e,i,t,n);Ai(e,t,n);break;case"Capacitance":Ei(An("name",e),n);break;case"Voltage[V]":Ei(An("name",e),n);Ai(e,t,n);break;case"Color":f(e,n,a);Ai(e,t,n);break;case"Current":Ei(An("name",e),n);Ai(e,t,n);break;case"Waveforms":case"Duty cycle":case"Offset":case"Rise/Fall Time":l(e,i,t,n);Ai(e,t,n);break;default:Ai(e,t,n)}}function l(e,t,n,r){var i,a,o,s,c=e.childNodes,l=t.Waveforms,d=t.Frequency,u=t["Duty cycle"],h=t.Amplitude,f=t.Offset,p=t["Rise/Fall Time"],g=["Frequency","Duty cycle","Amplitude","Offset","Rise/Fall Time"],y=[d,u,h,f,p];if("Waveforms"===n){var x=c.filter(function(e){return"polyline"===e.tagName});i=c.filter(function(e){return"path"===e.tagName})[0];a=x[0];o=x[1];w(i,"stroke","black");w(a,"stroke","black");w(o,"stroke","black");switch(r){case"Sine Wave":w(i,"stroke","red");s="Sin("+d+" "+h+" "+f+")";break;case"Triangular Wave":w(a,"stroke","red");s="Sawtooth("+d+" "+u+" "+h+")";break;case"Rectangular Wave":w(o,"stroke","red");s="Square("+d+" "+u+" "+h+" "+p+")"}}else switch(l){case"Sine Wave":var v=g.indexOf(n);y[v]=r;s="Sin("+y[0]+" "+y[2]+" "+y[3]+")";break;case"Triangular Wave":v=g.indexOf(n);y[v]=r;s="Sawtooth("+y[0]+" "+y[1]+" "+y[2]+")";break;case"Rectangular Wave":v=g.indexOf(n);y[v]=r;s="Square("+y[0]+" "+y[1]+" "+y[2]+" "+y[4]+")"}Ei(An("name",e),s)}function d(e,t,n,r){var i=pn("getSpiceLibByName",[e]),a=[["del",n[0],n[1]]];pn("dataStrToDataUrl",[i]).then(function(e){var i=w(v(n[0]),"c_rotation");ha.removeOne(v(n[0]));qa.appendChild(v(n[0]));M(v(n[0]));var o=v(Qt(e.svg,!0,!1)),s=w(o,"c_origin").split(",").map(function(e){return+e});St(o,t[0]-s[0],t[1]-s[1]);r&&po.lockObjs([o]);i&&lo.g(o,360-i);La.records.pop();La.index-=1;ha.updateOne(o);la.select(o);pn("updateAttrPanel");a.push(["add",o.id]);La.save(a)})}function u(e,t,n,r){for(var i,a=function(e){var t;switch(e){case"Vsin":case"Isin":case"VSin":case"ISin":t="SIN(";break;case"VPULSE":case"IPULSE":t="PULSE(";break;case"VEXP":case"IEXP":t="EXP(";break;case"VSFFM":case"ISFFM":t="SFFM(";break;case"VPWL":case"IPWL":t="PWL("}return t}(t),o=An("name",e).textContent,s=[],c=o.indexOf("("),l=[],d=!1,u=0;u<o.length;u++){var h=o.charAt(u);"("===h&&l.push(h);")"===h&&l.pop();l.length&&(d=!0);if(!l.length&&d){i=u;break}}s=o.substring(c+1,i).split(" ");s[n]=r;var f=s.join(" ");Ei(An("name",e),a+f+")")}function h(e,t,n){var r=e.spicePre,i=e.spiceSymbolName;switch(r){case"I":case"V":case"B":for(var a,o=An("name",t).textContent,s=o.indexOf("("),c=[],l=[],d=!1,u=0;u<o.length;u++){var h=o.charAt(u);"("===h&&l.push(h);")"===h&&l.pop();l.length&&(d=!0);if(!l.length&&d){a=u;break}}c=o.substring(s+1,a).split(" ");n.AC_Amplitude=n.c_para.AC_Amplitude;n.AC_Phase=n.c_para.AC_Phase;switch(i.substr(1)){case"DC":n["DC Value"]=o.indexOf("DC")>-1?1:o;break;case"sin":case"Sin":n["DC offset"]=c[0];n.Amplitude=c[1];n.Freq=c[2];n.Tdelay=c[3];n.Theta=c[4];n.Phi=c[5];break;case"PULSE":n.Vinitial=c[0];n.Von=c[1];n.Tdelay=c[2];n.Trise=c[3];n.Tfall=c[4];n.Ton=c[5];n.Tperiod=c[6];break;case"EXP":n.Vinitial=c[0];n.Vpulsed=c[1];n["Rise Delay"]=c[2];n["Rise Tau"]=c[3];n["Fall Delay"]=c[4];n["Fall Tau"]=c[5];break;case"SFFM":n["DC offset"]=c[0];n.Amplitude=c[1];n["Carrier Freq"]=c[2];n["Modulation Index"]=c[3];n["Signal Freq"]=c[4];break;case"PWL":var f,p,g=0;for(u=0;u<5;u++){f="Time"+(u+1).toString();p="Value"+(u+1).toString();n[f]=c[g];n[p]=c[g+1];g+=2}break;case"_Behavioral_Source":n.Value=o}break;case"X":case"U":switch(i){case"MULTIMETER":n["Multimeter Type"]=e["Multimeter Type"];break;case"FUNCTIONGENERATOR":n.Waveforms=e.Waveforms;n.Frequency=e.Frequency;n["Duty cycle"]="Sine Wave"===e.Waveforms?"":e["Duty cycle"];n.Amplitude=e.Amplitude;n.Offset="Sine Wave"===e.Waveforms?e.Offset:"";n["Rise/Fall Time"]="Rectangular Wave"===e.Waveforms?e["Rise/Fall Time"]:"";break;case"XFMR":case"XFMR_TAP":n.Ratio=n["attr-name"];break;case"LOGICSTATE":case"LOGIC":n.State=e.State;break;case"Potentiometer":case"POTENTIOMETER":case"Potentiometer_3D":n.Resistance=n["attr-name"];n.K=e.K?e.K:"50";break;case"DIGITALCLOCK":case"DELAY_FUSE":n.Frequency=n["attr-name"];break;case"XTALFAST":n.Frequency=n["attr-name"];n.C0=e.C0;n.C1=e.C1;n.R1=e.R1;break;case"FUSE":n.Current=n["attr-name"];break;case"OPAMP3PEE":case"OPAMP3PEECN":case"OPAMP5PEECN":case"OPAMP5PEE":var y=["Gbw","Slewrate","Avol","Rout(Ω)","Rin(Ω)","Ibias[A]","Inhi[V]","Inlo[V]","Isc[A]","Outhi[V]","Outlo[V]"];"OPAMP5PEE"!==i&&"OPAMP5PEECN"!==i||y.push("Vabsmax[V]","Vmin[V]","Iq[A]","Cin[F]");for(u=0;u<y.length;u++)n[y[u]]=e[y[u]];n.Model=n["attr-name"];break;case"MUTUAL_INDUCTORS":case"MUTUAL_INDUCTORS2":y=["Rs1","Rs2","L1","L2","K"];"MUTUAL_INDUCTORS2"===i&&(y=["Rs1","Rs2","Rs3","L1","L2","L3","K"]);for(u=0;u<y.length;u++)n[y[u]]=e[y[u]];break;case"Resistor_3D":n.Resistance=n["attr-name"];break;case"Cap_3D":n.Capacitance=n["attr-name"];break;case"Inductor_3D":n.Inductance=n["attr-name"];break;case"THREE_PHASE_DELTA":case"THREE_PHASE_WYE":n["Voltage[V]"]=n["attr-name"];n["Frequency[Hz]"]=e["Frequency[Hz]"];break;case"LAMP":n.Power=e.Power;n["Dropout Voltage"]=e["Dropout Voltage"];break;case"BCDSEGMENT":case"SEVENSEGMENT":n.Type=e.Type;n.Color=e.Color;break;case"SPST":case"SPDT":n.State="Open"===e.State?"spice.open":"spice.close";break;case"LOGICANALYZER":n.Threshold=e.Threshold;n["Clock Rate"]=e["Clock Rate"];break;case"LED":n.Color=e.Color;n.Model=n["attr-name"]||e.spiceSymbolName;break;default:n.Model=n["attr-name"]}break;case"W":case"S":n.Switch=e.Switch;break;case"R":n.Resistance=n["attr-name"];break;case"C":n.Capacitance=n["attr-name"];break;case"J":case"M":case"Q":case"D":n.Model=n["attr-name"]||e.spiceSymbolName;break;case"L":n.Inductance=n["attr-name"];break;case"E":n["Voltage gain"]=n["attr-name"];break;case"F":n["Current gain"]=n["attr-name"];break;case"G":n.Transconductance=n["attr-name"];break;case"H":n.Transresistance=n["attr-name"]}return n}function f(e,t,n){var r,i={red:["#610000","#FF0000"],yellow:["#595900","#FFFF00"],green:["#005000","#00FF00"],blue:["#003399","#33CCFF"]};t=t.toLowerCase();switch(n){case"LED":var a=e.childNodes.filter(function(e){return"ellipse"===e.tagName})[0];w(a,"stroke",i[t][1]);"none"!==w(a,"fill")&&w(a,"fill",i[t][1]);break;case"SEVENSEGMENT":case"BCDSEGMENT":var o=e.childNodes.filter(function(e){return"polygon"===e.tagName});o.shift();o.forEach(function(e){r=1==w(e,"state")?1:0;w(e,"stroke",i[t][r]);w(e,"fill",i[t][r])})}}function p(e,t,n,r){var i,a=w(e,"abs_type");switch(a){case"multimeter":if(r){var o=e.parentNode,s=w(o,"c_rotation");i=12;if("0"===s||"180"===s||!s)return"quit";w(e,"x",2*t+i-w(e,"x"))}else{o=e.parentNode;s=w(o,"c_rotation");if("90"===s||"270"===s)return"quit";i=12;w(e,"y",2*n+i-w(e,"y"))}break;case"wattmeter_rate":case"wattmeter_freq":m("[rect]",e.parentNode)[2],m("[rect]",e.parentNode)[3];o=e.parentNode;s=w(o,"c_rotation");if(r){i=0;"90"!==s&&"270"!==s||(i=8);w(e,"x",2*t+i-w(e,"x"))}else{if("90"===s||"270"===s)return"quit";i=9;w(e,"y",2*n+i-w(e,"y"))}}}function g(e){var t=["MULTIMETER","WATTMETER","LED","BCDSEGMENT","LAMP","TRAFFICLIGHT","SEVENSEGMENT"];for(var n in e)if(j(e,n)){if(n.indexOf("frame_lib")>-1)continue;var r=Wa.c_paraToJson(e[n].head.c_para),i=r.spiceSymbolName;if(t.indexOf(i)<0)continue;var a=v(n),o=(An("pre",a).textContent,An("name",a).textContent,a.childNodes.filter(function(e){return"part_annotation"===w(e,"c_partid")}));switch(i){case"LED":a.childNodes.forEach(function(e){"ellipse"===e.tagName&&w(e,"fill","none")});break;case"MULTIMETER":if(o[2]){var s=w(a,"locked"),c=w(a,"c_rotation");c&&"0"!==c&&Tr([a],+c);var l,d,u=a.childNodes.filter(function(e){return"rect"===e.tagName});l=u[u.length-1];a.removeChild(o[2]);var h,f,p=Wt("path",{id:Wa.newId(),locked:s,c_shapetype:"line",stroke:"#000000","stroke-width":"1",c_helper_type:"arc",fill:"none"}),g=Wt("polyline",{id:Wa.newId(),locked:s,c_shapetype:"line",stroke:"#000000","stroke-width":"1","stroke-linecap":"round",fill:"none"});d=Wa.svg.getBBox(l);h="M"+(d.x+5)+" "+(d.y+d.height)+" A 20.04 10.07 0 0 1 "+(d.x+45)+" "+(d.y+d.height);f=[d.x+d.width/2,d.y+d.height,d.x+d.width/2+10,d.y+d.height-20];w(p,"d",h);w(g,"points",f.join());a.appendChild(p);a.appendChild(g);c&&"0"!==c&&Tr([a],360-c)}break;case"WATTMETER":var y=a.children.filter(function(e){return"spice_res"===w(e.childNodes[0],"type")});if(y.length){y.forEach(function(e){a.removeChild(e)});var x=a.children.filter(function(e){return"rect"===e.tagName});s=w(a,"locked");c=w(a,"c_rotation");c&&"0"!==c&&Tr([a],+c);var m=x[x.length-2],L=x[x.length-1],_=Wa.svg.getBBox(m),b=Wa.svg.getBBox(L),S=Wt("text",{id:Wa.newId(),fill:"#000000",type:"comment","font-family":"Verdana","font-size":"4pt","text-anchor":"start"}),C=Wt("g",{id:Wa.newId(),c_partid:"part_annotation",locked:s,c_shapetype:"group",c_etype:"pinpart"});p=Wt("path",{id:Wa.newId(),locked:s,c_shapetype:"line",stroke:"#000000",c_helper_type:"arc1",fill:"none","stroke-width":"1"}),g=Wt("polyline",{id:Wa.newId(),locked:s,c_shapetype:"line",stroke:"#000000",fill:"none","stroke-width":"1","stroke-linecap":"round"});S.textContent="Power Factor";C.appendChild(S);var M,N;M=b.x+5;N=b.y+7;h="M"+(_.x+30)+" "+(_.y+_.height)+" A 14.98 10.02 0 1 1 "+(_.x+60)+" "+(_.y+_.height);f=[_.x+45,_.y+_.height,_.x+35,_.y+_.height-10];w(p,"d",h);w(g,"points",f.join());w(S,"x",M);w(S,"y",N);a.appendChild(p);a.appendChild(g);a.appendChild(C);c&&"0"!==c&&Tr([a],360-c)}break;case"LAMP":var P=a.childNodes.filter(function(e){return"ellipse"===e.tagName});w(P[0],"fill","none");break;case"TRAFFICLIGHT":var T=["#610000","#595900","#005000"];P=a.childNodes.filter(function(e){return"ellipse"===e.tagName});P.forEach(function(e,t){w(e,"stroke",T[t]);w(e,"fill",T[t])});break;case"BCDSEGMENT":case"SEVENSEGMENT":var O=a.childNodes.filter(function(e){return"polygon"===e.tagName});O.shift();O.forEach(function(e){w(e,"stroke","#800000");w(e,"fill","#800000")})}ha.updateOne(a)}}function y(e,t,n){var r=e&&e.cloneNode(!1!==t),i=Object.assign({},n),a=de(e);if(!i.keepPadVisibility)if("PAD"===a){r.removeAttribute("visibility");r.removeAttribute("shadow-id")}else"FOOTPRINT"===a&&r&&r.childNodes&&r.childNodes.forEach(function(e){if("PAD"===de(e)){e.removeAttribute("visibility");e.removeAttribute("shadow-id")}});return r}function x(e,t){this.x=+e||0;this.y=+t||0}function v(e,n){return e?n&&n.querySelector?m("#"+e,n)[0]:t.getElementById(e):null}function m(e,n){if(!e||"#"==e)return[];try{return(n||t).querySelectorAll(e)}catch(e){return[]}}function L(e,n){if(!e||"#"==e)return null;try{return(n||t).querySelector(e)}catch(e){return null}}function _(e,t,n){if(e&&t){var r,i,a,o,s;a=t?t.split(/\s+/):[];s=n?"add":!1===n?"remove":"toggle";if(e.classList&&e.classList.toggle)for(r=0;r<a.length;r++)a[r]&&e.classList[s](a[r]);else{var c="object"==typeof e.className,l=c?e.className.baseVal:e.className;i=l?l.split(/\s+/):[];for(r=0;r<a.length;r++)if(a[r]){o=i.indexOf(a[r]);o<0?"remove"!=s&&i.push(a[r]):"add"!=s&&i.splice(o,1)}l=i.join(" ");c?e.className.baseVal=l:e.className=l}}}function b(e,t){if(!e)return!1;if(e.classList)return e.classList.contains(t);var n="object"==typeof e.className?e.className.baseVal:e.className;return t&&n&&n.split(/\s+/).indexOf(t)>=0}function S(e,t){if(e&&t){var n,r=t?t.split(/\s+/):[];if(e.classList)for(n=0;n<r.length;n++)r[n]&&e.classList.add(r[n]);else{var i="object"==typeof e.className,a=i?e.className.baseVal:e.className,o=a?a.trim().split(/\s+/):[];for(n=0;n<r.length;n++)r[n]&&o.indexOf(r[n])<0&&o.push(r[n]);a=o.join(" ");i?e.className.baseVal=a:e.className=a}}}function C(e,t){var n,r,i=t?t.split(/\s+/):[];if(e.classList)for(n=0;n<i.length;n++)i[n]&&e.classList.remove(i[n]);else{var a="object"==typeof e.className,o=a?e.className.baseVal:e.className,s=o?o.trim().split(/\s+/):[];for(n=0;n<i.length;n++){r=s.indexOf(i[n]);r>=0&&s.splice(r,1)}o=s.join(" ");a?e.className.baseVal=o:e.className=o}}function M(e){if(e&&e.parentNode)return e.parentNode.removeChild(e)}function w(e,t,n){if(!e)return null;var r,i,a,o,s=arguments.length;if(e.tagName){if("string"==typeof t){if(2===s)return e.getAttribute(t);if(t.indexOf(":")>0){i=t.substr(0,t.indexOf(":"));if(i in $i){a=t.substr(i.length+1);Ha?e.setAttributeNS($i[i],t,n):e.setAttributeNS($i[i],a,n)}}else{e.setAttribute(t,n);if(""===n||null===n||void 0===n){"transform"===t&&e.setAttribute(t,"");e.removeAttribute(t)}}return e}for(r in t)if(j(t,r))if(r.indexOf(":")>0){i=r.substr(0,r.indexOf(":"));if(i in $i){a=r.substr(i.length+1);""===t[r]?e.hasAttributeNS($i[i],a)&&e.removeAttributeNS($i[i],a):Ha?e.setAttributeNS($i[i],r,t[r]):e.setAttributeNS($i[i],a,t[r])}}else if(""===t[r]){if(e.hasAttribute(r)){"transform"===r&&e.setAttribute(r,"");e.removeAttribute(r)}}else e.setAttribute(r,t[r]);return e}if(Array.isArray(e)||e instanceof NodeList||e instanceof HTMLCollection||Ga&&"number"==typeof e.length){if("string"==typeof t&&2==s)return e[0]?w(e[0],t):null;if(2==s)for(o=0;o<e.length;o++)w(e[o],t);else if(s>=3)for(o=0;o<e.length;o++)w(e[o],t,n);return e}}function N(e,t){if(!e||!t)return e;if(e.removeAttribute)e.removeAttribute(t);else if(e.length)for(var n=0,r=e.length;n<r;n++)e[n]&&e[n].removeAttribute&&e[n].removeAttribute(t)}function P(e){var t,n=e.attributes,r=n?n.length:0,i={};for(t=0;t<r;t++){var a=n[t].name;a.match(/[a-z]/)||(a=a.toLowerCase());i[a.toLowerCase()]=n[t].value}return i}function T(e){return"part_lib_sheet"===w(e,"c_partid")}function O(e){return b(e,"fakeSegment")}function k(e){var t,n,r;for(t=e.childNodes,n=t.length-1,r="";n>=0;n--){r=t[n].tagName;if(!r||r.indexOf(":")>0||"script"===r||"metadata"===r)e.removeChild(t[n]);else{A(t[n]);t[n].childNodes.length>0&&"text"!==r&&"tspan"!==r&&k(t[n])}}}function A(e){var t,n=e.attributes,r=n.length,i={};for(t=r-1;t>=0;t--)if(n[t].nodeName.indexOf(":")>0){var a=n[t].namespaceURI;if(a in $i){if(!1===/^c:|^xlink:|^xml:|^xmlns:/.test(n[t].nodeName))try{if(a===NS_c){if(n[t].prefix!==$i[NS_c]){i[$i[NS_c]+":"+n[t].localName]=n[t].nodeValue;e.removeAttributeNode(n[t])}}else e.removeAttributeNode(n[t])}catch(e){parent.$.messager.alert(e.message)}}else e.removeAttributeNode(n[t])}else if(0===n[t].nodeName.indexOf("on"))try{e.removeAttributeNode(n[t])}catch(e){parent.$.messager.alert(e.description)}w(e,i)}function E(e,t){for(var n,r=[],i=[],a=[],o=0,s=e.length;o<s;o++){r[o]=o;n=t?e[o][t]||"":e[o];i[o]=n.toUpperCase().match(/\D+|\d+(?:\.\d+)?/g);a[o]=[];if(i[o])for(var c=0;c<i[o].length;c++)a[o][c]=i[o][c].match(/\d/)?1:2}var l=function(e,t){var n=i[e],r=i[t],o=a[e],s=a[t];if(!n||!r)return n==r?0:n?1:-1;for(var c=0,l=Math.max(n.length,r.length);c<l;c++){if(!n[c])return-1;if(!r[c])return 1;if(n[c]!=r[c])return o[c]!=s[c]?1==o[c]?-1:1:1==o[c]?n[c]-r[c]:n[c]<r[c]?-1:1}return 0};r.sort(l);var d=[];for(o=0;o<s;o++)d[o]=e[r[o]];return d}function I(e){return t.createTextNode(e||"")}function j(e,t){return!!e&&e.hasOwnProperty(t)}function B(e){try{return JSON.parse(e)}catch(e){return null}}function D(e){try{return e?JSON.parse(JSON.stringify(e)):e}catch(t){return e}}function F(e,t){if(!e)return null;t=!0===t;try{var n=(new DOMParser).parseFromString(e,"text/xml");if(!n||n.querySelector("parsererror")){!t&&(parent.$||self.$).messager.error("ERROR: svg parsererror");return null}return n}catch(e){!t&&(parent.$||self.$).messager.error("ERROR: svg parsererror");return null}}function R(){for(var e=[],t=Ji.children,n=wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE,r=0,i=t.length;r<i;r++){var a=t[r];if(1===a.nodeType&&a.id){if(n){var o=de(a);if(!o||"RATLINE"==o)continue}e.push(a.id)}}return e}function V(){for(var e=m("[id]",Ji),t=0,n=/^[^\d]*(\d+)$/,r=0,i=e.length;r<i;r++)if(n.test(e[r].id)){var a=+RegExp.$1;a&&a<1e8&&(t=Math.max(t,a))}return t}function G(e){return(e||"").replace(/[ ,]{2,}| /g,",").split(",")}function z(e){for(var t=[],n=G(e),r=n.length-1,i=0;i<r;i+=2)t[i/2]=new x(+n[i],+n[i+1]);return t}function H(e,t){var n;t&&t.match(/^PCB/i)&&(n={decimalPlaces:4});if(e&&e.length>=2){for(var r=[],i=0;i<e.length;i++)e[i]&&r.push(Wa.formatLengthSave(e[i].x,n),Wa.formatLengthSave(e[i].y,n));return r.join(" ")}return""}function U(e){return e.x+"_"+e.y}function Y(){}function J(e){return Array.isArray(e)||e&&"object"==typeof e&&"[object String]"!=Object.prototype.toString.call(e)&&"number"==typeof e.length&&e.length>=0&&e.length<4294967296&&e.length%1==0}function W(e){return Array.isArray(e)}function X(e){return e?e.trim?e.trim():e.replace(/^\s+|\s+$/g,""):""}function Q(e){for(var t,n=e;n!=t;){t=n;n=t.replace(/~|\^\^|#@\$|`|#sheet#/gi,"")}return n}function K(e,t){var n;for(n in e)if(j(e,n)&&j(t,n)&&e[n]===t[n]){delete e[n];delete t[n]}}function q(e){if(null===e||void 0===e||""===e)return"";e=ie(e);return e}function Z(e,t){var n;for(var r in t)if(j(t,r)&&-1!==e.indexOf(r)){n=!0;break}return n}function ee(e){function t(e){return n[e]}if(void 0===e||null===e)return"";if("string"!=typeof e)return e;var n={"~":"&#126;","^":"&#94;","#@$":"&#35;&#64;&#36;","`":"&#96;"};return Z(e,n)?e.replace(/(\~|\^|#@\$|\`)/g,t):e}function te(e){function t(e){return n[e.toLowerCase()]}if(void 0===e||null===e)return"";if("string"!=typeof e)return e;var n={"&#126;":"~","&#94;":"^","&#35;&#64;&#36;":"#@$","&#96;":"`","&apos;":"'","&APOS;":"'"};return e.replace(/&#96;|&#126;|&#94;|&#35;&#64;&#36;|&apos;/gi,t)}function ne(e){function t(e){return n[e]}if(void 0===e||null===e)return"";if("string"!=typeof e)return e;var n={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","&":"&amp;"};return e.replace(/[<>'"&]/g,t)}function re(e){function t(e){return n[e.toLowerCase()]}if(void 0===e||null===e)return"";if("string"!=typeof e)return e;var n={"&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&amp;":"&","&#039;":"'"};return e.replace(/&lt;|&gt;|&quot;|&apos;|&amp;|&#039;/gi,t)}function ie(e){if(void 0===e||null===e)return"";e=e.replace(/&/g,"&amp;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");e=e.replace(/"/g,"&quot;");e=e.replace(/'/g,"&#039;");return e}function ae(e){if(wa.lsCache)return j(wa.lsCache,String(e))?wa.lsCache[e]:null;try{return localStorage.getItem(e)}catch(e){return null}}function oe(e,t){if(wa.lsCache)wa.lsCache[e]=String(t);else try{localStorage.setItem(e,t)}catch(n){wa.localStorageDisabled=1;wa.lsCache={};wa.lsCache[e]=String(t)}}function se(){function e(e){return navigator.userAgent.indexOf(e)}return e("chromeframe")>0||e("x-clock")>0?"chromeframe":e("MSIE")>0||e("Trident")>=0?"ie":e("Edge/")>0?"edge":e(" Edg/")>0?"edg":e("Electron/")>0?"electron":e("Firefox/")>0?"firefox":e("Opera/")>0?"opera":e("Chrome/")>0?"chrome":e("Safari/")>0?"safari":"other"}function ce(e,t,n){var r=+e;t="-"!=t?"+":"-";if(r<=0||isNaN(r))return"100";var i=n&&n.min||.1;if(r<i||r==i&&"-"==t)return i.toString();var a=n&&n.max||1e5;if(r>a||r==a&&"+"==t)return a.toString();e=r<1?(10+r+"").substr(1):r+"";e=e.replace(/([1-9]\.?\d)(.*)/,function(e,t,n){return t+n.replace(/[1-9]/g,"0")});e.match(/[1-9]$/)&&(e=e.indexOf(".")<0?e+".0":e+"0");var o,s,c=e.match(/([1-9])\.?(\d)/),l=c[1]+c[2],d="--,10,14,20,27,38,54,75,AA".split(",");Ba&&(d="--,10,12,15,17,20,25,30,35,40,50,60,80,90,AA".split(","));for(o=1;o<d.length;o++){if(l==d[o]){s=d["+"==t?o+1:o-1];break}if(l<d[o]){s=d["+"==t?o:o-1];break}}if("AA"==s){s=d[1];e=e.replace(/([1-9])(\.?)(\d)/,s[0]+"$2"+s[1]);e=function(e){return e.indexOf(".")<0?e+"0":e.replace(/\.(\d)/,"$1.").replace(/^0+(?!\.)/,"").replace(/\.$/,"")}(e)}else if("--"==s){s=d[d.length-2];e=e.replace(/([1-9])(\.?)(\d)/,s[0]+"$2"+s[1]);e=function(e){return e.indexOf(".")<0?e.replace(/\d$/,".$&").replace(/^\./,"0."):e.replace(/(\d)\./,".$1").replace(/^\./,"0.")}(e)}else e=e.replace(/([1-9])(\.?)(\d)/,s[0]+"$2"+s[1]);return function(e){return e.indexOf(".")>0?e.replace(/\.?0*$/,""):e}(e)}function le(e,t){if("canvas"!==t.cmdKey){var n,r=["attr-topic","groupAttr","cmdKey","attr-selected-count","sameType"];t.c_para&&(t.c_para=Wa.c_paraToJson(t.c_para));if(!t)return!1;e.sameType=!j(e,"sameType")||e.sameType;if(-1===e.cmdKey.split(",").indexOf(t.cmdKey)){e.sameType=!1;e.cmdKey+=","+t.cmdKey}for(n in e){j(e,n)&&!j(t,n)&&-1===r.indexOf(n)&&delete e[n];if(e[n]&&!isNaN(e[n])&&t[n]&&!isNaN(t[n])){e[n]=+Wa.formatLengthShow(e[n]);t[n]=+Wa.formatLengthShow(t[n])}e[n]!=t[n]&&"c_para"!==n&&-1===r.indexOf(n)&&(e[n]="<...>")}if(e.c_para)if(t.c_para){e.c_para||(e.c_para={});for(n in t.c_para)j(t.c_para,n)&&(j(e.c_para,n)?e.c_para[n]!==t.c_para[n]&&(e.c_para[n]="<...>"):e.c_para[n]="<...>")}else delete e.c_para}}function de(e){var t=void 0!==wo;t=t?wo:getActiveDoctype();if(t){var n=Le(t)?Wa.getSCHCmdKey(e):Wa.getPCBCmdKey(e);va&&"draw(origin)"===va&&(n="origin");return n}}function ue(e){return MD5(Date.now()+ot(!0,3,32)+e).substr(8,16)}function he(e){void 0===e&&(e="");return e?MD5(e).substr(8,16):null}function fe(t,n,r,i,a,o){var s=t?t.schlib||t.FOOTPRINT:null;if(s){a="md5Id"===a;o="wait"===o;var c=!!t.schlib,l=[],d=Ya&&Ya.fileList;if(c&&n&&d&&j(d,n)){var u,h;for(u in d)if(j(d,u)){h=d[u].schlib;if(u==n||!h)continue;l=l.concat(Object.keys(h))}}var f,p,g,y,x=!!e.frameElement,v={},m={},L=[],_=[];for(f in s)if(j(s,f)){if(f.indexOf("frame_lib_")>=0){m[f]=s[f];continue}g=s[f];y=ge(g,"pre");y&&i&&(L.indexOf(y)<0?L.push(y):_.indexOf(y)<0&&_.push(y));if(a){if(y){p="gge"+he(y);l.indexOf(p)>=0&&(p="")}p||(p="gge"+ue())}else p="old_"+f;l.push(p);if(p==f){m[f]=s[f];continue}m[p]=s[f];m[p].head&&m[p].head.gId&&(m[p].head.gId=p);v[f]=p}if(pe(_,c))return!1;if(Object.keys(v).length){t[c?"schlib":"FOOTPRINT"]=m;d&&d[n]&&(d[n].schlib=m)}else;var b={saved:!1};if(x){ar(v,m,c);La.clear(b)}else if(r){r.querySelector||(r=null);editorCall("updateDomId",[v,m,c],r);editorCall("clearHistory",[b],r)}return!!a||!o&&fe(t,n,r,i,"md5Id")}}function pe(t,n){var r=!!e.frameElement;if(t.length){var i="Reset failed! There are duplicate component prefixs in the current "+(n?"schematic":"PCB")+":";i=r?parent.Locale.i18n(i):Locale.i18n(i);i="<p>"+i+"</p><ul>";t.forEach(function(e){i+="<li>"+e+"</li>"});i+="</ul>";var a="Please modify the component prefixs first to ensure that the component prefix is unique.";i+=r?parent.Locale.i18n(a):Locale.i18n(a);r?parent.$.messager.warn(i):$.messager.warn(i);return!0}return!1}function ge(e,t){var n=e?e.annotation:null,r="mark",i="string";if(!n){n=e.TEXT;r="type";i="text"}if(n){var a,o="pre"==t?"P":"N";for(var s in n)if(j(n,s)){a=n[s];if(a[r]==o)return a[i]}}}function ye(){var e,t=/{([\d\w.]+)}/g,n=Array.prototype.slice.call(arguments),r=n.shift()+"";1==n.length&&"object"==typeof n[0]&&(n=n[0]);t.lastIndex=0;return r.replace(t,function(t,r){e=n[r];return void 0===e?t:e})}function xe(e,t,n){e=e||Ji;"string"==typeof n&&(n=v(n));n?e.insertBefore(t,n):e.appendChild(t)}function ve(e){function t(e){return e>=10?e:"0"+e}var n=new Date(e);return n.getFullYear()+"-"+t(n.getMonth()+1)+"-"+t(n.getDate())+" "+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())}function me(e){return e==ia.SCH||e==ia.SUBCKT}function Le(e){return me(e)||e==ia.SUBPART||e==ia.SPICESYMBOL||e==ia.WAVEFORM||/^sch/i.test(aa[e])}function _e(e){return/^pcb/i.test(aa[e])}function be(e){var t,n,r;if(Array.isArray(e)){t=new Array(e.length);for(var i=0,a=e.length;i<a;i++){r=e[i];t[i]=null!==r&&"object"==typeof r?be(r):r}return t}t={};for(n in e)j(e,n)&&(t[n]="object"==typeof e[n]&&null!==e[n]?be(e[n]):e[n]);return t}function Se(e){var t=[];len=e&&e.length;if(!len)return t;for(var n,r=0;r<len;r++){n=e[r].id;n&&t.push(n)}return t}function Ce(e,t){var n=[];if(!e||!W(t))return n;var r,i,a;for(a in e)if(t.indexOf(a)>=0){r=e[a];if("object"==typeof r)for(i in r)n.push(i)}return n}function Me(e,t){var n=t&&t.length;if(e&&n)for(var r=0;r<n;r++)delete e[t[r]]}function we(e,t,n,r){var i=e.x,a=e.y,o=t.x,s=t.y,c=n.x,l=n.y,d=o-i,u=s-a,h=d*d+u*u,f=((c-i)*d+(l-a)*u)/h;return(f>1||f<0)&&r?null:{x:i+f*d,y:a+f*u}}function Ne(e,t,n,r){var i=e.x,a=e.y,o=t.x,s=t.y,c=n.x,l=n.y,d=o-i,u=s-a,h=d*d+u*u;void 0===r&&(r=0);var f=((c-i)*d+(l-a)*u)/h;if(!(f>=1+r||f<=0)){var p=i+f*d,g=a+f*u,y=p-c,x=g-l;return{point:{x:p,y:g},distance2:y*y+x*x}}}function Pe(e,t,n){var r=e.x,i=e.y,a=t.x,o=t.y,s=n.x,c=n.y,l=a-r,d=o-i,u=l*l+d*d;if(0===u)return(s-r)*(s-r)+(c-i)*(c-i);var h=((s-r)*l+(c-i)*d)/u,f=r+h*l,p=i+h*d,g=f-s,y=p-c;return g*g+y*y}function Te(e,t,n,r){var i=e.x,a=e.y,o=t.x,s=t.y,c=n.x,l=n.y,d=r.x,u=r.y,h=o-i,f=s-a,p=c-d,g=l-u,y=f*p-h*g;return y?{x:(h*p*(l-a)-c*h*g+i*f*p)/y,y:(f*g*(c-i)-l*f*p+a*h*g)/-y}:null}function Oe(e,t,n){var r,i=-1,a=t.getAttribute("stroke-width")/2,o=a;n&&(a+=n);var s,c,l=a*a,d=z(w(t,"points"));s=d[0];if(Je(e,s)||Be(e.x,e.y,s.x,s.y)<o*o)return 0;for(var u=0;u<d.length-1;u++){s=d[u];c=d[u+1];Je(e,c)&&(i=2*(u+1));if(!Je(s,c)){var h=Ne(s,c,e);if(h){if(h.distance2<=l&&(void 0===r||h.distance2<r)){r=h.distance2;i=2*u+1}}else Be(e.x,e.y,c.x,c.y)<o*o&&(i=2*(u+1))}}return i}function ke(e,t,n,r){function i(e,t){return e.x==t.x&&e.y==t.y}var a=i(e,n)||i(e,r)?e:i(t,n)||i(t,r)?t:null;if(a)return{x:a.x,y:a.y};var o,s,c,l,d,u,h,f,p;o=t.x-e.x;s=t.y-e.y;c=r.x-n.x;l=r.y-n.y;h=c*s-l*o;if(0===h)return!1;f=n.x-e.x;p=n.y-e.y;u=(o*p-s*f)/h;d=(c*p-l*f)/h;return u>=0&&u<=1&&d>=0&&d<=1&&{x:e.x+d*o,y:e.y+d*s}}function Ae(e,t,n){n=n||{x:ba.canvas.originX,y:ba.canvas.originY};var r={x:+e.x,y:+e.y},i=t||+w(v("gridPattern"),"width"),a=t||+w(v("gridPattern"),"height"),o=(e.x-n.x)%i,s=(e.y-n.y)%a;if(!i||!a)return r;if(o){o<0&&(o+=i);r.x+=-o+(o<i/2?0:i)}if(s){s<0&&(s+=a);r.y+=-s+(s<a/2?0:a)}r.x=Wa.toFixed(r.x,2);r.y=Wa.toFixed(r.y,2);return r}function Ee(e,t,n){if(!t)return null;var r,i,a,o=t.length,s=null,c=t[0].x,l=t[0].y,d=c,u=l,h=e.x,f=e.y;for(r=1;r<o;r++){i=t[r].x;a=t[r].y;c>i&&(c=i);l>a&&(l=a);d<i&&(d=i);u<a&&(u=a)}if(h<c-n||f<l-n||h>d+n||f>u+n)return null;for(r=1;r<o;r++){s=Ie(e,t[r-1],t[r]);if(s.d<n)return s}return null}function Ie(e,t,n){var r,i,a,o,s,c,l,d=+t.x,u=+t.y,h=+n.x,f=+n.y,p=+e.x,g=+e.y,y=h-d,x=f-u,v=p-d,m=g-u;if(0===y&&0===x)return{d:Math.sqrt(v*v+m*m),point:{x:d,y:u}};r=(v*y+m*x)/(y*y+x*x);if(r<0)return{d:Math.sqrt(v*v+m*m),point:{x:d,y:u}};if(r>1){i=p-h;a=g-f;return{d:Math.sqrt(i*i+a*a),point:{x:h,y:f}}}c=d+r*y;l=u+r*x;o=p-c;s=g-l;return{d:Math.sqrt(o*o+s*s),point:{x:c,y:l}}}function je(e,t,n,r){var i=n-e,a=r-t,o=Math.atan2(a,i);o=o<0?o+Math.PI+Math.PI:o;return o}function Be(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}function De(e,t,n,r){return Math.sqrt(Be(e,t,n,r))}function Fe(e,t,n,r){t=+t;n=+n;r=+r;if(void 0===n||void 0===r)return e.slice(0);t=Ue(t);if(!t)return e.slice(0)
;for(var i=e.slice(0),a=i.length,o=0;o<a;o++)"number"!=typeof i[o]&&(i[o]-=0);if(!j(Xi,t)){Xi[t]=Math.sin(t*Math.PI/180);Qi[t]=Math.cos(t*Math.PI/180)}var s=Xi[t],c=Qi[t];for(o=0;o<a;o+=2){var l=i[o],d=i[o+1],u=l-n,h=d-r;i[o]=n+c*u-s*h;i[o+1]=r+c*h+s*u}return i}function Re(e,t,n,r){var i=[e.x,e.y,e.x+e.width,e.y,e.x,e.y+e.height,e.x+e.width,e.y+e.height];i=Fe(i,t,n,r);var a={x:Math.min(i[0],i[2],i[4],i[6]),y:Math.min(i[1],i[3],i[5],i[7])};a.width=Math.max(i[0],i[2],i[4],i[6])-a.x;a.height=Math.max(i[1],i[3],i[5],i[7])-a.y;return a}function Ve(e,t){var n,r=w(e,"transform");if(!r||r.indexOf("rotate")<0)return 0;n=t?r.match(/rotate\(([\-\+]?[\d\.]+)(?:[,\s]+([\-\+]?[\d\.]+)[,\s]+([\-\+]?[\d\.]+))?\)/):r.match(/rotate\(([\-\+]?[\d\.]+).*?\)/);if(!n)return 0;var i=n[1]%360;i<0&&(i+=360);return t?{ang:i,ox:+n[2],oy:+n[3]}:i}function Ge(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=e[0]-t[0],o=e[1]-t[1];return[a*i-o*r+t[0],o*i+a*r+t[1]]}function ze(e,t,n){return Ge(e,t,n*Math.PI/180)}function He(e,t,n){if(null===n)return e;n="string"==typeof n?-parseInt(n):-n;return Ge(e,t,n*Math.PI/180)}function Ue(e){return e<0?(360+e%360)%360:e>=360?e%360:e}function Ye(e,t,n){var r=e-t;n||(n=1e-10);return(r>0?r:-r)<n}function Je(e,t,n){n||(n=.001);var r=e.x-t.x,i=e.y-t.y;return(r>0?r:-r)<n&&(i>0?i:-i)<n}function We(e,t){var n=e-t;return(n>0?n:-n)<.1}function Xe(e,t,n,r,i){var a={x:n,y:r};if(Math.abs(e.x-t.x)<1e-4&&Math.abs(e.y-t.y)<1e-4)return(e.x-n)*(e.x-n)+(e.y-r)*(e.y-r)<1e-4?[{x:e.x,y:t.y}]:[];var o=we(e,t,a),s=De(n,r,o.x,o.y);if(s-i>1e-4)return[];if(Math.abs(s-i)<1e-4)return[o];if(s<1e-4)var c=Math.atan2(t.y-e.y,t.x-e.x)+Math.PI/2;else c=Math.atan2(r-o.y,n-o.x);var l=$e(o,c),d=($e(a,c),Math.sqrt(i*i-s*s)),u={x:l.x,y:l.y+d},h={x:l.x,y:l.y-d};return[$e(u,-c),$e(h,-c)]}function Qe(e,t,n,r,i){var a=[];arr=Xe(e,t,n,r,i);arr.forEach(function(n){Ke({x:n.x,y:n.y},e,t)&&a.push({x:n.x,y:n.y})});return a}function Ke(e,t,n){function r(e){if(!e)return!1;e.x=Number(e.x);e.y=Number(e.y);return!isNaN(e.x)&&!isNaN(e.y)}if(!(r(e)&&r(t)&&r(n)))return null;var i=t.x-n.x>0?t.x:n.x,a=t.y-n.y>0?t.y:n.y,o=t.x-n.x>0?n.x:t.x,s=t.y-n.y>0?n.y:t.y,c=e.x,l=e.y;return c<=i+.001&&c>=o-.001&&l<=a+.001&&l>=s-.001}function $e(e,t){var n=Math.cos(t),r=Math.sin(t);return{x:e.x*n+e.y*r,y:e.y*n-e.x*r}}function qe(e,t,n){return!!Ke(e,t,n)&&Ye((e.x-t.x)*(n.y-t.y),(n.x-t.x)*(e.y-t.y),.001)}function Ze(e,t,n){var r=Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x);if(n){r>Math.PI&&(r-=2*Math.PI);r<-Math.PI&&(r+=2*Math.PI);return r}return r}function et(e,t,n){var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x);return r>0?"顺时针":r<0?"逆时针":0===r?"共线":void 0}function tt(e,t){return e.x==t.x&&e.y==t.y}function nt(e,t){for(var n=t.points,r=1;r<n.length;r+=1)if(qe(e,n[r-1],n[r]))return r;return-1}function rt(e){e=e.trim();if("M"!==e[0])return null;var t=e.slice(1).split("A");if(2!==t.length)return null;var n=t[0].trim().split(",").reduce(function(e,t){return e.concat(t.trim().split(" "))},[]),r=t[1].trim().split(",").reduce(function(e,t){return e.concat(t.trim().split(" "))},[]);return 7!==r.length?null:r[0]!==r[1]?null:{M:{x:Number(n[0]),y:Number(n[1])},A:{rx:Number(r[0]),ry:Number(r[1]),rotation:Number(r[2]),largeArc:Number(r[3]),clockwise:Number(r[4]),x:Number(r[5]),y:Number(r[6])}}}function it(e){"string"==typeof e&&(e=rt(e));var t=e.M,n=e.A,r=e.A.rx,i=Math.atan2(n.y-t.y,n.x-t.x),a=$e(t,i),o=$e(n,i),s=De(a.x,a.y,o.x,o.y)/2;r<s&&(r=s);var c=Math.sqrt(r*r-s*s),l=e.A.largeArc===e.A.clockwise?1:-1;return $e({x:a.x+s,y:a.y-c*l},-i)}function at(e){var t,n,r,i,a=[];W(e[0])?e.forEach(function(e){a=a.concat(e)}):a=e;if("object"!=typeof a[0]){var o=D(a);a=[];o.forEach(function(e,t){o[t+1]&&t%2==0&&a.push({x:e,y:o[t+1]})})}a.forEach(function(e){(void 0===t||e.x<t)&&(t=e.x);(void 0===n||e.x>n)&&(n=e.x);(void 0===i||e.y>i)&&(i=e.y);(void 0===r||e.y<r)&&(r=e.y)});return{xMin:t,xMax:n,yMin:r,yMax:i}}function ot(e,t,n){t=t||1;n=n||32;var r="",i=t,a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];e&&(i=Math.round(Math.random()*(n-t))+t);for(var o=0;o<i;o++){pos=Math.round(Math.random()*(a.length-1));r+=a[pos]}return r}function st(e){for(var t,n=vt(e),r={x:Wa.toFixed(n[0].x,1),y:Wa.toFixed(n[0].y,1)},i=n.length,a={x:Wa.toFixed(n[1].x,1),y:Wa.toFixed(n[1].y,1)},o=2;o<i;o++){t=Pe(r,a,{x:Wa.toFixed(n[o].x,1),y:Wa.toFixed(n[o].y,1)});if(t)return!1}return!0}function ct(e,t){function n(e,t){return[e[0]-t[0],e[1]-t[1]]}function r(e,t){return e[0]*t[0]+e[1]*t[1]}function i(e){return e[0]*e[0]+e[1]*e[1]}function a(e,t){return i(n(e,t))}function o(e,t,s,c,l){if(!(c<=s+1)){for(var d,u,h,f,p,g=s,y=0,x=e*e,v=[t[s],t[c]],m=n(v[1],v[0]),L=i(m,m),_=s+1;_<c;_++){d=n(t[_],v[0]);f=r(d,m);if(f<=0)p=a(t[_],v[0]);else if(L<=f)p=a(t[_],v[1]);else{h=f/L;u=[v[0][0]+h*m[0],v[0][1]+h*m[1]];p=a(t[_],u)}if(!(p<=y)){g=_;y=p}}if(y>x){l[g]=1;o(e,t,s,g,l);o(e,t,g,c,l)}}}var s,c,l,d,u=e.length,h=[],f=t*t,p=[],g=[];p[0]=e[0];for(s=c=1,d=0;s<u;s++)if(!(a(e[s],e[d])<f)){p[c++]=e[s];d=s}d<u-1&&(p[c++]=e[u-1]);g[0]=g[c-1]=1;o(t,p,0,c-1,g);for(s=l=0;s<c;s++)g[s]&&(h[l++]=p[s]);return h}function lt(e,t,n){if(e&&!(t.length<=4)){for(var r,i,a=[],o=[],s=[],c=0,l=0,d=t.length;c<d;c+=2){a[l]=[t[c],t[c+1]];o[l]=t[c];s[l]=t[c+1];l++}n<0&&(n=0);if(void 0===n){r=Math.max.apply(null,o)-Math.min.apply(null,o);i=Math.max.apply(null,s)-Math.min.apply(null,s);n=Math.min(.1/Za,Math.max(.01*r,.01*i));if(!n)return}var u=ct(a,n);if(2*u.length!==d){var h=u.slice(1).join(" ").replace(/,/g," ");"path"===e.tagName?w(e,"d","M"+t[0]+" "+t[1]+" L"+h):"polyline"!==e.tagName&&"polygon"!==e.tagName||w(e,"points",t[0]+" "+t[1]+" "+h)}}}function dt(e){return Wa.svg.getViewBBox(e)}function ut(e,t,n){function r(e){return new RegExp(e+"\\((.*?)\\)")}if(t%360==0)return"";n||(n="");n.match(r("translate"))||(n+="translate(0,0)");var i=n.match(r("translate"))[1].split(","),a=+i[0],o=+i[1];e.width=+e.width;e.height=+e.height;var s=" rotate("+t+","+e.x+","+e.y+")";if(90==t){a=e.height;o=0}else if(180==t){a=e.width;o=e.height}else if(270==t){o=e.width;a=0}return"translate("+a+","+o+")"+s}function ht(e){return{x:+w(e,"x"),y:+w(e,"y"),width:+w(e,"width"),height:+w(e,"height")}}function ft(e,t){var n=Ve(e),r=Ue(n+(t||0));w(e,"transform",r?ut(ht(e),r,w(e,"transform")):"");w(e,"c_rotation",r?360-r:0)}function pt(e){"string"==typeof e||e.tagName&&(e=w(e,"d"));return e.replace(/\,/g," ").replace(/(?=\S)([\+\-A-Z])/gi,"  $1").replace(/([A-Za-z])(?=\S)/g,"$1 ").replace(/^\s+|\s+$/g,"").split(/\s+/g)}function gt(e){var t=So.getViewBox();return{x:t[0]+e.x/Za,y:t[1]+e.y/Za}}function yt(e){return xt(e)}function xt(e){if(e&&e.points){var t,n,r,i,a,o,s,c,l,d,u,h,f,p,g=e.points,y=g.numberOfItems;for(i=y-2;i>=0;i--){t=g.getItem(i);n=g.getItem(i+1);We(t.x,n.x)&&We(t.y,n.y)&&(0===i?g.removeItem(i+1):g.removeItem(i))}y=g.numberOfItems;for(i=y-2;i>=1;i--){t=g.getItem(i-1);r=g.getItem(i);n=g.getItem(i+1);if(We(t.x,r.x)&&We(n.x,r.x)){o=t.x+n.x+r.x;s=Math.abs(o-3*n.x);c=Math.abs(o-3*r.x);o=Math.abs(o-3*t.x);l=Math.min(o,s,c);l==o?n.x=r.x=t.x:t.x=l==s?r.x=n.x:n.x=r.x;var x=(t.y+n.y+r.y)/3;o=Math.abs(t.y-x);s=Math.abs(n.y-x);c=Math.abs(r.y-x);l=Math.min(o,s,c);l==o?g.removeItem(i-1):l==s?g.removeItem(i+1):g.removeItem(i)}else if(We(t.y,r.y)&&We(n.y,r.y)){o=t.y+n.y+r.y;s=Math.abs(o-3*n.y);c=Math.abs(o-3*r.y);o=Math.abs(o-3*t.y);l=Math.min(o,s,c);l==o?n.y=r.y=t.y:t.y=l==s?r.y=n.y:n.y=r.y;tt(t,n)?g.removeItem(i+1):g.removeItem(i)}else{o=Math.atan((t.y-r.y)/(t.x-r.x));s=Math.atan((n.y-r.y)/(n.x-r.x));Math.abs(o-s)<Math.PI/180&&g.removeItem(i)}}if("none"!==ba.canvas.removeLoop){y=g.numberOfItems;for(i=3;i<y;i++){u=[g.getItem(i-1),g.getItem(i)];for(a=1;a<i-1;a++){h=[g.getItem(a-1),g.getItem(a)];d=ke({x:u[0].x,y:u[0].y},{x:u[1].x,y:u[1].y},{x:h[0].x,y:h[0].y},{x:h[1].x,y:h[1].y});if(d){if(1===a&&i===y-1&&Je(u[1],h[0]))continue;for(f=a;f<i;f++)g.removeItem(a);p=fa.createSVGPoint();p.x=d.x;p.y=d.y;g.insertItemBefore(p,a);i=2;y=g.numberOfItems;break}}}}}}function vt(e,t){var n,r,i=[],a=e.points,o=a.numberOfItems;for(r=0;r<o;r++){n=a.getItem(r);switch(t){case 1:i.push(n.x,n.y);break;case 2:i[r]=[n.x,n.y];break;default:i[r]={x:n.x,y:n.y}}}return i}function mt(e){var t=fa.createSVGPoint();t.x=e.x;t.y=e.y;return t}function Lt(e){if(e&&(e.length||e.tagName)){e.tagName&&(e=[e]);var t,n,r,i,a,o=e.length;for(r=0;r<o;r++){t=w(e[r],"c_origin");if(t){n=t.split(",");return{x:+n[0],y:+n[1]}}}for(r=0;r<o;r++){a=e[r];switch(a.tagName){case"polyline":case"polygon":var s=G(w(a,"points"));if(s.length>=4)return{x:+s[0],y:+s[1]};break;case"rect":case"image":return{x:+w(a,"x"),y:+w(a,"y")};case"circle":case"ellipse":return{x:+w(a,"cx"),y:+w(a,"cy")};case"line":return{x:+w(a,"x1"),y:+w(a,"y1")}}}for(r=0;r<o;r++){a=e[r];if("path"==a.tagName&&a.pathSegList.numberOfItems){i=a.pathSegList.getItem(0);if(i&&"M"==i.pathSegTypeAsLetter)return{x:Wa.formatLengthSave(i.x),y:Wa.formatLengthSave(i.y)}}}for(r=0;r<o;r++)if("text"==e[r].tagName)return{x:+w(e[r],"x"),y:+w(e[r],"y")};for(r=0;r<o;r++)if(e[r]&&e[r].children){var c=Lt(m("*",e[r]));if(c)return c}}}function _t(e){var t=ba.canvas.originX,n=ba.canvas.originY,r=fo.getSanpSize("X"),i=fo.getSanpSize("Y"),a=Math.round((e.x-t)/r)*r+t,o=Math.round((e.y-n)/i)*i+n;return{x:Wa.formatLengthSave(a),y:Wa.formatLengthSave(o)}}function bt(e,t,n){var r=fo.getSanpSize("X"),i=fo.getSanpSize("Y"),a=_t(e);t>0&&a.x<e.x?a.x+=r:t<0&&a.x>e.x&&(a.x-=r);n>0&&a.y<e.y?a.y+=i:n<0&&a.y>e.y&&(a.y-=i);return a}function St(e,t,n){co[e.tagName]&&co[e.tagName](e,t,n)}function Ct(e,t,n,r){if(!e||!e.length)return!1;if(!(e.length>=ca)||r&&r.hideBox)for(var i=0;i<e.length;i++)(co[e[i].tagName]||Y)(e[i],t,n);else{if(!v("selectionBox")){wt(Wa.svg.getBBoxMerged(e))}St(v("selectionBox"),t,n)}if(Qa.origin){Qa.origin.x+=t;Qa.origin.y+=n}return!0}function Mt(e,t){if(e&&e.length&&v("selectionBox")){var n=z(w(v("selectionBox"),"c_start"))[0],r=+w(v("selectionBox"),"c_rotate")||0,i=v("selectionBox").getBBox();Ji.removeChild(v("selectionBox"));if("cancel"!=t){e.forEach(function(e){e.style.display=""});0!==r&&lo.rotate(e,r,n.x,n.y);var a,o;if(Qa.origin){a=Qa.origin.x-n.x;o=Qa.origin.y-n.y}else{a=+i.x+i.width/2-n.x;o=+i.y+i.height/2-n.y}if(a||o){for(var s=0;s<e.length;s++)(co[e[s].tagName]||Y)(e[s],a,o);_e(wo)&&saveHistoryOfSelected(e,a,o)}delete Qa.origin}}}function wt(e){var t=Qa.origin?Qa.origin.x+","+Qa.origin.y:+e.x+e.width/2+","+(+e.y+e.height/2);Ji.appendChild(Wt("rect",{x:e.x,y:e.y,c_start:t,width:e.width,height:e.height,"stroke-width":1,fill:"none",stroke:"red","stroke-dasharray":"4 1","vector-effect":"non-scaling-stroke",id:"selectionBox"}))}function Nt(e,t,n){if(e&&"text"==e.tagName&&"string"==typeof t){t.indexOf("\r")>=0&&(t=t.indexOf("\n")>=0?t.replace(/\r/g,""):t.replace(/\r/g,"\n"));void 0===n&&(n="\n");var r,i,a,o="line"==w(e,"c_shapetype")||e.parentNode&&"part_annotation"==w(e.parentNode,"c_partid");if(o){r=t.split(n);i=r.length;a=i>1}else{t=t.replace(/\n/g," ");r=[t];i=1;a=!1}var s=m("tspan",e),c=s.length,l=w(e,"x");if(a){0===c&&e.childNodes[0]&&e.removeChild(e.childNodes[0]);for(;c<i;){e.appendChild(Wt("tspan",{x:l,dy:c?"1em":"0","xml:space":"preserve"}));c++}for(;c>i;){c--;s[c].parentNode.removeChild(s[c])}for(;i--;)e.childNodes[i].textContent=r[i]||" ";Ha&&a&&setTimeout(function(){for(var t=m("tspan",e),n=t.length,r=0;r<n;r++)t[r].textContent=t[r].textContent},1)}else{for(;e.lastChild;)e.removeChild(e.lastChild);Wa.node.setTextContent(e,t)}}}function Pt(e,t){if(!e||"text"!==e.tagName)return"";var n=m("tspan",e),r=n.length,i="";void 0===t&&(t="\n");if(r>0){i=n[0].textContent;for(var a=1;a<r;a++)i+=t+n[a].textContent}else i=e.textContent;return i}function Tt(e){function t(e){return Wa.formatLengthSave(e)+""}if(!e)return null;var n,r=e.attributes,i=r?r.length:0,a={},o=/\d+\.\d{9,}/g,s=/^(?:points|d|x|y|width|height|cx|cy|r|rx|ry|x1|y1|x2|y2|dx|dy|transform|stroke-width|viewBox|c_origin|c_rotation)/;for(n=0;n<i;n++){var c=r[n].name;c.match(/[a-z]/)||(c=c.toLowerCase());s.test(c)?a[c]=r[n].value.replace(o,t):a[c]=r[n].value}return a}function Ot(e){if(e&&e.length){var t,n,r,i,a=So.getViewBox(),o="getBoundingClientRect";for(t=0;t<e.length;t++){n=e[t];if(n){if(n[o]){r=n[o]();if(!r.width&&!r.height)continue;r=[a[0]+r.left/Za,a[1]+r.top/Za,a[0]+r.right/Za,a[1]+r.bottom/Za]}else{r=Wa.svg.getBBox(n);if(!r.width&&!r.height)continue;r=[r.x,r.y,r.x+r.width,r.y+r.height]}i=i?[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]:r.slice(0,4)}}if(i){return{x:i[0],y:i[1],width:i[2]-i[0],height:i[3]-i[1]}}}}function kt(t,n){if(!t)return!1;var r,i,a,o,s=[],c=e.frameElement,l=c&&c.parentNode,d=l&&"none"!=l.style.display;l&&!d&&(l.style.display="");if(b(t,$a)){o=Wa.svg.getBBox(t);if(!o.width&&!o.height){l=e.frameElement&&e.frameElement.parentNode;if(l){if(!(l.style&&"none"!=l.style.display)){l.style.display="";o=Wa.svg.getBBox(t);l.style.display="none"}}}if(!o.width&&!o.height){if(Wa.fileType.isLib(wo))Et(ba.canvas.originX,ba.canvas.originY);else{var u=So.getViewBox();u[0]=ba.canvas.originX;u[1]=ba.canvas.originY;So.setViewBox(u)}return}}else{a=m("[c_note]",t);i=a.length;for(r=0;r<i;r++){s[r]=a[r].style.display;"none"!=s[r]&&(a[r].style.display="none")}o=Wa.svg.getBBox(t);for(r=0;r<i;r++)a[r].style.display=s[r]}l&&!d&&(l.style.display="none");o&&(o.width||o.height)&&At(o,n)}function At(e,n){if(e&&(e.x||e.y||e.width||e.height)){!n||e.width||e.height||(n=0);var r=e.x+e.width/2,i=e.y+e.height/2,a=t.body.clientWidth||9,o=t.body.clientHeight||9,s=n?Math.min(a/e.width,o/e.height):Za,c=n&&isFinite(s)?ce(99*s,"-"):100*Za,l=c/100,d=So.getViewBox();if(c<.1){c=.1;l=c/100}else if(c>1e5){c=1e5;l=c/100}var u=l!=Za;d[0]=r-d[2]/2;d[1]=i-d[3]/2;So.setViewBox(d);u&&pn("zoom",[c])}}function Et(e,t){var n=So.getViewBox();n[0]+=e-(n[0]+n[2]/2);n[1]+=t-(n[1]+n[3]/2);So.setViewBox(n)}function It(e,t){var n=Ot(e);n&&jt(n,t)}function jt(e,t){var n=e.x,r=e.y,i=n+e.width,a=r+e.height,o=So.getViewBox();t=isFinite(t)?t/Za:20/Za;n-=t;r-=t;i+=t;a+=t;var s,c;s=n<=o[0]==i>=o[0]+o[2]?0:n<=o[0]?n-o[0]:i-o[0]-o[2];c=r<=o[1]==a>=o[1]+o[3]?0:r<=o[1]?r-o[1]:a-o[1]-o[3];if(s||c){o[0]+=s;o[1]+=c;So.setViewBox(o)}}function Bt(e,t){jt({x:e.x,y:e.y,width:0,height:0},t)}function Dt(){kt(Ji,1)}function Ft(e,t,n){var r=An("pre",e),i=[],a=r.textContent;i.push(e);if(r&&/\.\d+$/.test(a)){var o,s=pn("getAllJson"),c=pn("getAllSchInProject");for(L=0;L<s.length;L++)if(!(c.length&&c.indexOf(s[L].tabid)<0)){var l=pn("getTabById",[s[L].fid]);o=s[L].json.schlib;for(var d in o)if(j(o,d)){if(d.indexOf("frame_lib")>=0)continue;var u=pn("getPreOrNameFromJson",[o[d]]).pre;if(u===a||!/\.\d+$/.test(u))continue;u.substr(0,u.indexOf("."))===a.substr(0,u.indexOf("."))&&i.push(l.contentWindow.document.getElementById(d))}}}for(var h=[],f=0;f<i.length;f++){var p,g,y,x=w(i[f],"c_para")||"",v=x.split("`"),m=v.length;m%2&&(v[m-1]?v[m++]="":v.length=--m);t=t.replace(/[`\^~\\"]/gi,"");for(var L=0;L<m-1;L+=2){p=v[L];g=v[L+1];if(t==p){y=1;if(n==g)return x;v[L+1]=n;break}}y||v.push(t,n);var _=v.join("`");w(i[f],"c_para",_);ha.updateOne(i[f]);var b={},S={};b.c_para=x;S.c_para=_;h.push(["attr",i[f].id,b,S])}La.save(h);return _}function Rt(e,t){function n(e,t){var n=e.id;if(t){e.id=t;return t}n?e.id="":n=Wa.newId();if(n.match(/^(frame_\w*?)([_\?\d]*)$/)){var r=RegExp.$1,i=1;"_"!=r.substr(-1)&&(r+="_");n=r+i;for(;v(n);)n=r+ ++i}else for(;v(n);)n=Wa.newId();e.id==n?n.match(/^gge(\d+)$/)&&+RegExp.$1>to&&(to=+RegExp.$1):e.id=n;return n}var r=n(e,t);[].forEach.call(m("*",e),function(e,t){n(e,null)});return r}function Vt(t){if(!(za&&e.frameElement&&"none"==e.frameElement.parentNode.style.display||function(e){if(!e||"g"!=e.tagName)return!0;var t=w(e,"c_partid");if(!t||t.indexOf("part_lib")<0)return!0;var n=L('text[c_note="note_name"]',e),r=n&&(n.textContent||"").toLowerCase();return r&&0===r.indexOf("frame")}(t))){var n=t.id;n||(t.id="rnd"+(Math.random()+"").replace(".",""));var r=L("#"+t.id+" rect.hitbox"),i="none"==w(t,"display");i&&N(t,"display");for(var a=t.childNodes,o=[],s=[],c=0,l=a.length;c<l;c++){var d=a[c],u=d.tagName;if("none"!=w(d,"display"))if("g"==u){var h=d.getAttribute("c_partid");if("part_annotation,part_pin,part_junction,part_netLabel_text".indexOf(h)>=0){o.push(d);continue}s.push(d)}else"text"==u?o.push(d):s.push(d)}n||(t.id="");if(s.length){for(c=0,l=o.length;c<l;c++)w(o[c],"display","none");var f=Wa.svg.getBBox(t);for(c=0,l=o.length;c<l;c++)N(o[c],"display");i&&w(t,"display","none");if(f.width&&f.height){var p={x:f.x,y:f.y,width:f.width,height:f.height,fill:"none",class:"hitbox"};if(r)w(r,p);else{r=Wt("rect",p);t.insertBefore(r,t.firstChild)}}}else i&&w(t,"display","none")}}function Gt(e){e=e||v("part_arrowhead");return v("part_arrowhead").getAttribute("arrowtype")||"3"}function Gt(e){e=e||v("part(arrowhead)");return v("part(arrowhead)").getAttribute("arrowtype")||"3"}function zt(e){e=e||v("part(arrowhead)");return+e.getAttribute("arrowsize")||15}function Ht(e,t){if(t&&t.childNodes&&!(t.childNodes.length<=0)){w(t,"arrowtype",e);Ut(zt(t),t.childNodes[0])}}function Ut(e,t){var n,r,i=w(t.parentNode,"arrowtype")||Gt(t),a=t.pathSegList,o=a.getItem(0).x,s=a.getItem(0).y,c=e,l=[];switch(i){case"1":w(t,"stroke",w(t,"fill"));l=[o,s,o-c,s+c/2,o,s,o-c,s-c/2];n=+w(t.parentNode,"c_rotation")||0;n=360-n;n&&(l=Fe(l,n,o,s));r="M"+l[0]+","+l[1]+"L"+l.slice(2).join(",");break;case"2":w(t,"stroke","none");l=[o,s,o-c,s+c/2,o-c,s-c/2];n=+w(t.parentNode,"c_rotation")||0;n=360-n;n&&(l=Fe(l,n,o,s));r="M"+l[0]+","+l[1]+"L"+l.slice(2).join(",")+"Z";break;case"3":w(t,"stroke","none");l=[o,s,o-c,s+c/2,o-3*c/4,s,o-c,s-c/2];n=+w(t.parentNode,"c_rotation")||0;n=360-n;n&&(l=Fe(l,n,o,s));r="M"+l[0]+","+l[1]+"L"+l.slice(2).join(",")+"Z"}w(t,"d",r)}function Yt(e,t){function n(e){e[0].type="M"}function r(e,t,n){a.updateAndSave();ha.updateOne(e,{notCopper:!0});t[3]={points:w(e,s)};if(o&&"wire"===de(e)){Sa.solveItem(e);Sa.solveTodoList();La.save(Sa.batHistoryCmd(t))}else if(n.length){n.push(t);La.save(n)}else La.save(t);La.saveBatch()}La.startBatch();var i=!1,a=new Pi([e]),o=Le(wo),s="points";"path"===e.tagName&&(s="d");var c,l,d,u=w(e,"layerid"),h=e.getPathData(),f=h.length;for(d=f-1;d>0;d--)h[d].values.join("")===h[d-1].values.join("")&&h.splice(d-1,1);n(h);f=h.length;var p,g,y=-1,x=e.getAttribute("stroke-width"),v=x*x,m={};m[s]=w(e,s);var L=["attr",e.id,m];if(!(f<3)){for(d=f-1;d>=1;d--){c={x:h[d].values[0],y:h[d].values[1]};l={x:h[d-1].values[0],y:h[d-1].values[1]};p=function(e,t,n){var r=e.x,i=e.y,a=t.x,o=t.y,s=n.x,c=n.y,l=a-r,d=o-i,u=l*l+d*d,h=((s-r)*l+(c-i)*d)/u;if(!(h>=1||h<=0)){var f=r+h*l,p=i+h*d,g=f-s,y=p-c;return{point:{x:f,y:p},d2:g*g+y*y}}}(c,l,t);if(p&&p.d2<=v&&(void 0===g||g>p.d2)){g=p.d2;y=d;p.point.x;p.point.y}}o&&"wire"===de(e)&&Sa.solveItem(e);var _=[];wo!=ia.PCB&&wo!=ia.PCBMODULE||(_=removeTeardrop({wire:e.id},!0));if(1===y||y===f-1){1===y?h.splice(0,1):h.splice(f-1,1);n(h);e.setPathData(h);r(e,L,_);vn(e);_e(wo)&&"object"==typeof Layer&&Layer.appendElement(e,u);i=!0}else if(y>1){var b=e.cloneNode(!0);la.unselect(e);la.unselect(b);pa=null;b.id=Wa.newId();yn();var S=D(h).splice(y);n(S);e.setPathData(S);var C=D(h).splice(0,y);n(C);b.setPathData(C);if(_e(wo)&&"object"==typeof Layer){Layer.appendElement(b,u);Layer.appendElement(e,u)}else Ji.appendChild(b,u);ha.updateOne(b,{notCopper:!0});La.save(["add",b.id]);r(e,L,_);i=!0}w(e,"net")&&ratLineMgr.buildOneNet(w(e,"net"),!0);i||La.endBatch();return!0}Lr([e]);La.saveBatch()}function Jt(e){if(e){e='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e.trim()+"</svg>";var n=F(e);if(n){var r=t.importNode(n.documentElement,!0);return r.removeChild(r.childNodes[0])}}}function Wt(e,n){var r=t.createElementNS("http://www.w3.org/2000/svg",e);n&&w(r,n);return r}function Xt(r,i){i=i||{};var a,o,s,c,l=null,d=_e(wo);if("string"==typeof r){c=r.length>3e5;a=F(r);if(!a){var u=[55470,56447,55486,57017];u=u.map(function(e){return"&#x"+e.toString(16)});var h=u.join("|"),f=new RegExp(h,"g");r=r.replace(/[$\x00-\x1F]/g,"?").replace(f,"?").replace(/\ufffd/g,"?");a=F(r)}if(!a)return;l=t.importNode(a.documentElement,!0)}else l="[object Object]"==Object.prototype.toString.call(r)?makeSVG(r.tagName||r.tag,r.attr||r.attrs):t.importNode(r,!0);if(l){var p=w(l,"canvas")||"";N(l.firstChild,"c_transformList");if(wo==ia.WAVEFORM){var g=w(l,"waveForm")||"{}";Ja=B(g)||{}}var y={offsetX:ba.canvas.originX,offsetY:ba.canvas.originY};Mi(p);y.offsetX=ba.canvas.originX-y.offsetX;y.offsetY=ba.canvas.originY-y.offsetY;var x=l.querySelector("g"),_={};x&&(_=Tt(x));k(l);var b=l.getElementsByTagName("title");b=b[0]&&b[0].firstChild&&3===b[0].firstChild.nodeType?b[0].firstChild.nodeValue:" ";var S=fa.getElementsByTagName("title")[0];if(S){for(;S.firstChild;)S.removeChild(S.firstChild);S.appendChild(I(b))}if(!i.clearHistory)var C=v("g1").cloneNode(!0);So.clear("NotSaveHistory",!0);var M=i.needCalAll,P=_i();P||(M=!0);if(d){Wa.node.clearChildNodes(v("gNets"));l=l.querySelector("g")||l}else{var T=L("*[c_shapetype]",l);T&&(l=T.parentNode);if(Wa.fileType.isLib(wo)){var O=m('g[c_partid="part_pin"][display="none"]',l);for(o=0;o<O.length;o++){N(O[o],"display");w(O[o],{c_show:"none",display:""})}}}if(l)if(d){Layer.innerElements(l.childNodes);var A=ha.gJsonCache.panelize;A&&applyPanelize(A)}else{for(var E,D=t.createDocumentFragment();l.firstChild;){E=l.firstChild;1!=E.nodeType||"polyline"==E.tagName&&E.points.numberOfItems<2||"polygon"==E.tagName&&E.points.numberOfItems<3?l.removeChild(E):D.appendChild(E)}Ji.appendChild(D);D=null}i.clearHistory?i.saved?La.clear({saved:i.saved}):La.clear():La.save([["node",Ji.id,C,Ji.cloneNode(!0)],["originXY","set.origin",y]]);!function(){var e={sch:5e4,pcb:2e4},t={sch:5e4,pcb:2e4},n=function(e,t,n){return e>=t&&e<=n},r=Wa.svg.getBBox(Ji);d&&(r.width>t.pcb||r.height>t.pcb)&&function(){var t,r,i,a,o=function(t){return!isNaN(t)&&n(t,-e.pcb,e.pcb)},s=m('#g1 > g[id^="layer_"] > *',Ji);for(t=s.length-1;t>=0;t--){i=s[t];a=de(i);if("FOOTPRINT"==a){var c=w(i,"c_origin").split(",").map(Number);if(o(c[0])&&o(c[1])){var l=m('g[c_partid="part_pcbtext"]',i);for(r=l.length-1;r>=0;r--){var d=w(l[r],"c_origin").split(",").map(Number),u=0,h=0;if(isNaN(d[0])||isNaN(d[1]));else if(!o(d[0])||!o(d[1])){o(d[0])||(u=c[0]-d[0]);o(d[1])||(h=c[1]-d[1]);if(u||h){co.move(l[r],u,h);M=!0}}}}}}}()}();to=V()+1;if(d){var R,G=m("path[c_note=note_pre]",Ji);for(o=0,s=G.length;o<s;o++)(R=w(G[o],"c_text"))&&ua.ini(R)}if(_.c_transformList){var z=_.c_transformList.split(" ");for(o=0;o<z.length-1;o+=2){var H=v(z[o]),U=z[o+1],Y=0,J="M"==U.charAt(0);if(H){if(J){d?changeFootprintLayerId(H,na.BOTTOMLAYER):uo.flipH([H]);Y=+U.substr(1)}else{Y=+U;Y=360-Y}if(!isNaN(Y))if(d){var W=null,X=parseInt(w(H.firstChild,"c_rotation"),10)||0;X=180==X?0:X;Pr([H.firstChild],X,!1);W=H.firstChild.cloneNode(!0);Y&&Pr([H],Y,!0);if(W){w(W,"c_rotation",X);H.replaceChild(W,H.firstChild)}}else Y&&bi(H,Y)}}}if(d)M?ha.calAll({notCopper:!0,notRealtimeDRC:!0,noText:!0}):buildOvalPadOutline();else{ha.rebuildAllCache();M&&ha.calAll()}for(o in _)j(_,o)&&w(Ji,o,_[o]||"");pn("triggerEvent",["import_doc_done"]);pn("triggerEvent",["select_change"]);po.createLockUi(m('[locked="1"]',Ji));if(d){restoreHideFootprintsAndNets();Layer.initByCache();w(m("#gDrcDots > path"),"stroke",ha.gJsonCache.layers.DRCError.color);ha.buildSignals();kt(Ji);if(wo==ia.PCB||wo==ia.PCBMODULE){var Q;Q=c&&"undefined"!=typeof Worker?buildRtreeRatline("worker",!0):buildRtreeRatline("delay",!0);copperAreaMgr.rebuildPlane("all");pn("getCopperAreaDataInIndexDB").then(function(e){if(e){var t=pn("getTabInfo",[e.uuid]),n=e?e.copperAreaData:void 0;n&&t&&n.datastrid===t.datastrid&&(wa.copperNetRelation=Wa.extend(wa.copperNetRelation,n.copperNetRelation||n.activeCopperNetRelation));var r=!n||n.datastrid!==t.datastrid||"1.0"!==n.algorithmVersion,i=!!t&&0!==t.tabid.indexOf("sheet_")&&!!t.fid;return{uuid:e.uuid,needRebuildCopperArea:r,storeCopperAreaInIndexDB:i}}}).then(function(e){e&&e.needRebuildCopperArea&&!wa.buildAllNeting&&pn("buildCopper",["all",e.storeCopperAreaInIndexDB,!0],e.uuid);if(e&&e.needRebuildCopperArea&&wa.buildAllNeting){wa.copperOptions=e;wa.buildAllNeting=!1}Q.then(function(){Layer.updateNetColor(ha.gJsonCache.netColors)})})}wo==ia.PCBLIB&&setTimeout(function(){RTreeMgr.rebuild()},1e3);setTimeout(function(){updateNetText()},1e3);createLibMasker();var K=m("path[copper]",Ji);K.length&&K.forEach(function(e){setCushionForCopperAreaOutline(e)});P&&(wo!=ia.PCB&&wo!=ia.PCBMODULE||ja.rebuildRTree());var $,q=ha.gJsonCache.objectMap.objects;for($ in q){"All"!=$&&"Prefix"!=$&&"Name"!=$&&j(q,$)&&n("object_showOrSelected",[$,q[$].visible,"visible"]);"All"!=$&&n("object_showOrSelected",[$,q[$].selected,"selected"])}}else{var Z=pn("getJsonCache");Z&&Z.colors&&(ba.colors=Wa.extend({},Z.colors));if(me(wo)||wo==ia.SCHMODULE){Si();if(!za||!e.frameElement||"none"!=e.frameElement.parentNode.style.display){var ee=m(".shapeBox > g");for(o=0,s=ee.length;o<s;o++)Vt(ee[o])}}wo===ia.WAVEFORM?Ma.resizeToFitWindow():kt(Ji);setTimeout(function(){mi()},60)}pn("triggerEvent",["select_change"]);var te=ha.gJsonCache.head.newgId,ne=!te,re=ha.gJsonCache.head.docType+"";if(ne){var ie=parent.$("#tabbar .tabbar-tab.active").attr("tabid");ne=ia.SCH==re&&ie.indexOf("sheet_")>-1}if(ne&&[ia.SCH,ia.PCB,ia.SCHMODULE,ia.PCBMODULE,ia.SUBCKT].indexOf(re)>=0){var ae=!0;try{tr(ha);ha.calAll(null,!0)}catch(e){ae=!1}ae&&(ha.gJsonCache.head.newgId=!0)}}else parent.$.messager.error("import node failure")}function Qt(e,t,n,r,i){function a(){return"part_lib_"+(1e6+(1e6*Math.random()|0)+"").substr(1)}Co.started&&dr();var o=Le(wo);if(e){var s=Kn(e);if(s){w(m('[locked="1"]',s),"locked","0");var c=!!L("[c_etype=frame_]",s),l=w(s,"c_module");i&&l&&!isNaN(i.x)&&!isNaN(i.y)&&w(s,"c_origin",i.x+","+i.y);if(!o)var d=+Layer.getActiveLayer()||1,u=Layer.getValidLayer("FOOTPRINT",d);if(t){var h;o?Ji.appendChild(s):Layer.appendElement(s);t.rotation&&(t.layerid&&isBottomLayer(t.layerid)?Pr([s],t.rotation,!0):Pr([s],360-t.rotation,!0));if(j(t,"x")&&j(t,"y")){h=w(s,"c_origin");if(h)S={x:t.x-h[0],y:t.y-h[1]};else{x=Wa.getPlainBBox(s);S={x:t.x-x.x,y:t.y-x.y}}co.move(s,Wa.formatLengthSave(S.x),Wa.formatLengthSave(S.y))}if(l){h=Fn(s.childNodes);w(s,{c_origin:h.x+","+h.y,c_module:"1"})}}for(var f,p,g=[],y=s.childNodes.length-1;y>=0;y--){f=s.childNodes[y];if(n)return Kt(f);N(f,"pointer-events");if(!w(f,"c_origin")){var x=Wa.svg.getBBox(f);w(f,"c_origin",x.x+x.width/2+","+(x.y+x.height/2))}w(f,"display","");var _=Wa.c_paraToJson(w(f,"c_para")||"");if(!l){!o&&w(f,"layerid",u);var b=$n(w(f,"c_para"));w(f,{c_para:b.newPara});Hn(f,{pre:b.pre,name:b.name},"place_part")}if(o){Bi(ba.colors,f);wo!=ia.SCHMODULE&&w(f,"c_para")&&Wr(An("pre",f).childNodes[0],An("name",f).childNodes[0]);c&&w(f,{id:"frame_lib_?"})}Wa.svg.fixOrigin(f);var S,x;if(t){Rt(f);t.c_partid?w(f,{c_partid:t.c_partid}):w(f,{c_partid:a()});if(o){Un("mounted",f,"No"!=_.BOM_Mounted);"schlib"===de(f)&&vi(f)}t.id&&w(f,{id:t.id});if(t.layerid){t.layerid=+t.layerid;isBottomLayer(t.layerid)&&changeFootprintLayerId(f,t.layerid,!0)}w(f,{c_shapetype:"group",c_etype:"pinpart"});o?Ji.appendChild(f):Layer.appendElement(f);ha.updateOne(f,{notCopper:!0});if(o){Sa.solveItem(f);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["add",f.id]))}g.push(f.id)}if("FOOTPRINT"===de(f)||"schlib"===de(f)){p=L("g "+(o?"text":"path")+'[c_note="note_pre"]',f);if(p){var C=o?p.textContent:w(p,"c_text"),P=C;l&&r&&(C=r+C);if(l&&C.match(/\?/))return parent.$.messager.warn("Exist doesn't annotate prefix component(s) in the module, please edit and annotate the unique prefix(s) for component(s) first.");!l&&C.search(/\d+/)>=0&&(C=C.replace(/\d+(\D*)$/,"?$1"));P!=C&&(o?p.textContent=C:Ei(p.parentNode,{text:C}));t&&(o?En(f,{pre:ua.getNewPre(C)},"schlib"):updatePCBPre(f))}o&&Vt(f)}}if(t){if(g&&!o){ratLineMgr.buildAllNet();La.save(["add",g.join(",")])}M(s);return f.id}var T="part(lib)",O=v(T);if(O){M(O);m("#gCurParts > g[subparts]").forEach(function(e){M(e)})}var k=l?s:s.childNodes[0];w(k,{id:T,c_partid:a()});l||o||isBottomLayer(u)&&changeFootprintLayerId(k,u,!0);v("gCurParts").appendChild(k);w(k,"display","none");sr("place_"+T);if(!l&&o&&w(k,"subparts")){m("g[subparts]",s).forEach(function(e){w(e,{id:"",c_partid:a(),display:"none"});v("gCurParts").appendChild(e)})}}}}function Kt(e){var t=Le(wo),n="part(lib)",r=v(n);r&&M(r);w(e,{id:n});var i,a,o,s,c=e.childNodes,l=e,d=t?"#frame_lib_1":"#frame_sheet_1",u=L(d,l),h=Tt(u);if(h){var f=t?"0,0":"4000,3000";isNaN(ha.gJsonCache.head.x)||isNaN(ha.gJsonCache.head.y)||(f=[ha.gJsonCache.head.x,ha.gJsonCache.head.y].join(","));w(l,"c_origin",f);N(l,"uuid");if(t){w(l,"c_para",h.c_para||"package``BOM_Manufacturer Part`?`spicePre`.`");w(l,"c_partid","part_lib_sheet");N(l,"puuid")}else{w(l,"c_partid","part_sheet");w(l,"layerid",h.layerid);N(l,"c_para");N(l,"c_transformlist");N(l,"utime")}var p,g=u.childNodes,x=g.length;for(i=0;i<x;i++){p=y(g[i],!0);t&&p.firstChild&&w(p.firstChild,"c_note")||l.insertBefore(p,l.firstChild)}u.remove();if(t){for(i=0;i<c.length;i++){a=c[i].tagName;n=c[i].id;o=w(c[i],"c_etype");o&&o.indexOf("frame_")<0&&(o="");if(!o&&n&&(0!==n.indexOf("frame_hitarea_")||0!==n.indexOf("frame_title_"))){0===n.indexOf("frame_")&&(o="frame_"+n.split("_")[1]);!o&&"g"===a&&"part_annotation"===w(c[i],"c_partid")&&n.indexOf("_title")<0&&(o="frame_title");o||"rect"!==a||(o="frame_hitarea");o&&w(c[i],"c_etype",o)}}var _,b=m("image",e);for(i=0;i<b.length;i++){w(b[i],"c_shapetype","line");_=Wt("g",{id:"gge?",c_partid:"part_image",c_shapetype:"group",c_etype:"frame_image"});_.appendChild(y(b[i],!0));e.appendChild(_);e.removeChild(b[i])}v("gCurParts").appendChild(e);Bi(ba.colors,e);w(e,"display","none")}else{for(i=0;i<c.length;i++){a=c[i].tagName;s=c[i].id;0===s.indexOf("frame_")&&(o="frame_"+s.split("_")[1]);w(c[i],"c_etype",o);if("polyline"===a&&c[i].childNodes)for(;c[i].childNodes.length>0;)M(c[i].childNodes[0])}v("gCurParts").appendChild(e);w(e,"display","none");var S=w(e,"layerid");xo.updateSheetLayer(e,S);addLayerByLayerid(S)}sr("place_part(lib)");return e.id}}function $t(e,t){var n=t&&[t]||Zt();if(!n.length)return!1;var r=n[0],i=w(r,"c_para")||"";if(0===i.length)return!1;e["Supplier Part"]=e["Supplier Part"]||e.LCSC;e.package=e.package||e.Package;e.Value=e.Value||e.Name;var a=r.cloneNode(!0),o=r.children,s=Wa.c_paraToJson(i);e.spicePre&&(s.spicePre=e.spicePre);e.package&&(s.package=e.package);e.Supplier&&(s.BOM_Supplier=e.Supplier);e.Manufacturer&&(s.BOM_Manufacturer=e.Manufacturer);e["Manufacturer Part"]&&(s["BOM_Manufacturer Part"]=e["Manufacturer Part"]);e["Supplier Part"]&&(s["BOM_Supplier Part"]=e["Supplier Part"]);e.Value&&(s.Value=e.Value);i=Wa.jsonToC_para(s);w(r,{c_para:i});e.pre&&(An("pre",r).childNodes[0].textContent=e.pre);if(e.data){var c,l=e.data;for(var d in l)if(j(l,d)){var u=l[d];c=o[u.id];if(c){w(c,{c_spicepin:u.spiceNum,c_elec:u.pinpartElec});Wa.node.setTextContent(c.children[0],u.name);Wa.node.setTextContent(c.children[1],u.num);w(c.children[0],{display:"none"==u.nameDisplay?"none":""});w(c.children[1],{display:"none"==u.pinpartNumDisplay?"none":""})}if("none"===u.pinpartShow){w(c,{c_show:"none",display:"none"});Sa.solveItem(gr(c));Sa.solveTodoList()}else w(c,{c_show:"show",display:""})}}var h=r.cloneNode(!0);ha.updateOne(r);La.save(["node",r.id,a,h])}function qt(e){var t,n=e.target==fa,r=e.target,i=r.parentNode,a=w(i,"c_partid"),o="cdot"==w(e.target,"c_shapetype");w(r,"attach_libid")&&(r=v(w(r,"attach_libid")));w(r,"copper_id")&&(r=v(w(r,"copper_id")));if("part_pad"!==a&&"part_pcbtext"!==a&&"part_annotation"!==a||xo.isFrameTick(r))r=gr(r);else{r=r.parentNode;t=!0}var s=function(e){"cdot"!==w(e,"c_shapetype")&&(pa=e);pa||(pa=la.get()[0]);la.select(pa);"line"==w(e,"c_shapetype")&&vn(e)},c=Zt();if((!o&&!n&&"TEXTAREA"!=e.target.tagName&&(!r||!la.isSelected(r))||n)&&!c){pn("multiSelect",[!1]);pn("releaseActive")}s("part_image"==a?i:r);var l,d=Zt();if(n){l="";if(0!==c.length){l=de(d[0]);if(!l)return}else d="canvas"
}else if(o&&"light"!=w(e.target,"class")){l="cdot";d=[e.target]}else if(T(r))l="sheet";else{if(!r)return;l=de(r);if(!l)return}var u=ln(e,!1);0===d.length&&r&&"part_image"===w(r.parentNode,"c_partid")&&(d=[r]);var h={target:d,docType:wo,cmdKey:l,clientX:e.clientX,clientY:e.clientY,x:u.x,y:u.y};t&&!b(r.parentNode,$a)||(h.locked=w(r,"locked"));if(j(h,"locked")&&!h.locked&&h.target){h.locked=w(h.target[0],"locked");h.target[0]&&"netflag"===de(h.target[0].parentNode)&&delete h.locked}wa.contextmenuDisableOnce||pn("showEditorContextMenu",[h])}function Zt(e){var t=la.get();t=t.filter(function(e){var t=gr(e);return t&&(b(t.parentNode,$a)||O(t))});if(!e)return t;for(var n={},r=0,i=t.length;r<i;r++){var a=de(t[r]),o=t[r].id;if(a&&o&&ha.gJsonCache[a]){n[a]||(n[a]={});n[a][o]=ha.gJsonCache[a][o]}}return n}function en(e){if(pa){pa=null;yn()}for(var t=m("#g1 ."+la.highlightClass),n=t.length-1;n>=0;n--)la.unhighlight(t[n]);tn(e);wo!=ia.PCB&&wo!=ia.PCBLIB&&wo!=ia.PCBMODULE||removeFakePolyline();wo==ia.PCB&&ratLineMgr.cancelHighlightNets()}function tn(e){var t=e||Zt(),n=t.length;if(n>0){for(var r=n;--r>=0;)la.unselect(t[r]);yn()}Mt(t);var i=m("."+la.selectClass,Ji);la.unselect(i);tn.unSelectShadowNode();return n}function nn(){var e=_e(wo);me(wo)||pn("multiSelect",[!0]);if(pa){pa=null;yn()}var t,n,r,i=m("#g1 ."+la.highlightClass);for(t=i.length-1;t>=0;t--)la.unhighlight(i[t]);la.unselectAll();n=m('.shapeBox > [c_shapetype]:not(.selected):not(.events-none):not([d=""]):not([display="none"]), .shapeBox > path[stroke="none"]:not([fill])',Ji);if(e)var a,o=ha.gJsonCache.objectMap,s=o.objects.Component.selected,c=!0;n=[].filter.call(n,function(t){var n=getComputedStyle(t);if(e){if("FOOTPRINT"===de(t))return s;a=objectShow.getName(t);a&&j(o.objects,a)&&(c=o.objects[a].selected);if(!c)return c}return n&&"none"!=n.display&&"none"!=n["pointer-events"]});r=n.length;if(r>0){t=r;for(;--t>=0;)la.select(n[t])}if(e&&!s){var l,d,u=["Prefix","Name"];for(d=0;d<u.length;d++){c=o.objects[u[d]].selected;if(c){l=m(o.objects[u[d]].selectorText);r=l.length;if(r>0){t=r;for(;--t>=0;)la.select(l[t].parentNode)}}}}pn("triggerEvent",["select_change"]);return r}function rn(){if(e.frameElement){var n=frameElement.getAttribute("c_para");n&&w(Ji,{c_para:n});var r=frameElement.getAttribute("winzoom");if(Wa.fileType.isLib(wo)){fr(+r,{clientX:(t.documentElement.clientWidth||9)>>1,clientY:(t.documentElement.clientHeight||9)>>1})}else fr(+r,{clientX:0,clientY:0});w(v("gridOH"),{y1:ba.canvas.originY,y2:ba.canvas.originY});w(v("gridOV"),{x1:ba.canvas.originX,x2:ba.canvas.originX})}}function an(e){var t,n=e.childNodes;if(n&&n.length>0)for(t=n.length-1;t>=0;t--)1==n[t].nodeType?"text"!=n[t].tagName&&"tspan"!=n[t].tagName&&an(n[t]):e.removeChild(n[t])}function on(){var e=So.getViewBox();pn("updateRuler",[{zoom:Za,unit:ba.canvas.unit,vbX:e[0],vbY:e[1],originX:ba.canvas.originX,originY:ba.canvas.originY}])}function sn(e){pn("updateRuler",[{clientX:e.clientX,clientY:e.clientY}])}function cn(){var e=t.body,n=t.documentElement;return{zoom:eo,scrollLeft:Math.max(e.scrollLeft,n.scrollLeft),scrollTop:Math.max(e.scrollTop,n.scrollTop),scrollWidth:Math.max(e.scrollWidth,n.scrollWidth),scrollHeight:Math.max(e.scrollHeight,n.scrollHeight),clientWidth:n.clientWidth,clientHeight:n.clientHeight,width:Math.max(e.scrollWidth,n.scrollWidth),height:Math.max(e.scrollHeight,n.scrollHeight),canvasWidth:+w(fa,"width"),canvasHeight:+w(fa,"height"),viewBox:w(fa,"viewBox")}}function ln(e,t){var n=gt({x:e.clientX,y:e.clientY}),r=n.x,i=n.y;return!0===t||!1!==t&&ba.adsorbGrid.enabled?_t(n):{x:Wa.formatLengthSave(r),y:Wa.formatLengthSave(i)}}function dn(e){if("TEXTAREA"!=e.target.tagName&&"INPUT"!=e.target.tagName){e.preventDefault();""===va&&(Oa&&Oa.ready||wa.dragpanning||wa.drawing||Qa&&Qa.on||wa.contextmenuDisableOnce&&(wa.contextmenuDisableOnce=!1))}}function un(e){if(!("TEXTAREA"==e.target.tagName||Ba&&wa.dragpanning)){e.preventDefault();if(e.detail||e.deltaX||e.deltaY){var t,n,r,i,a=1===e.deltaMode,o=100;n=e.deltaX||e.wheelDeltaX/-3||0;r=e.deltaY||e.wheelDeltaY/-3||0;!e.detail||n||r||(r=e.detail);a&&(o=3);wa.wheelData=wa.wheelData||{x:0,y:0,lastFire:0,lastRealHandle:0};var s=wa.wheelData,c=Date.now();if(c-s.lastFire>500){s.x=0;s.y=0}s.x+=n;s.y+=r;s.lastFire;s.lastFire=c;if(!(Math.abs(s.x)<o&&Math.abs(s.y)<o)){s.lastRealHandle=c;i=Math.abs(s.x)>Math.abs(s.y);if(i){t=s.x>0;s.x+=s.x>0?-o:o;s.y=0}else{t=s.y>0;s.y+=s.y>0?-o:o;s.x=0}var l=Ua.getCacheObj("ZoomWay");void 0===l&&(l="ScrollKey");"ScrollKey"===l?hn(e,i,t):fn(e,i,t)}}}}function hn(e,t,n){if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||t){var r;r=t||e.shiftKey?n?[1,0]:[-1,0]:n?[0,1]:[0,-1];var i=So.getViewBox(),a=20/Za;i[0]+=a*r[0];i[1]+=a*r[1];So.setViewBox(i)}else if(!e.altKey)try{var o={min:20},s=ce(eo,n?"-":"+",o),c=wo==ia.PCB||wo==ia.PCBMODULE;if(c&&ja.isWaiting()){var l={nextZoom:s,clientX:e.clientX,clientY:e.clientY};ja.setWaitingZoomOption(l)}else{fr(s,{clientX:e.clientX,clientY:e.clientY});pn("setZoomText",[s+"%"])}}catch(e){}}function fn(e,t,n){if(e.ctrlKey||e.altKey||e.metaKey||t)try{var r=ce(eo,n?"-":"+");if((wo==ia.PCB||wo==ia.PCBMODULE)&&ja.isWaiting()){var i={nextZoom:r,clientX:e.clientX,clientY:e.clientY};ja.setWaitingZoomOption(i)}else{fr(r,{clientX:e.clientX,clientY:e.clientY});pn("setZoomText",[r+"%"])}}catch(e){}else if(e.shiftKey||!e.altKey){var a,o=t||e.shiftKey;a=o?n?[1,0]:[-1,0]:n?[0,1]:[0,-1];var s=So.getViewBox(),c=20/Za;s[0]+=c*a[0];s[1]+=c*a[1];So.setViewBox(s)}}function pn(t,n,r){var i=parent;if(i!=e){var a=n||[],o=[{args:a,uuid:r,func:t}];return i.callByEditor.apply(e,o)}}function gn(e,t,n){if(e||t){var r,i,a,o,s=e.length,c="x"==t?"y":"x";for(r=s-1;r>=0;r--)for(i=s-r;i>=0;i--)if(e[i]&&e[i-1]&&e[i][t]<e[i-1][t]){a=e[i];e[i]=e[i-1];e[i-1]=a;o=n[i];n[i]=n[i-1];n[i-1]=o}else if(e[i]&&e[i-1]&&e[i][t]==e[i-1][t]&&e[i][c]<e[i-1][c]){a=e[i];e[i]=e[i-1];e[i-1]=a;o=n[i];n[i]=n[i-1];n[i-1]=o}return{os:e,objs:n}}}function yn(){w(mo,{visibility:"hidden"});w(_o,{visibility:"hidden"});w(bo,{visibility:"hidden"});Lo&&w(Lo.children[0],{visibility:"hidden"})}function xn(e){var t=["FOOTPRINT","TRACK","ARC","CIRCLE","PROTRACTOR","COPPERAREA","SOLIDREGION","DIMENSION","RECT","arc","ellipse","polygon","rect","path","polyline","bus","wire","image"],n=de(e);return-1!==t.indexOf(n)}function vn(e){if(xn(e)&&!Qa.on&&v(e.id)){_e(wo)&&O(e)&&(e=v(w(e,"for")));var t=ho.get(e);t.length>=2&&Ar(t)}}function mn(){for(var e=m("#g1 ."+la.highlightClass),t=e.length-1;t>=0;t--)la.unhighlight(e[t]);"pcb"==Wa.fileType.getAbstractFileType(wo)&&ratLineMgr.cancelHighlightNets()}function Ln(e,t){function n(){w(v("gMarkError"),"visibility","hidden");Sn(!1);wa.markPinTimer=0}function r(e,t){var r=wo==ia.PCB||wo==ia.PCBMODULE;if(!1===e||arguments.length<2){w(v("gMarkError"),"visibility","hidden");Sn(!1)}else{w(v("gMarkError"),{cx:e,cy:t,visibility:"yes","stroke-width":1.5/Za});if(r){Bt({x:e,y:t},20);Sn(e,t,{strokeWidth:"2",strokeLinecap:"square"});"#FFFFFF"!=ha.gJsonCache.backGround&&Sn(e,t,{stroke:"#FFFFFF",strokeWidth:"2",strokeLinecap:"square"})}else{Et(e,t);Sn(e,t,{strokeWidth:"2",strokeLinecap:"square"})}wa.markPinTimer&&clearTimeout(wa.markPinTimer);wa.markPinTimer=setTimeout(n,1e3)}}t=t||{};var i,a;if(e.wires){for(var o,s=[],i=0;i<e.wires.length;i++){o=v(e.wires[i]);if(o){s.push(o);if(!la.isSelected(o)){la.select(o);t.selectClass&&_(o,t.selectClass,!0)}wo==ia.SCH&&"wire"==de(o)&&_(o,"designManager_selected",!0)}}var c=Ot(s);if(!c)return;var l=So.getViewBox();c.width>l[2]||c.height>l[3]?kt(s[0]):At(c)}else if(e.pin){var d=e.pin.gId,u=v(d);if(u&&"pin"==de(u)){var h=Wa.numberlistToArray(w(u,"c_origin"));r(h[0],h[1])}}else{e.labelFlag&&r(e.labelFlag.pinDot.x,e.labelFlag.pinDot.y);var f=wo==ia.PCB||wo==ia.PCBMODULE;if(f&&e.pad){var p=e.pad,g=ha.gJsonCache.FOOTPRINT[p.fid],y=g&&g.PAD&&g.PAD[p.gId];p.number==y.number&&r(y.x,y.y)}else if(W(e)){!t.fromHotKey&&mn();var x,a,m=[];for(i=0,a=e.length;i<a;i++){x=v(e[i]);x&&m.push(x)}t&&!1===t.scroll||It(m);for(i=0,a=m.length;i<a;i++){x=m[i];if(x){var L=t.selectClass||t.class||la.highlightClass;L===la.selectClass?la.select(x):_(x,L,!0);var b=de(x);me(wo)&&"wire"==b&&_(x,"designManager_selected",!0);if(f&&"FOOTPRINT"==b||me(wo)&&"schlib"==b){var S=Lt(x);S&&r(S.x,S.y)}}}pn("triggerEvent",["select_change"])}}}function _n(){for(var e,n=v("gCursors").childNodes,r=n.length,i=0;i<r;i++)(e=n[i].id)&&(_a[e]={trs:w(n[i],"transform")||"",width:w(n[i],"width"),height:w(n[i],"height")});t.addEventListener("mousemove",Cn,!1)}function bn(e,t,n){var r=/^(grab|grabbing|row-resize|col-resize)$/;ma&&("cross-red"==ma?Sn(!1):r.test(ma)?C(fa,"cursor-"+ma):w(v(ma),{display:"none"}));if(e&&r.test(e)){S(fa,"cursor-"+e);ma=e}else{var i=!1;if(e&&_a[e])if("cross-red"==e)if(!1===pn("getCrossCursor")){Sn(!1);i=!0}else if(arguments.length>=3){Sn(t,n);i=!0}else if(ma&&!0===t)Sn(!1);else{Sn(!1);i=!0}else if(arguments.length>=3)w(v(e),{x:t,y:n,display:""});else if(ma&&!0===t)w(v(e),{display:""});else{w(v(e),{x:-1e5,y:-1e5,display:""});i=!0}else i=!0;_(fa,"cursor-none",!i);ma=e||"";!e&&Sn(!1)}}function Sn(e,t,n){if(!1===e||isFinite(e)&&isFinite(t)){var r=v("cross-x-big"),i=v("cross-y-big");if(!1!==e&&!1!==pn("getCrossCursor")){var a=So.getViewBox(),o=1/Za,s=o/2,c=e%o,l=t%o;e=e-c+s;t=t-l+s;e=Math.round(1e6*e)/1e6;t=Math.round(1e6*t)/1e6;w(r,"d","M"+e+" "+a[1]+" v"+a[3]);w(i,"d","M"+a[0]+" "+t+" h"+a[2]);if(n&&n.stroke){w(r,"stroke",n.stroke);w(i,"stroke",n.stroke)}else{w(r,"stroke","red");w(i,"stroke","red")}if(n&&n.strokeWidth){w(r,"stroke-width",n.strokeWidth);w(i,"stroke-width",n.strokeWidth);w(r,"stroke-dasharray",2*n.strokeWidth+","+2*n.strokeWidth);w(i,"stroke-dasharray",2*n.strokeWidth+","+2*n.strokeWidth);if(n.strokeLinecap){r.style.strokeLinecap=n.strokeLinecap;i.style.strokeLinecap=n.strokeLinecap}}else{w(r,"stroke-width","1");w(i,"stroke-width","1");w(r,"stroke-dasharray","2, 2");w(i,"stroke-dasharray","2, 2");r.style.strokeLinecap="round";i.style.strokeLinecap="round"}}else{w(r,"d","M0 0");w(i,"d","M0 0")}}}function Cn(e){wa.canvasMoveEvent=e;if(ma)if(e.target!=t.documentElement&&e.target!=t.body||Ga){var n,r;if(!ba.adsorbGrid.enabled&&Co.forcedPixelSnap){n=Wa.extend({},ba.adsorbGrid);Wa.extend(ba.adsorbGrid,{distanceX:1,distanceY:1,enabled:!0});r=function(){Wa.extend(ba.adsorbGrid,n)}}var i,a;if(ba.adsorbGrid.enabled&&"cursor-hand"!=ma&&"cursor-grab"!=ma&&"cursor-freedraw"!=ma){fo.altKeyEnabled=e.altKey;var o=_t(ln(e));i=o.x;a=o.y}else{var s=ln(e,!1);i=s.x;a=s.y}"cross-red"==ma?Sn(i,a):w(v(ma),{x:i,y:a,display:""});r&&r()}else"cross-red"==ma?Sn(!1):w(v(ma),{display:"none"})}function Mn(e){for(;e&&!b(e.parentNode,$a);)e=e.parentNode;return e}function wn(e){"string"==typeof e&&(e=v(e));var t,n,r=!0===Ua.getCacheObj("showPadNumber"),i=m('#gNets > text[for="'+e.id+'"]'),a=w(e,"net"),o=w(e,"number"),s=w(e,"c_origin").split(","),c=("FOOTPRINT"===de(e.parentNode)?Wa.svg.getCss3(e.parentNode,"translate"):Wa.svg.getCss3(e,"translate")).split(","),l=+s[0]+1*c[0],d=+s[1]+1*c[1];i.length&&i.forEach(function(e){t=[w(e,"x"),w(e,"y")];n={x:l,y:r&&a&&o?w(e,"num")?d-.4:d+.4:d};w(e,n);if(w(e,"transform")){w(e,"transform","rotate("+Wa.svg.getCss3(e,"rotate").split(",")[0]+","+l+","+d+")")}})}function Nn(e,t,n){t=+t;n=+n;var r=w(e,"c_origin"),i=r?r.split(","):[0,0];w(e,"transform","translate("+(-i[0]+t)+","+(-i[1]+n)+")");"place_part(pad)"!=va&&"place_part(via)"!=va&&"place_part(lib)"!=va||("place_part(lib)"==va?m('g[c_partid="part_pad"]',Co.target).forEach(function(e){wn(e)}):wn(e))}function Pn(e){function t(e,t){t=t||Wa.svg.getCss3(e,"translate").split(",");if(w(e,"transform")){St(e,+t[0],+t[1]);N(e,"transform")}}var n=J(e)?e:[e],r=v("selectionBox"),i=null;n.length>=ca&&r&&w(r,"transform")&&(i=Wa.svg.getCss3(r,"translate").split(","));n.forEach(function(e){t(e,i)})}function Tn(e,t,n){var r,i,a;if(e){r="string"==typeof e?v(e):e;if(3==arguments.length){w(r,{display:""});i=w(r,"c_origin");a=i?i.split(","):[0,0];co.g(r,t-a[0],n-a[1]);w(r,{c_origin:t+","+n,display:""})}else w(r,{display:"none"})}}function On(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function kn(e){var t=[];e=e||Zt();for(var n=0,r=e.length;n<r;n++)t.push(e[n].id);return t.join(",")}function An(e,t){if(t){var n="name"==e?"note_name":"note_pre",r=t.querySelector("[c_note="+n+"]");if(!r){var i=t.firstElementChild&&b(t.firstElementChild,"hitbox")?t.firstElementChild:null,a=i?i.nextElementSibling:t.firstElementChild,o=Wa.svg.getBBox(t),s=null;if(_e(wo)){s=Wt("g",{c_partid:"part_pcbtext",id:Wa.newId(),c_origin:o.x+o.width/2+","+("note_name"===n?o.y-10:o.y-5),layerid:na.TOPSILKLAYER,display:"none"});r=Wt("path",{c_note:n,c_fontsize:"4.5",c_text:" ",fill:"none","text-anchor":"start","stroke-width":"0.7",d:"M0,0"});s.appendChild(r);"pre"===e&&a?On(s,a):t.insertBefore(s,a||null)}else{var c=L("text",t),l=w(t,n);s=Wt("g",{c_partid:"part_annotation",id:Wa.newId(),display:l||c&&c.textContent?"none":""});r=Wt("text",{c_note:n,"font-family":"Arial","font-size":"7pt",fill:"#000080","text-anchor":"start",x:o.x+o.width/2,y:"note_name"===n?o.y-10:o.y-5});l?r.textContent=l:c&&c.textContent&&(r.textContent=c.textContent);s.appendChild(r);"pre"===e&&a?On(s,a):t.insertBefore(s,a||null);"name"==e?Wr(null,r):Wr(r,null)}}return r.parentNode}}function En(e,t,n){function r(e,t){if("string"==typeof e){var n={fontFamily:w(t.firstChild,"c_fontfamily"),c_fontsize:w(t.firstChild,"c_fontsize"),degree:w(t,"c_rotation"),mirror:w(t,"c_mirror"),text:te(e),x:w(t,"c_origin").split(",")[0],y:w(t,"c_origin").split(",")[1]};if(wa.pcbFontsRegExp.test(e)){n.fontFamily=wa.pcbServersFonts[0];n.callback=function(e){N(t.childNodes[0],"fill");w(t.childNodes[0],"stroke","none");w(t,"d",e)};pn("getFontPath",[n])}else w(t.firstChild,{c_text:te(e),d:pn("getFontPath",[n])})}else t.parentNode.replaceChild(e,t)}var i=An("pre",e),a=An("name",e);if("schlib"===n){t.pre&&("string"==typeof t.pre?L("text",i).textContent=te(t.pre):i.parentNode.replaceChild(t.pre,i));t.name&&("string"==typeof t.name?L("text",a).textContent=te(t.name):a.parentNode.replaceChild(t.name,a))}else if("pcblib"===n){t.pre&&r(t.pre,i);t.name&&r(t.name,a)}}function In(e){if(!e){if(!pa)return;e=pa}var t,n=gr(e),r="cdot"==w(e,"c_shapetype"),i=!n&&(e==fa||"bodyPlaceholder"===e.id);t=r&&"light"!=w(e,"class")?"cdot":T(n)?"sheet":de(n);pn("showAttrDialog",[{cmdKey:t,docType:wo,targetId:i?"canvas":e.id}])}function me(e){return e==ia.SCH||e==ia.SUBCKT}function jn(e){function t(e,t){t.forEach(function(t){e.push(t)})}function n(e,t){var n=de(e),r=w(e,"c_rotation");if("FOOTPRINT"===n||"schlib"===n){r&&Pr([e],360- -1*r);Pr([e],Ue(360-parseInt(t,10)))}else{r&&Tr([e],360- -1*r);Tr([e],1*t)}}var r,i,a,o=Zt(),s=[],c=[],l=[],d=0,u=0,h=0;if([ia.PCB,ia.PCBMODULE,ia.PCBLIB].indexOf(wo)>-1){o=filterHilightSeginSelected(o);la.select(o)}if(o.length){La.startBatch();o.forEach(function(e){if(gr(e)==e){var t=de(e);"FOOTPRINT"===t?s.push(e):"PAD"===t?c.push(e):l.push(e)}});s.forEach(function(e,t){s[t]={ele:e,pre:w(L('[c_note="note_pre"]',An("pre",e)),"c_text")}});s=E(s,"pre");s.forEach(function(e,t){s[t]=e.ele});c.forEach(function(e,t){c[t]={ele:e,number:w(e,"number")}});c=E(c,"number");c.forEach(function(e,t){c[t]=e.ele});o=[];t(o,s);t(o,c);t(o,l);var f,p;if("matrix"===e["distribute-type"])o.forEach(function(t){f=t.cloneNode(!0);e.rotation&&n(t,e.rotation);p=w(t,"c_origin");if(p){r={};p=p.split(",");r.centerX=p[0];r.centerY=p[1]}else{r=Wa.svg.getPlainBBox(t);r.centerX=r.x+r.width/2;r.centerY=r.y+r.height/2}i=1*e["start-x"]+e["distance-x"]*d;a=1*e["start-y"]+e["distance-y"]*u;vr([t],i-r.centerX,a-r.centerY,{notHistory:!0,notCopper:!0});if("row"===e["distribute-by"]){d++;if(d>=e["per-count"]){d=0;u++}}if("column"===e["distribute-by"]){u++;if(u>=e["per-count"]){u=0;d++}}ha.updateOne(t,{noText:!0,notCopper:!0});La.save(["node",t.id,f,t.cloneNode(!0)])});else if("circular"===e["distribute-type"]){var g=0,y=e.radius,x=0;e["start-degree"]=1*e["start-degree"]+90;o.forEach(function(t){f=t.cloneNode(!0);(e.rotation||"yes"===e["r-to-match"])&&n(t,e.rotation);p=w(t,"c_origin");if(p){r={};p=p.split(",");r.centerX=1*p[0];r.centerY=1*p[1]}else{r=Wa.svg.getPlainBBox(t);r.centerX=r.x+r.width/2;r.centerY=r.y+r.height/2}g=h*e.spacing%360;x="anti-clockwise"===e.deretion?e["start-degree"]+g:e["start-degree"]-g;i=Math.sin(x*Math.PI/180)*y+1*e["center-x"];a=Math.cos(x*Math.PI/180)*y+1*e["center-y"];"yes"===e["r-to-match"]&&("anti-clockwise"===e.deretion?Pr([t],-(90+g)):Pr([t],90+g));vr([t],i-r.centerX,a-r.centerY,{notHistory:!0});ha.updateOne(t,{noText:!0,notCopper:!0});La.save(["node",t.id,f,t.cloneNode(!0)]);h++})}La.saveBatch()}}function Bn(e){function t(e,t,n,r,i){var a=!!i;try{r===(i?"different":"same")?String(e).match(new RegExp(t,n))&&(a=!i):String(e).match(new RegExp(t,n))||(a=!i)}catch(e){}return a}function n(e){return parseFloat(e).toFixed(2)}function r(e,r){if(!e||!r)return!1;var i,a,o,s,c=!0,l=/\/.*?\/g?i?/,d=["attr-name-display","attr-prefix-display"];for(i in e)if(j(e,i)){if(d.indexOf(i)>=0){"YES"==e[i].val&&(e[i].val="");r[i]&&"YES"==r[i].toUpperCase()&&(r[i]="")}a=e[i].val.match(l);if(a){o=e[i].val.split("/")[1];s=e[i].val.split("/")[2]}if("same"===e[i].type&&!j(r,i)&&!e[i].val)continue;if("any"===e[i].type)continue;if("same"===e[i].type){if(!a){isNaN(e[i].val)||isNaN(r[i])?e[i].val!=String(r[i]).toUpperCase()&&(c=!1):n(e[i].val)!==n(r[i])&&(c=!1);continue}c=t(r[i],o,s,e[i].type,!0);if(!c)continue}else if("different"===e[i].type){if(!a){isNaN(e[i].val)||isNaN(r[i])?e[i].val==String(r[i]).toUpperCase()&&(c=!1):n(e[i].val)===n(r[i])&&(c=!1);continue}c=t(r[i],o,s,e[i].type,!0);if(!c)continue}}return c}function i(t){var n,i,a=[],o=!0,s=!0;if(t)for(var c in t)if(j(t,c)){n=v(c);i=ki(n);i.c_para&&(i.c_para=Wa.c_paraToJson(i.c_para));o=r(e.attr,i);j(e,"custom")&&i.c_para&&(s=r(e.custom,i.c_para));if(o&&s){la.select(n);a.push(n)}}return a}en();var a,o=D(ha.gJsonCache);if(o.schlib)for(a in o.schlib)if(j(o.schlib,a)&&a.match(/frame_lib_/)){o.sheet||(o.sheet={});o.sheet[a]=o.schlib[a];delete o.schlib[a]}i(o[e.head.type]);"netlabel"===e.head.type&&i(o.netflag);var s,c,l;if(("prefix"===e.head.type||"name"===e.head.type||"package"===e.head.type)&&o.schlib)for(a in o.schlib)if(j(o.schlib,a)&&o.schlib[a].annotation){s=o.schlib[a].annotation;for(c in s)if(j(s,c)){if(!v(c))continue;l=w(v(c).querySelector("text[c_note]"),"c_note");if("prefix"===e.head.type&&"note_pre"===l||"name"===e.head.type&&"note_name"===l||"package"===e.head.type&&"note_package"===l)continue;delete s[c]}i(s)}if(("PREFIX"===e.head.type||"NAME"===e.head.type||"PAD"===e.head.type)&&o.FOOTPRINT)for(a in o.FOOTPRINT)if(j(o.FOOTPRINT,a)&&(o.FOOTPRINT[a].PAD||o.FOOTPRINT[a].TEXT))if("PAD"===e.head.type)i(o.FOOTPRINT[a].PAD);else{s=o.FOOTPRINT[a].TEXT;for(c in s)if(j(s,c)){if(!v(c))continue;l=w(v(c).querySelector("path[c_note]"),"c_note");if("PREFIX"===e.head.type&&"note_pre"===l||"NAME"===e.head.type&&"note_name"===l)continue;delete s[c]}i(s)}pn("triggerEvent",["select_change","multiSelect"])}function Dn(e){function t(e){e=u?Wa.units.convert(+e,"pixel",u):+e;e=Wa.formatLengthShow(e);return u?e+u:e}var n;n=_e(wo)?3:6;if("mousemove"==e.type||"mouseup"==e.type){var r=ln(e,!1);if(wo!=ia.WAVEFORM||Ma.isDrawingSelectBox){var i=e.target,a=ba.canvas,o=Dn.data;o.clientX=e.clientX;o.clientY=e.clientY;if(null===o.lastUpX){o.lastUpX=a.originX;o.lastUpY=a.originY}var s=r.x,c=r.y,l=s-o.lastUpX,d=c-o.lastUpY;if("mouseup"==e.type&&(i==fa||b(i,$a)||Ji.contains(i))){o.lastUpX=s;o.lastUpY=c;o.uplock=!0;o.clientX>0&&o.clientY>0&&o.clientX<e.view.innerWidth&&o.clientY<e.view.innerHeight&&(o.uplock=!1)}var u="pixel"!=a.unit&&a.unit||"",h={x:s,y:c};h=_t(h);h.x-=a.originX;h.y-=a.originY;h.x=t(h.x);h.y=t(h.y);o.uplock&&"mousemove"==e.type&&(Math.abs(l)*Za>n||Math.abs(d)*Za>n)&&(o.uplock=!1);if(!o.uplock){h.dx=t(l);h.dy=t(d)}o.currAbsX=h.absX=r.x;o.currAbsY=h.absY=r.y;pn("updateMouseXY",[h])}else Ma.updateMessageBarInfo(r)}}function Fn(t){if(!Qa.origin){var n;if(e.copyByRefPoint&&copyByRefPoint.fn&&copyByRefPoint.fn.position){n={x:copyByRefPoint.fn.position.x,y:copyByRefPoint.fn.position.y};return n}var r=function(e){if(1===e.length)return e[0];var t={element:e[0],bbox:Wa.svg.getBBox(e[0])},n=e.map(function(e){return{element:e,bbox:Wa.svg.getBBox(e)}}),r=null,i=null;n.forEach(function(e){r=null===r?e.bbox.x:Math.min(e.bbox.x,r);i=null===i?e.bbox.y:Math.min(e.bbox.y,i)});n.forEach(function(e){Be(e.bbox.x,e.bbox.y,r,i)<Be(t.bbox.x,t.bbox.y,r,i)&&(t=e)});return t.element}(t),i=de(r);if("arc1"===w(r,"c_helper_type")||"ARC"===i){var a=Wa.arc.convertSvgParam2CanvasParam(w(r,"d"));n=a?{x:a.cx,y:a.cy}:null}else if(["wire","bus","line","polyline","polygon","path","arc","rect","TRACK","DIMENSION","PROTRACTOR","SOLIDREGION","RECT","COPPERAREA"].indexOf(i)>-1||w(r,"copper_id"))"path"===r.tagName?n={x:r.pathSegList.getItem(0).x,y:r.pathSegList.getItem(0).y}:"polyline"===r.tagName||"polygon"===r.tagName?n=z(w(r,"points"))[0]:"rect"===r.tagName&&(n={x:+w(r,"x"),y:+w(r,"y")});else if(["ellipse"].indexOf(i)>-1){var o=r.getBBox();n={x:o.x,y:o.y+o.height}}else if(["image","SHEET","SVGNODE"].indexOf(i)>-1||"part_lib_sheet"===w(r,"c_partid")){o=r.getBBox();n={x:o.x,y:o.y}}else if(w(r,"c_origin"))n=z(w(r,"c_origin"))[0];else{o=r.getBBox();n={x:o.x+o.width/2,y:o.y+o.height/2}}}return n||Qa.origin}function Rn(e){function t(e){var t=ki(e);t.groupAttr=!0;return t}var n,r,i=[];if(!e||e.length<2)return!1;var a=t(e[0]);if(!a)return!1;a.c_para&&(a.c_para=Wa.c_paraToJson(a.c_para));for(var o=1,s=e.length;o<s;o++){var c=t(e[o]);wo===ia.PCB&&i.indexOf(c.cmdKey)<0&&i.push(c.cmdKey);"COPPERAREA"!==c.cmdKey&&"CIRCLE"!==c.cmdKey&&"TEXT"!==c.cmdKey&&"ARC"!==c.cmdKey&&"RECT"!==c.cmdKey&&"SOLIDREGION"!==c.cmdKey||(n=!0);"HOLE"!==c.cmdKey&&"VIA"!==c.cmdKey||(r=!0);if(i.length>4&&n&&r)break;le(a,c)}a["attr-selected-count"]=e.length;return a}function Vn(e){var t=Zt();if(t.length){var n,r,i;La.startBatch();t.forEach(function(t){i=de(t);if("schlib"===i||"FOOTPRINT"===i){var a=An("pre",t),o=Wa.svg.getPlainBBox(t),s=e;o.centerX=o.x+o.width/2;o.centerY=o.y+o.height/2;var c=Wa.svg.getBBox(a);c.centerX=c.x+c.width/2;c.centerY=c.y+c.height/2;parseFloat(w(a.firstChild,"c_fontsize")||w(a.firstChild,"font-size")||"7");n=o.centerX-c.centerX;r=o.centerY-c.centerY;w(t,"layerid")==na.BOTTOMLAYER&&("left"===s?s="right":"right"===s&&(s="left"));"top"===s?r+=-1*(o.height/2+c.height/2+3):"left"===s?n+=-1*(o.width/2+c.width/2+3):"bottom"===s?r=r+o.height/2+c.height/2+3:"right"===s&&(n=n+o.width/2+c.width/2+3);St(a,n,r);ha.updateOne(t);La.save(["move",a.id,n,r])}});La.saveBatch();pn("setTabUnsaved")}}function Gn(e){var t=Zt();if(t.length){var n,r,i;La.startBatch();t.forEach(function(t){i=de(t);if("FOOTPRINT"===i){var a=An("name",t),o=Wa.svg.getPlainBBox(t),s=e;o.centerX=o.x+o.width/2;o.centerY=o.y+o.height/2;var c=Wa.svg.getBBox(a);c.centerX=c.x+c.width/2;c.centerY=c.y+c.height/2;n=o.centerX-c.centerX;r=o.centerY-c.centerY;w(t,"layerid")==na.BOTTOMLAYER&&("left"===s?s="right":"right"===s&&(s="left"));"top"===s?r+=-1*(o.height/2+c.height/2+3):"left"===s?n+=-1*(o.width/2+c.width/2+3):"bottom"===s?r=r+o.height/2+c.height/2+3:"right"===s&&(n=n+o.width/2+c.width/2+3);St(a,n,r);ha.updateOne(t);La.save(["move",a.id,n,r])}});La.saveBatch();pn("setTabUnsaved")}}function zn(e,t){for(var n in e){var r=e[n],i=t[n];if(i)for(var a=0;a<i.length;a++){var o=v(i[a].gid);o&&w(o,"c_issystemlib",r.isSystemLib)}}}function Hn(e,n,r){function i(e,n,r,i,a){var o;o=m?'<g xmlns="http://www.w3.org/2000/svg" c_partid="part_pcbtext" c_origin="'+r+","+i+'" id="'+Wa.newId()+'" c_shapetype="group" layerid="3" '+("name"===a?'display="none"':"")+'><path c_note="note_'+a+'" c_fontsize="4.5" c_text="'+ne(e)+'" d="'+n+'" fill="none" stroke-width="0.6"/></g>':'<g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" c_shapetype="group"><text c_note="note_'+a+'" x="'+r+'" y="'+i+'" font-family="Arial" font-size="7pt" fill="#000080" text-anchor="start">'+ne(e)+"</text></g>";var s=F(o);if(s){o=t.importNode(s.documentElement,!0);return o}}function a(t,n,a,s){var l,d;if(m){d={text:n,x:a,y:s,fontSize:4.5,fontFamily:""};if(wa.pcbFontsRegExp.test(n)){d.fontFamily=wa.pcbServersFonts[0];d.callback=function(l){var d=i(n,l,a,s,t);N(d.childNodes[0],"fill");w(d.childNodes[0],"stroke","none");if("place_part"===r&&Co.target&&d){var u=y(d),h=An(t,Co.target);Co.target.replaceChild(u,h)}d&&e.insertBefore(d,e.firstChild);c=o(e);co.move(d,c.x-a,c.name_y-s);"place_part"!==r&&ha.updateOne(d)};pn("getFontPath",[d])}else{f=pn("getFontPath",[d])||"M0,0";l=i(n,f,a,s,t);l&&e.insertBefore(l,e.firstChild)}}else{l=i(n,null,a,s,t);l&&e.insertBefore(l,e.firstChild)}}function o(e){var t=Wa.svg.getBBox(e),n=[t.x,t.y,t.width,t.height],r=+n[0]+n[2]/2|0,i=0|+n[1],a=1;L('g[c_partid="part_pad"][c_shape="OVAL"]',e)&&(a=2);i-=a;return{x:r,y:i,name_y:i-7}}var s=L('g[c_etype="outline3D"] > polyline',e);s&&w(s,"display","none");var c=o(e);s&&w(s,"display","");var l,d,u,h,f,p=c.x,g=c.y,x=c.name_y,v=Wa.c_paraToJson(w(e,"c_para")||""),m=_e(wo),_='g[c_partid="'+(m?"part_pcbtext":"part_annotation")+'"]';u=L(_+' > [c_note="note_pre"]',e);if(!u&&j(n,"pre")){h=n.pre?n.pre:v.pre?v.pre:"U?";a("pre",h,p,g)}l=L(_+' > [c_note="note_name"]',e);if(!l&&j(n,"name")){d=n.name?n.name:v.value?v.value:"";a("name",d,p,x)}}function Un(e,t,n){var r,i,a=t.getBBox().x,o=t.getBBox().y+t.getBBox().height,s=0,c=pn("i18nTransfer",["This component is verified","This component is unmounted"]);if("verify"==e){i=Wt("g",{id:Wa.newId()});r=Wt("title");S(r,"i18n");r.innerHTML=c[0];i.appendChild(r);var l=Wt("text",{c_note:"note_verify",x:a,y:o+11});l.textContent="✔";l.style.fontSize="7pt";l.style.fontFamily="Arial";S(l,"verify-icon");i.appendChild(l);t.appendChild(i)}else if("mounted"==e){if(m("[c_note = note_verify]",t).length>0){var d=m("[c_note = note_verify]",t)[0],u=d.parentNode;M(d);a=t.getBBox().x;o=t.getBBox().y+t.getBBox().height;s=12;u.appendChild(d)}i=Wt("g",{id:Wa.newId()});r=Wt("title");S(r,"i18n");r.innerHTML=c[1];i.appendChild(r);l=Wt("text",{c_note:"note_mounted",x:a+s,y:o+11,fill:"red"});l.textContent="(R)";l.style.fontSize="7pt";l.style.fontFamily="Arial";S(i,"mounted-icon");i.appendChild(l);i.style.display=!1===n?"block":"none";t.appendChild(i)}}function Yn(){if(parent!=self){var e=F(Le(wo)?ao:io);if(e)for(var n,r,i=t.adoptNode(e.documentElement),a=i.childNodes,o=a.length-1;o>=0;o--){r=a[o];n=r.id;if(n&&!v(n)){v("gCurParts").appendChild(r);w(r,{display:"none"})}}}}function Jn(e,t){if(e&&"string"==typeof e){for(var n,r,i=m('.shapeBox > g[c_partid^="part_netLabel"]'),a=i,o=0;o<i.length;o++)i[o].id==t&&(a=i.slice(o+1));for(o=0;o<a.length;o++){r=a[o].textContent;if(X(r||"").toUpperCase()==X(e||"").toUpperCase()){n=a[o];break}}return n}}function Wn(e,t,n){if(e&&"string"==typeof e){var r=_e(wo);if(!t){t="prefix";n=0}var i,a;if("prefix"==t){var o=m('[c_note="note_pre"]',Ji),s=o;if(n)for(c=0;c<o.length;c++)gr(o[c]).id==n&&(s=o.slice(c+1));for(var c=0;c<s.length;c++){a=r?w(s[c],"c_text"):s[c].textContent;if(X(a||"").toUpperCase()==X(e||"").toUpperCase()){i=gr(s[c]);break}}}else if("name"==t){var l=m('[c_note="note_name"]',Ji),d=l;if(n)for(c=0;c<l.length;c++)gr(l[c]).id==n&&(d=l.slice(c+1));for(c=0;c<d.length;c++){a=r?w(d[c],"c_text"):d[c].textContent;if(X(a||"").toUpperCase()==X(e||"").toUpperCase()){i=gr(d[c]);break}}}else if("package"==t){var u=m(".shapeBox > g[c_para]",Ji),h=u;if(n)for(c=0;c<u.length;c++)u[c].id==n&&(h=u.slice(c+1));var f;for(c=0;c<h.length;c++){f=Wa.c_paraToJson(w(h[c],"c_para"));if(f&&X(f.package||"").toUpperCase()==X(e||"").toUpperCase()){i=h[c];break}}}else"id"==t?i=v(e):"bindId"==t&&(i=L('.shapeBox > g[id="'+e+'"]',Ji));return i}}function Xn(e){function t(e,n){if(!1===e||arguments.length<2){w(v("gMarkError"),"visibility","hidden");Sn(!1)}else{w(v("gMarkError"),{cx:e,cy:n,visibility:"yes","stroke-width":1.5/Za});Sn(e,n,{strokeWidth:"2",strokeLinecap:"square"});setTimeout(t,1e3)}}var n=v(e);if(n){en();la.select(n);var r=Wa.svg.getPlainBBox(n);kt(n);t(r.x+r.width/2,r.y+r.height/2);pn("triggerEvent",["select_change"])}}function Qn(e,t){var n,r,i,a,o,s,c,l,d,u,h,f={},p=[];La.startBatch();var g=!1,x=[],v=[],_={};for(var b in e)if(j(e,b)){_[b]||(_[b]=b);!function(t){yo.addTask(function(){if(g)x.push(t);else{n=Wn(t,"id");if(n){_e(wo)&&reCoverBeforeId(n);c=e[t];o=w(n,"c_origin").split(",");u=Tt(n);r=Wa.c_paraToJson(u.c_para);if(ha.gJsonCache.FOOTPRINT){i=ha.gJsonCache.FOOTPRINT[t];a=i.PAD;f={};if(a)for(var b in a)if(j(a,b)){f[a[b].number]=a[b].net;a[b].net&&-1===p.indexOf(a[b].net)&&p.push(a[b].net)}}l=Kn(c);if(l){l=l.childNodes[0];w(l,"c_para",$n(w(l,"c_para")).newPara);d=Wa.c_paraToJson(w(l,"c_para"));r.BOM_Mounted&&(d.BOM_Mounted=r.BOM_Mounted);r.Contributor&&(d.Contributor=r.Contributor);r["Package Display"]&&(d["Package Display"]=r["Package Display"]);w(l,"c_para",Wa.jsonToC_para(d));var S=w(n,"c_issystemlib");S&&w(l,"c_issystemlib",S);m('[c_partid="part_pad"]',l).forEach(function(e){var t=f[w(e,"number")];t&&w(e,{net:t,title:t})});h=Rt(l,_[t]);w(l,"c_partid","part_lib_"+h);u.c_rotation&&(u.layerid&&isBottomLayer(+u.layerid)?Pr([l],u.c_rotation,!0):Pr([l],360-u.c_rotation,!0));if(u.layerid){u.layerid=+u.layerid;isBottomLayer(u.layerid)&&changeFootprintLayerId(l,u.layerid,!0)}_e(wo)?Layer.appendElement(l):Ji.appendChild(l);s=w(l,"c_origin").split(",");co.move(l,o[0]-s[0],o[1]-s[1]);l.insertBefore(y(An("pre",n)),l.children[0]);l.insertBefore(y(An("name",n)),l.children[0]);var C=!1;if(Le(wo)){C=!0;var M=L('[c_note="note_package"]',n);M&&l.appendChild(y(M.parentNode));w(l,{c_shapetype:"group",c_etype:"pinpart"})}po.isLocked(n)&&po.lockObjs([l]);ha.removeOne(n);La.save(["del",n.id,Wa.node.getParentNodeId(n)]);La.save(["add",l.id,Wa.node.getParentNodeId(l)]);la.unselect(n);qa.appendChild(n);C&&Vt(l);ha.updateOne(l,{notCopper:!0,notRealtimeDRC:!0,noText:!0,noRebuildPlane:!0});v.push(t);if(_e(wo)){deleteNetText(n);Layer.updatePadsByNodes([l])}else Bi(ba.colors,l)}}}})}(b)}yo.addTask(function(){if(_e(wo)){Layer.showAtFront(Layer.front);ratLineMgr.buildGroupNets(p)}pn("updateAttrPanel");t&&t({updated:v,notUpdated:x});La.saveBatch()});yo.onProgress(function(e){if(!g){e=Math.min(1,Math.max(e,.01));pn("progressUpdate",[e,"Update from Library","updateLibsProcess",function(){g=!0}])}});yo.run()}function Kn(e){var n,r,i,a;if("string"==typeof e){e.match(/^<\w/)&&!e.match(/^<svg/)&&(e='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e+"</svg>");n=F(e);if(!n)return;if(_e(wo)){var o=m("g",n.documentElement)&&m("g",n.documentElement)[0];o&&pcblibRectToPolyGonOrPath(o)}a=t.importNode(n.documentElement,!0)}else 1===e.nodeType?a=t.importNode(e,!0):e.constructor==Object&&(a=makeSVG(e.tagName||e.tag,e.attr||e.attrs));if(a){k(a);N(a,"c_maxggei");if("svg"==a.tagName){var s=m("svg > g[subparts]",a);if(s.length){var c=Wt("g");for(r=0;r<s.length;r++)c.appendChild(s[r]);return c}for(r=0,i=a.childNodes.length;r<i;r++){var l=a.childNodes[r];if("g"===l.tagName){a=l;break}}}if("g"!=a.tagName){var c=Wt("g");if("svg"==a.tagName)for(;a.firstChild;)c.appendChild(a.firstChild);else c.appendChild(a);a=c}if("g1"===a.id||w(a,"c_module")){var d=L("[c_origin]",a);w(a,{c_module:"1"});if(d)w(a,{c_origin:w(d,"c_origin")});else{var u=Wa.svg.getBBox(a);w(a,{c_origin:u.x+u.width/2+","+(u.y+u.height/2)})}}else{c=Wt("g",{id:Ji.id,c_origin:w(a,"c_origin")});w(a,"layerid")&&w(c,"layerid",w(a,"layerid"));c.appendChild(a);a=c}return a}parent.$.messager.alert("import fail")}function $n(e){var t=Le(wo);"string"==typeof e&&(e=Wa.c_paraToJson(e));var n,r=e.pre?e.pre:"U?";if(t){if(e.nameAlias&&e.nameAlias.length>0){n=e[e.nameAlias]||e.name||"";delete e[e.nameAlias]}else n=e.name;!e.spicePre&&e.pre&&(e.spicePre=e.pre.substr(0,1));e.spiceSymbolName||(e.spiceSymbolName=e.name);e["BOM_Manufacturer Part"]||(e["BOM_Manufacturer Part"]="")}else n=e.package?e.package:"";delete e.pre;delete e.name;delete e.nameDisplay;return{pre:r,name:n,newPara:Wa.jsonToC_para(e)}}function qn(e,t){var r,i,a,o=So.getViewBox();switch(e){case ia.SCHMODULE:r=70;i=+o[0]+r;a=t?+o[3]-r:+o[1]+r;n("setOriginXY",[{x:i,y:a}]);break;case ia.PCB:case ia.PCBMODULE:r=20
;i=+o[0]+r;a=t?+o[3]+ +o[1]-r:+o[1]+r;n("setOriginXY",[{x:i,y:a}])}}function Zn(e,t){t=t&&t.ids?t.ids:t;t=t||Zt();var n=!Le(wo);if(!t||Array.isArray(t)){n&&(t=filterHilightSeginSelected(t));var r=[];t=t?[].map.call(t,function(e){return"string"==typeof e?v(e):e.gId?v(e.gId):e}).filter(function(e){if(!e)return!1;if("part_pcbtext"==w(e,"c_partid")&&er(e.parentNode)){if(po.isLocked(e.parentNode)){r.push(e);return!1}return!0}if(er(e)){if(po.isLocked(e)){r.push(e);return!1}return!0}}):Zt().filter(function(e){if(!b(e.parentNode,$a))return!1;if(po.isLocked(e)){r.push(e);return!1}return!0});if(t.length){if(n){la.select(t);for(o=0,s=t.length;o<s;o++)"TEXT"==de(t[o])&&"FOOTPRINT"===de(t[o].parentNode)&&w(t[o],"oldOrigin",w(t[o],"c_origin"))}else Sa.solveItems(t);var i,a,o,s,c,l,d,u,h=new Pi(t),f=[],p=0,g=ba.adsorbGrid.gridSize,y={x:ba.canvas.originX,y:ba.canvas.originY};if("align_grid"==e)for(o=0,s=t.length,c=0;o<s;o++){var x=w(t[o],"c_origin");if(x)x=x.split(",");else if("path"==t[o].tagName){var m=pt(t[o].getAttribute("d"));x=[Number(m[1]),Number(m[2])]}else if("ellipse"==t[o].tagName||"circle"==t[o].tagName){var L=t[o].getAttribute("cx"),_=t[o].getAttribute("cy");x=[Math.round(L/g-y.x)*g+y.x-x[0],Math.round(_/g-y.y)*g+y.y-x[1]]}else if("polygon"==t[o].tagName||"polyline"==t[o].tagName){var S=vt(t[o],1);x=[Number(S[1]),Number(S[2])]}else{var C=Wa.svg.getBBoxFixed(t[o],{excludeText:!0,excludePindot:!0});if(!C.width&&!C.height)continue;x=[C.x+C.width/2,C.y+C.height/2]}if(x){l=function(e,t,n){return{x:Math.round((e.x-n.x)/t)*t+n.x-e.x,y:Math.round((e.y-n.y)/t)*t+n.y-e.y}}({x:x[0],y:x[1]},g,y);if(l.x||l.y||"align_horizontal_equidistant"===e){co.move(t[o],l.x,l.y);p++}else h.deleteItemAt(o+c--)}}else{var M,N,P,T,O,k=t.concat(r);for(o=0,s=k.length;o<s;o++){C=Wa.svg.getBBoxFixed(k[o],{excludeText:!0,excludePindot:!0});if(C.width||C.height){f[o]=C;if(0===o){i=C.x;a=C.y;M=C.x;N=C.y;P=C.x+C.width;T=C.y+C.height}switch(e){case"align_left":i=void 0===i?C.x:Math.min(i,C.x);break;case"align_right":i=void 0===i?C.x+C.width:Math.max(i,C.x+C.width);break;case"align_top":a=void 0===a?C.y:Math.min(a,C.y);break;case"align_bottom":a=void 0===a?C.y+C.height:Math.max(a,C.y+C.height);break;case"align_horizontal_center":a=void 0===a?C.y:Math.min(a,C.y);T=Math.max(T,C.y+C.height);o==s-1&&(a=(T+a)/2);break;case"align_vertical_center":i=void 0===i?C.x:Math.min(i,C.x);P=Math.max(P,C.x+C.width);o==s-1&&(i=(P+i)/2);break;case"align_horizontal_equidistant":i=void 0===i?C.x:Math.min(i,C.x);P=Math.max(P,C.x+C.width);break;case"align_vertical_equidistant":a=void 0===a?C.y:Math.min(a,C.y);T=Math.max(T,C.y+C.height);break;case"align_left_side_edge_equidistant":i=void 0===i?C.x:Math.min(i,C.x);M=void 0===i?C.x:Math.max(M,C.x);break;case"align_top_side_edge_equidistant":a=void 0===a?C.y:Math.min(a,C.y);N=void 0===a?C.y:Math.max(N,C.y);break;default:return}}}if(void 0===i&&("align_left"==e||"align_right"==e||"align_horizontal_center"==e))return;if(void 0===a&&("align_top"==e||"align_bottom"==e||"align_vertical_center"==e))return;if("align_vertical_center"==e||"align_top_side_edge_equidistant"==e||"align_vertical_equidistant"==e){var A=gn(f,"y",t);t=A.objs;f=A.os}else if("align_horizontal_center"==e||"align_left_side_edge_equidistant"==e||"align_horizontal_equidistant"==e){var E=gn(f,"x",t);t=E.objs;f=E.os}"align_left_side_edge_equidistant"==e?O=Math.abs(M-i)/(t.length-1):"align_top_side_edge_equidistant"==e&&(O=Math.abs(N-a)/(t.length-1));if("align_horizontal_equidistant"==e){O=P-i;if(f.length<=2)return;for(o=0;o<f.length;o++){O-=f[o].width;o==f.length-1&&(O/=f.length-1)}}else if("align_vertical_equidistant"==e){O=T-a;if(f.length<=2)return;for(o=0;o<f.length;o++){O-=f[o].height;o==f.length-1&&(O/=f.length-1)}}for(o=0,s=t.length,c=0;o<s;o++)if(f[o]){d=0;u=0;switch(e){case"align_left":d=i-f[o].x;break;case"align_right":d=i-f[o].x-f[o].width;break;case"align_top":u=a-f[o].y;break;case"align_bottom":u=a-f[o].y-f[o].height;break;case"align_horizontal_center":u=a-f[o].y-f[o].height/2;break;case"align_vertical_center":d=i-f[o].x-f[o].width/2;break;case"align_horizontal_equidistant":if(f[o].x+f[o].width===P&&f.length-1===o)break;d=i-f[o].x;i=i+f[o].width+O;break;case"align_vertical_equidistant":if(f[o].x+f[o].height===T)break;u=a-f[o].y;a=a+f[o].height+O;break;case"align_left_side_edge_equidistant":d=Math.round(i-f[o].x);i+=O;break;case"align_top_side_edge_equidistant":u=Math.round(a-f[o].y);a+=O}if(d||u){co.move(t[o],d,u);p++}else{var I=h.findIndexWithId(t[o].id,"hist");c--;h.deleteItemAt(I)}}else h.deleteItemAt(o+c--)}if(p){h.updateAndSave();ha.updateMore(t,{notCopper:!0,noText:!0});if(n){ratLineMgr.buildRatLinesOfPCBLib(t);updateNetText()}else{Sa.solveItems(t);Sa.solveTodoList();h.update();La.save(Sa.batHistoryCmd(h.hist))}pa&&vn(pa)}}}}function er(e){return!!e&&b(e.parentNode,$a)}function tr(e){var n=e.gJsonCache||{},r=n.schlib||n.FOOTPRINT,i={},a="",o={},s="";for(var c in r)if(r.hasOwnProperty(c)&&"object"==typeof r[c]&&!/^frame_lib_.*/i.test(c)){s=a=ue();if("object"==typeof r[c].annotation){o=Wa.findItemFromArrWithKey(Object.values(r[c].annotation),"mark","P");s=o&&o.string?o.string:a}else if("object"==typeof r[c].TEXT){o=Wa.findItemFromArrWithKey(Object.values(r[c].TEXT),"type","P");s=o&&o.text?o.text:a}i[c]={pre:s}}!function(e,n){void 0===e&&(e={});void 0===n&&(n="gge");for(var r=Object.keys(e),i="",a={},o=null,s=[],c=0;c<r.length;c++)if(v(r[c])){i=n+he(e[r[c]].pre);a[i]?i=n+ue(c):a[i]="1";s.push(i);w(v(r[c]),{"data-tmp-id":i})}for(c=0;c<s.length;c++){o=t.querySelector('[data-tmp-id="'+s[c]+'"]');if(o){o.setAttribute("id",s[c]);o.removeAttribute("data-tmp-id")}}}(i,"gge")}function nr(e){if(e){var t=[];Co.target&&Co.target.id&&t.push(Co.target.id);Qa.targets&&Qa.targets.forEach(function(e){t.push(e.id)});t.length&&(e=e.filter(function(e){return t.indexOf(e.id)<0}));return e}}function rr(e,t){if(!e)return"";var n,r=t?"text":"path",i=L("g "+r+'[c_note="note_pre"]',e);i&&(n=t?i.textContent:w(i,"c_text"));return n||""}function ir(e,t){if(e&&e.length){var n,r,i=pn("getAllLibIds",[null,t]),a=t?"schlib":"FOOTPRINT";e.forEach(function(e,o){if(!(de(e)!=a||t&&e.id&&e.id.indexOf("frame_lib_")>=0)){r=rr(e,t);if(r){n="gge"+he(r);i.indexOf(n)>=0&&(n="")}n||(n="gge"+ue(o));i.push(n);w(e,"id",n)}})}}function ar(e,t,n){if(e&&t){var r,i,a,o;ha.gJsonCache&&(ha.gJsonCache[n?"schlib":"FOOTPRINT"]=t);for(r in e)if(j(e,r)){i=e[r];a=v("repead_"+r)||v(r);if(a){o=v(i);o&&w(o,"id","repead_"+i);w(a,"id",i);ha&&ha.updateLibMasker&&ha.updateLibMasker(a)}}}}function or(e,t){if(e){var n=Kn(e);if(n&&n.childNodes)for(var r,i,a=n.childNodes.length-1,o=t?"text":"path";a>=0;a--){r=n.childNodes[a];pre=L("g "+o+'[c_note="note_pre"]',r);if(pre){i=t?pre.textContent:w(pre,"c_text");if(i&&i.match(/\?/))return!0}}}}function sr(e,t){if(va!=e&&!(Aa&&Aa.start||Ea&&Ea.start||Ia&&Ia.start)){""!==va&&dr();if(e){if("draw(refPoint)"!==e){pn("releaseActive");pn("triggerEvent",["select_change"])}n("dragMoveSwitch",[!1]);cr(e);Co.ready(t)}}}function cr(e){return""===va?va=e:va}function lr(){va="";Co.target=null}function dr(){if(""!==va){Co.end();va="";Co.target=null}}function ur(e){var r,i,a=e.target,o=e.type,s=e.button,c=s===qi,l=s===ea,d=Ba?e.metaKey:e.ctrlKey;if("mousedown"==e.type&&c){pn("hideMenuOnMouseDown");pn("triggerPanelChange");La.lastMergeSource=""}if(""===va&&!(Aa&&Aa.start||Ea&&Ea.start||Ia&&Ia.start||gi&&gi.instance.start)){3==a.nodeType&&(a=a.parentNode);"tspan"==a.tagName&&(a=a.parentNode);if(a!=t&&a!=t.documentElement&&a!=t.body||Ga||Xa){var u,h=gr(a);if(Rr(a)||Vr(a))u=a.parentNode;else{u=h;wo==ia.WAVEFORM&&(u=null)}var f="cdot"==w(a,"c_shapetype");if(!u&&f){if("mousedown"==o&&!d&&c){Aa.mdown(e);return}u=pa}!u&&Xa&&Xa.target&&(u=Xa.target);wo===ia.WAVEFORM&&(u=null);if(u&&"mouseover"==o){if(!h)return;if(Xa){la.unhighlight(Xa.target);Xa=null;t.removeEventListener("mousemove",hr,!1)}la.highlight(u)}else if(u&&"mouseout"==o)if("cdot"==w(a,"c_shapetype")){if(Xa){la.unhighlight(Xa.target);Xa=null}t.removeEventListener("mousemove",hr,!1)}else{var p=ln(e,!1);Xa={x:p.x,y:p.y,target:u,evtTarget:a};t.addEventListener("mousemove",hr,!1)}else if(u||"mousedown"!=o||"TEXTAREA"==e.target.tagName||d||!c){if(u&&"mousedown"==o&&!d&&c){if(u===pa||la.isSelected(u))return;pn("multiSelect",[!1]);pn("releaseActive");if("sch"==Wa.fileType.getAbstractFileType(wo)&&"pinpart"==w(a.parentNode,"c_etype")&&"part_junction"!=w(a.parentNode,"c_partid")){var g=L("circle[c_pindot]",a.parentNode);if(g){var y=+w(g,"cx"),x=+w(g,"cy"),v=+w(g,"r"),m=ln(e),_=m.x,b=m.y;if(a==g||De(_,b,y,x)<=v){pn("triggerEvent",["select_change"]);sr("draw(wire)");Co.dots=[y,x];Co.draw(_,b,!1);return}}}if(!f){if(pa!=u)if(pa)la.unselect(pa);else{pa=u;la.select(pa)}i=w(u,"c_shapetype");if("image"===a.tagName&&"part_image"==w(a.parentNode,"c_partid")){vn(a);pa=a}else"line"==i?!Qa.on&&vn(u):"group"==i&&yn();pn("triggerEvent",["select_change"])}}else if(u&&"mousedown"==o&&d&&c){var S=u;(Rr(a)||Vr(a))&&(S=a.parentNode);pn("multiSelect",[!0]);la.toggle(S);if(pa){pa!=S&&la.select(pa);pa=null;yn()}pn("triggerEvent",["select_change","multiSelect"])}else if(u&&"mouseup"==o&&!d&&c){if(Qa.on&&!Qa.bind){n("dragMoveCheck",[e,[u]]);return}if(Rr(a)){r=a.parentNode;if(pa!=r){en();pa=r;la.select(pa)}}wo==ia.SCH&&pn("crossProbe",[{silent:!0}])}else if("mousedown"==o&&!d&&l)Qa.on&&(wa.contextmenuDisableOnce=!0);else if("mouseup"==o&&c)wo==ia.SCH&&Ia.endEvent!==e&&pn("crossProbe",[{silent:!0}]);else if("mouseup"==o&&!d&&l){if(Qa.on){wa.contextmenuDisableOnce=!0;Qa.bind||n("dragMoveSwitch",[!1]);return}if(wa.dragpanning)return;if(va)return;qt(e)}}else{pn("multiSelect",[!1]);pn("releaseActive");pn("triggerEvent",["select_change"]);Ia.e.mdown(e)}}}}function hr(e){if(Xa){var n=ln(e,!1);if(Math.pow((n.x-Xa.x)*Za,2)+Math.pow((n.y-Xa.y)*Za,2)>81){la.unhighlight(Xa.target);t.removeEventListener("mousemove",hr,!1);Xa=null}else la.highlight(Xa.target)}}function fr(t,n){if(wo!=ia.WAVEFORM){t=+t;if(!(!t||t<.1||t>1e5)){t=function(e){var t=e+"",n=t.match(/[1-9]\.?\d/);if(!n)return e;var r=t.indexOf(n[0])+n[0].length;t=t.substr(0,r)+t.substr(r).replace(/[1-9]/g,"0");return+t}(t);var r=Za;eo=t;Za=t/100;var i,a,o=1===Za?1:Wa.toFixed(100/t+1e-5,5),s=So.getViewBox(),c=+w(fa,"width"),l=+w(fa,"height");if(n&&j(n,"clientX")&&!n.uplock){var d=1/r-1/Za;a=[s[0]+n.clientX*d,s[1]+n.clientY*d,c/Za,l/Za]}else{var u=Wa.svg.getBBox(Ji);i={x:u.width?u.x+u.width/2:u.x||s[0]+s[2]/2,y:u.height?u.y+u.height/2:u.y||s[1]+s[3]/2};a=[i.x-c/Za/2,i.y-l/Za/2,c/Za,l/Za]}So.setViewBox(a);var h=+ba.adsorbGrid.gridSize;(!h||h<1)&&(h=1);for(;h*Za<5;)h*=h*Za*2>=5?2:h*Za*5>=5?5:10;var f=.5/Za,p=void 0!==vo.style.vectorEffect,g=function(e){return e/Za},y=m("#gCursors>image");on();setTimeout(function(){w(v("gridPattern"),{x:ba.canvas.originX,y:ba.canvas.originY});w(v("gridPattern2"),{x:ba.canvas.originX+o,y:ba.canvas.originY+o});w(v("gridCell"),{width:o,height:o});w(v("gridCell2"),"stroke-width",o);w([v("gridPattern"),v("gridPattern2")],{width:h,height:h});w(v("gridCell2"),{d:"M10 0V10H-10".replace(/10/g,h)});w(v("gridOH"),{"stroke-width":o,y1:ba.canvas.originY+f,y2:ba.canvas.originY+f});w(v("gridOV"),{"stroke-width":o,x1:ba.canvas.originX+f,x2:ba.canvas.originX+f});w(m("circle.pindot, #gPinDots circle"),{r:Math.max(4*o,1)});w(m('#g1 g[c_partid="part_netLabel_text"] > path'),{"stroke-width":Math.max(o,.1)});var n=Math.max(4*o,1);n=Math.min(n,2);w(m("circle.pindot"),{r:n});if(!p){var r=Wa.toFixed(3*o,2);w(vo,"stroke-width",o);vo.style.strokeDasharray=r+","+r;var i=v("cross-x-big"),s=v("cross-y-big");w([i,s],{"stroke-width":o,"stroke-dasharray":r+","+r});i.style.strokeDasharray=r+","+r;s.style.strokeDasharray=r+","+r;if(2==i.pathSegList.numberOfItems&&i.pathSegList.getItem(1).y){var c=50/t,l=i.pathSegList.getItem(0).x,d=s.pathSegList.getItem(0).y;l=l-l%(100/t)+c;d=d-d%(100/t)+c;l=Math.round(1e6*l)/1e6;d=Math.round(1e6*d)/1e6;w(i,"d","M"+l+" "+a[1]+" v"+a[3]);w(s,"d","M"+a[0]+" "+d+" h"+a[2])}w(bo.children,{"stroke-width":o,"stroke-dasharray":r+","+r});w(_o.children,{"stroke-width":o,"stroke-dasharray":r+","+r});w(m("#gControlDots>*"),{"stroke-width":o})}var u;for(u=0;u<ga.length;u++)w(ga[u],{r:4*o});!function(e,t){if(e){var n=e.sheet.cssRules[0];n&&(n.style.strokeWidth=t)}}(v("px1Style"),o);!function(e,t,n){if(e)if(n<1){var r,i=e.sheet,a=i.cssRules,o=a.length,s=1/n;s=s<21?s:21;for(r=o-1;r>=0;r--)i.deleteRule(r);var c="";for(r=1;r<s;r++)c+=',#g1 [stroke-width="'+r+'"]';c=c.substr(1);c+=p?"{stroke-width:1;vector-effect:non-scaling-stroke;}":"{stroke-width:"+Wa.toFixed(s+99e-7,5)+";}";i.insertRule(c,0);e.disabled=!1}else e.disabled=!0}(v("thinLineStyle"),0,Za);for(u=0;u<y.length;u++){var x=_a[y[u].id];if(x&&x.trs){var L=1==Za?x.trs:x.trs.replace(/-?[\d.]+/g,g);w(y[u],{width:x.width/Za,height:x.height/Za,transform:L})}}e.frameElement&&e.frameElement.setAttribute("winzoom",t);p||w(m("#gControlLocks rect"),{"stroke-width":o,"stroke-dasharray":r+","+r})},62.5)}}}function pr(){var e=!1,t=!1;if(wo==ia.SCH){var n=Zt();e=n&&1===n.length&&w(n[0],"c_partid")&&!!w(n[0],"c_para")}wo==ia.SPICESYMBOL&&(t=!0);var r=Zt();return{newModified:!0,canUndo:La.canUndo(),canRedo:La.canRedo(),selected:!!la.count(),selectedObjs:r,canPaste:gClipboard.childNodes.length>0,zoom:eo,toolbars:"",visible_grid:ba.adsorbGrid.visible,snap_grid:ba.adsorbGrid.enabled,oneSchLib:e,canEditSubckt:t}}function gr(e){if(e==t)return null;for(;e&&e.parentNode!=Ji;)e=e.parentNode;return e}function yr(){var e=[],t=ha.gJsonCache.schlib;for(var n in t)if(j(t,n)){if(n.match(/frame_lib_\d+/i))continue;if(t[n].itemOrder.length>=2&&t[n].annotation){var r=t[n].annotation[t[n].itemOrder[1]];if(!r)continue;var i=X(r.string);if("P"==r.mark&&i){var a=Wa.c_paraToJson(t[n].head.c_para).package||"";e.push({id:n,pre:X(i+" ("+a+")")})}}}return e}function xr(e,t){if(!(Aa&&Aa.start||Ea&&Ea.start||Ia&&Ia.start)){var n,r,i,a,o=Za>=10?1:Math.round(10/Za),s=fo.getSanpSize("X"),c=fo.getSanpSize("Y"),l=!1;n=Zt().filter(function(e){l=e.parentNode&&e.parentNode.parentNode&&"g1"==e.parentNode.parentNode.id;a=l?po.isLocked(e.parentNode):po.isLocked(e);return!a});!n.length&&pa&&(n=[pa].filter(function(e){l=e.parentNode&&e.parentNode.parentNode&&"g1"==e.parentNode.parentNode.id;a=l?po.isLocked(e.parentNode):po.isLocked(e);return!a}));Sa.solveItems(n);var d;if(ba.adsorbGrid.enabled){n.forEach(function(e){var t=L('[c_partid="part_pin"]',e);if(t){var n=Wa.numberlistToArray(w(t,"c_origin"));d={x:+n[0],y:+n[1]}}});d||(d=Lt(n))}var u=d&&bt(d,e,t);if(d&&u){r=u.x-d.x;i=u.y-d.y}if(!r&&!i){r=e?e*(ba.adsorbGrid.enabled?s:o):0;i=t?t*(ba.adsorbGrid.enabled?c:o):0}if(!1!==Ct(n,r,i)){Mt(n);ha.updateMore(n);Sa.solveItems(n);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["move",kn(n),r,i]));pa&&vn(pa);return!0}return!1}}function vr(e,t,n){if("number"==typeof arguments[0]){n=arguments[1];t=arguments[0];e=Zt()}else e=e?[].map.call(e,function(e){return"string"==typeof e?v(e):e.gId?v(e.gId):e}).filter(function(e){return e&&b(e.parentNode,$a)}):Zt();isFinite(t)||(t=0);isFinite(n)||(n=0);var r=[].map.call(e,function(e){return e.id||""}).join(",");Sa.solveItems(e);if(!1!==Ct(e,t,n)){ha.updateMore(e);Sa.solveItems(e);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["move",r,t,n]));pa&&vn(pa);return!0}return!1}function mr(e,t,n){if("number"==typeof arguments[0]){n=arguments[1];t=arguments[0];e=Zt()}else e=e?[].map.call(e,function(e){return"string"==typeof e?v(e):e.gId?v(e.gId):e}).filter(function(e){return e&&b(e.parentNode,$a)}):Zt();La.startBatch();try{for(var r=isFinite(t),i=isFinite(n),a=0,o=e.length;a<o;a++){var s=e[a],c=s&&s.id,l=s&&w(s,"c_origin"),d=0,u=0;if(c){if(l){l=l.replace(/\s+/g,"").split(/,/);r&&(d=t-l[0]);i&&(u=n-l[1])}else{var h=Wa.svg.getRefPoint(s);if(h){r&&(d=t-h.x);i&&(u=n-h.y)}}vr([s],d,u)}}}catch(e){}La.saveBatch();pa&&vn(pa)}function Lr(e,t){!e||W(e)||J(e)||(e=[e]);var n,r,i,a,o,s,c,l=[];(e||Zt()).forEach(function(e){o=de(e);if(t)l.push(e);else if("annotation"===o&&e.parentNode&&e.parentNode!=Ji){c=e.parentNode;s=de(c);r={};if("schlib"===s){i=w(e.childNodes[0],"c_note")||"";"note_name"===i?r["attr-name-display"]="none":"note_pre"===i?r["attr-prefix-display"]="none":"note_package"===i&&(r["Package Display"]="No")}else"netflag"!==s&&"netlabel"!==s||(r["attr-name-display"]="none");la.unselect(e);Oi(c,r)}else po.isLocked(e)||l.push(e)});Sa.solveItems(l);if(l.length>0){var d=[];en();for(n=0;n<l.length;n++){a=l[n];if(a){d[n]=["del",a.id,Wa.node.getRefId(a)];ha.removeOne(a);qa.appendChild(a)}}Sa.solveTodoList();La.save(Sa.batHistoryCmd(d));pn("triggerEvent",["select_change"])}}function _r(){var t=Zt().filter(function(e){return!po.isLocked(e)}),n=t.length;if(1==n&&w(t[0],"c_partid")&&w(t[0].childNodes[0],"c_note"))parent.$.messager.error("This field can't be removed!");else{Sa.solveItems(t);if(0!==n){gClipboard.childNodes.length>0&&Wa.node.clearChildNodes(gClipboard);en();var r,i,a=[];for(r=0;r<n;r++){i=t[r];ha.removeOne(i);a[r]=["del",i.id,Wa.node.getRefId(i)];gClipboard.appendChild(i.cloneNode(!0));qa.appendChild(i)}wa.pasteCount=0;wa.pasteFrom="cut";Sa.solveTodoList();La.save(Sa.batHistoryCmd(a),{title:"cut",functionName:"cutSelectedObjs"});pn("triggerEvent",["select_change"]);parent.globalEditorClipboard=[wo,e.frameElement.id,+new Date]}}}function br(t){var n,r,i,a=t||Zt(),o=a.length;if(o>0){i=gClipboard.childNodes.length>0;i&&Wa.node.clearChildNodes(gClipboard);var s=[];for(n=0;n<o;n++){r=a[n].cloneNode(!0);la.unselect(r);la.unhighlight(r);po.isLocked(r)&&s.push(r);gClipboard.appendChild(r)}s.length&&po.unlockObjs(s,{noHistory:!0});if(1==o&&!b(a[0].parentNode,$a)&&"part_annotation"==w(r,"c_partid")&&r.childNodes[0]&&w(r.childNodes[0],"c_note")){w(r,"c_origin",w(r.childNodes[0],"x")+","+w(r.childNodes[0],"y"));w(r,"c_shapetype","group");w(r,"c_etype","pinpart");w(r.childNodes[0],"type","comment");N(r.childNodes[0],"c_note")}i||pn("triggerEvent",["enable_paste"]);wa.pasteFrom="copy";wa.pasteCount=0;parent.globalEditorClipboard=[wo,e.frameElement.id,+new Date];La.log(["copy",Array.from(a).map(function(e){var t=de(e),n=e.id?"#"+e.id:"";return t?t+n:"<"+e.tagName+n+">"}).join(",")])}}function Sr(){var e,t=gClipboard.childNodes,n=t.length,r=[];if(n){for(var i=0;i<n;i++){e=t[i];"none"==w(e,"display")||b(e,"hitbox")||b(e,"pindot")||r.push(e.cloneNode(!0))}Mr(r);wa.pasteCount++}}function Cr(){var n=parent.globalEditorClipboard;if(n){var r=Wa.fileType.getAbstractFileType(n[0]),i=Wa.fileType.getAbstractFileType(wo);if(-1!==["sch","schlib","waveform"].indexOf(r))if(n[1]!=e.frameElement.id){var a=e.frameElement.ownerDocument.getElementById(n[1]),o=a&&a.contentWindow;o=o&&o.gClipboard;o=o&&o.childNodes;if(o&&o.length){var s,c,l,d=function(e){N(e,"style");N(e,"class");N(e,"id")},u=[];for(s=0,c=o.length;s<c;s++){l=t.importNode(o[s],!0);Bi(ba.colors,l);r==i?u[s]=l:u=u.concat(function e(t){if("none"==w(t,"display")||b(t,"hitbox")||b(t,"pindot"))return[];var n=de(t),r=[];d(t);switch(n){case"schlib":case"netlabel":case"netflag":for(var i=0,a=t.children,o=a.length;i<o;i++){var s=e(a[i]);s.length&&(r=r.concat(s))}t=null;break;case"annotation":w(t,"c_shapetype","group");w(t,"c_etype","pinpart");var c=L("text",t);w(t,"c_origin",w(c,"x")+","+w(c,"y"));w(c,"type","comment");N(c,"c_note");break;case"pin":case"arrowhead":w(t,"c_shapetype","group");w(t,"c_etype","pinpart");break;case"svgnode":w(t,"c_shapetype","group");break;case"wire":case"bus":w(t,"c_shapetype","line");N(t,"c_etype");w(t,"stroke","#000000");break;case"arc":case"path":case"polyline":case"polygon":case"ellipse":case"circle":case"rect":case"image":w(t,"c_shapetype","line");N(t,"c_etype");break;case"text":w(t,"c_shapetype","line");w(t,"type","comment");N(t,"c_etype");var l=Wt("g",{c_shapetype:"group",c_etype:"pinpart",c_partid:"part_annotation",c_origin:w(t,"x")+","+w(t,"y")});l.appendChild(t.cloneNode(!0));t=l;break;case"noconnectflag":t=L("path",t);w(t,"c_shapetype","line");w(t,"fill","none");w(t,"stroke","#000000");break;case"busentry":t=L("line",t);t=Wt("polyline",{points:[w(t,"x1"),w(t,"y1"),w(t,"x2"),w(t,"y2")].join(" "),c_shapetype:"line",fill:"none",stroke:"#000000","stroke-width":"1"});break;case"line":t=Wt("polyline",{points:[w(t,"x1"),w(t,"y1"),w(t,"x2"),w(t,"y2")].join(" "),c_shapetype:"line",fill:"none",stroke:w(t,"stroke"),"stroke-width":w(t,"stroke-width")});break;case"junction":default:t=null}t&&r.push(t);return r}(l))}u.length&&Mr(u)}}else Sr()}}function Mr(e){if(e&&e.length&&!Qa.on){var t,n,r,i=e.length;en();var a=[],o=0;for(o=0;o<e.length;o++)a.push(e[o].id);var s=Wt("g");for(t=-1;++t<i;){"pimage"==de(e[t])&&(e[t]=e[t].firstChild);s.appendChild(e[t])}fa.appendChild(s);for(t=0,n=m('[id]:not([id^="frame_"])',s),r=n.length;t<r;t++)w(n[t],"id","");var c,l,d,u,h,f,p=s.getBBox(),g=cn();c=gt({x:Dn.data.clientX||g.clientWidth/2,y:Dn.data.clientY||g.clientHeight/2});u=L('g[c_partid="part_pin"]',s);u&&(f=z(w(u,"c_origin"))[0]);h=Qa.origin=Fn(e);var y=function(e,t,n){n=n||t;var r=_t({x:e.x-t.x+n.x,y:e.y-t.y+n.y});return{dx:r.x-n.x,dy:r.y-n.y}}(c,h,f);l=y.dx;d=y.dy;Ct(e,l,d);if(!1!==Ua.getCacheObj("AutoAnnotatePre")&&"sch"==Wa.fileType.getAbstractFileType(wo)){var x=m("text[c_note=note_pre]",s);if(x.length){var _=[];for(t=0,i=x.length;t<i;t++)_[t]=X(x[t].textContent).toUpperCase();var b=ua.getNewPreArr(_,!0);for(t=0,i=x.length;t<i;t++)b[t]&&b[t]!=_[t]&&Wa.node.setTextContent(x[t],b[t])}}Rt(s);var S,C,M,N,P;for(t=-1;++t<e.length;){"image"!==e[t].tagName&&la.select(e[t]);S=de(e[t]);if(wo==ia.SCH&&"schlib"===S&&"part_lib_sheet"!=w(e[t],"c_partid")){var T=!(a[t]&&!v(a[t],Ji));if(!T){C=C||pn("getActiveProjectAllSchJson");M=C&&C.schematics;if(W(M))for(var O=0;O<M.length;O++){N=M[O]&&M[O].json;P=N&&N[S];P&&j(P,a[t])&&(T=!0)}}T?w(e[t],"id","gge"+ue()):w(e[t],"id",a[t])}Ji.appendChild(e[t])}v("selectionBox")&&e.forEach(function(e){e.style.display="none"});fa.removeChild(s);ci(!0);bn("cross-red",h.x,h.y);di({targets:e,x:c.x,y:c.y,bbox:{x:p.x+l,y:p.y+d,width:p.width,height:p.height},hasPin:!!u});pn("triggerEvent",["select_change"])}}function wr(e){if(e&&e.length){var t=e.map(function(e){var t=e.cloneNode(!0);e.parentNode.insertBefore(t,e.nextSibling);w(t,"class","");Rt(t);if("pinpart"==w(t,"c_etype")){var n=L("text[c_note=note_pre]",t);if(n){var r=X(n.textContent),i=ua.getNewPre(r);r!=i&&Wa.node.setTextContent(n,i)}}return t});ha.updateMore(t);Sa.solveItems(t);Sa.solveTodoList();var n=t.map(function(e){return e.id}),r=n.join(",");La.save(Sa.batHistoryCmd(["add",r]));return n}}function Nr(e,t){if(ma&&va&&0===va.indexOf("place_part(")){var n=va.substr(6),r=v(n);if(Co.target)return e?uo.flipH([Co.target]):uo.flipV([Co.target]);if(r)return e?uo.flipH([r]):uo.flipV([r])}else{var i=Ea&&Ea.start,a=i;if(!ii()||i){var o;t=(t||Zt()).filter(function(e){return!po.isLocked(e)});if(0!==t.length){a||(o=new Pi(t));e?uo.flipH(t):uo.flipV(t);pa&&vn(pa);ha.updateMore(t);Sa.solveItems(t);Sa.solveTodoList();if(!a){o.update();La.save(Sa.batHistoryCmd(o.hist))}}}}}function Pr(e,t,n){void 0===t?t=270:"string"==typeof t&&(t=+t);t>360&&(t%=360);t<0&&(t=360+t%360);for(var r,i,a=0,o=0,s=e.length;a<s;a++){var c=e[a];if(w(c,"transform")){i=Wa.svg.getCss3(c,"translate").split(",");i[0]&&Pn(c)}var l=w(c,"c_origin"),d=+w(c,"c_rotation")||0;if(l)l=Wa.numberlistToArray(l);else{r=Wa.svg.getBBox(c);l=[r.x+r.width/2,r.y+r.height/2]}if(!0===n){var u=t-d;u<0&&(u+=360);lo[c.tagName](c,u,l[0],l[1])}else lo[c.tagName](c,t,l[0],l[1]);o++}return o>0}function Tr(){var e,t,n=arguments;e="object"==typeof n[0]?n[0]:Zt();t="number"==typeof n[0]?n[0]:"number"==typeof n[1]?n[1]:270;if(!e.length)return!1;Sa.solveItems(e,"old");if(e.length>1){var r=Wa.svg.getElementsCenter(e,!0);r=Ae(r);lo.rotate(e,t,r.x,r.y)}else lo.rotate(e,t);ha.updateMore(e);Sa.solveItems(e);Sa.solveTodoList();pa&&vn(pa);return e.length>0}function Or(){var e,t,n,r,i=Zt().filter(function(e){return!po.isLocked(e)}),a=i.length,o=[];if(a){for(e=a-1;e>=0;e--){t=i[e];n=t.parentNode;if(t!=n.lastChild){r=t.nextSibling?t.nextSibling.id:"";n.insertBefore(t,null);o.push(["elePosition",t.id,r,""])}}o.length&&La.save(o)}}function kr(){var e,t,n,r,i,a=Zt(),o=a.length,s=[];if(o){for(e=o-1;e>=0;e--){t=a[e];n=t.parentNode;if(t!=n.firstChild){r=t.nextSibling?t.nextSibling.id:"";i=n.firstChild.id;n.insertBefore(t,n.firstChild);s.push(["elePosition",t.id,r,i])}}s.length&&La.save(s)}}function Ar(e,t){function n(e,t){for(var n=xa[e],r=e;n&&n.tagName!=t;){w(n,"id","cline"+ ++r);n=xa[r]}if(n){if(r!=e){xa.splice(r,1);xa.splice(e,0,n);w(n,"id","cline"+e)}}else{n=Wt(t,{fill:"none",stroke:w(xa[0],"stroke"),"stroke-dasharray":w(xa[0],"stroke-dasharray"),id:"cline"+e});bo.insertBefore(n,xa[e]||null);xa.splice(e,0,n)}return n}function r(e){var t=ya[e];if(!t){t=_o.appendChild(y(ya[0]));w(t,"id","crect"+e);ya[e]=t}return t}if(wo!=ia.WAVEFORM&&wo!=ia.PHOTOVIEW){w(mo,{visibility:"visible"});w(_o,{visibility:"visible"});w(bo,{visibility:"visible"});var i=e.length/2,a=ga.length;if(0===a){ga[0]=v("cdot0");ga[1]=v("cdot1");a=2}var o,s,c={},l={},d={};c.transform=l.transform=d.transform=t||"";c.visibility=l.visibility=d.visibility="";c.r=4/Za;if(!e.onlyLines)for(o=0,s=Math.max(i,a);o<s;o++){c.visibility="";if(o<i&&o<a);else{if(o>=i){w(ga[o],{visibility:"hidden"});continue}ga[o]=ga[0].cloneNode(!0);c.id="cdot"+o;mo.appendChild(ga[o])}c.cx=e[2*o];c.cy=e[2*o+1];"odd"==e.lightDots&&o%2?c.class="light":Array.isArray(e.lightDots)&&e.lightDots.includes(o)?c.class="light":c.class="";w(ga[o],c)}var u=e.c_helper_lines;if(u){var h=xa.length,f=ya.length;if(0===h){xa[0]=v("cline0");h=1}if(0===f){ya[0]=v("crect0");f=1}o=-1;for(var p,g,x,m,L,_=-1,b=-1;++o<u.length;)if("rect_center_corner"==u[o].type){m=r(++b);p=u[o].center;g=u[o].corner;x=[e[2*p],e[2*p+1],e[2*g],e[2*g+1]];w(m,l);w(m,{x:Math.min(2*x[0]-x[2],x[2]),y:Math.min(2*x[1]-x[3],x[3]),width:2*Math.abs(x[0]-x[2]),height:2*Math.abs(x[1]-x[3])})}else if("rect_corner_corner"==u[o].type){m=r(++b);p=u[o].corner1;g=u[o].corner2;x=[e[2*p],e[2*p+1],e[2*g],e[2*g+1]];w(m,l);w(m,{x:Math.min(x[0],x[2]),y:Math.min(x[1],x[3]),width:Math.abs(x[0]-x[2]),height:Math.abs(x[1]-x[3])})}else if("rect"==u[o].type){m=r(++b);w(m,l);w(m,u[o].data)}else if("path_arc"==u[o].type){L=n(++_,"path");w(L,d);w(L,"d",e.path_arc||"")}else{L=n(++_,"line");w(L,d);p=u[o].from;g=u[o].to;x={x1:e[2*p],y1:e[2*p+1],x2:e[2*g],y2:e[2*g+1]};var S=x.x2-x.x1,C=x.y2-x.y1;if(!S&&!C){w(L,"visibility","hidden");continue}if(-1===u[o].ray){x.x2=x.x1+x.x1-x.x2;x.y2=x.y1+x.y1-x.y2}if(1===u[o].ray||-1===u[o].ray){var M=So.getViewBox(),N=+M[0],P=+M[1],T=N+ +M[2],O=P+ +M[2];if(x.x2>N&&x.x2<T&&x.y2>P&&x.y2<O){var k=x.x2<x.x1?N:T,A=x.y2<x.y1?P:O,E=S?(k-x.x1)/S:0,I=C?(A-x.y1)/C:0,j=Math.min(E,I);x.x2=x.x1+j*S;x.y2=x.y1+j*C}}w(L,x)}for(o=_+1;o<h;o++)w(xa[o],{visibility:"hidden"});for(o=b+1;o<f;o++)w(ya[o],{visibility:"hidden"})}else{w(_o,{visibility:"hidden"});w(bo,{visibility:"hidden"})}}}function Er(e,t,n){n=n||"";var r,i,a,o,s,c,l,d,u,h,f="check-group"==e&&1===arguments.length,p=Zt().filter(function(e){return!po.isLocked(e)}),g=[],y=[],x=[];if(0===p.length)return"group fail";if(1===p.length){var m=["MULTIMETER","FUNCTIONGENERATOR","LOGICANALYZER","OSCILLOSCOPE","WATTMETER"],_=Wa.c_paraToJson(w(p[0],"c_para"));if(_&&_.spiceSymbolName&&m.indexOf(_.spiceSymbolName)>-1)return"ungroup fail";La.startBatch();a=p[0];if("group"==w(a,"c_shapetype")&&L('g[c_partid="part_annotation"] text[c_note="note_name"]',a)){ha.removeOne(a);var S=a.children;for(r=0,i=S.length;r<i;r++){u=S[r].cloneNode(!0);"part_image"==w(u,"c_partid")&&(u=u.firstChild);if("part_annotation"==w(u,"c_partid")){h=L('text[c_note="note_name"], text[c_note="note_pre"], text[c_note="note_package"]',u);if(h)continue;N(u,"display")}if(!b(u,"hitbox")&&"none"!=w(u,"display")){s="g"==u.tagName?"group":"line";w(u,"c_shapetype",s);Ji.appendChild(u);Rt(u);ha.updateOne(u);x.push(u.id)}}x.length>0&&y.push(["add",x.join(",")]);y.push(["del",a.id]);qa.appendChild(a);La.save(y);La.saveBatch();return"ungroup ok"}return"ungroup fail"}var C,M;for(r=0,i=p.length;r<i;r++){a=p[r];o=w(a,"c_partid");s=w(a,"c_shapetype");c=w(a,"c_etype");if("part_arrowhead"==o||"part_pin"==o||"part_annotation"==o||"line"==s&&!c){if("part_annotation"==o){h=L("text",a);l=w(h,"c_note")||w(h,"c_note_0");if("note_name"==l){M=!0;g.unshift(a);continue}if("note_pre"==l){C=!0;M?g.splice(1,0,a):g.unshift(a);continue}}g.push(a)}}if(g.length<2)return"group fail";if(g.length==(C?1:0)+(M?1:0))return"group fail";if(f){e=C?g[M?1:0].firstChild.firstChild.nodeValue:"";t=M?g[0].firstChild.firstChild.nodeValue:"";n="";return[e,t,n]}var P="package`"+n,T=v("part(lib_temp)").cloneNode(!0);T.id=Wa.newId();var O=null;for(r=g.length-1;r>=0;r--){a=g[r];N(a,"class");u=a.cloneNode(!0);N(u,"c_shapetype");T.insertBefore(u,O);O||"pin"!==de(a)||(O=u);ha.removeOne(u);qa.appendChild(a);x.push(a.id)}x.length>0&&y.push(["del",x.join(",")]);w(T,{c_para:P,display:""});Ji.appendChild(T);Rt(T);y.push(["add",T.id]);La.save(y);var k,A,E,I,j,B;E=T.children[0];I=T.children[1];if(C&&M){T.removeChild(E);T.removeChild(I)}else if(C)T.removeChild(I);else if(M){T.removeChild(E);T.removeChild(I);T.insertBefore(I,T.children[1]||null)}k=T.children[0];A=T.children[1];j=L("text",k);B=L("text",A);Nt(j,t||"none");Nt(B,e||"none");N(j,"c_note_0");N(B,"c_note_0");w(j,"c_note","note_name");w(B,"c_note","note_pre");A.style.display="none";k.style.display="none";var D=Wa.svg.getBBoxFixed(T);k.style.display="";A.style.display="";var F=function(e,t,n,r){var i=+w(e,"c_rotation")||0;180==i&&(i=0);w(t,{x:n,y:r,transform:i?"rotate("+(360-i)+","+n+","+r+")":""});w(e,"c_origin",n+","+r);w(e,"c_rotation",i)},R=function(e,t){var n=w(t,"x"),r=w(t,"y");F(e,t,n,r)};M?R(k,j):F(k,j,Math.round(D.x+D.width/2),Math.round(D.y+D.height+10));C?R(A,B):F(A,B,Math.round(D.x+D.width/2),Math.round(D.y-5));d={x:D.x+D.width/2,y:D.y+D.height/2};d=Ae(d);w(T,"c_origin",d.x+","+d.y);Vt(T);ha.updateOne(T);return"group ok"}function Ir(e){var n,r=[];if(parent!=self){var i=F(ao);if(i){for(var a,o,s=t.adoptNode(i.documentElement),c=s.childNodes,l=c.length-1;l>=0;l--){o=c[l];a=o.id;if(a&&v(a)){if(e&&a.match(/part(lib)/))continue;n=v(a).cloneNode(!0);v(a).remove();w(o,{display:"none"});v("gCurParts").appendChild(o);r.push({exNode:n,newNode:o.cloneNode(!0)})}}return r}}}function jr(e){var t=e.id;if(t){var n,r,i,a=pa||la.get()[0];if(!po.isLocked(a)&&a&&b(a.parentNode,$a)){n=v(t);if(n&&n.parentNode==mo&&!b(n,"light")&&("path"==a.tagName||"polyline"==a.tagName||"polygon"==a.tagName)){r=+t.substr(4);if("path"!=a.tagName){r>>=1;var o=a,s=o.points,c=s.numberOfItems;if(!(c<=2)&&r>=0&&r<c){i=["attr",o.id,{points:w(o,"points")}];var l="wire"==de(o);l&&Sa.solveItem(o);s.removeItem(r);vn(o);ha.updateOne(o);l&&Sa.solveItem(o);l&&Sa.solveTodoList();i[3]={points:w(o,"points")};La.save(l?Sa.batHistoryCmd(i):i)}}else{i=["attr",a.id,{d:w(a,"d")}];Wa.svg.deletePathPointAtCdot(a,r);i[3]={d:w(a,"d")};if(i[2].d!=i[3].d)if(a.getTotalLength(a)<.01){w(a,"d",i[2].d);Lr([a])}else{ha.updateOne(a);vn(a);La.save(i)}}}}}}function Br(e){if(!e)return!1;for(var t,n,r,i,a=e.children,o={},s=0,c=!1,l=0,d=a.length;l<d;l++){t=a[l];if("part_pin"==w(t,"c_partid")){n=w(t,"c_spicepin")||"";i=X(q(t.children[0].textContent))||"";r=X(q(t.children[1].textContent))||"none";o[s++]={id:l,pinName:i,pinNum:r,spicePinOrder:n,nameDisplay:"none"===w(t.children[0],"display")?"none":"yes",pinpartNumDisplay:"none"===w(t.children[1],"display")?"none":"yes",pinpartShow:"show"===w(t,"c_show")?"yes":"none",pinpartElec:w(t,"c_elec")};"none"==X(w(t,"display"))&&(c=!0)}}return{pinMap:o,pinCount:s,hiddenPin:c}}function Dr(e){var t,n=e.data,r=Ji.children;for(var i in n){var a=n[i];if(j(n,i)&&a){t=r[a.id];if(t){w(t,{c_spicepin:a.spiceNum,c_elec:a.pinpartElec,c_show:"none"==a.pinpartShow?"none":"show"});Wa.node.setTextContent(t.children[0],a.name);Wa.node.setTextContent(t.children[1],a.num);w(t.children[0],{display:"none"==a.nameDisplay?"none":""});w(t.children[1],{display:"none"==a.pinpartNumDisplay?"none":""})}}}ha.calAll()}function Fr(){var e=Zt();if(e.length>0){var t=e[0],n=w(t,"c_para")||"";if(0===n.length)return!1;var r,i,a=Wa.c_paraToJson(n);r=An("pre",t).childNodes[0].textContent;i=a.spicePre;var o=Br(t)||{};return{pre:r,spicePre:i,
pinMap:o.pinMap,pinCount:o.pinCount,hiddenPin:o.hiddenPin}}return!1}function Rr(e){if(e&&e.parentNode&&gr(e)!==e){var t=de(e.parentNode);if("pin"===t||xo.isFrameTick(e.parentNode)||No&&!qr(e))return!1;if("annotation"===t)return!0}}function Vr(e){return e&&"image"==e.tagName&&"schlib"===de(gr(e))}function Gr(){var e=Br(Ji)||{};return{pinMap:e.pinMap,pinCount:e.pinCount,hiddenPin:e.hiddenPin}}function zr(e){var t=(w(e,"c_partid"),v("part(netLabel_text)")),n=e.cloneNode(!0);w(n,{id:"part(netLabel_text)",display:"none"});w(m("[id]",n),"id","");v("gCurParts").replaceChild(n,t)}function Hr(){return m("g[c_partid=part_netLabel_volProbe]",Ji).filter(function(e){return e!=Co.target})}function Ur(){for(var e=m("g>g>[c_note=note_name]",Ji),t=0,n=e.length;t<n;t++)if("Voltmeter"==Pt(e[t])||"Ammeter"==Pt(e[t]))return!0;return!1}function Yr(e){for(var t=m("text[type=spice]",Ji),n=0,r=t.length;n<r;n++){var i=Pt(t[n]);if("probe"==e){if((i||"").match(/\bprobe\b/gi))return!0}else if("gnd"==e){if((i||"").match(/\bgnd\b/gi))return!0;if((i||"").match(/\b0\b/gi))return!0}else{var a=new RegExp("^\\.?"+e+"\\b","mi");if((i||"").match(a))return!0}}return!1}function Jr(e){var t,n=Hr(),r=!1,i=e||"volProbe1";t=i.match(/\D+\d+$/)?i.match(/(\D+)\d+$/)[1]:i;for(var a=1;a<100;a++){r=!1;for(var o=0,s=n.length;o<s;o++)if(n[o].childNodes[1]&&n[o].childNodes[1].firstChild&&i.toLowerCase()==X(n[o].childNodes[1].firstChild.nodeValue||"").toLowerCase()){i=t+a;r=!0;break}if(!r)return i}}function Wr(e,t,n,r){if(e||t){var i,a,o,s,c;n&&(s=n.parentNode);r&&(c=r.parentNode);if(n||r){M(n);M(r)}var l=(e||t).parentNode.parentNode,d={top:!!L('g[c_partid="part_pin"][c_rotation="90"]',l),left:!!L('g[c_partid="part_pin"][c_rotation="180"]',l),right:!!L('g[c_partid="part_pin"][c_rotation="0"]',l),bottom:!!L('g[c_partid="part_pin"][c_rotation="270"]',l)};d.all=d.top&&d.left&&d.right&&d.bottom;var u=!1;if(za&&"none"===w(l,"display")){w(l,"display","");o=Wa.svg.getBBoxFixed(l,{excludeText:!0});u=!0}else o=Wa.svg.getBBoxFixed(l,{excludeText:!0});if(e){N(e,"transform");i=Wa.svg.getBBox(e)}if(t){N(t,"transform");var h="none"==w(t.parentNode,"display");h&&w(t.parentNode,"display","");a=Wa.svg.getBBox(t);h&&w(t.parentNode,"display","none")}e&&(!d.top||d.all?co.text(e,d.all?o.x-i.x:o.x+o.width/2-(i.x+i.width/2),o.y-(i.y+i.height)-10):d.right?d.bottom?d.left||co.text(e,o.x-(i.x+Math.max(i.width,a.width)),o.y+o.height/2-(i.y+i.height/2)):co.text(e,o.x+o.width/2-(i.x+i.width/2),o.y+o.height-i.y):co.text(e,o.x+o.width-i.x+2,o.y+o.height/2-(i.y+i.height/2)));if(t){if(!e){e=L("g>g>text[c_note=note_pre]",l);if(!e)return}i=Wa.svg.getBBox(e);var f="start"==w(e,"text-anchor")?i.x:i.x+a.width;w(t,{"text-anchor":w(e,"text-anchor"),x:f,y:i.y+i.height+7})}u&&w(l,"display","none");n&&s.appendChild(n);r&&c.appendChild(r)}}function Xr(e,t){if(e||t){var n,r,i,a=0,o=(e||t).parentNode.parentNode;e&&(r=e.parentNode);t&&(i=t.parentNode);M(e);M(t);n=Wa.svg.getBBoxFixed(o,{excludeText:!1});e&&r.appendChild(e);t&&i.appendChild(t);if(e){N(e,"transform");a=12}if(t){N(t,"transform");var s="none"==w(t.parentNode,"display");s&&w(t.parentNode,"display","");s&&w(t.parentNode,"display","none")}e&&w(e,{x:n.x,y:n.y+n.height+11});t&&w(t,{x:n.x+a,y:n.y+n.height+11})}}function Qr(e){if(e&&"none"!==w(e,"display")){N(e,"transform");var t,n,r,i=e.parentNode.parentNode,a=Wa.svg.getBBox(e);w(e,"display","none");r=Wa.svg.getBBox(i);w(e,"display","");switch(function(){var e,t,n,a,o,s=L('circle[c_pindot="true"]',i),c={x:w(s,"cx"),y:w(s,"cy")},l=[],d=[],u=0,h={0:"bottom",1:"top",2:"left",3:"right"};e=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y}];t=[{x:r.x,y:r.y+r.height},{x:r.x+r.width,y:r.y+r.height}];n=[{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height}];a=[{x:r.x,y:r.y},{x:r.x,y:r.y+r.height}];l.push(e,t,n,a);for(var f=0;f<4;f++)d.push(Ie(c,l[f][0],l[f][1]).d);o=Math.min.apply(null,d);d.forEach(function(e,t){e===o&&(u=t)});return h[u]}()){case"right":t=r.x+r.width+.5-a.x;n=r.y+r.height/2-a.height/2-a.y;co.text(e,t,n);break;case"left":t=r.x-a.width-.5-a.x;n=r.y+r.height/2-a.height/2-a.y;co.text(e,t,n);break;case"top":t=r.x+r.width/2-a.width/2-a.x;n=r.y-a.height-.5-a.y;co.text(e,t,n);break;default:t=r.x+r.width/2-a.width/2-a.x;n=r.y+r.height+.5-a.y;co.text(e,t,n)}}}function Kr(e){if(!e)return!1;var t=w(e,"c_partid");if(!t||0!==t.indexOf("part_lib_"))return!1;var n=An("pre",e);return!!n&&/\.\d+$/.test(n.textContent)}function $r(e){var t=["note_name","note_pre"],n=[];t.forEach(function(t){var r=e.querySelector("[c_note="+t+"]");r&&n.push(r)});if(n.length){var r=An("pre",e.parentElement),i=An("name",e.parentElement);return e===r||e===i}return!1}function qr(e){var t=["part_netLabel_GnD","part_netLabel_gnD","part_netLabel_GNd","part_netLabel_gNd","part_netLabel_VCC","part_netLabel_+5V","part_netLabel_VEE","part_netLabel_-5V","part_netLabel_Bar","part_lib_sheet"],n=w(e.parentNode.parentNode,"c_partid");return!("annotation"!==de(e.parentNode)||!No||!$r(e.parentNode)&&t.indexOf(n)<0)}function Zr(e){for(var t,n=pn("getAllJson"),r=pn("getAllSchInProject"),i=[],a=e.indexOf("."),o=0;o<n.length;o++)if(!(r.length&&r.indexOf(n[o].tabid)<0)){t=n[o].json.schlib;var s=pn("getTabById",[n[o].fid]);s.contentWindow.document;for(var c in t)if(j(t,c)){if(c.indexOf("frame_lib")>=0)continue;var l=t[c],d=pn("getPreOrNameFromJson",[l]).pre;if(d===e)continue;var u=d.indexOf(".");u>=1&&d.substr(0,u)===e.substr(0,a)&&i.push({id:l.head.gId,frame:s})}}return i}function ei(){function e(e){var t=e.target;t&&1!==t.nodeType&&t.parentNode&&(t=t.parentNode);if(!t||!t.tagName||"TEXTAREA"!=t.tagName.toUpperCase()){e.preventDefault();e.stopPropagation();return!1}}for(var n=["selectstart","drag","draggesture","dragstart","dragover"],r=0;r<n.length;r++)t.addEventListener(n[r],e,!1);void 0!==Ga&&Ga&&t.addEventListener("mousedown",function(e){if((Ba?e.metaKey:e.ctrlKey)&&0===e.button){fa.currentScale=1;fa.currentTranslate.x=0;fa.currentTranslate.y=0}},!1)}function ti(e){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.ready=!1;this.start=!1;e&&e.ondragstart&&(this.ondragstart=e.ondragstart);e&&e.ondrag&&(this.ondrag=e.ondrag);e&&e.ondragend&&(this.ondragend=e.ondragend)}function ni(e){var n=this;n.x0=0;n.y0=0;n.x1=0;n.y1=0;n.target=null;n.ready=!1;n.start=!1;if(e)for(var r in e)j(e,r)&&(n[r]=e[r]);t.addEventListener("mousedown",n.mdown,!1)}function ri(e){var t=this;t.x0=0;t.y0=0;t.x1=0;t.y1=0;t.ready=!1;t.start=!1;t.mouseIsDown=!1;t.mousedownTarget=fa;t.mousemoveTarget=fa;t.mouseupTarget=fa;if(e&&e instanceof Object)for(var n in e)j(e,n)&&(t[n]=e[n]);t.e={};t.e.mdown=function(e){t.mdown.call(t,e)};t.e.mmove=function(e){t.mmove.call(t,e)};t.e.mup=function(e){t.mup.call(t,e)}}function ii(){return ti.start||ni.start||ri.start||Qa.on&&Qa.target}function ai(){return{getHistory:function(){return{index:La.index,records:La.allRecordsToString()}},getHistoryTimestamp:function(){var e=La.index,t={};e>=0&&(t.undo=La.timestamps[e]);e<La.records.length-1&&(t.redo=La.timestamps[e+1]);return t},consoleHistory:function(){},clearHistory:function(e){La.clear(e)},cacheHistory:function(){La.startBatch()},flushHistory:function(){La.saveBatch()},appendToG1:function(e,t){e=e||Ji;e.appendChild(t);ha.updateOne(t)},setSheetFlag:function(e,t,n){var r=ha.gJsonCache.head.docType;if(!r||r===ia.SCHLIB||r===ia.PCBLIB){ha.gJsonCache.head.isSheet=e||!1;ha.gJsonCache.head.x=t||0;ha.gJsonCache.head.y=n||0}},getJsonCache:function(){return ha.gJsonCache},gCanvas:function(){return Ji},getLogs:function(){return La.getLogs()},setCustomPara:function(e,t){var n=Zt(),r=n.length;1===r?Ft(n[0],e,t):r>1?n.forEach(function(n){Ft(n,e,t)}):Ft(Ji,e,t)},changeCanvasUnit:function(){pn("changeCanvasUnit")},setPinMap:function(){return Dr.apply(null,arguments)},importDocEdit:function(){return Xt.apply(null,arguments)},importPart:function(){return Qt.apply(null,arguments)},importShape:function(){return Li.apply(null,arguments)},placePart:function(e){return zi(e)},drawShape:function(e){return Hi(e)},updateShape:function(){return Ui.apply(null,arguments)},setToolbarCmd:function(){return sr.apply(null,arguments)},zoom:function(){return fr.apply(null,arguments)},getDocStatus:function(){return pr.apply(null,arguments)},getViewStatus:function(){return cn()},getCanvas:function(){return Ci()},setViewBox:function(e){So.setViewBox(e)},getBBox:function(){var t,n;try{t=Ji.getBBox()}catch(r){n=e.frameElement.parentNode;if("none"!=n.style.display)throw"getBBox error";n.style.display="";try{t=Ji.getBBox()}catch(e){}n.style.display="none"}if(t&&0===t.x&&0===t.y&&0===t.width&&0===t.height){n=e.frameElement.parentNode;if("none"==n.style.display){n.style.display="";try{t=Ji.getBBox()}catch(e){}n.style.display="none"}}if(t)return{x:Wa.toFixed(t.x,1),y:Wa.toFixed(t.y,1),width:Wa.toFixed(t.width,1),height:Wa.toFixed(t.height,1)}},getPackage:function(){return Wa.c_paraToJson(w(Ji,"c_para")).package},getComponents:function(){return yr()},findNetlabel:function(e,t){return Jn(e,t)},findComponent:function(e,t,n){return Wn(e,t,n)},getPadsByFootprintId:function(e){return getPadsByFootprintId(e)},updateSaveIndex:function(){La.savedIndex=La.index;La.fileWaitingforSaving=!1},checkPrefixNamesAndNetNames:function(e,t,n,r,i){if(!(e&&e.length||t&&t.length||n&&Object.keys(n).length))return!1;var a=i&&i.toString()||wo;if(a===ia.SCH||a===ia.PCB){var o,s,c,l,d=r||ha.gJsonCache;if(d.schlib){o=d.schlib;s="annotation";c="mark";l=ia.SCH}else if(d.FOOTPRINT){o=d.FOOTPRINT;s="TEXT";c="type";l=ia.PCB}if(o&&e&&e.length>0)for(var u in o)if(j(o,u)){var h=o[u][s];for(var f in h)if(j(h,f)){var p=h[f];if("P"==p[c]&&-1!==e.indexOf(l===ia.PCB?p.text:p.string.split(".")[0]))return!0}}if(a===ia.PCB){if(t&&t.length>0)for(u in d){var g=d[u];if("TRACK"==u||"PAD"==u||"ARC"==u||"VIA"==u||"HOLD"==u&&eleJson){for(var y in g)if(j(g,y)&&t.indexOf(g[y].net)>-1)return!0}else if("FOOTPRINT"==u){g=d[u];for(y in g)if(j(g,y)){var x=g[y];for(var v in x){var m=x[v];if("TRACK"==v||"PAD"==v||"ARC"==v||"VIA"==v||"HOLD"==v&&m)for(var L in m)if(j(m,L)&&t.indexOf(m[L].net)>-1)return!0}}}}}else if(a===ia.SCH&&n&&Object.keys(n).length>0&&o)for(var _ in o){var b=o[_];h=b.annotation;for(f in h)if(j(h,f)){p=h[f];var S=p.string.split(".")[0];if("P"==p.mark&&n[S]&&b.pin)for(var C in b.pin){var M=b.pin[C];if(j(M,"num")&&M.num.text==n[S])return!0}}}return!1}},setSymbolInfo:function(e,t){$t(e,t)},groupSymbol:function(){return Er.apply(null,arguments)},isPreUsed:function(e){return e.indexOf("?")<0&&ua.isUsed(e)},saveHistory:function(e){La.save(e)},endDrawLine:function(){Co.end()},resolveNextName:function(e){if(!e||!e.match(/\d$/))return e+"1";var t=Co.resolveNextName(e);return(t&&t.name||"")+(t&&t.num?t.num+1:"1")},undo:function(){Co.started&&Co.dots.length||Qa.on&&Qa.waitingSave||ii()||e.routeLengthTuning&&routeLengthTuning.status&&routeLengthTuning.status.ready||(me(wo)?pn("project_undo"):La.go(-1))},redo:function(){Co.started&&Co.dots.length||Qa.on&&Qa.waitingSave||ii()||e.routeLengthTuning&&routeLengthTuning.status&&routeLengthTuning.status.ready||(me(wo)?pn("project_redo"):La.go(1))},sheet_undo:function(){Co.started&&Co.dots.length||Qa.on&&Qa.waitingSave||ii()||e.routeLengthTuning&&routeLengthTuning.status&&routeLengthTuning.status.ready||La.go(-1)},sheet_redo:function(){Co.started&&Co.dots.length||Qa.on&&Qa.waitingSave||ii()||e.routeLengthTuning&&routeLengthTuning.status&&routeLengthTuning.status.ready||La.go(1)},changeTrackWidth:function(){"draw(track)"===va&&pn("toggleTrackWidthPanel",[Dn.data])},cut:function(){if(!ii())if(_e(wo)){var e=Zt(),t=[],n=e&&e.filter(function(e){if(O(e)){var n=w(e,"for");n&&t.indexOf(n)<0&&t.push(n)}return er(e)&&!po.isLocked(e)});t.forEach(function(e){var t=v(e);t&&er(t)&&!po.isLocked(t)&&n.push(t)});copyByRefPoint.fn.cutObjs=n&&n.length>0?n:null;copyByRefPoint.fn.cutObjs&&copyByRefPoint()}else _r()},setCopperAreaNet:function(){pn("show_drawing_attr_dlg",["COPPERAREA",""])},pasteRepeatedly:function(){ii()||pasteFromSelectedObjs()},copyByRefPoint:function(){ii()||copyByRefPoint()},copy:function(t){var n;Array.isArray(t)&&(n=t);ii()||(e.copyByRefPoint?copyByRefPoint(n):br(n))},paste:function(){!ii()&&Cr()},pasteCloseRatLines:function(){!ii()&&pasteFromClipboardAfterCloseRatline()},paste_xdoc:function(){!ii()&&Cr()},clone:function(){var e=arguments[0];if("object"==typeof e&&e.ids){var t=e.ids;if(!Array.isArray(t))return;var n=t.map(function(e){return v(e)});n=n.filter(function(e){return e&&b(e.parentNode,$a)});if(n.length)return wr(n)}},select_all:function(){!ii()&&nn()},select_none:function(){en()},getSelectedIds:function(){return kn()},getSelectAttrJson:function(){var e=Zt();return e.length>=1?Tt(e[0]):{}},select:function(){var e=arguments[0];if("object"==typeof e&&e.ids){en();var t=e.ids;if(!Array.isArray(t))return;var n=t.map(function(e){return v(e)});n=n.filter(function(e){return e&&b(e.parentNode,$a)});n.length&&la.select(n)}else la.select(e);pn("triggerEvent",["select_change"])},clear_canvas:function(){So.clear()},move:function(){vr.apply(null,arguments)},moveTo:function(){mr.apply(null,arguments)},drag:function(){},bring_to_front:function(){Or()},send_to_back:function(){kr()},ctrlTab:function(){pn("ctrlTab")},ctrlTabReverse:function(){pn("ctrlTabReverse")},openLayerOptionsSet:function(){pn("openLayerOptionsSetDlg")},toggleActiveLayerVisible:function(){pn("toggleActiveLayerVisible",[Layer.getActiveLayer()])},changeRouteConflictWay:function(){pn("changeRouteConflictWay")},align_left:function(e){Zn("align_left",e)},align_right:function(e){Zn("align_right",e)},align_top:function(e){Zn("align_top",e)},align_bottom:function(e){Zn("align_bottom",e)},align_horizontal_center:function(e){Zn("align_horizontal_center",e)},align_vertical_center:function(e){Zn("align_vertical_center",e)},align_horizontal_equidistant:function(e){Zn("align_horizontal_equidistant",e)},align_vertical_equidistant:function(e){Zn("align_vertical_equidistant",e)},align_left_side_edge_equidistant:function(e){Zn("align_left_side_edge_equidistant",e)},align_top_side_edge_equidistant:function(e){Zn("align_top_side_edge_equidistant",e)},align_grid:function(e){Zn("align_grid",e)},rotate_left:function(){var e=arguments[0];"object"==typeof e&&e.ids?n("rotate",[{ids:e.ids,degree:270}]):n("rotate",[270])},rotate_right:function(){var e=arguments[0];"object"==typeof e&&e.ids?n("rotate",[{ids:e.ids,degree:90}]):n("rotate",[90])},fliph:function(){var e,t=arguments[0];if("object"==typeof t&&t.ids){e=t.ids;if(!Array.isArray(e))return;var n=e.map(function(e){return v(e)});n=n.filter(function(e){return e&&b(e.parentNode,$a)&&!po.isLocked(e)});n.length&&Nr(1,n)}else Nr(1)},flipv:function(){var e,t=arguments[0];if("object"==typeof t&&t.ids){e=t.ids;if(!Array.isArray(e))return;var n=e.map(function(e){return v(e)});n=n.filter(function(e){return e&&b(e.parentNode,$a)&&!po.isLocked(e)});n.length&&Nr(0,n)}else Nr(0)},lock:function(e){po.lockObjs(e)},unlock:function(e){po.unlockObjs(e)},unlockAll:function(){po.unlockObjs(m('[locked="1"]',Ji))},fitview:function(){Dt()},cross_cursor:function(e){!1===e&&Sn(!1)},canvas_config:function(){return D(ba.canvas)},getConfig:function(){return D(ba)},config:function(){return ba},attrpanel_apply:function(e,t,n){Oi(e,t,n)},attrpanel_data:function(){return ki()},realTimeNetLengthHandler:function(){pn("realTimeNetLengthHandler",[{type:"updateConfig"}])},getCanvasAttr:function(){return So.getCanvasAttrs()},size:function(){return{width:+w(fa,"width"),height:+w(fa,"height")}},currZoom:function(){return eo},getSelected:function(){return Zt()},getSelectedObjs:function(){return Zt(!0)},deletePathNode:function(e){e&&jr(e.target[0])},delete_segment:function(e){Yt(e.target[0],{x:e.x,y:e.y})},convert_to_NPTH:function(e){convertToNPTH(e.target)},convert_to_pad:function(e){convertToPolygonPad(e.target)},editorShowAttrDialog:function(){In()},updatePackageUuid:function(e,t){if(e&&Object.keys(e).length){var n,r,i,a=ha.gJsonCache,o=a.schlib||a.FOOTPRINT;for(i in e)if(j(e,i))for(n in o)if(j(o,n)&&!n.match(/frame_lib_/)){r=Wa.c_paraToJson(o[n].head.c_para);if(r.package==i)if(t==ia.PCB||t==ia.PCBMODULE){o[n].head.uuid=e[i].uuid;o[n].head.utime=e[i].updateTime||"";w(v(n),{uuid:e[i].uuid,utime:e[i].updateTime||""})}else{o[n].head.puuid=e[i].uuid;w(v(n),{puuid:e[i].uuid})}}a.head.hasIdFlag=!0}},getNearestGridPoint:function(){return Ae(arguments[0],arguments[1])},"cmd(dragMoveSwitch)":ci,dragMoveSwitch:ci,dragMoveCheck:li,getSnappedPoint:_t,getDecimalConfig:function(){return{fixedDecimal:wa.fixedDecimal,decimalPlaces:wa.decimalPlaces,decimalPlacesShow:wa.decimalPlacesShow}},getElementInfoById:function(e){return Tt(v(e))},getElementById:function(e){return v(e)},isSelected:function(e){"string"==typeof e&&(e=v(e));return e&&la.isSelected(e)},getAllTrackArcAttr:function(){return getAllTrackArcAttr()},getLibInfoById:function(e){var t=v(e),n=Tt(t),r=ha.gJsonCache,i={ele:[t],attr:n,bbox:Wa.svg.getBBox(t),uuid:w(t,"uuid")};if(r.schlib)i.schlib=r.schlib[e];else if(r.FOOTPRINT){i.FOOTPRINT=r.FOOTPRINT[e];var a=r.FOOTPRINT[e].PAD,o={};if(a){for(var s in a)j(a,s)&&(o[a[s].number]=a[s].net);i.nets=o}}return i},findSimilar:function(e){e?Bn(e):pn("showFindSimilarDlg")},distributeItems:function(e){jn(e)},removeCustomAttr:function(e){var t;t=wo==ia.SCHLIB||wo==ia.PCBLIB||wo==ia.SUBPART||wo==ia.SPICESYMBOL?[v("g1")]:Zt();var n,r,i=[];if(1===t.length&&/\.\d+$/.test(An("pre",t[0]).textContent))for(var a=pn("getAllJson"),o=An("pre",t[0]).textContent,s=0;s<a.length;s++){var c=a[s].json.schlib,l=pn("getTabById",[a[s].fid]).contentWindow.document;for(var d in c)if(!(d.indexOf("frame_lib")>=0)){var u=[];for(var h in c[d].annotation)u.push(c[d].annotation[h]);var f=u[1].string.indexOf(".");if(f>=1&&u[1].string.substr(0,f)===o.substr(0,f)){var p=l.getElementById(c[d].head.gId);n=w(p,"c_para");r=Wa.c_paraToJson(n);delete r[e];w(p,"c_para",Wa.jsonToC_para(r));ha.updateOne(p)}}}t.forEach(function(t){var a=[];if("3DModel"===e){var o=y(t);m('[c_etype="outline3D"]',t).forEach(function(e){M(e)});n=w(t,"c_para");r=Wa.c_paraToJson(n);delete r[e];w(t,"c_para",Wa.jsonToC_para(r));a=["node",t.id,o,t]}else{a=["attr",t.id];n=w(t,"c_para");a.push({c_para:n});r=Wa.c_paraToJson(n);delete r[e];w(t,"c_para",Wa.jsonToC_para(r));a.push({c_para:Wa.jsonToC_para(r)})}i.push(a);wo==ia.PCBLIB?ha.calAll():ha.updateOne(t)});La.save(i);pn("setTabUnsaved")},setPrePosition:function(e){Vn(e)},setNamePosition:function(e){Gn(e)},show_drawing_attr_dlg:function(e,t){if("TRACK"===e||"ARC"===e||"CIRCLE"===e)var n=w(t,"stroke-width");pn("show_drawing_attr_dlg",[e,"",n])},modify_drawing_attr:function(e,t){var r={},i=de(Co.target);""===i&&Co.controlLine&&(i=de(Co.controlLine));if(Co.started&&Co.target||"origin"===i||"COPPERAREA"===i){switch(e){case"name":switch(i){case"schlib":case"FOOTPRINT":r["attr-name"]=t;break;case"netflag":case"netlabel":case"pin":r["attr-name"]=t;break;case"annotation":r["attr-text-text"]=t;break;case"TEXT":r["attr-pcbtext-text"]=t}break;case"width":r["attr-stroke-width"]=t;break;case"number":if("pin"===i){t=t.replace(/[^\x20-\x7E]+/g,"");r["attr-pinpart-number"]=t;r["attr-pinpart-spicepin"]=t}else if("PAD"===i){r["attr-pad-number"]=t;Co.nameObj[va]=t}break;case"net":r["attr-net"]=t.replace(/[^\x20-\x7E]+/g,"");var a=getDRCRuleInfo();if(a&&a.isDrcOnRoutingOrPlaceVia){var o=getDiameterOfNetsRules(r["attr-net"]);if(o&&o.length){r["attr-diameter"]=o[0];r["attr-hole-diameter"]=o[1]}}}if("origin"===i&&"object"==typeof e){var s={offsetX:e.x-ba.canvas.originX,offsetY:e.y-ba.canvas.originY};if("SVG"!==Ua.getCacheObj("Coordinates")){e.y=ba.canvas.originY-s.offsetY;s.offsetY=-s.offsetY}n("setOriginXY",[e]);Co.end();lr();pn("setTabUnsaved");La.save(["originXY","set.origin",s])}else{"FOOTPRINT"!==i&&"schlib"!==i||Oi(v("part(lib)"),r,{notHistory:!0,notUpdateJsonCache:!0});Oi(Co.target,r,{notHistory:!0,notUpdateJsonCache:!0});"TRACK"!==i&&"ARC"!==i||!Co.controlLine||Oi(Co.controlLine,r,{notHistory:!0,notUpdateJsonCache:!0})}}},getPreOrNameNode:function(e,t){return An(e,t)},initVerifyAndMounted:function(e,t){return zn(e,t)},getActiveElement:function(){return pa},highlighFoundLib:function(e){Xn(e)},terminalWorker:function(){ro()},setOriginByCenter:function(e){var t,r,i={x:ba.canvas.originX,y:ba.canvas.originY},a={offsetX:0,offsetY:0},o=Wa.fileType.getAbstractFileType(wo);if("pcblib"==o){var s,c,l,d,u=ha.gJsonCache.PAD;if(u&&Object.keys(u).length>0){var h=Object.values(u)[0];s=c=h.x;l=d=h.y;for(var f in u){s=u[f].x>s?u[f].x:s;l=u[f].y>l?u[f].y:l;c=u[f].x<c?u[f].x:c;d=u[f].y<d?u[f].y:d}t=(s+c)/2;r=(l+d)/2;a={offsetX:t-i.x,offsetY:r-i.y};n("setOriginXY",[{x:t,y:r}]);pn("setTabUnsaved");La.save(["originXY","set.origin",a]);return}}else if("schlib"==o){for(var p=Ji.cloneNode(!0),g=m("text",p),y=0;y<g.length;y++)M(g[y]);var x=Wa.svg.getBBox(p);if(0!==x.width||0!==x.height){t=x.x+x.width/2;r=x.y+x.height/2;var v=Ae({x:t-i.x,y:r-i.y});a={offsetX:v.x,offsetY:v.y};n("setOriginXY",[{x:v.x+i.x,y:v.y+i.y}]);pn("setTabUnsaved");La.save(["originXY","set.origin",a]);return}}if(("pcblib"==o||"schlib"==o)&&e){x=Wa.svg.getBBox(Ji);t=x.x+x.width/2;r=x.y+x.height/2;a={offsetX:t-i.x,offsetY:r-i.y};n("setOriginXY",[{x:t,y:r}]);pn("setTabUnsaved");La.save(["originXY","set.origin",a])}},offsetElements:function(e,t){if((e||t)&&(wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE)){var n,r=Zt().filter(function(e){return"1"!=w(e,"locked")}),i=r.some(function(e){return O(e)}),a=[];if(i){n=combineHighlightLinesinObjs(r);r=n.objs;la.select(n.objs);ha.updateMore(n.objs);a=n.hist;La.save(a)}r=r.filter(function(e){return!O(e)});offsetPadInFootprint(r,e,t)}},relativeOffsetElements:function(e){var t,n=Zt().filter(function(e){return"1"!=w(e,"locked")}),r=n.some(function(e){return O(e)}),i=[];if(r){t=combineHighlightLinesinObjs(n);n=t.objs;la.select(t.objs);ha.updateMore(t.objs);i=t.hist;La.save(i)}n=n.filter(function(e){return!O(e)});var a;if(1===n.length&&w(n[0],"c_origin"))a=w(n[0],"c_origin").split(",");else{var o=n.map(function(e){return Wa.svg.getBBox(e)}),s=Wa.combineMultiBox(o);a=[s.x+s.width/2,s.y+s.height/2]}var c=e[0]-a[0],l=e[1]-a[1];offsetPadInFootprint(n,c,l)},toggleBottomTopLayer:function(e){var t=Zt();if(t.length){var n,r,i=+w(t[0],"layerid")!=+e&&copyByRefPoint.fn.position&&wa.canvasMoveEvent;i&&(r={changeFootPrintX:ln(wa.canvasMoveEvent).x});t.forEach(function(t){if("FOOTPRINT"===de(t)){n={};n["attr-layerid"]=e;Oi(t,n,r)}});Layer.updateShadowNode(t);pn("updateAttrPanel");return!0}return!0},set_fullscreen:function(){var t=e.parent.document.documentElement;(t.requestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullscreen).call(t)},cycleSelectObj:function(){la.cycleSelectObj()},showDrawingAttrDlg:function(){pn("show_drawing_attr_dlg",["origin","setToolbarCmd"])},moveRelatively:function(){moveRelatively.setRelativePoint()},highlight_net:function(){var e,t,n=wo==ia.PCB||wo==ia.PCBMODULE,r=wo==ia.SCH||wo==ia.SCHMODULE;if(pa){e=w(pa,"net");t=w(pa,"id")}else{var i=Zt();if(i&&i[0]){e=w(i[0],"net");t=w(i[0],"id")}}if(n&&(ratLineMgr.hasHighlightedNets("highlight-h")||ratLineMgr.hasHighlightedNets("selected-h"))){removeClassByClass("selected-h");ratLineMgr.cancelHighlightNets("selected-h");if(ratLineMgr.lastHighlightNet===e)return}if(n&&e){highlightNet(e,{scroll:!1,class:"selected-h"});ratLineMgr.lastHighlightNet=e}else if(r&&t){var a=v(t);"wire"===de(a)&&pn("schCreateNet",[a])}},buildAllNet:function(e){ratLineMgr.buildAllNet(e)},setPartElements:function(e,t){for(var n=Zt(),r=n.length,i=Wt("g"),a=-1;++a<r;)i.appendChild(n[a]);fa.appendChild(i);var o,s,c=i.getBBox(),l=ba.canvas,d={x:c.x+c.width/2,y:c.y+c.height/2};if(1===r&&w(n[0],"c_origin")){d.x=+w(n[0],"c_origin").split(",")[0];d.y=+w(n[0],"c_origin").split(",")[1]}if(wo===ia.PCB){s=t+l.originY-d.y;o=e+l.originX-d.x}else{o=e-d.x;s=t-d.y}Ct(n,o,s);Sn(!1);var u={},h=wo==ia.SCH||wo==ia.SCHLIB;if(h){if(h){var f=m("text[c_note=note_pre]",i);if(f.length){var p=[];for(a=0,r=f.length;a<r;a++)p[a]=X(f[a].textContent).toUpperCase();var g=ua.getNewPreArr(p,!0);for(a=0,r=f.length;a<r;a++)g[a]&&g[a]!=p[a]&&Wa.node.setTextContent(f[a],g[a])}}Rt(i);for(a=-1;++a<n.length;){la.select(n[a]);Ji.appendChild(n[a])}}else{var y=[];for(a=0,r=n.length;a<r;a++){var x=n[a];Rt(x);Layer.appendElement(x);la.select(x);if("pinpart"==w(x,"c_etype")){var v=x.querySelector("path[c_note=note_pre]");if(v){var L=w(v,"c_text")||"",_=ua.getNewPre2(L,!0,!0,u);_!=L&&Ei(v.parentNode,{text:_});u[_]=1}}"COPPERAREA"!=Wa.getPCBCmdKey(x)||wo!=ia.PCBLIB&&wo!=ia.PCBMODULE&&wo!=ia.PCB||y.push(x)}resetCoppersOrder(y)}fa.removeChild(i);var b="";for(a=0;a<n.length;a++)b+=n[a].id+",";yn();La.save(["add",b]);hi()},layerAppendNode:function(e){e&&Layer.appendElement(e)},updateBindId:function(){},updateSheetText:function(e,t){xo.updateSheetText(e,t)},setSheetSize:function(e,t){xo.setSheetSize(e,t)},jsonMgr_updateOne:function(e){ha.updateOne(e)},findIdsAndReplace:function(e,t){Qn(e,t)},getDrawLineTarget:function(){return Co.target},changeLogo:function(){var e="lceda"===Na?"en":"zh",t=L('#gCurParts g[c_partid="part_lib_sheet"] g[c_partid="part_image"] image[logotype="'+e+'"], #gCurParts g[c_partid="part_sheet"] path[logotype="'+e+'"]');t&&M(t);t&&t.remove()},getPinStrFromModule:function(){var e,t,n,r,i,a="",o=m('g[c_partid="part_pin"]',v("g1")).toArray(),s=o.length,c={},l=[],d=1;for(e=0;e<s;e++){t=m("text[text-anchor]",o[e]);if(t.length<1)break;if(w(t[0],"c_pinname")){r=t[0].textContent||"";n=t[1].textContent||""}else{r=t[1].textContent||"";n=t[0].textContent||""}n=n.replace(/[\s|,]/g,"");r=r.replace(/[\s|,]/g,"");if(void 0!==c[n]){i=n;for(;void 0!==c[n]||100===d;){n=i+"_"+d;d++}d=1}c[n]=r;l.push(n)}l.sort(function(e,t){return parseInt(e)-parseInt(t)});for(e=0;e<l.length;e++){n=l[e];r=c[n];a+=n+", "+r+"\n"}return a},updateRuler:function(){on()},createSchlibPackageText:function(e){vi(e,arguments[1])},rebuildPlane:function(e){copperAreaMgr.rebuildPlane(e)},getShapeLength:function(){return v("g1").childNodes.filter(function(e){return e.id&&!e.id.match(/^layer_[^_]+_(begin|end)/)}).length},buildSignals:function(){ha.buildSignals()},releaseActive:function(e){return en(e)},jsonMgr_calAll:function(){ha.calAll()},applyIntelligentSizeEdit:function(e,t,n,r){rulerCommon.applyIntelligentSizeEdit(e,t,n,r)},findFamiliarChildLib:function(e,t){return Ii(e,t)},recoverLibMd5Id:function(e,t){var n=parent.Locale.i18n("The component ID will be reset according to the component prefix, this operation will clear Undo historicals. Do you want to contiune?"),r=parent.Locale.i18n("Please make sure the component prefixs of the schematic and PCB are corresponding, otherwise the components of the schematic and PCB will not be matched after reset!");parent.$.messager.confirm("Warning","<p>"+n+"</p><p>"+r+"</p>",function(n){if(n)if(t){var r=fe(ha.gJsonCache,e,!1,!0);if(!r)return;ha.buildSignals();pn("setTabUnsaved");parent.$.messager.show({title:"Information",msg:"Component ID reset successfully!",timeout:3e3,showType:"slide"})}else pn("recoverAllLibMd5Id")},{buttons:[{text:"Confirm",iconCls:""},{text:"Cancel",iconCls:""}]})},highLightLibUnderPres:function(e){var t,n,r,i,a,o,s,c,l=wo===ia.PCB;if(e&&e.length&&(wo===ia.SCH||wo===ia.PCB)){t=m('[c_note="note_pre"]');for(n=0;n<t.length;n+=1){s=!1;r=t[n];i=l?w(r,"c_text"):r.textContent;a=r.parentNode;if(a){o=a.parentNode;c=w(o,"c_partid");s=c&&0===c.indexOf("part_lib")}e.indexOf(i)>-1&&s&&la.select(o)}pn("triggerEvent",["select_change"])}},isSelectedSheetElem:function(){return xo.isSelectedSheetElem()},filterSheetLayid:function(e){return xo.filterSheetLayid(e)},checkJsonCache:function(e){return ha.checkJsonCache(e)},fixedJsonCache:ha.fixedJsonCache,updateJsonCache:function(e,t){if(e)"all"===e?ha.calAll():ha.gJsonCache=e;else{var n=Zt();ha.updateMore(n)}"buildSignals"==t&&ha.buildSignals&&ha.buildSignals()},updateAttrById:function(e,t){var n=v(e);n&&w(n,t)},setInitOrigin:function(e,t){qn(e,t)},setSheetInfo:function(e){return xo.setSheetInfo(e)},setOriginXY:function(e){if(wo==ia.PCBLIB&&e.x<=0&&e.y<=0){e.x=400;e.y=300}e.x=isFinite(e.x)&&null!==e.x?+e.x:ba.canvas.originX;e.y=isFinite(e.y)&&null!==e.y?+e.y:ba.canvas.originY;e.x=Wa.formatLengthSave(e.x);e.y=Wa.formatLengthSave(e.y);ba.canvas.originX=e.x;ba.canvas.originY=e.y;var t=.5/Za,n=Wa.toFixed(1/Za+1e-5,5);w(v("gridOH"),{y1:e.y+t,y2:e.y+t});w(v("gridOV"),{x1:e.x+t,x2:e.x+t});w(v("gridPattern"),{x:e.x,y:e.y});w(v("gridPattern2"),{x:e.x+n,y:e.y+n});on()},snap_grid:function(){ba.adsorbGrid.enabled=!ba.adsorbGrid.enabled},visible_grid:function(){var e=w(v("grid1"),"display")||"";e="none"==e?"":"none";w(v("grid1"),{display:e});ba.adsorbGrid.visible=!e},isPrefixDuplicated:function(e){var t,n=Zt();n&&n[0]&&(t=An("pre",n[0]));return!(!t||!t.childNodes[0])&&(e.indexOf("?")<0&&ua.isUsed(e,{except:t.id}))},highlightItems:function(){return Ln.apply(null,arguments)},deleteUnnecessaryJunctions:function(){var e=ha.gJsonCache.junction,t=[];for(var n in e)if(j(e,n)){var r=v(n),i=e[n].pinDot;if(r){var a=Sa.checkJunctionValid(i);a.needJunction||t.push(r)}}if(t.length>0){Sa.solveItems(t);Sa.solveTodoList();pn("setTabUnsaved")}},isFreePad:function(e){var t=v(e);if(!t)return!1;var n=t.parentNode;return!(!n||0!==n.id.indexOf("layer_"))||void 0},isSheet:function(){return ha.gJsonCache&&ha.gJsonCache.head&&ha.gJsonCache.head.isSheet},checkPreErrorBeforePartModule:function(e,t){return or(e,t)},gJsonCache:function(e){if(e&&(e.id||e.gId)){var t=v(e.id||e.gId);if(!t)return;var r=e.cmdKey||de(t),i=ha.gJsonCache[r],a=i&&i[e.id];return a?D(a):null}ha.gJsonCache.head.docType=wo;ha.gJsonCache.head.c_para=w(Ji,"c_para");ha.gJsonCache.BBox=n("getBBox");ha.gJsonCache.canvas=Ci();ha.gJsonCache.itemOrder=R();if(Le(wo)){ha.gJsonCache.colors=ba.colors;ha.gJsonCache.head.c_spiceCmd=w(Ji,"c_spiceCmd")}return be(ha.gJsonCache)},updateDomId:function(e,t,n){ar(e,t,n)},deleteObjs:function(e){Lr(e)},undoDraw:function(){Co.started&&Co.canBackStep()&&Co.backStep()},updateDeviceDomIdAndJsonCache:function(e){var t=v(e);if(t){w(t,{id:"gge"+ue()});ha.updateOne(t)}}}}function oi(e){(Array.isArray(e)?e:[e]).forEach(function(e){var t,n,r;if("noconnectflag"===de(e)){t=w(e,"c_origin").split(",");n=+t[0];r=+t[1];if(go.getPinByXY(n,r))return;if(go.checkNCFlagInBridgeWire(n,r))return;pn("messagerError",["No connect flag only can be placed on Pin dot or the wire which is connected one Pin."])}})}function si(){var e={rect:vo,show:function(e,t,n,r){w(vo,{display:"",width:n,height:r,x:e,y:t})},showD:function(e,t,n,r){w(vo,{display:"",width:Math.abs(n),height:Math.abs(r),x:n>0?e:e+n,y:r>0?t:t+r,stroke:wo==ia.WAVEFORM?Ja._gridSetting.gridColor:"#0000FF"})},hide:function(){w(vo,{display:"none"})}};Aa=new ti({ondragstart:function(e){Sa.solveItem(this.target)},ondrag:function(e){var t=this,n=w(t.target,"c_etype");"wire"!=n&&"bus"!=n||ha.checkShow(t.targetX0+t.movedX,t.targetY0+t.movedY)},ondragend:function(e){var t=this,n=t.target,r=w(n,"c_etype");"line"==w(n,"c_shapetype")&&vn(n);ha.updateOne(n);"wire"!=r&&"bus"!=r||w(v("pdot0"),"display","none");Sa.solveItem(n);Sa.solveTodoList();var i=t.attrs,a=P(n);K(i,a);delete i.class;delete a.class;La.save(Sa.batHistoryCmd(["attr",n.id,i,a]));var o=de(n);"arc"!==o&&"rect"!==o&&"ellipse"!==o||pn("updateAttrPanel")}});Ea=new ni({ondragstart:function(){var e,t,n=this,r=n.selectedObjs,i=[];yn();if(!n.atPartNoteText&&!n.atPartText||1!==r.length){var a,o,s,c,l=so.calFollowing(r),d=l.followingWireIds,u=l.followingNoConnectFlagIds;for(a in d)if(j(d,a)){o=v(a);Sa.solveItem(o,"old");i.push(["node",a,o.cloneNode(!0),null])}i.wiresCount=i.length;for(s in u)if(j(u,s)){c=v(s);Sa.solveItem(c);i.push(["node",s,c.cloneNode(!0),null])}i.noConnectFlagsCount=i.length-i.wiresCount;for(e=0,t=r.length;e<t;e++)i.push(["node",r[e].id,r[e].cloneNode(!0),null]);n.hist=i;n.followingInfo=l;Sa.solveItems(r,"old")}else{var h=n.evtTarget;n.hist=["node",h.parentNode.id,h.parentNode.cloneNode(!0),null]}},ondrag:function(){var e=this,t=e.selectedObjs;if(!e.atPartNoteText&&!e.atPartText||1!==t.length){e.followingInfo&&e.followingInfo.followingMap&&so.moveFollowing(e.followingInfo.followingMap)
;e.followingInfo&&e.followingInfo.followingMapFlag&&so.moveFollowingNoConnectFlags(e.followingInfo.followingMapFlag)}},ondragend:function(){var e=this,t=e.selectedObjs,n=!(!e.movedX&&!e.movedY);if(!e.atPartNoteText&&!e.atPartText||1!==t.length){if(1==t.length&&"line"==w(t[0],"c_shapetype")){pa&&pa!=t[0]&&en();vn(t[0]);pa=t[0];la.select(pa)}var r,i,a,o,s,c,l,d,u=0,h=0,f=e.hist;for(o=0,s=f.wiresCount;o<s;o++){r=f[o][1];i=v(r);yt(i);if(i&&w(i,"points")!=w(f[o][2],"points")){u++;if(i.points&&i.points.numberOfItems<2){a=Wa.node.getRefId(i);ha.removeOne(i);w(i,"points",w(f[o][2],"points"));qa.appendChild(i);f[o]=["del",r,a]}else{e.addWire.indexOf(i.id)>-1?f[o]=["add",r,Wa.node.getRefId(i)]:f[o][3]=i.cloneNode(!0);ha.updateOne(i);Sa.solveItem(i)}}else f[o].length=0}for(o=f.wiresCount,s=f.noConnectFlagsCount+f.wiresCount;o<s;o++){l=f[o][1];d=v(l);Sa.solveItem(d);f[o][3]=d.cloneNode(!0);ha.updateOne(d)}for(o=0,s=t.length;o<s;o++){c=f[o+f.wiresCount+f.noConnectFlagsCount];if(!n&&Wa.node.isSame(c[2],t[o]))c.length=0;else{h++;c[3]=t[o].cloneNode(!0)}}ha.updateMore(t);Sa.solveItems(t);Sa.solveTodoList();1==t.length&&pn("updateAttrPanel");f.length&&(u||h)&&La.save(Sa.batHistoryCmd(f));e.hist=null;so.uplock=!0}else{var p=e.evtTarget,g=p;if(!n&&Wa.node.isSame(e.hist[2],p.parentNode))return;e.hist[3]=p.parentNode.cloneNode(!0);for(;g&&!b(g.parentNode,$a);)g=g.parentNode;g&&ha.updateOne(g);La.save(e.hist);e.hist=null}}});Ia=new ri({strictMousedownTarget:fa,onmousedown:function(e,t){if(va)return!1;if(Aa.start)return!1;if(Ea.start)return!1;if(!e.shiftKey){var n=Zt();if(n.length>0){en(n);pn("triggerEvent",["select_change"])}}wo===ia.WAVEFORM&&(Ma.isDrawingSelectBox=!0)},onready:function(e,t){en()},ondragstart:function(e,t){},ondrag:function(t,n){if(0!==n.dx&&0!==n.dy){if(!Qa.pasting){wo==ia.WAVEFORM&&Ma.updateMessageBarInfo({x:n.x0,y:n.y0,width:n.dx,height:n.dy});e.showD(n.x0,n.y0,n.dx,n.dy)}}else e.hide()},ondragend:function(t,r){if(!Qa.pasting){e.hide();var i={x:r.dx>0?r.x0:r.x0+r.dx,y:r.dy>0?r.y0:r.y0+r.dy,width:r.dx>0?r.dx:-r.dx,height:r.dy>0?r.dy:-r.dy};if(wo!==ia.WAVEFORM){for(var a,o,s,c,l,d,u=Ji.children,h=u.length,f=h;--f>=0;){l=u[f];d=getComputedStyle(l);if((!d||"none"!=d.display)&&!(d&&"none"==d.pointerEvents||l.id.match(/^frame_lib_/))){try{o=dt(l)}catch(e){continue}if(r.dx>0)s=Wa.isRectInRect(o,i);else{s=Wa.isRectTouchRect(o,i);s&&("polyline"==l.tagName?s=Wa.isPolylineTouchRect(l,i):"polygon"==l.tagName&&(s=Wa.isPolygonTouchRect(l,i)))}a=la.isSelected(l);if(s!=a){la.toggle(l,s);pn("multiSelect",[!0]);c=!0}}}c&&pn("triggerEvent",["select_change"]);n("dragMoveCheck",[t])}else Ma.zoomViaSelectBox({x:r.dx>0?r.x0:r.x1,y:r.dy>0?r.y0:r.y1,width:r.dx>0?r.dx:-r.dx,height:r.dy>0?r.dy:-r.dy},r.dx>0?"zoomin":"zoomout")}}})}function ci(e){var n=Qa;if(n.on!==e){if(n.on&&n.waitingSave&&n.targets){if(n.pasting)return;if(n.offsetX||n.offsetY){ha.updateMore(n.targets);Sa.solveItems(n.targets);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["move",n.ids,n.offsetX,n.offsetY]))}n.targets=null;n.ids="";n.waitingSave=0}dr();n.on=void 0!==e?e:!n.on;!n.on&&n.targets&&(n.targets=null);bn(n.on?"grab":void 0);!n.on&&n.pasting&&delete n.pasting;if(!1===e&&n.bind||null===n.targets){n.bind=!1;t.removeEventListener("mousemove",fi,!1);t.removeEventListener("mouseup",ui,!1);t.removeEventListener("keydown",pi,!1)}}}function li(e,n){if(Qa.on){Qa.targets=n||Zt();if(!(Qa.targets.length<=0)){var r=Qa,i=ln(e,!1);r.startX=i.x;r.startY=i.y;r.offsetX=0;r.offsetY=0;r.hasPin=!1;for(var a=la.get(),o=0,s=a.length;o<s;o++)if("part_pin"===w(a[o],"c_partid")||L('g[c_partid="part_pin"]',a[o])){r.hasPin=!0;break}n||(n=r.targets);_(Ji,"hidetext",!1);var c=n[0].id,l=n.length;for(o=1;o<l;o++)c+=","+n[o].id;r.ids=c;r.waitingSave=0;bn("grabbing",r.startX,r.startY);r.snapped=ba.adsorbGrid.enabled;r.unitSnap=!1;for(o=0;o<l;o++){var d=de(r.targets[o]);if("pin"==d||"schlib"==d||"wire"==d){r.unitSnap=!0;break}}Sa.solveItems(n);if(!Qa.bind){Qa.bind=!0;t.addEventListener("mousemove",fi,!1);if(ba.adsorbGrid.enabled){var u=_t(r.startX);bn("cross-red",u.x,u.y)}else bn("cross-red",r.startX,r.startY);setTimeout(function(){t.addEventListener("mouseup",ui,!1)},1)}}}}function di(e){var n=Qa;n.pasting=!0;n.targets=e.targets;n.startX=e.x;n.startY=e.y;n.offsetX=0;n.offsetY=0;n.hasPin=e.hasPin;_(Ji,"hidetext",!1);var r,i=n.targets[0].id,a=n.targets.length;for(r=1;r<a;r++)i+=","+n.targets[r].id;n.ids=i;n.waitingSave=1;n.snapped=ba.adsorbGrid.enabled;n.unitSnap=!1;for(r=0;r<a;r++){var o=de(n.targets[r]);if("pin"==o||"schlib"==o||"wire"==o){n.unitSnap=!0;break}}if(!n.bind){n.bind=!0;t.addEventListener("mousemove",fi,!1);t.addEventListener("keydown",pi,!1);setTimeout(function(){t.addEventListener("mouseup",ui,!1)},1)}}function ui(e){var t=Qa;if(t.on&&!wa.dragpanning){delete Qa.origin;Sn(!1);if(t.pasting)hi(e);else if(e.button===qi){Mt(t.targets);if(t.waitingSave&&t.targets){ha.updateMore(t.targets);Sa.solveItems(t.targets);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["move",t.ids,t.offsetX,t.offsetY]));t.targets=null;t.ids="";t.waitingSave=0}n("dragMoveSwitch",[!1]);t.on=!0;bn("grab")}else if(e.button===ea){Mt(t.targets,"cancel");t.targets&&(t.offsetX||t.offsetY)&&Ct(t.targets,-t.offsetX,-t.offsetY);t.targets=null;t.ids="";t.waitingSave=0;n("dragMoveSwitch",[!1])}}}function hi(e){var t=Qa;if(t.on){if(e&&e.button!==qi&&e.button!==Zi){if(e&&e.button===ea){Mt(t.targets,"cancel");for(var r=t.targets,i=r.length-1;i>=0;i--){la.unselect(r[i]);M(r[i])}}}else{Mt(t.targets);ha.updateMore(t.targets);Sa.solveItems(t.targets);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["add",t.ids]),{title:"paste",functionName:"dragMoveEndHandlerForPaste"});oi(t.targets)}delete t.pasting;t.targets=null;t.ids="";t.waitingSave=0;n("dragMoveSwitch",[!1])}}function fi(e){var t=Qa;t.targets=t.targets.filter(function(e){return!po.isLocked(e)});var n=ln(e,!1),r=n.x-t.startX,i=n.y-t.startY;fo.altKeyEnabled=e.altKey;if(t.snapped){var a=_t({x:t.startX,y:t.startY}),o=fo.getSanpSize("X"),s=fo.getSanpSize("Y");r=Math.round((n.x-a.x)/o)*o;i=Math.round((n.y-a.y)/s)*s}else{r=n.x-t.startX;i=n.y-t.startY}if(t.unitSnap){r=Math.round(r);i=Math.round(i)}var c=r-t.offsetX,l=i-t.offsetY;if(c||l){Ct(t.targets,c,l);t.offsetX+=c;t.offsetY+=l;t.waitingSave=1}}function pi(e){if(27==e.keyCode){var t=Qa;if(t.on){for(var r=t.targets,i=r.length-1;i>=0;i--)M(r[i]);delete t.pasting;delete t.origin;t.targets=null;t.ids="";t.waitingSave=0;n("dragMoveSwitch",[!1])}}}function gi(e){this.startX=0;this.startY=0;this.ready=0;this.start=0;this.target=null;this.oldPoints=[];this.pIndex=-1;if(e)for(var n in e)j(e,n)&&(this[n]=e[n]);gi.instance=this;t.addEventListener("mousedown",this.mdown,!1)}function yi(e,t){var n=e.points.getItem(t>>1),r=e.points.getItem(t+1>>1),i=n.y-r.y,a=n.x-r.x,o=Math.PI;bn((a?Math.abs(Math.atan(i/a)/o):.5)<.25?"row-resize":"col-resize")}function xi(){new gi({ondragstart:function(e){var t,n,r,i,a,o,s,c,l,d=e.target,u=d.points,h=u.numberOfItems,f=gi.instance;wo!==ia.PCB&&wo!==ia.PCBLIB&&wo!==ia.PCBMODULE||removeFakePolyline();if(d!==pa)if(pa)en();else{pa=d;la.select(pa);vn(d);pn("triggerEvent",["select_change"])}"wire"==de(d)&&Sa.solveItem(d,"old");var p=w(d,"layerid"),g=de(d);wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE?isSignalLayer(p)&&!isPlaneLayer(p)&&yt(d):"wire"!=g&&"bus"!=g||yt(d);if(h!=d.points.numberOfItems){u=d.points;h=u.numberOfItems;l=9;n=Oe({x:e.x0,y:e.y0},d,l)}else n=f.pIndex;n<=0?n=1:n%2==0&&n--;f.pIndex=n;r=vt(d);t=n>>1;i=r[t];a=r[t+1];if(h>2&&t===h-2){c=r[h-1];r.push({x:c.x,y:c.y});u.appendItem(mt(c));h++}if(h>2&&0===t){c=r[0];r.unshift({x:c.x,y:c.y});u.insertItemBefore(mt(c),0);h++;t++;n+=2;f.pIndex=n}wo===ia.SCH&&"bus"===de(d)&&(t=this.changePolyline({i:t,oldPoints:r,ps:u}));this.handleBusentry(d,t);o=r[t-1];s=r[t+2];var y,x,v,m,L,_,b,S,C,M,N;if(h>2&&("45"==ba.canvas.angle||"90"==ba.canvas.angle)){N=.01;S=Math.atan(Math.abs(i.y-a.y)/Math.abs(i.x-a.x));S=Wa.toFixed(180/(Math.PI/S));Ye(S,45,N)?f.configAngle="45":Ye(S,90,N)?"45"===ba.canvas.angle?f.configAngle="45":f.configAngle="90":f.configAngle=ba.canvas.angle;if("45"==f.configAngle){if(h>2){x=De(f.startX,f.startY,i.x,i.y);v=De(f.startX,f.startY,a.x,a.y);m=this.getAngleAOB(o,i,a);L=this.getAngleAOB(i,a,s);m=Math.round(180/(Math.PI/m));L=Math.round(180/(Math.PI/L));_=+w(d,"stroke-width");b=_/2;if(x<=_&&90===m){y=Qe(o,i,i.x,i.y,b);1===y.length&&(r[t]=y[0]);y=Qe(i,a,i.x,i.y,b);if(1===y.length){u.insertItemBefore(mt(y[0]),t+1);r.splice(t+1,0,y[0]);h++;i=r[t];a=r[t+1];o=r[t-1];s=r[t+2]}}else if(v<=_&&90===L){y=Qe(s,a,a.x,a.y,b);1===y.length&&(r[t+1]=y[0]);y=Qe(i,a,a.x,a.y,b);if(1===y.length){u.insertItemBefore(mt(y[0]),t+1);r.splice(t+1,0,y[0]);h++;t++;n+=2;f.pIndex=n;i=r[t];a=r[t+1];o=r[t-1];s=r[t+2]}}}if(!Ye(Math.abs(i.x-a.x),Math.abs(i.y-a.y),N)&&!Ye(i.y,a.y,N)&&!Ye(i.x,a.x,N)){if(Math.abs(S-45)<Math.abs(S-90)&&Math.abs(S-45)<S){C={x:(i.x<a.x?i.x:a.x)+Math.abs(i.x-a.x)/2,y:(i.y<a.y?i.y:a.y)+Math.abs(i.y-a.y)/2};if(tt(o,i)){y=Fe([a.x,a.y],S-45,i.x,i.y);y={x:y[0],y:y[1]};M=Te(i,y,s,a);M&&(r[t+1]=M)}else if(tt(s,a)){y=Fe([i.x,i.y],S-45,a.x,a.y);y={x:y[0],y:y[1]};M=Te(a,y,o,i);M&&(r[t]=M)}else{M=Te(o,i,{x:C.x+(i.x<a.x?-1:1),y:C.y+(i.y<a.y?-1:1)},C);M&&(r[t]=M);M=Te(s,a,{x:C.x+(i.x<a.x?-1:1),y:C.y+(i.y<a.y?-1:1)},C);M&&(r[t+1]=M)}}else if(Math.abs(S-90)<Math.abs(S-45)){r[t]={x:i.x+(a.x-i.x)/2,y:i.y};r[t+1]={x:a.x-(a.x-i.x)/2,y:a.y}}else{C={x:(i.x<a.x?i.x:a.x)+Math.abs(i.x-a.x)/2,y:(i.y<a.y?i.y:a.y)+Math.abs(i.y-a.y)/2};i.y=C.y;a.y=C.y;S=Math.atan(Math.abs(i.y-o.y)/Math.abs(i.x-o.x));S=180/(Math.PI/S);M=Math.abs(S-90)<Math.abs(S-45)?null:Te(a,i,{x:i.x<o.x?o.x-1:o.x+1,y:i.y<o.y?o.y-1:o.y+1},o);M&&(r[t]=M);S=Math.atan(Math.abs(a.y-s.y)/Math.abs(a.x-s.x));S=180/(Math.PI/S);M=Math.abs(S-90)<Math.abs(S-45)?null:Te(i,a,{x:s.x<a.x?s.x+1:s.x-1,y:s.y<a.y?s.y+1:s.y-1},s);M&&(r[t+1]=M)}i=r[t];a=r[t+1];o=r[t-1];s=r[t+2]}S=Math.atan(Math.abs(o.y-i.y)/Math.abs(o.x-i.x));S=180/(Math.PI/S);if(!isNaN(S)&&45!=S&&0!==S){M=Math.abs(S-45)<Math.abs(S-90)&&Math.abs(S-45)<S?Te(o,{x:o.x+(i.x<o.x?-1:1),y:o.y+(i.y<o.y?-1:1)},i,a):Math.abs(S-90)<Math.abs(S-45)?Te(o,{x:o.x,y:o.y+1},i,a):Te(o,{x:o.x+1,y:o.y},i,a);M&&(r[t]=M)}S=Math.atan(Math.abs(s.y-a.y)/Math.abs(s.x-a.x));S=180/(Math.PI/S);if(!isNaN(S)&&45!=S&&90!=S&&0!==S){M=Math.abs(S-45)<Math.abs(S-90)&&Math.abs(S-45)<S?Te(s,{x:s.x+(a.x<s.x?-1:1),y:s.y+(a.y<s.y?-1:1)},i,a):Math.abs(S-90)<Math.abs(S-45)?Te(s,{x:s.x,y:s.y+1},i,a):Te(s,{x:s.x+1,y:s.y},i,a);M&&(r[t+1]=M)}}else if("90"==f.configAngle)if(Ye(i.x,a.x,N)){S=Math.atan(Math.abs(o.y-i.y)/Math.abs(o.x-i.x));S=Wa.toFixed(180/(Math.PI/S));isNaN(S)||Ye(S,45,N)||Ye(S,90,N)||Ye(S,0,N)||(i.y=o.y);S=Math.atan(Math.abs(s.y-a.y)/Math.abs(s.x-a.x));S=Wa.toFixed(180/(Math.PI/S));isNaN(S)||Ye(S,45,N)||Ye(S,90,N)||Ye(S,0,N)||(a.y=s.y)}else if(Ye(i.y,a.y,N)){S=Math.atan(Math.abs(o.y-i.y)/Math.abs(o.x-i.x));S=Wa.toFixed(180/(Math.PI/S));isNaN(S)||Ye(S,45,N)||Ye(S,90,N)||Ye(S,0,N)||(i.x=o.x);S=Math.atan(Math.abs(s.y-a.y)/Math.abs(s.x-a.x));S=Wa.toFixed(180/(Math.PI/S));isNaN(S)||Ye(S,45,N)||Ye(S,90,N)||Ye(S,0,N)||(a.x=s.x)}else{S=Math.atan(Math.abs(i.y-a.y)/Math.abs(i.x-a.x));S=180/(Math.PI/S);if(S>=45){C={x:(i.x<a.x?i.x:a.x)+Math.abs(i.x-a.x)/2,y:(i.y<a.y?i.y:a.y)+Math.abs(i.y-a.y)/2};i.x=C.x;i.y=o.y;a.x=C.x;a.y=s.y}else{C={x:(i.x<a.x?i.x:a.x)+Math.abs(i.x-a.x)/2,y:(i.y<a.y?i.y:a.y)+Math.abs(i.y-a.y)/2};i.x=o.x;i.y=C.y;a.x=s.x;a.y=C.y}}}f.oldPoints=r},ondrag:function(e){var t,n,r,i,a,o,s,c,l,d,u,h,f,p,g,y,x,m,L,_=e.target,b=e.dx,S=e.dy,C=_.points,M=C.numberOfItems,w=gi.instance,N=de(_);n=w.pIndex;r=vt(_).length>2?w.oldPoints:vt(_);if(r&&v(_.id)){t=n>>1;i=r[t];a=r[t+1];o={x:i.x+b,y:i.y+S};s={x:a.x+b,y:a.y+S};var P,T;if(r.length>2){c=r[t-1];i=r[t];a=r[t+1];l=r[t+2];if(w.snap){d={x:e.x1,y:e.y1};u=we(o,s,d);h=_t(u);o.x+=h.x-u.x;o.y+=h.y-u.y;s.x+=h.x-u.x;s.y+=h.y-u.y}if(Be(c.x,c.y,i.x,i.y)<1){f="45"!=w.configAngle||Ye(i.x,a.x,m)||Ye(i.y,a.y,m)?we(o,s,c):this.getNewDot(c,o,s);"bus"===N&&(f=this.changeIntersectionForbus({A2:o,B2:s,C:c,A:i,B:a,D:l},"CA")||f)}else f=Te(o,s,c,i);if(Be(a.x,a.y,l.x,l.y)<1){p="45"!=w.configAngle||Ye(i.x,a.x,m)||Ye(i.y,a.y,m)?we(o,s,l):this.getNewDot(l,o,s);"bus"===N&&(p=this.changeIntersectionForbus({A2:o,B2:s,C:c,A:i,B:a,D:l},"BD")||p)}else p=Te(o,s,a,l);g=ke(c,f,l,p);if(g){f=g;p=g}else if("45"==w.configAngle||"90"==w.configAngle){m=.01;y=this.getAngleAOB(c,f,p);y=Math.round(180/(Math.PI/y));x=this.getAngleAOB(c,i,a);x=Math.round(180/(Math.PI/x));if(x&&x<90);else if(y<90){L=this.getNewDot(c,f,p);if(L){y=this.getAngleAOB(c,L,p);y=Math.round(180/(Math.PI/y));if(y<90){g=ke(c,L,l,p);if(g){f=g;p=g}else 90===Math.round(180/(Math.PI/this.getAngleSeg(c,L,l,p)))&&(f=L)}else f=L}}g=ke(c,f,l,p);if(g){f=g;p=g}else{y=this.getAngleAOB(f,p,l);y=Math.round(180/(Math.PI/y));x=this.getAngleAOB(i,a,l);x=Math.round(180/(Math.PI/x));if(x&&x<90);else if(y<90){L=this.getNewDot(l,p,f);if(L){y=this.getAngleAOB(f,L,l);y=Math.round(180/(Math.PI/y));if(y<90){g=ke(c,f,l,L);if(g){f=g;p=g}else 90===Math.round(180/(Math.PI/this.getAngleSeg(c,f,l,L)))&&(p=L)}else p=L}}g=ke(c,f,l,p);if(g){f=g;p=g}}}}else{f=o;p=s;if(w.snap){P=_t(f);T=_t(p);Be(P.x,P.y,f.x,f.y)<=Be(T.x,T.y,p.x,p.y)?T={x:p.x+P.x-f.x,y:p.y+P.y-f.y}:P={x:f.x+T.x-p.x,y:f.y+T.y-p.y};f=P;p=T}}if(wo===ia.SCH&&this.busEntry.length){r=vt(_);Ct(this.busEntry,f.x-r[t].x,f.y-r[t].y);this.followingInfo&&this.followingInfo.followingMap&&so.moveFollowing(this.followingInfo.followingMap)}if(t+1<M){i=C.getItem(t);a=C.getItem(t+1);i.x=f.x;i.y=f.y;a.x=p.x;a.y=p.y}if(wo==ia.PCB){N=de(_);if("TRACK"==N);else if("COPPERAREA"==N){ha.updateOne(_);pn("buildCopper",[_.id])}}"object"==typeof DRCMgr&&DRCMgr&&DRCMgr.doRealtimeDRC&&pa&&DRCMgr.doRealtimeDRC(pa,!0);_==pa&&vn(_)}},ondragend:function(e){var t=gi.instance,n=e.target,r=w(t.target,"net")||"",i=!0===Ua.getCacheObj("AutoTearDrop");if(t.polylinePoints&&t.polylinePoints!==w(n,"points")){var a=t.pIndex,o=a>>1;this.trimPolyline(n.points,o,w(n,"stroke-width")/2);var s=w(n,"layerid"),c=de(n);wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE?isSignalLayer(s)&&!isPlaneLayer(s)&&yt(n):"wire"!=c&&"bus"!=c||yt(n);n==pa&&vn(n);ha.updateOne(n);if(me(wo)){ha.updateMore(this.busEntry);this.updateFollowingWires()}if(wo==ia.PCB){var c=de(n),s=w(n,"layerid");"TRACK"!=c&&"ARC"!=c||!isPlaneLayer(s)||copperAreaMgr.rebuildPlane(s);"TRACK"==c?ratLineMgr.buildOneNet(w(n,"net"),!0):"COPPERAREA"==c&&pn("buildCopper",[n.id])}else if(wo==ia.SCH||wo==ia.SCHLIB){Sa.solveItem(n);Sa.solveTodoList()}this.updateNodeInHistory(n);var l=[];if(wo==ia.PCB&&i){l=removeTeardrop({wire:t.target.id},!0);var d=vt(t.target),u=ha.ifFind(d[0].x,d[0].y,r,s,"tearDrop",t.target.id),h=ha.ifFind(d[d.length-1].x,d[d.length-1].y,r,s,"tearDrop",t.target.id),f=!1;if(u){Co["draw(track)"].AutoTear(u,t.target,r);if(getTeardrop({wire:t.target.id}).length){La.index-=1;l.push(La.records.pop());f=!0}}if(h){Co["draw(track)"].AutoTear(h,t.target,r);var p=getTeardrop({wire:t.target.id}).length;if(1!==p||f){if(2===p){La.index-=1;l.push(La.records.pop())}}else{La.index-=1;l.push(La.records.pop())}}}var g=this.history.busEntry.concat(this.history.wire);l.length&&(g=g.concat(l));g.push(["attr",n.id,{points:t.polylinePoints},{points:w(n,"points")}]);wo==ia.SCH||wo==ia.SCHLIB?La.save(Sa.batHistoryCmd(g)):La.save(g)}}})}function vi(e,t){var n=Wa.c_paraToJson(w(e,"c_para"));if(!T(e)&&(j(n,"Package Display")&&"No"!==n["Package Display"]||t)){var r=m('[c_note="note_package"]',e);if(2===r.length)M(r[0].parentNode);else if(1===r.length){if(!t)return;M(r[0].parentNode)}var i,a=pn("getTabbarDivs")||[],o=[];for(i=0;i<a.length;i++){o.push(a[i].style.display);a[i].style.display="block"}var s=Wa.svg.getBBox(e);for(i=0;i<a.length;i++)a[i].style.display=o[i];var c=Wt("g",{c_partid:"part_annotation",id:Wa.newId()}),l=Wt("text",{c_note:"note_package",x:s.x,y:s.y+s.height+10,fill:"#000080","font-family":"Arial","font-size":"7pt","font-weight":"","font-style":"","dominant-baseline":"","text-anchor":"start"});l.innerHTML=n.package||"";c.appendChild(l);e.appendChild(c)}}function mi(){var e=ha.gJsonCache.schlib;if(e){var t;for(var n in e)if(j(e,n)){t=v(n);vi(t)}}}function Li(e,n){var r,i,a,o,s,c;if(J(e)){La.startBatch();for(c=0;c<e.length;c++)Li(e[c],n);La.saveBatch()}else if(e){c=e.indexOf(" xmlns=");(c<0||c>e.indexOf(">"))&&(e=e.replace(/\/?>/,' xmlns="http://www.w3.org/2000/svg"$&'));c=e.indexOf(" xlink:href");if(c>0){c=e.indexOf(" xmlns:xlink=");c<0&&(e=e.replace(/\/?>/,' xmlns:xlink="http://www.w3.org/1999/xlink"$&'))}r=F(e);if(r&&r.documentElement.namespaceURI==$i.svg){i=t.importNode(r.documentElement,!0);if(i){s=i.tagName;if(s&&!(s.indexOf(":")>0)&&"script"!==s&&"metadata"!==s){k(i);w(i,"c_shapetype","line");Rt(i);if(n.appendTo&&n.appendTo.indexOf(",")<0){a=L("#"+n.appendTo,Ji);(a||Ji).appendChild(i)}else if(n.insertBefore&&n.appendTo.indexOf(",")<0){o=L("#"+n.insertBefore,Ji);o?o.parentNode.insertBefore(i,o):Ji.appendChild(i)}else Ji.appendChild(i);ha.updateOne(i);var l=de(i);if(0===l.indexOf("part_")){var d,u=m("g text[c_note]",i);for(c=0;c<u.length;c++){d=u[c].textContent;if(d.indexOf("?")>0){u[c].textContent=ua.getNewPre(d);ha.updateOne(i)}}if("part_pin"==l){var h=v("part_pin"),f=+h.childNodes[2].textContent,p=+i.childNodes[2].textContent;if(isNaN(p)||p<f){i.childNodes[2].textContent=f;i.childNodes[3].textContent=f;h.childNodes[2].textContent=f+1;h.childNodes[3].textContent=f+1}else{h.childNodes[2].textContent=p+1;h.childNodes[3].textContent=p+1}w(h,{c_spicepin:f})}else{if("part_netLabel_volProbe"==w(i,"c_partid")){i.childNodes[1].firstChild.nodeValue=Jr();ha.updateOne(i)}Sa.solveItem(i);Sa.solveTodoList()}}if("wire"==l){Sa.solveItem(i);Sa.solveTodoList()}La.save(["add",i.id])}}else parent.$.messager.alert("import fail")}}}function _i(){var e=!0,t=pn("getJsonCache");if(t){var n=B(JSON.stringify(t));n.head.editorVersion=Wi;ha.gJsonCache=n}else e=!1;return e}function bi(e,t){var n=w(e,"c_origin"),r=w(e,"c_rotation")||"0";if(n){n=Wa.numberlistToArray(n);var i,a,o,s=t-r,c=n[0],l=n[1];void 0===s&&(s=270);if(s%360==0)return;n=w(e,"c_origin");if(void 0===c||void 0===l)if(n){i=n.split(",");c=+i[0];l=+i[1]}else{a=e.getBBox();c=a.x+a.width/2;l=a.y+a.height/2}else if(n){i=n.split(",");o=[+i[0],+i[1]];o=Fe(o,s,c,l);w(e,"c_origin",o.join(","))}if(n){r=+(w(e,"c_rotation")||0);r=Ue(r-s);w(e,"c_rotation",r)}for(var d=e.children||e.childNodes,u=d.length,h=0;h<u;h++)"part_annotation"==w(d[h],"c_partid")&&d[h].firstChild&&w(d[h].firstChild,"c_note")||d[h].tagName&&lo.hasOwnProperty(d[h].tagName)&&lo[d[h].tagName](d[h],s,c,l)}}function Si(){var e=[];for(var t in ha.gJsonCache.junction)j(ha.gJsonCache.junction,t)&&(function(e){var t;for(t in ha.dots)if(j(ha.dots,t)&&go.isPointEqual(e,ha.dots[t]))return!0;for(t in ha.wires)if(j(ha.wires,t)&&(go.isPointEqual(e,ha.wires[t][0])||go.isPointEqual(e,ha.wires[t][ha.wires[t].length-1])))return!0;return!1}(ha.gJsonCache.junction[t].pinDot)||e.push(v(t)));if(e.length){Lr(e);La.clear()}}function Ci(){return{viewWidth:1e3,viewHeight:1e3,backGround:w(v("gridBg"),"fill"),gridVisible:w(v("grid1"),"display")||"yes",gridColor:w(v("gridCell"),"fill"),gridSize:ba.adsorbGrid.gridSize,canvasWidth:1e3,canvasHeight:1e3,gridStyle:"url(#gridPattern)"==w(v("grid1"),"fill")?"dot":"line",snapSize:ba.adsorbGrid.distanceX,unit:ba.canvas.unit,altSnapSize:ba.adsorbGrid.altSnapSize,originX:ba.canvas.originX,originY:ba.canvas.originY}}function Mi(e){if(e.length>10){var t=e.split(oa);So.modify_canvas({"attr-width":t[7]||1e3,"attr-canvas-height":t[8]||1e3,"attr-canvas-bgcolor":t[3]||"#FFFFFF","attr-canvas-grid-visible":t[4],"attr-canvas-grid-color":t[5],"attr-canvas-grid-size":t[6]||10,"attr-canvas-grid-style":t[9],"attr-canvas-snap-size":t[10],"attr-canvas-alt-snap-size":t[12]||t[10]/2});if(e.length>14&&t[13]&&t[14]){var r=+t[13],i=+t[14];isFinite(r)&&isFinite(i)&&n("setOriginXY",[{x:r,y:i}])}}}function wi(e,t){Ni(e,t)&&setTimeout(function(){pn("alert_polyline_maybe_wire")},10)}function Ni(e,t){for(var n in ha.dots)if(j(ha.dots,n)){var r=ha.dots[n];if(r.x==e&&r.y==t)return!0}return!1}function Pi(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(["node",e[n].id,e[n].cloneNode(!0)]);this.hist=t;this.nodes=[].slice.call(e)}function Ti(){function e(e){var t={"Ctrl+Shift+R":!0,"Ctrl+Shift+O":!0,"Ctrl+Shift+B":!0,"Ctrl+Shift+G":!0,"Ctrl+L":!0,"Ctrl+Tab":function(){return!0},"Ctrl+Shift+H":!0,"Shift+Alt+H":!0,"Ctrl+Shift+E":!0,"Ctrl+Shift+C":!0,"Ctrl+J":!0};return!(!e||e.split("+").length<2)&&("function"==typeof t[e]?t[e]():t[e])}function r(e){var t=e.metaKey,n=e.ctrlKey,r=e.shiftKey,i=e.altKey,a=e.keyCode,o="",s=c[a];t&&(o+="Cmd+");n&&(o+="Ctrl+");r&&(o+="Shift+");i&&(o+="Alt+");a>=48&&a<=57||a>=65&&a<=90?o+=String.fromCharCode(a):"Cmd"!=s&&"Ctrl"!=s&&"Shift"!=s&&"Alt"!=s&&j(c,a)&&(o+=c[a]);o&&/[^+]\+$/.test(o)&&(o=o.substring(0,o.length-1));return o}function i(t){fo.altKeyEnabled=t.altKey;if(t.target.tagName){var i=t.target.tagName.toUpperCase();if("TEXTAREA"==i||"INPUT"==i&&"text"==t.target.type)return}if("keydown"===t.type){var a,c=r(t),l=wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE?"PCB":"SCH",d=pn("getHotkeyConfig");if(d&&d[l]){d[l].hasOwnProperty(c)?a=d[l][c]:j(d.ALL,c)&&(a=d.ALL[c]);a||"R"!=c||(a="rotate");var u=["draw(wire)","draw(bus)","groupSymbol"],h=["left","right","up","down","zoom(in)","zoom(out)","fitview"],f=["file_save"],p=["draw(connect)","draw(copperArea)","draw(rect)","groupSymbol"],g=Wa.fileType.getAbstractFileType(wo);if(a&&!pn("isDisabledCmd",[a])){pn("addUserBehaviorRecord",["hotkey-down",{cmd:a,fileType:g,target:Zt().map(function(e){return e.id}).join(",")}]);if("schlib"==g&&(-1!==u.indexOf(a)||/^place_part\((?!pin\)$)(?!annotation\)$)/.test(a))){t.preventDefault();t.stopPropagation();return}if("photoview"==g&&-1===h.indexOf(a)){t.preventDefault();t.stopPropagation();return}if("waveform"==g&&-1===f.indexOf(a)){t.preventDefault();t.stopPropagation();return}if("pcblib"==g&&-1!==p.indexOf(a)){t.preventDefault();t.stopPropagation();return}if(j(s,a)){var y=s[a](t);if(!1===y&&("Up"==c||"Down"==c||"Left"==c||"Right"==c)){var x={Up:[0,-1],Down:[0,1],Left:[-1,0],Right:[1,0]},v=So.getViewBox(),m=10/Za;v[0]+=m*x[c][0];v[1]+=m*x[c][1];So.setViewBox(v);t.preventDefault();t.stopPropagation();return}if(!1===y&&"Esc"===c){en();pn("triggerEvent",["select_change"]);return}}else n(a)}if(e(c)||o.test(c)||Ba&&"Delete"==c){t.preventDefault();t.stopPropagation()}t.altKey&&t.preventDefault()}}}function a(t){if("keyup"===t.type){if(t.target.tagName){var i=t.target.tagName.toUpperCase();if("TEXTAREA"==i||"INPUT"==i&&"text"==t.target.type)return}var a=r(t);(o.test(a)||Ba&&"Delete"==a||e(a))&&t.preventDefault();if("Esc"===a){if(Qa.on){n("dragMoveSwitch",[!1]);n("undo")}pn("triggerEvent",["keyup",t])}"Backspace"===a&&n("undoDraw")}}var o=/^(Backspace|Space|F1|Home|End|(?:Ctrl|Cmd|Shift)\+[\-+AOSFRDG])$/,s={left:function(){return xr(-1,0)},right:function(){return xr(1,0)},up:function(){return xr(0,-1)},down:function(){return xr(0,1)},"zoom(in)":function(){return pn("zoom(in)",[Dn.data])},"zoom(out)":function(){return pn("zoom(out)",[Dn.data])},draw_end:function(e){if("draw(track)"!==va||27!==e.keyCode||!pn("trackWidthPanelStatus")){if(0===va.indexOf("place_part(")){Co.end(c.ESC);return!0}if("DrawIntelligentRulerLine"==va)intelligentRulerLine.endFirstCreate();else if(va){Co.restart();return!0}return!1}},file_save:function(){return pn("file_save")},editSymbol:function(){return pn("symbolTool")},updatePCB:function(){return pn("updatePCB")},importChanges:function(){return pn("importChanges")},convertToPCB:function(){return pn("convertToPCB")},snap_grid:function(){return pn("snap_grid",[!ba.adsorbGrid.enabled])},change_route_angle:function(){var e=ba.canvas.angle+"",t=["45","90","0","ARC"];return pn("updateAttrByHotkey",[{cmd:"pcbcanvas-angle",value:t[(t.indexOf(e)+1)%t.length]}])},decrease_routing_width:function(){var e=+ba.canvas.routing;if(e>=.4){return pn("updateAttrByHotkey",[{cmd:"pcbcanvas-routing-size",value:Wa.toFixed(Wa.units.convert(e-.2,"pixel",ba.canvas.unit),Wa.units.decimals[ba.canvas.unit])}])}},increase_routing_width:function(){var e=+ba.canvas.routing;return pn("updateAttrByHotkey",[{cmd:"pcbcanvas-routing-size",value:Wa.toFixed(Wa.units.convert(e+.2,"pixel",ba.canvas.unit),Wa.units.decimals[ba.canvas.unit])}])},decrease_snap_size:function(){var e=+ba.adsorbGrid.distanceX;if(e>=.6){return pn("updateAttrByHotkey",[{cmd:"pcbcanvas-snap-size",value:Wa.toFixed(Wa.units.convert(e-.1,"pixel",ba.canvas.unit),Wa.units.decimals[ba.canvas.unit])}])}},increase_snap_size:function(){var e=+ba.adsorbGrid.distanceX;return pn("updateAttrByHotkey",[{cmd:"pcbcanvas-snap-size",value:Wa.toFixed(Wa.units.convert(e+.1,"pixel",ba.canvas.unit),Wa.units.decimals[ba.canvas.unit])}])},toggle_all_copper_area:function(){var e=ha.gJsonCache.objectMap,t="visible"===ba.canvas.copperZone;e&&e.objects["Copper Area"].visible==t&&pn("copperChangeLinkObjectsTool",[e,!t]);for(var n=m("#g1 path[attachedcopperid]"),r=0;r<n.length;r++)objectShow.toggoleClass(n[r],!t);ba.canvas.copperZone=t?"invisible":"visible";pn("setTabUnsaved");pn("updateAttrPanel")},findComponent:function(){return pn("findComponent")},findLibs:function(){pn("findLibs")},crossProbeForce:function(){return pn("crossProbeForce")},crossProbeAndPlace:function(){return pn("crossProbeAndPlace")},designManager:function(){return pn("designManager")},runSpice:function(){return pn("runSpice")},openSpiceDlg:function(){return pn("openSpiceDlg")},opendlgSimResult:function(){return pn("opendlgSimResult")},exploreFindComponents:function(){return pn("exploreFindComponents")},show_drawing_attr_dlg:function(e){if(Co.started){var t=de(Co.target);""===t&&Co.controlLine&&(t=de(Co.controlLine));if(T(Co.target))return;n("show_drawing_attr_dlg",[t,Co.target]);e.preventDefault();e.stopPropagation()}else if(Qa.on)Zt()&&pn("showOffsetElementsByPastDlg");else if([ia.PCB,ia.PCBLIB,ia.PCBMODULE].indexOf(wo)>-1&&Zt().length>0){pn("showAbsoluteOffsetDlg");e.preventDefault();e.stopPropagation()}},setRefPoint:function(){if([ia.PCB,ia.PCBLIB,ia.PCBMODULE].indexOf(wo)>-1){Zt().filter(function(e){return"1"!=w(e,"locked")}).length>0&&sr("draw(refPoint)")}},"Open the FAQ page":function(){return pn("OpenFAQPage")},openLogsDlg:function(){return pn("openLogsDlg")}},c=function(){var e,t={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Esc:27,Space:32,PageUp:33,PageDn:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,"`":192,"-":za?173:189,"+":za?61:187,"[":219,"]":221,"\\":220,";":za?59:186,"'":222,",":188,".":190,"/":191,"*":106};for(e=1;e<=12;e++)t["F"+e]=111+e;var n=Object.keys(t);for(e=0;e<n.length;e++){var r=t[n[e]];j(t,r)||(t[r]=n[e])}if(Ba){if(za)t[224]="Cmd";else{t[91]="Cmd";t[93]="Cmd"}delete t.Backspace;t[8]="Delete";t.Delete=8}var i={107:"+107",109:"-109"};return Object.assign({},t,i)}();n.registerHook({transferKeydown:i,transferKeypress:i});t.addEventListener("keydown",i,!1);t.addEventListener("keyup",a,!1);!function(){if(Ga){var e=function(e){if((e.keyCode==c["+"]||e.keyCode==c["-"])&&(Ba?e.metaKey:e.ctrlKey)){e.preventDefault();e.stopPropagation();return!1}};t.addEventListener("keydown",e,!1)}}()}function Oi(e,t,n){var r,i,a,o,s,l,d,u,h,f,p,g,y,x,_,S,C,P,T,O,k,A,E;n=n||{};if(W(e)){if(1!==e.length){if(wa.isUpdatingMoreAttr)return;wa.isUpdatingMoreAttr=!0;La.startBatch();for(o=0;o<e.length;o++)!function(r){yo.addTask(function(){Oi("string"==typeof e[r]?v(e[r]):e[r],t,n)})}(o);yo.addTask(function(){La.saveBatch();wa.isUpdatingMoreAttr=!1});yo.onProgress(function(e){e=Math.min(1,Math.max(e,.01));pn("progressUpdate",[e,"Update Attribute"])});yo.run();return}e="string"==typeof e[0]?v(e[0]):e[0]}"pimage"===de(e)&&(e=e.firstChild);var I=e&&e.tagName;if(e&&"object"==typeof t&&("object"!=typeof e||1==e.nodeType)&&Object.keys(t).length)if("canvas"!=e){if(n.notHistory&&n.quickchange)if(La.quickchangeNode!=e){k=e.cloneNode(!0);La.quickchangeNode=e;La.quickchangeNodeClone=k}else k=La.quickchangeNodeClone;else n.notHistory||(k=La.quickchangeNode!=e?e.cloneNode(!0):La.quickchangeNodeClone);var B,D=w(e,"c_partid")||"",F=w(e,"c_shapetype")||"";w(e,"c_helper_type");a=w(e,"c_origin");a&&(B=Wa.numberlistToArray(a));if(j(t,"attr-locked")){var R=e.parentNode&&"pimage"===de(e.parentNode)?e.parentNode:e;"yes"===t["attr-locked"]?po.lockObjs([R]):po.unlockObjs([R]);var V=Object.keys(t);1===V.length&&"attr-locked"===V[0]&&(n.notHistory=!0)}if("line"==F&&"text"==I){for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-text-text":Ei(e.parentNode,l);break;case"attr-color":w(e,{fill:l});break;default:d={};d[s.substr(10)]=l;w(e,d);if(Ha&&"attr-text-font-size"==s){h=L("tspan:last-child",e);h&&h.parentNode.appendChild(h.parentNode.removeChild(h))}}}}else if("line"==F&&"image"==I){var G=t["attr-image-href"];if(void 0!==G&&!Wa.isValidImageURL(G,{strict:!0}))return;if(void 0!==G&&Q(G)!=G)return;for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-image-href":w(e,{"xlink:href":l});break;case"attr-image-x":w(e,{x:l});break;case"attr-image-y":w(e,{y:l});break;case"attr-width":w(e,{width:l});break;case"attr-height":w(e,{height:l});break;case"attr-rotation":w(e,{c_rotation:l})}}var z=j(t,"attr-rotation")?Ue(360-t["attr-rotation"]):Ve(e);z?w(e,"transform",ut(ht(e),z,w(e,"transform"))):w(e,"transform","");pn("updateAttrPanel");vn(e)}else if("line"==F&&"text"!=I&&"image"!=I){if("attr-stroke-color"in t){w(e,{stroke:t["attr-stroke-color"]});"wire"==w(e,"c_etype")&&(ba.canvas.schWireStrokeColor=t["attr-stroke-color"])}if("attr-stroke-width"in t){w(e,{"stroke-width":t["attr-stroke-width"]});ba.canvas.strokeWidth=t["attr-stroke-width"]}"attr-stroke-dasharray"in t&&w(e,{"stroke-dasharray":t["attr-stroke-dasharray"]});"attr-fill-color"in t&&w(e,{fill:t["attr-fill-color"]});"attr-rect-rxry"in t&&w(e,{rx:t["attr-rect-rxry"],ry:t["attr-rect-rxry"]});"attr-width"in t&&w(e,{width:t["attr-width"]});"attr-height"in t&&w(e,{height:t["attr-height"]});"hidden"!=w(mo,"visibility")&&vn(e);if("attr-arrow-marker"in t&&("path"==I||"polyline"==I||"line"==I||"polygon"==I)){l=t["attr-arrow-marker"];"start"!=l&&N(e,"marker-start");"end"!=l&&N(e,"marker-end");"start"==l?w(e,"marker-start",Ha?"url(#arrowOnStartChrome)":"url(#arrowOnStart)"):"end"==l&&w(e,"marker-end",Ha?"url(#arrowOnEndChrome)":"url(#arrowOnEnd)")}if("ellipse"==I){"attr-ellipse-rx"in t&&w(e,{rx:t["attr-ellipse-rx"]});"attr-ellipse-ry"in t&&w(e,{ry:t["attr-ellipse-ry"]});"attr-center-x"in t&&w(e,{cx:t["attr-center-x"]});"attr-center-y"in t&&w(e,{cy:t["attr-center-y"]});"hidden"!=w(mo,"visibility")&&vn(e)}if("path"==I&&("attr-ellipse-rx"in t||"attr-ellipse-ry"in t||"attr-center-x"in t||"attr-center-y"in t)){f=e.pathSegList;var H,U,Y=f.numberOfItems;if(2==Y||4==Y){for(o=1;o<Y;o++)if("A"==f.getItem(o).pathSegTypeAsLetter){g=f.getItem(o);p=f.getItem(o-1);break}if(g&&("attr-ellipse-rx"in t||"attr-ellipse-ry"in t)){C=H=g.r1;P=U=g.r2;H="attr-ellipse-rx"in t?+t["attr-ellipse-rx"]:C;U="attr-ellipse-ry"in t?+t["attr-ellipse-ry"]:P;(isNaN(H)||H<=0)&&(H=C);(isNaN(U)||U<=0)&&(U=P);if(H==C&&U==P)return;var J=(p.x-g.x)/2,X=(p.y-g.y)/2,K=J*J/(H*H)+X*X/(U*U);if(K>1)return;g.r1=H;g.r2=U;if(4==Y){S=Wa.arc.getCenterParam(p.x,p.y,g.x,g.y,g.largeArcFlag,g.sweepFlag,H,U,g.angle);if(S){p=f.getItem(0);p.x=S.cx;p.y=S.cy}}}if(g&&("attr-center-x"in t||"attr-center-y"in t)){S=Wa.arc.getCenterPoint(p.x,p.y,g.x,g.y,g.largeArcFlag,g.sweepFlag,g.r1,g.r2,g.angle);"attr-center-x"in t&&St(e,t["attr-center-x"]-S.x,0);"attr-center-y"in t&&St(e,0,t["attr-center-y"]-S.y)}"hidden"!=w(mo,"visibility")&&vn(e)}}}else if("part_annotation"==D){for(s in t)if(j(t,s)){u=e.childNodes[0];l=t[s];switch(s){case"attr-text-text":Ei(e,l);break;case"attr-color":w(u,{fill:l});break;case"attr-text-type":w(u,{type:l});if(!j(t,"attr-color")){var $="spice"===l?{fill:"#000000","font-style":"italic"}:{fill:"#0000FF","font-style":""};w(u,$)}break;default:if("attr-text-"!=s.substr(0,10))break;d={};d[s.substr(10)]=l;w(u,d);if(Ha&&"attr-text-font-size"==s){h=L("tspan:last-child",e);h&&h.parentNode.appendChild(h.parentNode.removeChild(h))}}}if(b(u.parentNode.parentNode,$a)){var q=Tt(u),Z={},ee=["font-family","font-size","fill","font-style","text-anchor","font-weight"]
;for(o=0;o<ee.length;o++)Z[ee[o]]=q[ee[o]];w(v("part(annotation)").childNodes[0],Z)}}else if("part_pin"==D){var te=e.childNodes[0],ne=e.childNodes[1],re=e.childNodes[2],ie=e.childNodes[3],ae=e.childNodes[4],oe=e.childNodes[5];for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-pinpart-rotation":Pr([e],(+w(e,"c_rotation")||0)-l);break;case"attr-name":Ei(te,l);break;case"attr-pinpart-font-family":w(te,{"font-family":l});w(ne,{"font-family":l});break;case"attr-pinpart-font-size":w(te,{"font-size":l});w(ne,{"font-size":l});break;case"attr-pinpart-number":Ei(ne,l);break;case"attr-name-display":w(te,{display:"none"==l?"none":""});break;case"attr-pinpart-number-display":w(ne,{display:"none"==l?"none":""});break;case"attr-pinpart-color":w(ie,{stroke:l});w(ae,{stroke:l});w(oe,{stroke:l});break;case"attr-name-color":w(te,{fill:l});break;case"attr-pinpart-number-color":w(ne,{fill:l});break;case"attr-pinpart-dot":var se=w(ae,"display")||"";if("none"!=se==("none"!=l))break;ie;a=Wa.numberlistToArray(w(e,"c_origin"));p=ie.pathSegList.getItem(0);y=ie.pathSegList.getItem(1);x=y.pathSegTypeAsLetter;_=6;w(ae,{display:"none"==l?"none":""});var ce="h"==x?"x":"y";y[ce]+=y[ce]<0==("none"==l)?-_:+_;break;case"attr-pinpart-Clock":w(oe,{display:"none"==l?"none":""});break;case"attr-pinpart-show":w(e,{c_show:"none"==l?"none":"show"});break;case"attr-pinpart-elec":w(e,{c_elec:l});break;case"attr-pinpart-spicepin":w(e,{c_spicepin:l});break;case"attr-pinpart-length":ie;p=ie.pathSegList.getItem(0);y=ie.pathSegList.getItem(1);x=y.pathSegTypeAsLetter;_=0;l=Math.abs(0|+l);l<1&&(l=0);if(ae&&"none"!==w(ae,"display")){_=2*w(ae,"r");l<_&&(l=_)}var le="h"==x?"x":"y",ue=+w(re,"cx"),he=+w(re,"cy");if(p.x!=ue||p.y!=he){p.x=ue;p.y=he;if(0!==y[le]){y[le]=-y[le];"y"==le?w(e,"c_rotation",y[le]>0?"90":"270"):w(e,"c_rotation",y[le]>0?"180":"0")}}var fe=y[le],pe=w(e,"c_rotation")||"0",ge={0:-1,90:1,180:1,270:-1},ye=ge[pe]*(l-_);if(ye!=fe){y[le]=ye;var xe={x:0,y:0};xe[le]=ye-fe;co.move(te,xe.x,xe.y);co.move(ne,xe.x/2|0,xe.y/2|0);co.move(ae,xe.x,xe.y);co.move(oe,xe.x,xe.y)}w(e,"c_origin",w(re,"cx")+","+w(re,"cy"));break;case"attr-pinpart-x":co.move(e,l-w(e,"c_origin").split(",")[0],0);break;case"attr-pinpart-y":co.move(e,0,l-w(e,"c_origin").split(",")[1])}}}else if("part_junction"==D){var ve=v("part(junction)");for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-part-junction-x":a=Wa.numberlistToArray(w(e,"c_origin"));Tn(e,+l,a[1]);break;case"attr-part-junction-y":a=Wa.numberlistToArray(w(e,"c_origin"));Tn(e,a[0],+l);break;case"attr-part-junction-size":w(e.childNodes[1],{r:l});w(ve.childNodes[1],{r:l});break;case"attr-color":w(e.childNodes[1],{fill:l});w(ve.childNodes[1],{fill:l})}}}else if("part_arrowhead"==D){for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-fill-color":w(e.childNodes[0],"fill",l);if("1"===w(e,"arrowtype")){w(e.childNodes[0],"stroke",l);w(v("part(arrowhead)").childNodes[0],"stroke",l)}else w(v("part(arrowhead)").childNodes[0],"stroke","none");break;case"attr-arrowhead-rotation":T=360-(l-w(e,"c_rotation"));lo.rotate(e,T,B[0],B[1]);break;case"attr-arrowhead-size":l=+l;if(l>=1){Ut(l,e.childNodes[0],!0);w(e,"arrowsize",l);Ut(l,v("part(arrowhead)").childNodes[0]);w(v("part(arrowhead)"),"arrowsize",l)}break;case"attr-arrowhead-type":w(v("part(arrowhead)"),"arrowtype",l);Ht(l,e);Ht(l,v("part(arrowhead)"))}}}else if("part_no_connect_flag"==D){for(s in t)if(j(t,s)){l=t[s];if("attr-color"==s){w(e.childNodes[0],{stroke:t["attr-color"]});w(v("part_no_connect_flag").childNodes[0],{stroke:t["attr-color"]})}}}else if("part_lib_sheet"==D)xo.setSheetAttr(e,t);else if(0===D.indexOf("part_netLabel_")){for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-name":Ei(e,l);break;case"attr-color":var me=m("path[stroke],circle[stroke],rect[stroke],polyline[stroke],ellipse[stroke]",e);for(o=0;o<me.length;o++)b(me[o],"pindot")||w(me[o],"stroke",l);w(e.childNodes[1],{fill:l});break;case"attr-name-display":var Le=L("text",e),_e=L('[c_partid="part_annotation"]',e)||Le;if(_e){"none"===w(Le,"display")&&w(Le,"display","");w(_e,"display",l)}break;case"attr-text-font-family":textE=e.childNodes[1];"text"!==textE.tagName&&(textE=textE.children[0]);w(textE,"font-family",l);break;case"attr-text-font-size":textE=e.childNodes[1];"text"!==textE.tagName&&(textE=textE.children[0]);w(textE,"font-size",l)}}"part_netLabel_text"!=D||n.notUpdateJsonCache||zr(e)}else if(0===D.indexOf("part_")){var be,Se,Ce=ha.gJsonCache,Me=Ce.schlib,we=[],Ne=[],Pe=/\.\d+$/.test(An("pre",e).childNodes[0].innerHTML);for(s in t)if(j(t,s)){l=t[s];switch(s){case"attr-name":if(Pe&&!n.ignoreChild){wa.isUpdatingMoreAttr=!1;return pn("changeChildLib",[An("pre",e).textContent,t])}Ei(An("name",e),l);break;case"attr-name-display":be=An("name",e);if(Pe&&!n.ignoreChild){wa.isUpdatingMoreAttr=!1;return pn("changeChildLib",[An("pre",e).textContent,t])}if("none"==l){Se="note_name";w(e,Se,be.childNodes[0].textContent);M(be);An("name",e)}else N(be,"display");break;case"attr-prefix":Ei(An("pre",e),l);break;case"attr-prefix-display":be=An("pre",e);if(Pe&&!n.ignoreChild){wa.isUpdatingMoreAttr=!1;return pn("changeChildLib",[An("pre",e).textContent,t])}if("none"==l){Se="note_pre";w(e,Se,be.childNodes[0].textContent);M(be);An("pre",e)}else N(be,"display");break;case"convert-to-PCB":case"add-into-BOM":s="convert-to-PCB"===s?"convert_to_pcb":"add_into_bom";if(Pe&&!n.ignoreChild){wa.isUpdatingMoreAttr=!1;return pn("changeChildLib",[An("pre",e).textContent,t])}Me[e.id].head[s]=l;w(e,s,l);break;default:var Te=Wa.c_paraToJson(w(e,"c_para"));if(No&&Te.spicePre){c(e,s,l);if("Voltage type"===s||"Current type"===s){Object.keys(t).length>1&&(e=Zt()[0]);n.notHistory=!0}}}}r="";i="";E=!1;for(s in t)if(s&&!s.match(/^attr-/)&&!No&&"convert-to-PCB"!==s&&"add-into-BOM"!==s){r=s;i=t[s];E=!0;if(/\.\d+$/.test(An("pre",e).childNodes[0].innerHTML)&&!n.ignoreChild){wa.isUpdatingMoreAttr=!1;return pn("changeChildLib",[An("pre",e).textContent,t])}Ai(e,r,i)}if(E){ha.updateOne(e);pn("updateAttrPanel")}Ne&&Ne.length&&ha.updateMore(Ne)}n.notUpdateJsonCache||ha.updateOne(e);if(!n.notHistory){A=e.cloneNode(!0);var Oe=1===Object.keys(t).length?Object.keys(t)[0]:"";La.quickchangeNode=null;La.quickchangeNodeClone=null;if(Ne&&Ne.length){var ke=[["node",e.id,k,A]];for(o=0;o<Ne.length;o++)ke.push(["node",Ne[o].id,we[o],Ne[o]]);La.save(ke)}else La.save(["node",e.id,k,A],Oe)}}else if(n.notHistory)So.modify_canvas(t);else{var Ae=wo==ia.SCHLIB||wo==ia.SUBPART,Ee=!1;O=So.getCanvasAttrs();So.modify_canvas(t);for(s in O){if(j(O,s)&&Ae&&"c_para"==s){var Ie=Wa.c_paraToJson(O[s]);for(var je in Ie)if(j(Ie,je)&&j(t,je)){Ie[je]=t[je];Ee=!0}if(Ee){t[s]=Wa.jsonToC_para(Ie);continue}}j(O,s)&&!j(t,s)&&delete O[s]}if(Object.keys(O).length&&Object.keys(t).length){var Be=Wa.c_paraToJson(O.c_para),De=!0;for(s in t)if(j(t,s)&&j(Be,s)){if(t[s]!==Be[s]){De=!1;break}De=!0}De||La.save(["attrpanel",Ji.id,O,t])}}}function ki(e){var t,n,r,i,a,o={},s=e?W(e)?e:[e]:Zt(),c=s.length>1&&Rn(s);o["attr-selected-count"]=s.length;if(c)return c;if(s.length<1||s.length>1&&!c||1===s.length&&"g1"===s[0].id){o=So.getCanvasAttrs();o["attr-selected-count"]=s.length;o.cmdKey="canvas";ha.gJsonCache.head||(ha.gJsonCache.head={});"schlib"!=Wa.fileType.getAbstractFileType(wo)&&delete o.c_para;o.c_para&&(o.c_para=Wa.sortC_paraJson(Wa.c_paraToJson(o.c_para)));if(o.c_para&&ha.gJsonCache.head&&ha.gJsonCache.head.isSheet){var l=o.c_para.name||"";o.c_para={name:l}}return o}n=s[0];o.cmdKey=de(n);o["attr-locked"]="1"===w(n,"locked")?"yes":"none";r=Tt(n);var d,u="part_annotation"==r.c_partid||!r.c_shapetype&&"annotation"==de(n);if("line"==r.c_shapetype){t=n.tagName;o["attr-topic"]=(w(n,"c_etype")||t).replace(/^(\w)/,function(e){return e.toUpperCase()});if("text"==t){o["attr-text-text"]=Pt(n,"\\n");o["attr-color"]=w(n,"fill");o["attr-text-font-family"]=w(n,"font-family");o["attr-text-font-size"]=w(n,"font-size");o["attr-text-font-weight"]=w(n,"font-weight");o["attr-text-font-style"]=w(n,"font-style");o["attr-text-text-anchor"]=w(n,"text-anchor");o["attr-text-dominant-baseline"]=w(n,"dominant-baseline")}else if("image"==t){o["attr-image-href"]=w(n,"xlink:href")||w(n,"href");o["attr-image-x"]=w(n,"x");o["attr-image-y"]=w(n,"y");o["attr-width"]=w(n,"width");o["attr-height"]=w(n,"height");d=w(n,"c_rotation");o["attr-rotation"]=d}else{o["attr-stroke-color"]=w(n,"stroke")||"";o["attr-stroke-width"]=+w(n,"stroke-width");o["attr-stroke-dasharray"]=w(n,"stroke-dasharray");o["attr-fill-color"]=w(n,"fill")||"";if("rect"==t){o["attr-width"]=w(n,"width")||"0";o["attr-height"]=w(n,"height")||"0";o["attr-rect-rxry"]=w(n,"rx")||"0"}if("ellipse"==t){o["attr-ellipse-rx"]=w(n,"rx");o["attr-ellipse-ry"]=w(n,"ry");o["attr-center-x"]=w(n,"cx");o["attr-center-y"]=w(n,"cy")}if("path"==t){var f,p,g,y=n.pathSegList,x=y.numberOfItems,v="";for(i=0;i<x;i++)v+=y.getItem(i).pathSegTypeAsLetter;if(/^(?:MA|MALZ|MLAZ|MLLAZ?)$/.test(v)){i=v.indexOf("A");f=y.getItem(i-1);p=y.getItem(i);g=Wa.arc.getCenterPoint(f.x,f.y,p.x,p.y,p.largeArcFlag,p.sweepFlag,p.r1,p.r2,p.angle);o["attr-ellipse-rx"]=p.r1;o["attr-ellipse-ry"]=p.r2;o["attr-center-x"]=g.x;o["attr-center-y"]=g.y;o["attr-topic"]=2==x?"Arc":"Pie"}else/^M[CSQT]+Z?$/i.test(v)&&(o["attr-topic"]="Bezier")}}}else if("group"==r.c_shapetype||u){"schlib"!=de(n.parentNode)&&"netflag"!=de(n.parentNode)||delete o["attr-locked"];if("part_annotation"==r.c_partid||u){n=n.childNodes[0];"note_package"!==w(n,"c_note")&&(o["attr-text-text"]=Pt(n,"\\n"));o["attr-color"]=w(n,"fill");o["attr-text-font-family"]=w(n,"font-family");o["attr-text-font-size"]=w(n,"font-size");o["attr-text-font-weight"]=w(n,"font-weight");o["attr-text-font-style"]=w(n,"font-style");o["attr-text-text-anchor"]=w(n,"text-anchor");o["attr-text-dominant-baseline"]=w(n,"dominant-baseline");o["attr-text-type"]=w(n,"type")||""}else if("part_image"==r.c_partid){n=n.childNodes[0];o["attr-image-href"]=w(n,"xlink:href")||w(n,"href");o["attr-image-x"]=w(n,"x");o["attr-image-y"]=w(n,"y");o["attr-width"]=w(n,"width");o["attr-height"]=w(n,"height");d=Ve(n);d>0&&(d=360-d);o["attr-rotation"]=d;o.cmdKey="image";o["attr-locked"]="1"===w(n,"locked")?"yes":"none"}else if("part_pin"==r.c_partid){o["attr-pinpart-rotation"]=w(n,"c_rotation");a=w(n,"c_origin").split(",");o["attr-pinpart-x"]=a[0];o["attr-pinpart-y"]=a[1];o["attr-pinpart-length"]=w(n.childNodes[3],"d").replace(/^.*[hv]\s*\-?/,"");n.childNodes[4]&&"none"!=w(n.childNodes[4],"display")&&(o["attr-pinpart-length"]-=-6);o["attr-name"]=n.childNodes[0].textContent;o["attr-pinpart-number"]=n.childNodes[1].textContent;o["attr-name-display"]="none"==w(n.childNodes[0],"display")?"none":"yes";o["attr-pinpart-number-display"]="none"==w(n.childNodes[1],"display")?"none":"yes";o["attr-pinpart-color"]=w(n.childNodes[3],"stroke");o["attr-name-color"]=w(n.childNodes[0],"fill");o["attr-pinpart-number-color"]=w(n.childNodes[1],"fill");o["attr-pinpart-dot"]="none"==w(n.childNodes[4],"display")?"none":"yes";o["attr-pinpart-Clock"]=n.childNodes[5]&&"none"!=w(n.childNodes[5],"display")?"yes":"none";o["attr-pinpart-show"]="none"==r.c_show?"none":"yes";o["attr-pinpart-elec"]=r.c_elec;o["attr-pinpart-spicepin"]=r.c_spicepin;o["attr-pinpart-font-family"]=w(n.childNodes[0],"font-family");o["attr-pinpart-font-size"]=w(n.childNodes[0],"font-size")}else if("part_junction"==r.c_partid){delete o["attr-locked"];o["attr-part-junction-x"]=r.c_origin.split(",")[0];o["attr-part-junction-y"]=r.c_origin.split(",")[1];o["attr-part-junction-size"]=w(n.childNodes[1],"r");o["attr-color"]=w(n.childNodes[1],"fill")||""}else if(0===r.c_partid.indexOf("part_power_")){var _=m("path[stroke]",n);_=_[0]?_[0].getAttribute("stroke"):"#000000";o["attr-color"]=_}else if(0===r.c_partid.indexOf("part_netLabel_")){var b=L("text",n),S=L('[c_partid="part_annotation"]',n)||b,C=L("polyline",n);o["attr-name"]=b.textContent;o["attr-name-display"]="none"===w(S,"display")?"none":"yes";o["attr-color"]=C?w(C,"stroke"):w(b,"fill")||"#000000";o["attr-text-font-family"]=w(b,"font-family");o["attr-text-font-size"]=w(b,"font-size");"part_netLabel_netPort"==r.c_partid?o["attr-topic"]="Net Port":"part_netLabel_text"==r.c_partid?o["attr-topic"]="Net Label":"part_netLabel_volProbe"==r.c_partid?o["attr-topic"]="Voltage Probe":o["attr-topic"]="Net Flag"}else if("part_busentry"===r.c_partid){o["attr-busentry-x1"]=w(n.childNodes[0],"cx");o["attr-busentry-y1"]=w(n.childNodes[0],"cy");o["attr-busentry-x2"]=w(n.childNodes[1],"cx");o["attr-busentry-y2"]=w(n.childNodes[1],"cy")}else if("part_arrowhead"===r.c_partid){o["attr-topic"]="Arrowhead";o["attr-fill-color"]=w(n.childNodes[0],"fill")||"";o["attr-arrowhead-rotation"]=r.c_rotation||"0";o["attr-arrowhead-size"]=+r.arrowsize||15;o["attr-arrowhead-type"]=r.arrowtype||"3"}else if("part_no_connect_flag"===r.c_partid)o["attr-color"]=w(n.childNodes[0],"stroke")||"";else if("part_lib_sheet"===r.c_partid)Wa.extend(o,xo.getSheetAttr(n));else if(0===r.c_partid.indexOf("part_")){var M=ha.gJsonCache.schlib&&ha.gJsonCache.schlib[n.id];o["attr-name"]=An("name",n).childNodes[0].textContent;o["attr-prefix"]=An("pre",n).childNodes[0].textContent;o["attr-name-display"]="none"==w(An("name",n),"display")?"none":"";o["attr-prefix-display"]="none"==w(An("pre",n),"display")?"none":"";o["convert-to-PCB"]=M&&(M.head.sim?"none":"none"==M.head.convert_to_pcb?"none":"yes");o["add-into-BOM"]=M&&("none"==M.head.add_into_bom?"none":"yes");o.c_para=Wa.c_paraToJson(w(n,"c_para"));j(o.c_para,"BOM_Supplier")||(o.c_para.BOM_Supplier="");j(o.c_para,"Package Display")||(o.c_para["Package Display"]="No");j(o.c_para,"BOM_Supplier Part")||(o.c_para["BOM_Supplier Part"]="");j(o.c_para,"BOM_Manufacturer")||(o.c_para.BOM_Manufacturer="");o.c_para=Wa.sortC_paraJson(o.c_para);o.c_para.spicePre&&No&&(o=h(o.c_para,n,o))}}return o}function Ai(e,t,n){if(0!==t.indexOf("attr-")){var r=w(e,"c_para")||"",i=r.split(sa),a=Wa.c_paraToJson(r);if(Object.keys(a).length){"spicePre"==t&&(n=n.toUpperCase());a[t]=n;var o=Wa.fileType.getAbstractFileType(wo),s=Wa.jsonToC_para(a);if(0===t.indexOf("power_")){t=t.replace(/power_/g,"");var c=X(An("name",e).childNodes[0].textContent),l=function(e){var t=e.substr(0,e.indexOf("("));t=t?t.toUpperCase():"DC";return t}(c);if("function"==t)if("DC"==l&&"DC"!=n){c+=" ";c=n+"("+c.replace(/ /,") ");c=X(c)}else if("DC"!=l&&"DC"==n){var d=c.split(")")[1];c="5"+d}else c=c.replace(l,n);else if(-1!=t.indexOf("ac")){i=c.split("AC");if(i[1]){i[1]=X(i[1]);var u=i[1].split(/\s+/g);if("ac0"==t)u[0]=n;else{u[1]=n;if(!u[0])return;u[1]=n}c=u[0]||u[1]?i[0]+" AC "+u.join(" "):i[0]}else"ac0"==t&&(c=i[0]+" AC "+n)}else if(-1!=c.indexOf("(")){var h=c?c.substr(c.indexOf("(")+1):"";h=h?h.substr(0,h.indexOf(")")):"";h=X(h);i=h.split(/\s+/g);i[t]=n;c=c.replace(h,i.join(" "))}else{i=c.split(/\s+/g);i[0]=n;c=i.join(" ")}An("name",e).childNodes[0].textContent=c}if("package"==t&&n&&"sch"==o){var f=w(e,"eelibtitle");if(f){var p=ae("easyeda.preferences");p=B(p);var g=p&&p["eelib-package"];g||(g=p["eelib-package"]={});w(e,"package-default")!=n?g[f]=n:delete g[f];oe("easyeda.preferences",JSON.stringify(p))}}w(e,{c_para:s});if("Package Display"==t&&0!==e.id.indexOf("frame_sheet_"))if("Yes"===n)vi(e);else{var y=L('[c_note="note_package"]',e)&&L('[c_note="note_package"]',e).parentNode;y&&y.parentNode.removeChild(y)}pn("updateAttrPanel")}}}function Ei(e,t,n){for(var r,i,a,o=e.parentNode,s="part_pin"===w(o,"c_partid"),c=w(o,"c_partid"),l=ha.gJsonCache.schlib,d=null,u=e.children,h=0;h<u.length;h++)if(u[h]&&"TEXT"===u[h].nodeName.toUpperCase()){d=u[h];break}if(!s){c=w(e,"c_partid");"part_annotation"===c&&(c=w(e.parentNode,"c_partid"));var f=L("text",e),p=f&&f.textContent,g=w(f,"c_note");r="note_pre"==g;i="note_name"==g;a=0===(c||"").indexOf("part_netLabel_")}t=X(t).replace(/\\n/g,"\n");if(t!=p){if(r||s&&null===w(e,"c_pinname")||a){var y=t;t=t.replace(/[^\x20-\x7E]+/g,"");if(!t||y!==t)return pn("updateAttrPanel")}else if(i){y=t;t=t.replace(/\n/g,"");if(!t||y!==t)return pn("updateAttrPanel")}if((a||s)&&t.match(/\\$/)){t=t.replace(/\\+$/,"");return pn("updateAttrPanel")}if(!t){if(a||s||i||r){!function(e){parent.$.messager.show({msg:e,timeout:5e3,showType:"slide",title:"Information"})}("This text can not be empty!");s&&w(e,"display","none");return pn("updateAttrPanel")}var x,v,m;m=Mn(e);if(e==m){La.save(["del",m.id,Wa.node.getRefId(m)]);ha.removeOne(m);M(m)}else{x=m.cloneNode(!0);M(e);v=m.cloneNode(!0);La.save(["node",m.id,x,v]);ha.updateOne(m)}}if(r){t=t.toUpperCase();if(t.indexOf(" ")>=0)return pn("updateAttrPanel")}var _="place_"+c,b="place_part("+_.split("place_part_")[1]+")";if(s){var S=w(e,"c_pinname")?0:1;Co.updateNextDrawLineName(b+S,t);w(e,0===S?"c_pinname":"c_pinnumber",t)}else a?Co.updateNextDrawLineName(b,t):Co.updateNextDrawLineName("place_part(annotation)",t);if("sch"===Wa.fileType.getAbstractFileType(wo)){if(r&&t.indexOf("?")<0&&ua.isUsed(t,{except:e.id})){pn("warnPrefixDuplicate",[t,"Components"]);return pn("updateAttrPanel")}var C=r?t.match(/\./g):null;if(C&&C.length>1)return pn("updateAttrPanel");var N=t.indexOf(".");if(r&&t.indexOf("?")<0&&N>-1){var P=t.substr(0,N),T=An("name",e.parentNode).textContent;for(var O in l)if(j(l,O)){var k=[];if(O.indexOf("frame_lib")>=0||O===e.parentNode.id)continue;for(var A in l[O].annotation)"PK"!==l[O].annotation[A].mark&&k.push(l[O].annotation[A].string);var E=k[1].indexOf("."),I=E>-1?k[1].substr(0,E):k[1];if(I===P&&(l[O].head.puuid!==l[e.parentNode.id].head.puuid||k[0]!==T))return pn("updateAttrPanel")}}}s&&w(e,0===S?"c_pinname":"c_pinnumber",t);Nt(s?e:f,t);Nt(s?e:d,t);Nt(f,t);i&&(/\.\d+$/.test(An("pre",e.parentNode).textContent)?pn("updateAttr",[{"attr-name":t},{},e.parentNode]):Nt(e.childNodes[0],t));w(f,"value",t);n&&n()}}function Ii(e,t){var n=[];for(var r in t)if(!(r.indexOf("frame_lib")>=0)){var i=[];for(var a in t[r].annotation)i.push(t[r].annotation[a]);var o=i[1].string.replace(/\.\d+$/,"");o===e.replace(/\.\d+$/,"")&&n.push(t[r].head.gId)}return n}function ji(t,n){e.schTheme||Di();var r,i,a,o,s=t.color,c=[],l=[],d=Ji,u={};for(o in s)j(s,o)&&"null"===s[o]&&schTheme[t.activeTheme]&&(s[o]=schTheme[t.activeTheme].color[o]||"#FFFFFF");var h,f=So.getCanvasAttrs(),p={},g={};if(j(s,"background")){p["attr-canvas-bgcolor"]=f["attr-canvas-bgcolor"];g["attr-canvas-bgcolor"]=s.background;h=!0}if(j(s,"grid")){p["attr-canvas-grid-color"]=f["attr-canvas-grid-color"];g["attr-canvas-grid-color"]=s.grid;h=!0}if(h){n||c.push(["attrpanel",Ji.id,p,g]);So.modify_canvas(g)}j(s,"foreground")&&(ba.canvas.fgcolor=s.foreground);for(var y=m(":not(g):not([id])",d),x=0,L=y.length;x<L;x++)y[x].id=Wa.newId();r=Ji.cloneNode(!0);Wa.extend({},ba.colors);t.reloadBuiltInParts||function(){for(var e,t,n=v("gCurParts").childNodes,r=n.length-1;r>=0;r--){t=n[r];e=t.id;e&&v(e)&&!e.match(/part(lib)/)&&(u[e]=v(e).cloneNode(!0))}}();ba.colors=Wa.extend({},t.colorSuffix||s);i=v("selectStyle").cloneNode(!0);Fi(ba.colors.select);l.push({exNode:i,newNode:v("selectStyle").cloneNode(!0)});Bi(s,d);if(t.reloadBuiltInParts){a=Ir(!0);a.length&&(l=l.concat(a))}else{Bi(ba.colors,v("gCurParts"));!function(){for(var e,t,n=v("gCurParts").childNodes,r=n.length-1;r>=0;r--){t=n[r];e=t.id;e&&u[e]&&l.push({exNode:u[e],newNode:t.cloneNode(!0)})}}()}schTheme.activeTheme=t.activeTheme;if("user-define"===t.activeTheme){Wa.extend({},schTheme["user-define"].color);Wa.extend(schTheme["user-define"].color,ba.colors)}ha.calAll();l.push({exNode:r,newNode:Ji.cloneNode(!0)});l.forEach(function(e){c.push(["node",e.exNode.id,e.exNode,e.newNode])});c.length&&!n&&La.save(c);pn("updateAttrPanel")}function Bi(e,t){var n,r;if(e){if(!t.id){r=!0;t.id="tempIdForSetElementColors"}n="#"+t.id;j(e,"text")&&w(m("text",t),"fill",e.text);if(j(e,"partGraphics")){w(m('g:not([c_partid="part_junction"]) > :not(text)[stroke]:not([stroke=none])',t),"stroke",e.partGraphics);w(m('g:not([c_partid="part_junction"]) > :not(text)[fill]:not([fill=none])[stroke=none],g:not([c_partid="part_junction"]) > :not(text)[fill]:not([fill=none]):not([stroke])',t),"fill",e.partGraphics)}j(e,"partGraphicsPrefix")&&w(m('g text[c_note="note_pre"]',t),"fill",e.partGraphicsPrefix);j(e,"partGraphicsName")&&w(m('g text[c_note="note_name"]',t),"fill",e.partGraphicsName);if(j(e,"foreground")){w(m("> [stroke]:not([stroke=none])",t),"stroke",e.foreground);w(m(n+" > [fill]:not([fill=none])[stroke=none],"+n+" > [fill]:not([fill=none]):not([stroke])",t),"fill",e.foreground)}j(e,"draw")&&w(m(n+' > [c_shapetype="line"][stroke]:not([stroke=none])',t),"stroke",e.draw);j(e,"arrow")&&w(m('g[c_partid="part_arrowhead"] [fill]:not([fill=none])',t),"fill",e.arrow);if(j(e,"pin")){w(m('g[c_partid="part_pin"] [stroke]:not([stroke=none])',t),"stroke",e.pin);w(m('g[c_partid="part_pin"] [fill]:not([fill=none]):not(text)',t),"fill",e.pin)}j(e,"pinName")&&w(m('g[c_partid="part_pin"] text',t),"fill",e.pinName);j(e,"pinNumber")&&w(m('g[c_partid="part_pin"] text[c_pinnumber]',t),"fill",e.pinNumber);j(e,"drawFill")&&w(m("g > :not(text)[fill]:not([fill=none]):not([fill=transparent]):not([fill=NONE])[stroke]:not([stroke=none])",t),"fill",e.drawFill);j(e,"wire")&&w(m('[c_etype="wire"]',t),"stroke",e.wire);j(e,"bus")&&w(m('[c_etype="bus"]',t),"stroke",e.bus);if(j(e,"sheet")){w(m('g[c_partid="part_lib_sheet"] > *[c_partid="part_annotation"] text',t),"fill",e.sheet);w(m('g[c_partid="part_lib_sheet"] > *:not(g)',t),"stroke",e.sheet)}j(e,"busEntry")&&w(m('g[c_partid="part_busentry"] [stroke]:not([stroke=none])',t),"stroke",e.busEntry);if(j(e,"netLabel")){w(m('g[c_partid="part_netLabel_text"] [stroke]:not([stroke=none])',t),"stroke",e.netLabel);w(m('g[c_partid="part_netLabel_text"] [fill]:not([fill=none]):not([fill=transparent])',t),"fill",e.netLabel);w(m('g[c_partid="part_netLabel_netPort"] [stroke]:not([stroke=none])',t),"stroke",e.netLabel);w(m('g[c_partid="part_netLabel_netPort"] [fill]:not([fill=none]):not([fill=transparent])',t),"fill",e.netLabel)}if(j(e,"voltageProbe")){w(m('g[c_partid="part_netLabel_volProbe"] [stroke]:not([stroke=none])',t),"stroke",e.voltageProbe);w(m('g[c_partid="part_netLabel_volProbe"] [fill]:not([fill=none])',t),"fill",e.voltageProbe)}if(j(e,"netFlag")){w(m('g[c_partid^="part_netLabel"]:not([c_partid="part_netLabel_volProbe"]):not([c_partid="part_netLabel_text"]):not([c_partid="part_netLabel_netPort"]) [stroke]:not([stroke=none])',t),"stroke",e.netFlag);w(m('g[c_partid^="part_netLabel"]:not([c_partid="part_netLabel_volProbe"]):not([c_partid="part_netLabel_text"]):not([c_partid="part_netLabel_netPort"]) [fill]:not([fill=none]):not([fill=transparent])',t),"fill",e.netFlag)}j(e,"noConnect")&&w(m('g[c_partid="part_no_connect_flag"] [stroke]:not([stroke=none])',t),"stroke",e.noConnect);if(j(e,"junction")){w(m('g[c_partid="part_junction"] [stroke]:not([stroke=none])',t),"stroke",e.junction);w(m('g[c_partid="part_junction"] [fill]:not([fill=none])',t),"fill",e.junction)}r&&(t.id="")}}function Di(){var t=Ua.getCacheObj("themeColor")||{};if(!e.schTheme){e.schTheme={activeTheme:"original-theme"};schTheme["original-theme"]={color:{background:"#FFFFFF",grid:"#CCCCCC",select:"#FF0000",wire:"#008800",bus:"#008800",busEntry:"#008800",netLabel:"#0000FF",netFlag:"#000000",noConnect:"#33CC33",voltageProbe:"#0000FF",pin:"#880000",pinName:"#0000FF",pinNumber:"#0000FF",partGraphics:"#880000",partGraphicsName:"#000080",partGraphicsPrefix:"#000080",sheet:"#880000",draw:"#000000",drawFill:"#880000",text:"#0000FF",arrow:"#333333",junction:"#CC0000"},colorSuffix:{select:"#FF0000"},activeTheme:"original-theme",changeable:!1,blockColorShow:!0,reloadBuiltInParts:!0};schTheme["white-on-black"]={color:{background:"#000000",grid:"#CCCCCC",select:"#FF0000",wire:"#FFFFFF",bus:"#FFFFFF",busEntry:"#FFFFFF",netLabel:"#FFFFFF",netFlag:"#FFFFFF",noConnect:"#FFFFFF",voltageProbe:"#FFFFFF",pin:"#FFFFFF",pinName:"#FFFFFF",pinNumber:"#FFFFFF",partGraphics:"#FFFFFF",partGraphicsName:"#FFFFFF",partGraphicsPrefix:"#FFFFFF",sheet:"#FFFFFF",draw:"#FFFFFF",drawFill:"#FFFFFF",text:"#FFFFFF",arrow:"#FFFFFF",junction:"#FFFFFF"},colorSuffix:!1,activeTheme:"white-on-black",changeable:!1,blockColorShow:!1,reloadBuiltInParts:!1};schTheme["black-on-white"]={color:{background:"#FFFFFF",grid:"#CCCCCC",select:"#FF0000",wire:"#000000",bus:"#000000",busEntry:"#000000",netLabel:"#000000",netFlag:"#000000",noConnect:"#000000",voltageProbe:"#000000",pin:"#000000",pinName:"#000000",pinNumber:"#000000",partGraphics:"#000000",partGraphicsName:"#000000",partGraphicsPrefix:"#000000",sheet:"#000000",draw:"#000000",drawFill:"#000000",text:"#000000",arrow:"#000000",junction:"#000000"},colorSuffix:!1,activeTheme:"black-on-white",changeable:!1,blockColorShow:!1,reloadBuiltInParts:!1};schTheme["user-define"]={color:{background:"#FFFFFF",grid:"#CCCCCC",select:"#FF0000",wire:"#008800",bus:"#008800",busEntry:"#008800",netLabel:"#0000FF",netFlag:"#000000",noConnect:"#33CC33",voltageProbe:"#0000FF",pin:"#880000",pinName:"#0000FF",pinNumber:"#0000FF",partGraphics:"#880000",partGraphicsName:"#000080",partGraphicsPrefix:"#000080",sheet:"#880000",draw:"#000000",drawFill:"#880000",text:"#0000FF",arrow:"#333333",junction:"#CC0000"},colorSuffix:!1,activeTheme:"user-define",changeable:!0,blockColorShow:!1,reloadBuiltInParts:!1};ba.colors||(ba.colors={});Object.keys(t).length&&(schTheme["user-define"].color=t);schTheme.activeTheme=function(){function e(e,t){var n=!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in t)if(j(t,r)&&t[r].toLowerCase()!==(e[r]&&e[r].toLowerCase())){n=!1;break}return n}if(!ba.colors||0===Object.keys(ba.colors).length||e(schTheme["original-theme"].colorSuffix,ba.colors))return"original-theme";for(var t in schTheme)if("original-theme"!==t&&j(schTheme,t)&&"object"==typeof schTheme[t]&&e(ba.colors,schTheme[t].color))return t;return"user-define"}();"user-define"===schTheme.activeTheme&&Wa.extend(schTheme["user-define"].color,ba.colors);Bi(ba.colors,v("gCurParts"),w);Fi(ba.colors.select);pn("setThemeDropdownRadio",[schTheme.activeTheme]);return schTheme}}function Fi(e){v("selectStyle")&&e&&(v("selectStyle").innerHTML=".highlight, g.highlight * {stroke:"+e+";}\t\t.selected, .selected * {stroke:"+e+";}\t\ttext.highlight, .highlight text, tspan.highlight, .highlight tspan {stroke:none;fill:"+e+";}\t\ttext.selected, .selected text, tspan.selected, .selected tspan {stroke:none;fill:"+e+";}")}function Ri(e){return"6,6"==e?1:"3,10"==e?2:0}function Vi(e){return"Verdana"==e?"":e}function Gi(e){return"7pt"==e?"":e}function zi(e){var t=e.shapeType,n="part("+t+")",r=v(n);if(r&&"import_tmpl"!=t&&"junction"!=t){var i=r.cloneNode(!0);w(i,{id:Wa.newId(),c_shapetype:"group",c_etype:"pinpart"});N(i,"pointer-events");Ji.appendChild(i);for(var a,o=m("g text[c_note]",i),s=0;s<o.length;s++){a=o[s].textContent;a.indexOf("?")>0&&(o[s].textContent=ua.getNewPre(a))}Rt(i);j(e,"x")&&j(e,"y")&&Tn(i,e.x,e.y);e.rotation&&Pr([i],e.rotation,!0);if("part(pin)"==n){var c=+r.childNodes[2].textContent+1+"";r.childNodes[2].textContent=c;r.childNodes[3].textContent=c;w(r,{c_spicepin:c})}else"part(netLabel_volProbe)"==n&&(i.childNodes[1].firstChild.nodeValue=Jr());var l={name:"attr-name",color:"attr-color","font-family":"attr-text-font-family","font-size":"attr-text-font-size"},d={no_connect_flag:{stroke:"attr-color"},noconnectflag:{stroke:"attr-color"},arrowhead:{color:"attr-fill-color",size:"attr-arrowhead-size"},busentry:{},netlabel:l,junction:{size:"attr-part-junction-size",color:"attr-color"},pin:{length:"attr-pinpart-length",name:"attr-name",number:"attr-pinpart-number",spicepin:"attr-pinpart-spicepin","name-display":"attr-name-display","number-display":"attr-pinpart-number-display",color:"attr-pinpart-color",dot:"attr-pinpart-dot",clk:"attr-pinpart-clk",show:"attr-pinpart-show",elec:"attr-pinpart-elec","font-family":"attr-pinpart-font-family","font-size":"attr-pinpart-font-size"},annotation:{text:"attr-text-text",color:"attr-color","text-type":"attr-text-type","font-family":"attr-text-font-family","font-size":"attr-text-font-size","font-weight":"attr-text-font-weight","font-style":"attr-text-font-style"}},u={},h=0===t.indexOf("netLabel_")?l:d[t];if(h){!function(e,t,n){if(n)for(var r in n)if(j(n,r))if(j(e,r))t[n[r]]=e[r];else{var i=Wa.camelize(r);j(e,i)&&(t[n[r]]=e[i])}}(e,u,h);Object.keys(u).length>0&&Oi(i,u,{notHistory:!0})}ha.updateOne(i);if("part_pin"!=n){Sa.solveItem(i);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["add",i.id]))}else La.save(["add",i.id]);return i}}function Hi(e){function n(e,t){var n=t.points;Array.isArray(n)&&(n=n.reduce(function(e,t){return(e?e+" ":"")+t.x+" "+t.y},""));var r=Wt(e,{points:n,id:Wa.newId()});return Ji.appendChild(r)}function r(e){var t=Wt("path",{d:e.d});return Ji.appendChild(t)}function i(e,t){var n={solid:"",dashed:"6,6",dotted:"3,10"};t["stroke-style"]&&n[t["stroke-style"]]&&w(e,{"stroke-dasharray":n[t["stroke-style"]]});w(e,{stroke:t.stroke||ba.canvas.fgcolor,"stroke-width":t["stroke-width"]||"1",fill:t.fill||"none",c_shapetype:"line"})}var a,o,s=e.shapeType;if(!(["text","image","wire","bus","rect","polyline","polygon","circle","ellipse","line","path","bezier","arc","pie"].indexOf(s)<0)){switch(s){case"wire":!function(e){e.stroke||(e.stroke=ba.canvas.schWireStrokeColor||"#008800");var t=n("polyline",e.points);i(t,e);w(t,{c_etype:"wire"});var r=["add",t.id,Wa.node.getRefId(t)],a=go.simplifyWire(t);switch(a.status){case"merge":M(t);t=v(a.wireId);r=["node",t.id,a.oldNode,t.cloneNode(!0)];break;case"invalidWire":M(t);t=null}if(t){ha.updateOne(t);Sa.solveItem(t);Sa.solveTodoList();La.save(Sa.batHistoryCmd(r))}}(e);return;case"bus":e["stroke-width"]||(e["stroke-width"]="2");a=n("polyline",e);w(a,{c_etype:"bus"});break;case"text":a=function(e){var n=Wt("text",{id:Wa.newId(),x:e.x,y:e.y,stroke:e.stroke||"none",fill:e.fill||e.color||ba.canvas.fgcolor,"font-family":e["font-family"]||"Verdana","font-size":e["font-size"]||"9pt","font-weight":e["font-weight"]||"","font-style":e["font-style"]||"",c_shapetype:"line"}),r=(e.text||"TEXT").trim();if(r.match(/[\r\n]/))for(var i,a=r.replace(/\r\n?/g,"\n").split("\n"),o={x:e.x,dy:"0","xml:space":"preserve"},s=0;s<a.length;s++){s>0&&(o.dy="1em");o.id=Wa.newId();i=Wt("tspan",o);i.appendChild(t.createTextNode(a[s]||" "));r.appendChild(i)}else n.appendChild(t.createTextNode(r));e.type&&Oi(n,{"attr-text-type":e.type},{notHistory:!0});Ji.appendChild(n);e.rotation&&lo.rotate(n,e.rotation);return n}(e);break;case"image":a=function(e){var t,n,r=e.src;if(e.src){t=e.width||e.height||100;n=e.height||e.width||100}else{r=da.src;t=da.width;n=da.height}var i=Wt("image",{id:Wa.newId(),x:e.x,y:e.y,width:t,height:n,preserveAspectRatio:"none","xlink:href":r,c_shapetype:"line",c_rotation:0});Ji.appendChild(i);e.rotation&&lo.rotate(i,e.rotation);return i}(e);break;case"polyline":case"polygon":a=n(s,e);break;case"rect":a=Ji.appendChild(Wt(s,{x:e.x,y:e.y,width:e.width,height:e.height,rx:e["round-radius"]||"",ry:e["round-radius"]||""}));break;case"circle":isFinite(e.cx)||(e.cx=500);isFinite(e.cy)||(e.cy=500);isFinite(e.r)||(e.r=50);a=Ji.appendChild(Wt(s,{cx:e.cx,cy:e.cy,r:e.r}));break;case"ellipse":isFinite(e.cx)||(e.cx=500);isFinite(e.cy)||(e.cy=500);isFinite(e.rx)||(e.rx=100);isFinite(e.ry)||(e.ry=50);a=Ji.appendChild(Wt(s,{cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry}));break;case"line":if(!(isFinite(e.x1)&&isFinite(e.x2)&&isFinite(e.y1)&&isFinite(e.y2)))break;a=Ji.appendChild(Wt(s,{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}));break;case"path":(e.d||e.pathString)&&(a=r({d:e.d||e.pathString}));break;case"bezier":if(e.controls){o=function(e){if(!(e.length<4)){for(var t="M"+e[0].x+" "+e[0].y,n=3;n<e.length;n+=3)t+="C"+e[n-2].x+" "+e[n-2].y+" "+e[n-1].x+" "+e[n-1].y+" "+e[n].x+" "+e[n].y;return t}}(e.controls);o&&(a=r({d:o}))}break;case"arc":case"pie":o=function(e){function t(t){return j(e,t)}function n(t){return e[t]}j(e,"angle")||(e.angle=0);!j(e,"rx")&&j(e,"r1")&&(e.rx=e.r1);!j(e,"ry")&&j(e,"r2")&&(e.ry=e.r2);var r,i,a=["x1","y1","x2","y2","rx","ry","angle","largeArcFlag","sweepFlag"],o=["cx","cy","rx","ry","x1","y1","x2","y2"],s=["x1","y1","x2","y2","x3","y3"],c=["cx","cy","rx","ry","a1","a2","sweepFlag"],l=e.shapeType,d="pie"==l;if(a.every(t)){
i="A"+e.rx+" "+e.ry+" "+(e.angle||0)+" "+(e.largeArcFlag?1:0)+" "+(e.sweepFlag?1:0)+" "+e.x2+" "+e.y2;if(d){var u=Wa.arc.getCenterParam(e.x1,e.y1,e.x2,e.y2,e.largeArcFlag,e.sweepFlag,e.rx,e.ry,e.angle||0);u&&(i="M"+u.cx+" "+u.cy+"L"+e.x1+" "+e.y1+i+"Z")}else i="M"+e.x1+" "+e.y1+i}else if(o.every(t)){r=Wa.arc.getArcParams.apply(null,o.map(n));i="A"+e.rx+" "+e.ry+" 0 "+r.fa+" "+r.fs+" "+r.x2+" "+r.y2;i=d?"M"+e.cx+" "+e.cy+"L"+r.x1+" "+r.y1+i+"Z":"M"+r.x1+" "+r.y1+i}else if(s.every(t)){r=Wa.arc.getArcParamsBy3Points.apply(null,s.map(n));i="A"+r.r1+" "+r.r2+" "+r.angle+" "+r.largeArcFlag+" "+r.sweepFlag+" "+r.x+" "+r.y;i=d?"M"+r.cx+" "+r.cy+"L"+e.x1+" "+e.y1+i+"Z":"M"+e.x1+" "+e.y1+i}else if(c.every(t)){r=Wa.arc.getArcParamsByCRA.apply(null,c.map(n));i="A"+e.rx+" "+e.ry+" 0 "+r.fa+" "+r.fs+" "+r.x2+" "+r.y2;i=d?"M"+e.cx+" "+e.cy+"L"+r.x1+" "+r.y1+i+"Z":"M"+r.x1+" "+r.y1+i}return i}(e);o&&(a=r({d:o}));break;default:return}if(a){a.id||(a.id=Wa.newId());"text"!=s&&"image"!=s&&i(a,e);ha.updateOne(a);La.save(["add",a.id])}}}function Ui(e){var t=v(e.id);if(t&&e.svg&&b(t.parentNode,$a)){var n=e.id,r=t,i=Jt(e.svg);if(i){var a=m("*",r),o=m("*:not(.hitbox)",i);i.id=n;for(var s=0;s<o.length;s++)o[s].id=a[s]&&a[s].id||Wa.newId();r=r.parentNode.replaceChild(i,r);me(wo)&&"schlib"==de(i)&&Vt(i);ha.updateOne(i);La.save(["node",n,i.cloneNode(!0),r])}}}function Yi(){return function(){var e=[Ja._xaxis.name];for(var t in Ja.series)j(Ja.series,t)&&e.push(t);return e.join("\t")}()+"\n"+function(){var e=[],t=Ja._xaxis.data.length,n=[];for(var r in Ja.series)j(Ja.series,r)&&n.push(r);for(var i=0;i<t;i++){for(var a=[Ja._xaxis.data[i]],o=0,s=n.length;o<s;o++)a.push(Ja.series[n[o]].data[i]);e.push(a.join("\t"))}return e.join("\n")}()}!function(){function e(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,i,a,o;i=2147483648&e;a=2147483648&t;n=1073741824&e;r=1073741824&t;o=(1073741823&e)+(1073741823&t);return n&r?2147483648^o^i^a:n|r?1073741824&o?3221225472^o^i^a:1073741824^o^i^a:o^i^a}function r(e,t,n){return e&t|~e&n}function i(e,t,n){return e&n|t&~n}function a(e,t,n){return e^t^n}function o(e,t,n){return t^(e|~n)}function s(e,i,a,o,s,c,l){e=n(e,n(n(r(i,a,o),s),l));return n(t(e,c),i)}function c(e,r,a,o,s,c,l){e=n(e,n(n(i(r,a,o),s),l));return n(t(e,c),r)}function l(e,r,i,o,s,c,l){e=n(e,n(n(a(r,i,o),s),l));return n(t(e,c),r)}function d(e,r,i,a,s,c,l){e=n(e,n(n(o(r,i,a),s),l));return n(t(e,c),r)}function u(e){var t,n,r="",i="";for(n=0;n<=3;n++){t=e>>>8*n&255;i="0"+t.toString(16);r+=i.substr(i.length-2,2)}return r}var h,f,p,g,y,x,v,m,L,_=Array();e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128)t+=String.fromCharCode(r);else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(63&r|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(63&r|128)}}return t}(e);_=function(e){for(var t,n=e.length,r=n+8,i=(r-r%64)/64,a=16*(i+1),o=Array(a-1),s=0,c=0;c<n;){t=(c-c%4)/4;s=c%4*8;o[t]=o[t]|e.charCodeAt(c)<<s;c++}t=(c-c%4)/4;s=c%4*8;o[t]=o[t]|128<<s;o[a-2]=n<<3;o[a-1]=n>>>29;return o}(e);x=1732584193;v=4023233417;m=2562383102;L=271733878;for(h=0;h<_.length;h+=16){f=x;p=v;g=m;y=L;x=s(x,v,m,L,_[h+0],7,3614090360);L=s(L,x,v,m,_[h+1],12,3905402710);m=s(m,L,x,v,_[h+2],17,606105819);v=s(v,m,L,x,_[h+3],22,3250441966);x=s(x,v,m,L,_[h+4],7,4118548399);L=s(L,x,v,m,_[h+5],12,1200080426);m=s(m,L,x,v,_[h+6],17,2821735955);v=s(v,m,L,x,_[h+7],22,4249261313);x=s(x,v,m,L,_[h+8],7,1770035416);L=s(L,x,v,m,_[h+9],12,2336552879);m=s(m,L,x,v,_[h+10],17,4294925233);v=s(v,m,L,x,_[h+11],22,2304563134);x=s(x,v,m,L,_[h+12],7,1804603682);L=s(L,x,v,m,_[h+13],12,4254626195);m=s(m,L,x,v,_[h+14],17,2792965006);v=s(v,m,L,x,_[h+15],22,1236535329);x=c(x,v,m,L,_[h+1],5,4129170786);L=c(L,x,v,m,_[h+6],9,3225465664);m=c(m,L,x,v,_[h+11],14,643717713);v=c(v,m,L,x,_[h+0],20,3921069994);x=c(x,v,m,L,_[h+5],5,3593408605);L=c(L,x,v,m,_[h+10],9,38016083);m=c(m,L,x,v,_[h+15],14,3634488961);v=c(v,m,L,x,_[h+4],20,3889429448);x=c(x,v,m,L,_[h+9],5,568446438);L=c(L,x,v,m,_[h+14],9,3275163606);m=c(m,L,x,v,_[h+3],14,4107603335);v=c(v,m,L,x,_[h+8],20,1163531501);x=c(x,v,m,L,_[h+13],5,2850285829);L=c(L,x,v,m,_[h+2],9,4243563512);m=c(m,L,x,v,_[h+7],14,1735328473);v=c(v,m,L,x,_[h+12],20,2368359562);x=l(x,v,m,L,_[h+5],4,4294588738);L=l(L,x,v,m,_[h+8],11,2272392833);m=l(m,L,x,v,_[h+11],16,1839030562);v=l(v,m,L,x,_[h+14],23,4259657740);x=l(x,v,m,L,_[h+1],4,2763975236);L=l(L,x,v,m,_[h+4],11,1272893353);m=l(m,L,x,v,_[h+7],16,4139469664);v=l(v,m,L,x,_[h+10],23,3200236656);x=l(x,v,m,L,_[h+13],4,681279174);L=l(L,x,v,m,_[h+0],11,3936430074);m=l(m,L,x,v,_[h+3],16,3572445317);v=l(v,m,L,x,_[h+6],23,76029189);x=l(x,v,m,L,_[h+9],4,3654602809);L=l(L,x,v,m,_[h+12],11,3873151461);m=l(m,L,x,v,_[h+15],16,530742520);v=l(v,m,L,x,_[h+2],23,3299628645);x=d(x,v,m,L,_[h+0],6,4096336452);L=d(L,x,v,m,_[h+7],10,1126891415);m=d(m,L,x,v,_[h+14],15,2878612391);v=d(v,m,L,x,_[h+5],21,4237533241);x=d(x,v,m,L,_[h+12],6,1700485571);L=d(L,x,v,m,_[h+3],10,2399980690);m=d(m,L,x,v,_[h+10],15,4293915773);v=d(v,m,L,x,_[h+1],21,2240044497);x=d(x,v,m,L,_[h+8],6,1873313359);L=d(L,x,v,m,_[h+15],10,4264355552);m=d(m,L,x,v,_[h+6],15,2734768916);v=d(v,m,L,x,_[h+13],21,1309151649);x=d(x,v,m,L,_[h+4],6,4149444226);L=d(L,x,v,m,_[h+11],10,3174756917);m=d(m,L,x,v,_[h+2],15,718787259);v=d(v,m,L,x,_[h+9],21,3951481745);x=n(x,f);v=n(v,p);m=n(m,g);L=n(L,y)}return(u(x)+u(v)+u(m)+u(L)).toLowerCase()}function t(t){return t?e(t+"_^&!Aa1"):""}var n="undefined"!=typeof exports?exports:this;n.MD5=e;n.ourMD5=t}();!function(){"use strict";if(!("SVGPathSeg"in e)){e.SVGPathSeg=function(e,t,n){this.pathSegType=e;this.pathSegTypeAsLetter="z"==t?"Z":t;this._owningPathSegList=n};SVGPathSeg.prototype.classname="SVGPathSeg";SVGPathSeg.PATHSEG_UNKNOWN=0;SVGPathSeg.PATHSEG_CLOSEPATH=1;SVGPathSeg.PATHSEG_MOVETO_ABS=2;SVGPathSeg.PATHSEG_MOVETO_REL=3;SVGPathSeg.PATHSEG_LINETO_ABS=4;SVGPathSeg.PATHSEG_LINETO_REL=5;SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6;SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9;SVGPathSeg.PATHSEG_ARC_ABS=10;SVGPathSeg.PATHSEG_ARC_REL=11;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13;SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14;SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)};e.SVGPathSegClosePath=function(e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CLOSEPATH,"z",e)};SVGPathSegClosePath.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"};SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter};SVGPathSegClosePath.prototype.clone=function(){return new SVGPathSegClosePath(void 0)};e.SVGPathSegMovetoAbs=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_ABS,"M",e);this._x=t;this._y=n};SVGPathSegMovetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"};SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoAbs.prototype.clone=function(){return new SVGPathSegMovetoAbs(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegMovetoRel=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_REL,"m",e);this._x=t;this._y=n};SVGPathSegMovetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"};SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoRel.prototype.clone=function(){return new SVGPathSegMovetoRel(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoAbs=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_ABS,"L",e);this._x=t;this._y=n};SVGPathSegLinetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"};SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoAbs.prototype.clone=function(){return new SVGPathSegLinetoAbs(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoRel=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_REL,"l",e);this._x=t;this._y=n};SVGPathSegLinetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"};SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoRel.prototype.clone=function(){return new SVGPathSegLinetoRel(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicAbs=function(e,t,n,r,i,a,o){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",e);this._x=t;this._y=n;this._x1=r;this._y1=i;this._x2=a;this._y2=o};SVGPathSegCurvetoCubicAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"};SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicRel=function(e,t,n,r,i,a,o){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",e);this._x=t;this._y=n;this._x1=r;this._y1=i;this._x2=a;this._y2=o};SVGPathSegCurvetoCubicRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"};SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticAbs=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",e);this._x=t;this._y=n;this._x1=r;this._y1=i};SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"};SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticRel=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",e);this._x=t;this._y=n;this._x1=r;this._y1=i};SVGPathSegCurvetoQuadraticRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"};SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(e){this._x1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(e){this._y1=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegArcAbs=function(e,t,n,r,i,a,o,s){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_ABS,"A",e);this._x=t;this._y=n;this._r1=r;this._r2=i;this._angle=a;this._largeArcFlag=o;this._sweepFlag=s};SVGPathSegArcAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"};SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcAbs.prototype.clone=function(){return new SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(e){this._r1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(e){this._r2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(e){this._angle=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegArcRel=function(e,t,n,r,i,a,o,s){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_REL,"a",e);this._x=t;this._y=n;this._r1=r;this._r2=i;this._angle=a;this._largeArcFlag=o;this._sweepFlag=s};SVGPathSegArcRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"};SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcRel.prototype.clone=function(){return new SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(e){this._r1=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(e){this._r2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(e){this._angle=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(e){this._largeArcFlag=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(e){this._sweepFlag=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoHorizontalAbs=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",e);this._x=t};SVGPathSegLinetoHorizontalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"};SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new SVGPathSegLinetoHorizontalAbs(void 0,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoHorizontalRel=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",e);this._x=t};SVGPathSegLinetoHorizontalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"};SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new SVGPathSegLinetoHorizontalRel(void 0,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoVerticalAbs=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",e);this._y=t};SVGPathSegLinetoVerticalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"};SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new SVGPathSegLinetoVerticalAbs(void 0,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegLinetoVerticalRel=function(e,t){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",e);this._y=t};SVGPathSegLinetoVerticalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"};SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new SVGPathSegLinetoVerticalRel(void 0,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicSmoothAbs=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",e);this._x=t;this._y=n;this._x2=r;this._y2=i};SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"};SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoCubicSmoothRel=function(e,t,n,r,i){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",e);this._x=t;this._y=n;this._x2=r;this._y2=i};SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"};SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(e){this._x2=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(e){this._y2=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticSmoothAbs=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",e);this._x=t;this._y=n};SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"};SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});e.SVGPathSegCurvetoQuadraticSmoothRel=function(e,t,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",e);this._x=t;this._y=n};SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"};SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e;this._segmentChanged()},enumerable:!0});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e;this._segmentChanged()},enumerable:!0});SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new SVGPathSegClosePath(void 0)};SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(e,t){return new SVGPathSegMovetoAbs(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegMovetoRel=function(e,t){return new SVGPathSegMovetoRel(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(e,t){return new SVGPathSegLinetoAbs(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegLinetoRel=function(e,t){return new SVGPathSegLinetoRel(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(e,t,n,r,i,a){return new SVGPathSegCurvetoCubicAbs(void 0,e,t,n,r,i,a)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(e,t,n,r,i,a){return new SVGPathSegCurvetoCubicRel(void 0,e,t,n,r,i,a)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(e,t,n,r){return new SVGPathSegCurvetoQuadraticAbs(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(e,t,n,r){return new SVGPathSegCurvetoQuadraticRel(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegArcAbs=function(e,t,n,r,i,a,o){return new SVGPathSegArcAbs(void 0,e,t,n,r,i,a,o)};SVGPathElement.prototype.createSVGPathSegArcRel=function(e,t,n,r,i,a,o){return new SVGPathSegArcRel(void 0,e,t,n,r,i,a,o)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(e){return new SVGPathSegLinetoHorizontalAbs(void 0,e)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(e){return new SVGPathSegLinetoHorizontalRel(void 0,e)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(e){return new SVGPathSegLinetoVerticalAbs(void 0,e)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(e){return new SVGPathSegLinetoVerticalRel(void 0,e)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(e,t,n,r){return new SVGPathSegCurvetoCubicSmoothAbs(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(e,t,n,r){return new SVGPathSegCurvetoCubicSmoothRel(void 0,e,t,n,r)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(e,t){return new SVGPathSegCurvetoQuadraticSmoothAbs(void 0,e,t)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(e,t){return new SVGPathSegCurvetoQuadraticSmoothRel(void 0,e,t)};"getPathSegAtLength"in SVGPathElement.prototype||(SVGPathElement.prototype.getPathSegAtLength=function(e){if(void 0===e||!isFinite(e))throw"Invalid arguments.";var n=t.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",this.getAttribute("d"));var r=n.pathSegList.numberOfItems-1;if(r<=0)return 0;do{n.pathSegList.removeItem(r);if(e>n.getTotalLength())break;r--}while(r>0);return r})}if(!("SVGPathSegList"in e&&"appendItem"in e.SVGPathSegList.prototype)){e.SVGPathSegList=function(e){this._pathElement=e;this._list=this._parsePath(this._pathElement.getAttribute("d"));this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]};this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this));this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};SVGPathSegList.prototype.classname="SVGPathSegList";Object.defineProperty(SVGPathSegList.prototype,"numberOfItems",{get:function(){this._checkPathSynchronizedToList();return this._list.length},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"pathSegList",{get:function(){this._pathSegList||(this._pathSegList=new SVGPathSegList(this));return this._pathSegList},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0});Object.defineProperty(SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0});SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())};SVGPathSegList.prototype._updateListFromPathMutations=function(e){if(this._pathElement){var t=!1;e.forEach(function(e){"d"==e.attributeName&&(t=!0)});t&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}};SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect();this._pathElement.setAttribute("d",SVGPathSegList._pathSegArrayAsString(this._list));this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};SVGPathSegList.prototype.segmentChanged=function(e){this._writeListToPath()};SVGPathSegList.prototype.clear=function(){
this._checkPathSynchronizedToList();this._list.forEach(function(e){e._owningPathSegList=null});this._list=[];this._writeListToPath()};SVGPathSegList.prototype.initialize=function(e){this._checkPathSynchronizedToList();this._list=[e];e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList.prototype._checkValidIndex=function(e){if(isNaN(e)||e<0||e>=this.numberOfItems)throw"INDEX_SIZE_ERR"};SVGPathSegList.prototype.getItem=function(e){this._checkPathSynchronizedToList();this._checkValidIndex(e);return this._list[e]};SVGPathSegList.prototype.insertItemBefore=function(e,t){this._checkPathSynchronizedToList();t>this.numberOfItems&&(t=this.numberOfItems);e._owningPathSegList&&(e=e.clone());this._list.splice(t,0,e);e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList.prototype.replaceItem=function(e,t){this._checkPathSynchronizedToList();e._owningPathSegList&&(e=e.clone());this._checkValidIndex(t);this._list[t]=e;e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList.prototype.removeItem=function(e){this._checkPathSynchronizedToList();this._checkValidIndex(e);var t=this._list[e];this._list.splice(e,1);this._writeListToPath();return t};SVGPathSegList.prototype.appendItem=function(e){this._checkPathSynchronizedToList();e._owningPathSegList&&(e=e.clone());this._list.push(e);e._owningPathSegList=this;this._writeListToPath();return e};SVGPathSegList._pathSegArrayAsString=function(e){var t="",n=!0;e.forEach(function(e){if(n){n=!1;t+=e._asPathString()}else t+=" "+e._asPathString()});return t};SVGPathSegList.prototype._parsePath=function(e){if(!e||0==e.length)return[];var t=this,n=function(){this.pathSegList=[]};n.prototype.appendSegment=function(e){this.pathSegList.push(e)};var r=function(e){this._string=e;this._currentIndex=0;this._endIndex=this._string.length;this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN;this._skipOptionalSpaces()};r.prototype._isCurrentSpace=function(){var e=this._string[this._currentIndex];return e<=" "&&(" "==e||"\n"==e||"\t"==e||"\r"==e||"\f"==e)};r.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex};r.prototype._skipOptionalSpacesOrDelimiter=function(){if(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))return!1;if(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)){this._currentIndex++;this._skipOptionalSpaces()}return this._currentIndex<this._endIndex};r.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex};r.prototype.peekSegmentType=function(){var e=this._string[this._currentIndex];return this._pathSegTypeFromChar(e)};r.prototype._pathSegTypeFromChar=function(e){switch(e){case"Z":case"z":return SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return SVGPathSeg.PATHSEG_LINETO_REL;case"C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return SVGPathSeg.PATHSEG_ARC_ABS;case"a":return SVGPathSeg.PATHSEG_ARC_REL;case"H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return SVGPathSeg.PATHSEG_UNKNOWN}};r.prototype._nextCommandHelper=function(e,t){return("+"==e||"-"==e||"."==e||e>="0"&&e<="9")&&t!=SVGPathSeg.PATHSEG_CLOSEPATH?t==SVGPathSeg.PATHSEG_MOVETO_ABS?SVGPathSeg.PATHSEG_LINETO_ABS:t==SVGPathSeg.PATHSEG_MOVETO_REL?SVGPathSeg.PATHSEG_LINETO_REL:t:SVGPathSeg.PATHSEG_UNKNOWN};r.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return e==SVGPathSeg.PATHSEG_MOVETO_ABS||e==SVGPathSeg.PATHSEG_MOVETO_REL};r.prototype._parseNumber=function(){var e=0,t=0,n=1,r=0,i=1,a=1,o=this._currentIndex;this._skipOptionalSpaces();if(this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex))this._currentIndex++;else if(this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)){this._currentIndex++;i=-1}if(!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!=this._string.charAt(this._currentIndex))){for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=s)for(var c=this._currentIndex-1,l=1;c>=s;){t+=l*(this._string.charAt(c--)-"0");l*=10}if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){this._currentIndex++;if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";){n*=10;r+=(this._string.charAt(this._currentIndex)-"0")/n;this._currentIndex+=1}}if(this._currentIndex!=o&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){this._currentIndex++;if("+"==this._string.charAt(this._currentIndex))this._currentIndex++;else if("-"==this._string.charAt(this._currentIndex)){this._currentIndex++;a=-1}if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";){e*=10;e+=this._string.charAt(this._currentIndex)-"0";this._currentIndex++}}var d=t+r;d*=i;e&&(d*=Math.pow(10,a*e));if(o!=this._currentIndex){this._skipOptionalSpacesOrDelimiter();return d}}};r.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var e=!1,t=this._string.charAt(this._currentIndex++);if("0"==t)e=!1;else{if("1"!=t)return;e=!0}this._skipOptionalSpacesOrDelimiter();return e}};r.prototype.parseSegment=function(){var e=this._string[this._currentIndex],n=this._pathSegTypeFromChar(e);if(n==SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==SVGPathSeg.PATHSEG_UNKNOWN)return null;n=this._nextCommandHelper(e,this._previousCommand);if(n==SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;this._previousCommand=n;switch(n){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(t,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new SVGPathSegLinetoVerticalAbs(t,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:this._skipOptionalSpaces();return new SVGPathSegClosePath(t);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(t,r.x,r.y,r.x1,r.y1,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(t,r.x,r.y,r.x1,r.y1,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:var r={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(t,r.x,r.y,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:var r={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(t,r.x,r.y,r.x2,r.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(t,r.x,r.y,r.x1,r.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(t,r.x,r.y,r.x1,r.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(t,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:var r={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(t,r.x,r.y,r.x1,r.y1,r.arcAngle,r.arcLarge,r.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:var r={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(t,r.x,r.y,r.x1,r.y1,r.arcAngle,r.arcLarge,r.arcSweep);default:throw"Unknown path seg type."}};var i=new n,a=new r(e);if(!a.initialCommandIsMoveTo())return[];for(;a.hasMoreData();){var o=a.parseSegment();if(!o)return[];i.appendSegment(o)}return i.pathSegList}}}();SVGPathElement.prototype.getPathData&&SVGPathElement.prototype.setPathData||function(){function t(e,t){var n=o(e.getAttribute("d")||"");if(t&&t.normalize){return l(c(n))}return n}function n(e,t){var n="path"===e.tagName?"d":"points";if(0===t.length)a?e.setAttribute(n,""):e.removeAttribute(n);else{for(var r="",i=0,o=t.length;i<o;i+=1){var s=t[i];i>0&&(r+=" ");r+="d"===n?s.type:"";s.values&&(r+=("d"===n?" ":"")+s.values.join(" "))}e.setAttribute(n,r)}}var r={Z:"Z",M:"M",L:"L",C:"C",Q:"Q",A:"A",H:"H",V:"V",S:"S",T:"T",z:"Z",m:"m",l:"l",c:"c",q:"q",a:"a",h:"h",v:"v",s:"s",t:"t"},i=function(e){this._string=e;this._currentIndex=0;this._endIndex=this._string.length;this._prevCommand=null;this._skipOptionalSpaces()},a=-1!==e.navigator.userAgent.indexOf("MSIE ");i.prototype={parseSegment:function(){var e=this._string[this._currentIndex],t=r[e]?r[e]:null;if(null===t){if(null===this._prevCommand)return null;t=("+"===e||"-"===e||"."===e||e>="0"&&e<="9")&&"Z"!==this._prevCommand?"M"===this._prevCommand?"L":"m"===this._prevCommand?"l":this._prevCommand:null;if(null===t)return null}else this._currentIndex+=1;this._prevCommand=t;var n=null,i=t.toUpperCase();if("H"===i||"V"===i)n=[this._parseNumber()];else if("M"===i||"L"===i||"T"===i)n=[this._parseNumber(),this._parseNumber()];else if("S"===i||"Q"===i)n=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()];else if("C"===i)n=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseNumber()];else if("A"===i)n=[this._parseNumber(),this._parseNumber(),this._parseNumber(),this._parseArcFlag(),this._parseArcFlag(),this._parseNumber(),this._parseNumber()];else if("Z"===i){this._skipOptionalSpaces();n=[]}return null===n||n.indexOf(null)>=0?null:{type:t,values:n}},hasMoreData:function(){return this._currentIndex<this._endIndex},peekSegmentType:function(){var e=this._string[this._currentIndex];return r[e]?r[e]:null},initialCommandIsMoveTo:function(){if(!this.hasMoreData())return!0;var e=this.peekSegmentType();return"M"===e||"m"===e},_isCurrentSpace:function(){var e=this._string[this._currentIndex];return e<=" "&&(" "===e||"\n"===e||"\t"===e||"\r"===e||"\f"===e)},_skipOptionalSpaces:function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex+=1;return this._currentIndex<this._endIndex},_skipOptionalSpacesOrDelimiter:function(){if(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!==this._string[this._currentIndex])return!1;if(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","===this._string[this._currentIndex]){this._currentIndex+=1;this._skipOptionalSpaces()}return this._currentIndex<this._endIndex},_parseNumber:function(){var e=0,t=0,n=1,r=0,i=1,a=1,o=this._currentIndex;this._skipOptionalSpaces();if(this._currentIndex<this._endIndex&&"+"===this._string[this._currentIndex])this._currentIndex+=1;else if(this._currentIndex<this._endIndex&&"-"===this._string[this._currentIndex]){this._currentIndex+=1;i=-1}if(this._currentIndex===this._endIndex||(this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")&&"."!==this._string[this._currentIndex])return null;for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";)this._currentIndex+=1;if(this._currentIndex!==s)for(var c=this._currentIndex-1,l=1;c>=s;){t+=l*(this._string[c]-"0");c-=1;l*=10}if(this._currentIndex<this._endIndex&&"."===this._string[this._currentIndex]){this._currentIndex+=1;if(this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";){r+=(this._string[this._currentIndex]-"0")*(n*=.1);this._currentIndex+=1}}if(this._currentIndex!==o&&this._currentIndex+1<this._endIndex&&("e"===this._string[this._currentIndex]||"E"===this._string[this._currentIndex])&&"x"!==this._string[this._currentIndex+1]&&"m"!==this._string[this._currentIndex+1]){this._currentIndex+=1;if("+"===this._string[this._currentIndex])this._currentIndex+=1;else if("-"===this._string[this._currentIndex]){this._currentIndex+=1;a=-1}if(this._currentIndex>=this._endIndex||this._string[this._currentIndex]<"0"||this._string[this._currentIndex]>"9")return null;for(;this._currentIndex<this._endIndex&&this._string[this._currentIndex]>="0"&&this._string[this._currentIndex]<="9";){e*=10;e+=this._string[this._currentIndex]-"0";this._currentIndex+=1}}var d=t+r;d*=i;e&&(d*=Math.pow(10,a*e));if(o===this._currentIndex)return null;this._skipOptionalSpacesOrDelimiter();return d},_parseArcFlag:function(){if(this._currentIndex>=this._endIndex)return null;var e=0,t=this._string[this._currentIndex];this._currentIndex+=1;if("0"===t)e=0;else{if("1"!==t)return null;e=1}this._skipOptionalSpacesOrDelimiter();return e}};var o=function(e){if(!e||0===e.length)return[];var t=new i(e),n=[];if(t.initialCommandIsMoveTo())for(;t.hasMoreData();){var r=t.parseSegment();if(null===r)break;n.push(r)}return n},s=function(e,t,n,r,i,a,o,c,l,d){var u,h,f,p,g=function(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}},y=function(e){return Math.PI*e/180}(o),x=[];if(d){u=d[0];h=d[1];f=d[2];p=d[3]}else{var v=g(e,t,-y);e=v.x;t=v.y;var m=g(n,r,-y);n=m.x;r=m.y;var L=(e-n)/2,_=(t-r)/2,b=L*L/(i*i)+_*_/(a*a);if(b>1){b=Math.sqrt(b);i*=b;a*=b}var S;S=c===l?-1:1;var C=i*i,M=a*a,w=C*M-C*_*_-M*L*L,N=C*_*_+M*L*L,P=S*Math.sqrt(Math.abs(w/N));f=P*i*_/a+(e+n)/2;p=P*-a*L/i+(t+r)/2;u=Math.asin(((t-p)/a).toFixed(9));h=Math.asin(((r-p)/a).toFixed(9));e<f&&(u=Math.PI-u);n<f&&(h=Math.PI-h);u<0&&(u=2*Math.PI+u);h<0&&(h=2*Math.PI+h);l&&u>h&&(u-=2*Math.PI);!l&&h>u&&(h-=2*Math.PI)}var T=h-u;if(Math.abs(T)>120*Math.PI/180){var O=h,k=n,A=r;h=l&&h>u?u+120*Math.PI/180*1:u+120*Math.PI/180*-1;n=f+i*Math.cos(h);r=p+a*Math.sin(h);x=s(n,r,k,A,i,a,o,0,l,[h,O,f,p])}T=h-u;var E=Math.cos(u),I=Math.sin(u),j=Math.cos(h),B=Math.sin(h),D=Math.tan(T/4),F=4/3*i*D,R=4/3*a*D,V=[e,t],G=[e+F*I,t-R*E],z=[n+F*B,r-R*j],H=[n,r];G[0]=2*V[0]-G[0];G[1]=2*V[1]-G[1];if(d)return[G,z,H].concat(x);x=[G,z,H].concat(x).join().split(",");var U=[],Y=[];x.forEach(function(e,t){t%2?Y.push(g(x[t-1],x[t],y).y):Y.push(g(x[t],x[t+1],y).x);if(6===Y.length){U.push(Y);Y=[]}});return U},c=function(e){var t=[],n=null,r=null,i=null,a=null;e.forEach(function(e){var o=e.type;if("M"===o){var s=e.values[0],c=e.values[1];t.push({type:"M",values:[s,c]});i=s;a=c;n=s;r=c}else if("m"===o){var s=n+e.values[0],c=r+e.values[1];t.push({type:"M",values:[s,c]});i=s;a=c;n=s;r=c}else if("L"===o){var s=e.values[0],c=e.values[1];t.push({type:"L",values:[s,c]});n=s;r=c}else if("l"===o){var s=n+e.values[0],c=r+e.values[1];t.push({type:"L",values:[s,c]});n=s;r=c}else if("C"===o){var l=e.values[0],d=e.values[1],u=e.values[2],h=e.values[3],s=e.values[4],c=e.values[5];t.push({type:"C",values:[l,d,u,h,s,c]});n=s;r=c}else if("c"===o){var l=n+e.values[0],d=r+e.values[1],u=n+e.values[2],h=r+e.values[3],s=n+e.values[4],c=r+e.values[5];t.push({type:"C",values:[l,d,u,h,s,c]});n=s;r=c}else if("Q"===o){var l=e.values[0],d=e.values[1],s=e.values[2],c=e.values[3];t.push({type:"Q",values:[l,d,s,c]});n=s;r=c}else if("q"===o){var l=n+e.values[0],d=r+e.values[1],s=n+e.values[2],c=r+e.values[3];t.push({type:"Q",values:[l,d,s,c]});n=s;r=c}else if("A"===o){var s=e.values[5],c=e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,c]});n=s;r=c}else if("a"===o){var s=n+e.values[5],c=r+e.values[6];t.push({type:"A",values:[e.values[0],e.values[1],e.values[2],e.values[3],e.values[4],s,c]});n=s;r=c}else if("H"===o){var s=e.values[0];t.push({type:"H",values:[s]});n=s}else if("h"===o){var s=n+e.values[0];t.push({type:"H",values:[s]});n=s}else if("V"===o){var c=e.values[0];t.push({type:"V",values:[c]});r=c}else if("v"===o){var c=r+e.values[0];t.push({type:"V",values:[c]});r=c}else if("S"===o){var u=e.values[0],h=e.values[1],s=e.values[2],c=e.values[3];t.push({type:"S",values:[u,h,s,c]});n=s;r=c}else if("s"===o){var u=n+e.values[0],h=r+e.values[1],s=n+e.values[2],c=r+e.values[3];t.push({type:"S",values:[u,h,s,c]});n=s;r=c}else if("T"===o){var s=e.values[0],c=e.values[1];t.push({type:"T",values:[s,c]});n=s;r=c}else if("t"===o){var s=n+e.values[0],c=r+e.values[1];t.push({type:"T",values:[s,c]});n=s;r=c}else if("Z"===o||"z"===o){t.push({type:"Z",values:[]});n=i;r=a}});return t},l=function(e){var t=[],n=null,r=null,i=null,a=null,o=null,c=null,l=null;e.forEach(function(e){if("M"===e.type){var d=e.values[0],u=e.values[1];t.push({type:"M",values:[d,u]});c=d;l=u;a=d;o=u}else if("C"===e.type){var h=e.values[0],f=e.values[1],p=e.values[2],g=e.values[3],d=e.values[4],u=e.values[5];t.push({type:"C",values:[h,f,p,g,d,u]});r=p;i=g;a=d;o=u}else if("L"===e.type){var d=e.values[0],u=e.values[1];t.push({type:"L",values:[d,u]});a=d;o=u}else if("H"===e.type){var d=e.values[0];t.push({type:"L",values:[d,o]});a=d}else if("V"===e.type){var u=e.values[0];t.push({type:"L",values:[a,u]});o=u}else if("S"===e.type){var y,x,p=e.values[0],g=e.values[1],d=e.values[2],u=e.values[3];if("C"===n||"S"===n){y=a+(a-r);x=o+(o-i)}else{y=a;x=o}t.push({type:"C",values:[y,x,p,g,d,u]});r=p;i=g;a=d;o=u}else if("T"===e.type){var h,f,d=e.values[0],u=e.values[1];if("Q"===n||"T"===n){h=a+(a-r);f=o+(o-i)}else{h=a;f=o}var y=a+2*(h-a)/3,x=o+2*(f-o)/3,v=d+2*(h-d)/3,m=u+2*(f-u)/3;t.push({type:"C",values:[y,x,v,m,d,u]});r=h;i=f;a=d;o=u}else if("Q"===e.type){var h=e.values[0],f=e.values[1],d=e.values[2],u=e.values[3],y=a+2*(h-a)/3,x=o+2*(f-o)/3,v=d+2*(h-d)/3,m=u+2*(f-u)/3;t.push({type:"C",values:[y,x,v,m,d,u]});r=h;i=f;a=d;o=u}else if("A"===e.type){var L=e.values[0],_=e.values[1],b=e.values[2],S=e.values[3],C=e.values[4],d=e.values[5],u=e.values[6];if(0===L||0===_){t.push({type:"C",values:[a,o,d,u,d,u]});a=d;o=u}else if(a!==d||o!==u){var M=s(a,o,d,u,L,_,b,S,C);M.forEach(function(e){t.push({type:"C",values:e});a=d;o=u})}}else if("Z"===e.type){t.push(e);a=c;o=l}n=e.type});return t};SVGPathElement.prototype.getPathData=function(e){return t(this,e)};SVGPathElement.prototype.setPathData=function(e){n(this,e)};SVGPolylineElement.prototype.getPathData=function(e){var n=this.getAttribute("points")||"";return t(Wt("path",{d:n?"M"+n:""}),e)};SVGPolygonElement.prototype.getPathData=function(e){var n=this.getAttribute("points")||"";return t(Wt("path",{d:n?"M"+n:""}),e)};SVGPolylineElement.prototype.setPathData=function(e){n(this,e)};SVGPolygonElement.prototype.setPathData=function(e){n(this,e)}}();!function(){function e(e){this.message=e}var t="undefined"!=typeof exports?exports:this,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error;e.prototype.name="InvalidCharacterError";t.btoa||(t.btoa=function(t){for(var r,i,a=String(t),o=0,s=n,c="";a.charAt(0|o)||(s="=",o%1);c+=s.charAt(63&r>>8-o%1*8)){i=a.charCodeAt(o+=.75);if(i>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|i}return c});t.atob||(t.atob=function(t){var r=String(t).replace(/=+$/,"");if(r.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,a,o=0,s=0,c="";a=r.charAt(s++);~a&&(i=o%4?64*i+a:a,o++%4)?c+=String.fromCharCode(255&i>>(-2*o&6)):0)a=n.indexOf(a);return c})}();!function(e){var t=["concat","every","filter","forEach","includes","indexOf","lastIndexOf","map","pop","push","reduce","reduceRight","reverse","shift","slice","some","sort","splice","unshift"],n={};Array.prototype.toArray||(Array.prototype.toArray=function(){return this.slice()});for(var r=0;r<e.length;r++){e[r].toArray||(e[r].toArray=function(){return Array.prototype.slice.call(this)});for(var i=0;i<t.length;i++){var a=t[i];e[r][a]||(e[r][a]=function(e){return n[e]||(n[e]=function(){var t=this.toArray();return t[e].apply(t,arguments)})}(a))}}}([HTMLCollection.prototype,NodeList.prototype]);e.SVGElement&&!SVGElement.prototype.getTransformToElement&&(SVGElement.prototype.getTransformToElement=function(e){return e.getScreenCTM().inverse().multiply(this.getScreenCTM())});e.SVGElement&&!SVGElement.prototype.contains&&(SVGElement.prototype.contains=function(e){return(20&this.compareDocumentPosition(e))>0});!e.SVGElement||"children"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"children",{get:function(){for(var e=this.childNodes,t=e.length,n=[],r=0;r<t;r++)1===e[r].nodeType&&n.push(e[r]);return n}});!e.SVGElement||"outerHTML"in SVGElement.prototype||Object.defineProperty(SVGElement.prototype,"outerHTML",{get:function(){var e=this,t=(new XMLSerializer).serializeToString(e);"svg"!=e.tagName&&(t=t.replace(/ xmlns="http:\/\/www\.w3\.org\/2000\/svg"/g,""));return t}});!e.SVGSVGElement||"checkEnclosure"in SVGSVGElement.prototype||Object.defineProperties(SVGSVGElement.prototype,{getIntersectionList:{get:function(e,t){return[]}},getEnclosureList:{get:function(e,t){return[]}},checkIntersection:{get:function(e,t){return!1}},checkEnclosure:{get:function(e,t){return!1}}});!function(e){e.forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),n=t.createDocumentFragment();e.forEach(function(e){var r=e instanceof Node;n.appendChild(r?e:t.createTextNode(String(e)))});this.appendChild(n)}})})}([Element.prototype,Document.prototype,DocumentFragment.prototype]);!function(){function t(e,t){return e.hasOwnProperty(t)}var n="object"==typeof localStorage;if(n)try{var r="_"+Math.random();localStorage.setItem(r,"_");localStorage.removeItem(r)}catch(e){n=!1}if(!n){var i={},a={getItem:function(e){return t(i,e)?i[e]:null},setItem:function(e,t){i[e]=String(t)},removeItem:function(e){t(i,e)&&delete i[e]},clear:function(){for(var e in i)t(i,e)&&delete i[e]}};if("object"!=typeof localStorage)e.localStorage=a;else for(var o in a)t(a,o)&&(localStorage[o]=a[o])}}();String.prototype.codePointAt||function(){"use strict";var e=function(e){if(null===this)throw TypeError();var t=String(this),n=t.length,r=e?Number(e):0;r!=r&&(r=0);if(!(r<0||r>=n)){var i,a=t.charCodeAt(r);if(a>=55296&&a<=56319&&n>r+1){i=t.charCodeAt(r+1);if(i>=56320&&i<=57343)return 1024*(a-55296)+i-56320+65536}return a}};Object.defineProperty?Object.defineProperty(String.prototype,"codePointAt",{value:e,configurable:!0,writable:!0}):String.prototype.codePointAt=e}();String.fromCodePoint||function(){var e=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),t=String.fromCharCode,n=Math.floor,r=function(){var e,r,i=[],a=-1,o=arguments.length;if(!o)return"";for(var s="";++a<o;){var c=Number(arguments[a]);if(!isFinite(c)||c<0||c>1114111||n(c)!=c)throw RangeError("Invalid code point: "+c);if(c<=65535)i.push(c);else{c-=65536;e=55296+(c>>10);r=c%1024+56320;i.push(e,r)}if(a+1==o||i.length>16384){s+=t.apply(null,i);i.length=0}}return s};e?e(String,"fromCodePoint",{value:r,configurable:!0,writable:!0}):String.fromCodePoint=r}();Object.values||(Object.values=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t});"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(void 0!==i&&null!==i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},writable:!0,configurable:!0});Array.prototype.includes||(Array.prototype.includes=function(e,t){return this.indexOf(e,t)>=0});Array.prototype.flat||(Array.prototype.flat=function(){return this.reduce(function(e,t){return e.concat(t)},[])});!function(){function t(e,t){var n=[];t=t||4;A=[];e.forEach(function(e){n.push(new b(e[0],e[1]))});r(n,n.length,t);return A}function n(e,t){A.push(t)}function r(e,t,n){var r=new S,a=new S;r=f(e,0);a=p(e,t-1);i(e,0,t-1,r,a,n)}function i(e,t,r,s,c,l){var d,u,h,f,p,v,m=[],L=[],_=new S;p=l*l;f=r-t+1;if(2!==f){m=y(e,t,r);d=a(e,t,r,m,s,c);var b=x(e,t,r,d,m,h);u=b.maxError;h=b.splitPoint;if(u<l)n(3,d);else{if(u<p)for(v=0;v<4;v++){L=o(e,t,r,m,d);d=a(e,t,r,L,s,c);b=x(e,t,r,d,L,h);u=b.maxError;h=b.splitPoint;if(u<l){n(3,d);return}m=L}_=g(e,h);i(e,t,h,s,_,l);_=w(_);i(e,h,r,_,c,l)}}else{var C=k(e[r],e[t])/3;d=[];d[0]=e[t];d[3]=e[r];s=P(s,C);c=P(c,C);d[1]=T(d[0],s);d[2]=T(d[3],c);n(3,d)}}function a(e,t,n,r,i,a){var o,s,c,f,p,g,y,x,_=[],b=[[],[]],C=[],M=new S;x=[];s=n-t+1;for(o=0;o<s;o++){var w=new S(i.x,i.y),N=new S(a.x,a.y);w=P(w,d(r[o]));N=P(N,u(r[o]));_[o]=[];_[o][0]=w;_[o][1]=N}b[0][0]=0;b[0][1]=0;b[1][0]=0;b[1][1]=0;C[0]=0;C[1]=0;for(o=0;o<s;o++){b[0][0]+=O(_[o][0],_[o][0]);b[0][1]+=O(_[o][0],_[o][1]);b[1][0]=b[0][1];b[1][1]+=O(_[o][1],_[o][1]);M=L(e[t+o],v(m(e[t],l(r[o])),v(m(e[t],d(r[o])),v(m(e[n],u(r[o])),m(e[n],h(r[o]))))));C[0]+=O(_[o][0],M);C[1]+=O(_[o][1],M)}c=b[0][0]*b[1][1]-b[1][0]*b[0][1];f=b[0][0]*C[1]-b[1][0]*C[0];p=C[0]*b[1][1]-C[1]*b[0][1];g=0===c?0:p/c;y=0===c?0:f/c;var A=k(e[n],e[t]),E=1e-6*A;if(g<E||y<E){var I=A/3;x[0]=e[t];x[3]=e[n];x[1]=T(x[0],P(i,I));x[2]=T(x[3],P(a,I));return x}x[0]=e[t];x[3]=e[n];x[1]=T(x[0],P(i,g));x[2]=T(x[3],P(a,y));return x}function o(e,t,n,r,i){var a,o=[],c=[new b(i[0].x,i[0].y),new b(i[1].x,i[1].y),new b(i[2].x,i[2].y),new b(i[3].x,i[3].y)];for(a=t;a<=n;a++)o[a-t]=s(c,e[a],r[a-t]);return o}function s(e,t,n){var r,i,a,o,s=[new b,new b,new b],l=[new b,new b],d=new b,u=new b,h=new b,f=[new b(e[0].x,e[0].y),new b(e[1].x,e[1].y),new b(e[2].x,e[2].y),new b(e[3].x,e[3].y)],p=new b(t.x,t.y);d=c(3,f,n);for(o=0;o<=2;o++){s[o].x=3*(f[o+1].x-f[o].x);s[o].y=3*(f[o+1].y-f[o].y)}for(o=0;o<=1;o++){l[o].x=2*(s[o+1].x-s[o].x);l[o].y=2*(s[o+1].y-s[o].y)}u=c(2,s,n);h=c(1,l,n);r=(d.x-p.x)*u.x+(d.y-p.y)*u.y;i=u.x*u.x+u.y*u.y+(d.x-p.x)*h.x+(d.y-p.y)*h.y;if(0===i)return n;a=n-r/i;return a}function c(e,t,n){var r,i,a,o=[];for(r=0;r<=e;r++)o[r]=new b(t[r].x,t[r].y);for(r=1;r<=e;r++)for(i=0;i<=e-r;i++){o[i].x=(1-n)*o[i].x+n*o[i+1].x;o[i].y=(1-n)*o[i].y+n*o[i+1].y}a=new b(o[0].x,o[0].y);return a}function l(e){var t=1-e;return t*t*t}function d(e){var t=1-e;return 3*e*(t*t)}function u(e){return 3*e*e*(1-e)}function h(e){return e*e*e}function f(e,t){var n=new S;n=L(e[t+1],e[t]);n=N(n);return n}function p(e,t){var n=new S;n=L(e[t-1],e[t]);n=N(n);return n}function g(e,t){var n=new S,r=new S,i=new S;n=L(e[t-1],e[t]);r=L(e[t],e[t+1]);i.x=(n.x+r.x)/2;i.y=(n.y+r.y)/2;i=N(i);return i}function y(e,t,n){var r,i;i=[];i[0]=0;for(r=t+1;r<=n;r++)i[r-t]=i[r-t-1]+k(e[r],e[r-1]);for(r=t+1;r<=n;r++)i[r-t]=i[r-t]/i[n-t];return i}function x(e,t,n,r,i,a){var o,s,l,d=new b,u=new S;a=(n-t+1)/2;s=0;for(o=t+1;o<n;o++){d=c(3,r,i[o-t]);u=L(d,e[o]);l=C(u);if(l>=s){s=l;a=o}}return{maxError:s,splitPoint:a}}function v(e,t){var n=new S;n.x=e.x+t.x;n.y=e.y+t.y;return n}function m(e,t){var n=new S;n.x=e.x*t;n.y=e.y*t;return n}function L(e,t){var n=new S;n.x=e.x-t.x;n.y=e.y-t.y;return n}function _(e,t){this.x="number"==typeof e?e:0;this.y="number"==typeof t?t:0}function b(e,t){_.call(this,e,t)}function S(e,t){_.call(this,e,t)}function C(e){return e.x*e.x+e.y*e.y}function M(e){return Math.sqrt(C(e))}function w(e){var t=new b;t.x=-e.x;t.y=-e.y;return t}function N(e){var t=new b,n=M(e);if(0!==n){t.x=e.x/n;t.y=e.y/n}return t}function P(e,t){var n=new b,r=M(e);if(0!==r){n.x=e.x*t/r;n.y=e.y*t/r}return n}function T(e,t){var n=new b;n.x=e.x+t.x;n.y=e.y+t.y;return n}function O(e,t){return e.x*t.x+e.y*t.y}function k(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}var A=[];"undefined"!=typeof module?module.exports=t:e.polyline2bezier=t}();var Ji,Wi="6.4.14",Xi={0:0,90:1,180:0,270:-1},Qi={0:1,90:0,180:-1,270:0},Ki=[1,10,100,1e3],$i=function(){var e="http://www.w3.org/2000/svg",t="http://www.w3.org/1999/xlink",n="http://www.w3.org/XML/1998/namespace",r="https://easyeda.com/",i={svg:e,xlink:t,xml:n,c:r};i[e]="svg";i[t]="xlink";i[n]="xml";i[r]="c";return i}(),qi=0,Zi=1,ea=2,ta={A4L:{W:1169,H:827},A4P:{W:827,H:1169},A3L:{W:1654,H:1169},A3P:{W:1169,H:1654},A2L:{W:2339,H:1654},A2P:{W:1654,H:2339},A1L:{W:3311,H:2339},A1P:{W:2339,H:3311}},na=function(){var e,t={RATLINES:9,MODEL3D:19,ALL:11,TOPSILKLAYER:3,TOPLAYER:1,TOPPASTERLAYER:5,TOPSOLDERLAYER:7,ComponentShapeLayer:99,PADSURFACE:100,BOARDOUTLINE:10,DOCUMENT:12,TOPASSEMBLY:13,MECHANICAL:15,ComponentPolarityLayer:101,TOPCOMPONENT:16,SUBSTRATE:18};for(e=21;e<53;e++)t["INNER"+(e-20)]=e;t.BOTTOMSILKLAYER=4;t.BOTTOMLAYER=2;t.BOTTOMPASTERLAYER=6;t.BOTTOMSOLDERLAYER=8;t.BOTTOMASSEMBLY=14;t.BOTTOMCOMPONENT=17;for(e=53;e<85;e++)t["BOARD"+(e-52)]=e;return t}(),ra=(function(){var e={COPPERAREA:[1,2,21,22,23,24],PLANEZONE:[1,2,21,22,23,24],RECT:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,99],TRACK:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],PAD:[11,1,2],VIA:[11],HOLE:[11],TEXT:[3,4,1,2,7,8,12,13,14,15,21,22,23,24],ARC:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99],ELLIPSE:[3,4,12,13,14,15],CIRCLE:[1,2,3,4,5,6,7,8,10,12,13,14,15,21,22,23,24,99,100,101],DIMENSION:[3,4,12,13,14,15],FOOTPRINT:[1,2],SOLIDREGION:[1,2,3,4,5,6,7,8,12,13,14,15,21,22,23,24,11,99,100],SVGNODE:[1,2,3,4,7,8,12,13,14,15],PROTRACTOR:[3,4,12,13,14,15],SHEET:[12,13,14,15]};e["3D"]=function(){for(var e=[16,19,3,7,5,1],t=21;t<52;t++)e.push(t+32,t);e.push(2,6,8,4,17);return e}();var t,n,r;for(t in e)if(e.hasOwnProperty(t)){r=e[t];if(r.indexOf(21)>0&&-1===r.indexOf(25))for(n=25;n<=52;n++)r.push(n)}}(),function(){var e,t={1:"TopLayer",2:"BottomLayer",3:"TopSilkLayer",
4:"BottomSilkLayer",5:"TopPasteMaskLayer",6:"BottomPasteMaskLayer",7:"TopSolderMaskLayer",8:"BottomSolderMaskLayer",9:"Ratlines",10:"BoardOutLine",11:"Multi-Layer",12:"Document",13:"TopAssembly",14:"BottomAssembly",15:"Mechanical",16:"TopComponents",17:"BottomComponents",18:"Substrate",19:"3DModel",99:"ComponentShapeLayer",100:"LeadShapeLayer",101:"ComponentPolarityLayer"};for(e=21;e<53;e++)t[e]="Inner"+(e-20);for(e=53;e<85;e++)t[e]="Substrate"+(e-52);return t}()),ia=(function(){function e(e){if("string"!=typeof e||!e.match(/#?([\da-f]{6})/i))return e;var t=parseInt(RegExp.$1,16);return"#"+("00000"+((Math.min(255,Math.round(.5*(t>>16)))<<16)+(Math.min(255,Math.round(.5*(t>>8&255)))<<8)+Math.min(255,Math.round(.5*(255&t)))).toString(16)).substr(-6).toUpperCase()}var t=[],n=[];for(var r in na)if(na.hasOwnProperty(r)){if(r.match(/^BOARD\d+/))continue;t.push(na[r])}t.sort();n.sort();var i,a={},o={21:"#999966",22:"#008000",23:"#00FF00",24:"#BC8E00",25:"#70DBFA",26:"#00CC66",27:"#9966FF",28:"#800080",29:"#008080",30:"#15935F",31:"#000080",32:"#00B400",33:"#2E4756",34:"#99842F",35:"#FFFFAA",36:"#99842F",37:"#2E4756",38:"#3535FF",39:"#8000BC",40:"#43AE5F",41:"#C3ECCE",42:"#728978",43:"#39503F",44:"#0C715D",45:"#5A8A80",46:"#2B937E",47:"#23999D",48:"#45B4E3",49:"#215DA1",50:"#4564D7",51:"#6969E9",52:"#9069E9"};t.forEach(function(t){switch(t){case na.TOPLAYER:i={name:ra[t],color:"#FF0000",darkColor:"#CC0000",visible:!0,active:!0,config:!0};break;case na.BOTTOMLAYER:i={name:ra[t],color:"#0000FF",darkColor:"#000080",visible:!0,active:!1,config:!0};break;case na.TOPSILKLAYER:i={name:ra[t],color:"#FFCC00",darkColor:"#806600",visible:!0,active:!1,config:!0};break;case na.BOTTOMSILKLAYER:i={name:ra[t],color:"#66CC33",darkColor:"#33661A",visible:!0,active:!1,config:!0};break;case na.TOPPASTERLAYER:i={name:ra[t],color:"#808080",darkColor:"#666666",visible:!0,active:!1,config:!0};break;case na.BOTTOMPASTERLAYER:i={name:ra[t],color:"#800000",darkColor:"#660000",visible:!0,active:!1,config:!0};break;case na.TOPSOLDERLAYER:i={name:ra[t],color:"#800080",darkColor:"#660066",visible:!0,active:!1,transparency:.3,config:!0};break;case na.BOTTOMSOLDERLAYER:i={name:ra[t],color:"#AA00FF",darkColor:"#8800CC",visible:!0,active:!1,transparency:.3,config:!0};break;case na.RATLINES:i={name:ra[t],color:"#6464FF",darkColor:"#5050CC",visible:!1,active:!1,config:!0};break;case na.BOARDOUTLINE:i={name:ra[t],color:"#FF00FF",darkColor:"#CC00CC",visible:!0,active:!1,config:!0};break;case na.ALL:i={name:ra[t],color:"#C0C0C0",darkColor:"#999999",visible:!0,active:!1,config:!0};break;case na.DOCUMENT:i={name:ra[t],color:"#FFFFFF",darkColor:"#CCCCCC",visible:!0,active:!1,config:!0};break;case na.TOPASSEMBLY:i={name:ra[t],color:"#33CC99",darkColor:"#33AA99",visible:!1,active:!1,config:!1};break;case na.BOTTOMASSEMBLY:i={name:ra[t],color:"#5555FF",darkColor:"#8888FF",visible:!1,active:!1,config:!1};break;case na.MECHANICAL:i={name:ra[t],color:"#F022F0",darkColor:"#F088F0",visible:!1,active:!1,config:!1};break;case na.MODEL3D:i={name:ra[t],color:"#66CCFF",visible:!1,active:!1,config:!1};break;case na.ComponentShapeLayer:i={name:ra[t],color:"#00CCCC",visible:!1,active:!1,config:!1};break;case na.PADSURFACE:i={name:ra[t],color:"#CC9999",visible:!1,active:!1,config:!1};break;case na.ComponentPolarityLayer:i={name:ra[t],color:"#66FFCC",visible:!1,active:!1,config:!1};break;default:i=t>=na.INNER1&&t<=na.INNER32?{name:ra[t],color:o[t],darkColor:e(o[t]),visible:!1,active:!1,config:!1}:null}i&&(a[t]=i)});a.Hole={config:!0,name:"Hole",darkColor:"#222222",color:"#222222"};a.DRCError={config:!0,name:"DRCError",color:"#FAD609",darkColor:"#FAD609"}}(),{SCH:"1",SCHLIB:"2",PCB:"3",PCBLIB:"4",PRJ:"5",SUBPART:"6",SPICESYMBOL:"7",SUBCKT:"8",NETLIST:"9",WAVEFORM:"10",SCHLIB3D:"11",PHOTOVIEW:"12",SCHMODULE:"13",PCBMODULE:"14",VIEW3D:"15",PCBLIB3D:"16"}),aa=function(){var e,t={};for(e in ia)t[ia[e]]=e;return t}(),oa="~",sa="`",ca=200,la=function(){function e(e){_(e,o,!0);-1===a.indexOf(e)&&a.push(e);if("FOOTPRINT"===de(e)&&e.id){var t=v("shadow-"+e.id);t&&_(t,o,!0)}}function t(e){_(e,o,!1);b(e,s)&&_(e,s,!1);var t=a.indexOf(e);t>-1&&a.splice(t,1);var n=de(e);if("FOOTPRINT"===n&&e.id){var r=v("shadow-"+e.id);r&&e.parentNode&&_(r,o,!1)}if("TRACK"===n&&wa.moveRocord&&Ji.contains(wa.moveRocord)){Layer.appendElement(wa.moveRocord);wa.moveRocordNext&&wa.moveRocordNext.parentNode.insertBefore(item,wa.moveRocordNext);delete wa.moveRocord;delete wa.moveRocordNext}}function n(e){_(e,c,!0);if("FOOTPRINT"===de(e)&&e.id){var t=v("shadow-"+e.id);t&&_(t,c,!0)}}function r(e){_(e,c,!1);if("FOOTPRINT"===de(e)&&e.id){var t=v("shadow-"+e.id);t&&_(t,c,!1)}}function i(e){return e.id}var a=[],o="selected",s="designManager_selected",c="highlight",l=Object.create(null);return{count:function(){return a.length},highlightClass:c,selectClass:o,updateSelectedPoint:function(){l={x:Dn.data.currAbsX,y:Dn.data.currAbsY}},cycleSelectObj:function(){var e,t,n,r,i=this.get(),a=0,o=i.length&&i[0].id;if(1===i.length){e=ha.findObjectsByPoint(l,{precision:5});for(n=0;n<e.length;n+=1){e[n].gId===o&&(a=n===e.length-1?0:n+1);r=v(e[n].gId);r.parentNode.id===o&&"FOOTPRINT"===de(r.parentNode)&&"PAD"!==de(r)&&(a=n===e.length-1?0:n+1);r.parentNode.id===o&&"PAD"===de(r.parentNode)&&(a=n===e.length-1?0:n+1);if(a>n||n===e.length-1){r=v(e[a].gId);t="FOOTPRINT"===de(r.parentNode)&&"PAD"!==de(r)?r.parentNode:r;if(t.id!==o)break}}this.unselectAll();this.select(t);pa=t;yn();vn(t);pn("triggerEvent",["select_change"])}},select:function(t){if(t)if(1==t.nodeType)e(t);else if(t.length)for(var n=0,r=t.length;n<r;n++)e(t[n])},unselect:function(e){if(e)if(1==e.nodeType)t(e);else if(e.length)for(var n=0,r=e.length;n<r;n++)t(e[n])},highlight:function(e){if(e)if(1==e.nodeType)n(e);else if(e.length)for(var t=0,r=e.length;t<r;t++)n(e[t])},unhighlight:function(e){if(e)if(1==e.nodeType)r(e);else if(e.length)for(var t=0,n=e.length;t<n;t++)r(e[t])},toggleHighlight:function(e,t){if(e)if(1==e.nodeType)!0===t?n(e):!1===t&&r(e);else if(e.length)for(var i=0,a=e.length;i<a;i++)!0===t?n(e[i]):!1===t&&r(e[i])},isSelected:function(e){return a.indexOf(e)>=0},toggle:function(n,r){if(n){var i;if(1==n.nodeType){if(!0===r)e(n);else if(!1===r)t(n);else if(void 0===r){i=a.indexOf(n);i<0?e(n):t(n)}}else if(n.length)for(var o=0,s=n.length;o<s;o++)if(!0===r)e(n[o]);else if(!1===r)t(n[o]);else if(void 0===r){i=a.indexOf(n[o]);i<0?e(n[o]):t(n[o])}}},unselectAll:function(){for(var e=a.length-1;e>=0;e--)t(a[e]);a.length=0},get:function(){for(var e=a.length-1;e>=0;e--)a[e].parentNode||a.splice(e,1);return a},getIds:function(){return a.map(i)}}}(),da={src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA1MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB4PSIxIiB5PSIxIiB3aWR0aD0iNDgiIGhlaWdodD0iMzgiIGZpbGw9IiNGRkYiIHN0cm9rZT0iI0NDQyIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBvbHlsaW5lIHBvaW50cz0iMS41LDIzLDE2LDEzLDM0LDI2LDQ4LjUsMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI0NDQyIgc3Ryb2tlLXdpZHRoPSIyIi8+PGNpcmNsZSBjeD0iMzUiIGN5PSIxMiIgcj0iNCIgZmlsbD0iI0NDQyIgc3Ryb2tlPSJub25lIi8+PC9zdmc+",width:50,height:40},ua={data:{}},ha={dots:{},wires:{},junctions:{},gJsonCache:{head:{newgId:!0}},lastHoverWire:null},fa=t.getElementById("root"),pa=null,ga=[],ya=[],xa=[],va="",ma="",La={},_a={},ba={adsorbGrid:{visible:!0,gridSize:10,enabled:!0,distanceX:10,distanceY:10,altSnapSize:5},canvas:{originX:400,originY:300,strokeWidth:1,unit:"pixel",bgcolor:"#FFFFFF",fgcolor:"#000000"},colors:{}},Sa={_todoList:[],_historyList:{add:[],del:[]}},_a={},Ca={},Ma={_messageBarHeight:20,_paneTopPadding:30,_paneLeftPadding:70,_paneBottonPadding:35,_paneRightPadding:70,_width:null,_height:null,_paneHeight:0,isZoomViaSelectBox:!1,isDrawingSelectBox:!1},wa={fixedDecimal:!1,decimalPlaces:2,decimalPlacesShow:2,schDecimalPlaces:2,schDecimalPlacesShow:2,pcbDecimalPlaces:4,pcbDecimalPlacesShow:3,pcbServersFonts:["NotoSerifCJKsc-Medium","NotoSansCJKsc-DemiLight"],pcbFontsRegExp:/[^!"\\#\$%&'`\(\)\*\+,\-\.\/a-zA-z0-9:<;\=\?>@\[\]\^_\{\|\}~°\s\t\r\n]/,pcbNetTextVisible:!0,checkNotificationInterval:12e4,checkUpdateInterval:36e5,saveFileTimeout:3e5,autoSaveMaxCount:1e3,autoSaveMaxBackupLevel:10,autoGzipAjaxPostSize:1e4,cooperationSites:["elektroda","amobbs","allaboutcircuits","diyaudio","hifidiy","edaboard"],cushionShape:null,cushionShapeFor:null,fileOperationAPI:"/EditorBridge/fileOperation",svgFileAPI:"/EditorBridge/svgFile",treeDataAPI:"/EditorBridge/treeData",anonymousPid:"441bd07389f646ac82c8d1dbc45a6021",version:"V"+Wi,buildDate:"01/08/2021",lcscUUID:"0819f05c4eef4c71ace90d822a990e87",easyedaUUID:"4251c6ae97414f38bb1d929da02c4173",winWidth:e.innerWidth||t.documentElement.clientWidth,winHeight:e.innerHeight||t.documentElement.clientHeight,ignoreConfirmClose:!1,globalVariableCookieData:{},teams:[],needFixedTabUUid:!1,networkWarn:"Fail to connect to server! Please check your internet connection status and try again!",updatePcbFileInfo:[],repeatDeviceDomId:{},multiSelect:!1,copperNetRelation:{},isSaving:!1,pasteCount:0,pasteFrom:null,canvasStrTolerance:10,bugLog:{interval:3e5,lastSent:{}},logTypes:{BOM_EXPORT:1,BOM_LCSC:2,GERBER_DOWNLOAD:3,GERBER_JLC:4,ALTIUM_SCH:6,ALTIUM_SCHMODULE:6,ALTIUM_SCHLIB:7,ALTIUM_PCB:8,ALTIUM_PCBMODULE:8,ALTIUM_PCBLIB:9,OFFLINE_NEW_PROJECT:5,OFFLINE_BOM_EXPORT:10,OFFLINE_BOM_LCSC:11,OFFLINE_GERBER_DOWNLOAD:12,OFFLINE_GERBER_JLC:13,OFFLINE_ALTIUM_SCH:14,OFFLINE_ALTIUM_SCHMODULE:14,OFFLINE_ALTIUM_SCHLIB:15,OFFLINE_ALTIUM_PCB:16,OFFLINE_ALTIUM_PCBMODULE:16,OFFLINE_ALTIUM_PCBLIB:17},doctypeMaptoLogtype:{online:{1:"ALTIUM_SCH",2:"ALTIUM_SCHLIB",3:"ALTIUM_PCB",4:"ALTIUM_PCBLIB",13:"ALTIUM_SCHMODULE",14:"ALTIUM_PCBMODULE"},offline:{1:"OFFLINE_ALTIUM_SCH",2:"OFFLINE_ALTIUM_SCHLIB",3:"OFFLINE_ALTIUM_PCB",4:"OFFLINE_ALTIUM_PCBLIB",13:"OFFLINE_ALTIUM_SCHMODULE",14:"OFFLINE_ALTIUM_PCBMODULE"}},openedUuidsRecords:{lists:[]},apis:{projects:{create:"/api/projects/add",my_projects:"/api/projects",common:"/api/users/0819f05c4eef4c71ace90d822a990e87/public_project",update:"/api/projects/{uuid}/update",share:"/api/projects/{uuid}/share",stick:"/api/projects/{uuid}/stick",cancelStick:"/api/projects/{uuid}/unstick",addVersion:"/api/projects/{uuid}/version",showVersion:"/api/projects/{uuid}/version",toggleVersion:"/api/projects/{uuid}/version/{newUuid}/change",sheetOrder:"/api/projects/{uuid}/update_sort",fork:"/api/projects/{uuid}/fork",unStar:"/api/projects/{uuid}/unstar"},document:{create:"/api/documents/create",ajaxDetail:"/api/documents/{uuid}",schematics:"/api/projects/schematic",updateCanvas:"/api/documents/{uuid}/update_canvas",modify:"/api/documents/{uuid}/update",tag:"/api/histories/{uuid}",share:"/api/documents/{uuid}/share",duplicate:"/api/documents/{uuid}/copy",delete:"/api/documents/{uuid}/delete",simulation:"/api/documents/{uuid}/simulate",simulationv2:"/api/v2/documents/simulate",getSimModel:"/api/getSubcktModel",spiceNetlist:"/api/documents/{uuid}/spiceNetlist",simulatedSpice:"/api/documents/{uuid}/simulatedSpice",importThirdDocOrLibs:"/analyzer/api/convert/from/{from}/to/{to}",histories:"/api/documents/{uuid}/histories",datastrid:"/api/documents/{uuid}/datastrid"},components:{myComponents:"/api/user/component_tags",myModules:"/api/user/model_tags",ajaxLists:"/api/components",create:"/api/components/add",ajaxDetail:"/api/components/{uuid}",ajaxDetailByLcscId:"/api/products/{lcscid}/components",ajaxComponentInfo:"/api/components/componentInfo",updateCanvas:"/api/components/{uuid}/update_canvas",modify:"/api/components/{uuid}/update",delete:"/api/components/{uuid}/delete",duplicate:"/api/components/{uuid}/copy",subpart:"/api/components/{uuid}/add_subpart",contribute:"/api/components/contribute",getSubckt:"/api/components/getSubckt",updateSubckt:"/api/components/updateSubckt",search:"/api/components/search",searchByIds:"/api/components/searchByIds",searchByIdAndPre:"/api/components/searchByIdAndPre",searchPCBAndModules:"/api/components/search/PCBAndModules",packageDetail:"/api/components/packages",tags:"/api/components/tags",uuid:"/api/packages/uuid",reportError:"/api/components/{uuid}/report",sendErrorMessages:"/api/messages/send",getCanUseStockNum:"/api/component/getCanUseStockNum",customData:"/api/components/{uuid}/customData"},others:{bugReport:"/api/client/bugs",userInfo:"/api/user",getLcscPrice:"/api/getPrices",buyComponentFromLcsc:"/api/v1/buy",addFavorite:"/api/components/{uuid}/star",unFavorite:"/api/components/{uuid}/unstar",checkPackagesAvaliable:"/api/packagesExists",pcbOperate:"/api/PCB/operate",teams:"/api/teams",startPage:"/api/page/editor-start-page",startPage_new:"/api/page/editor-start-page-new",update_notice:"/api/page/system-update-notice",versionPage:"/api/page/editor-v",notification:"/api/notifications/unread-count",getVersion:"/version",getPackageNewestTitle:"/api/components/check-different",preference:"/api/user/preference",getPcbFabricationPrice:"/api/pcb_order/{uuid}/get_price",orderAtJLCPCB:"/api/pcb_order/{uuid}/save",gerberView:"/api/pcb_order/{uuid}/gerber_view",gerberDownloadStatistic:"/api/documents/{uuid}/download_gerber",postUserBehaviorData:"/api/data/postdata",getFontPath:"/api/getFontPath",gerberDialogShow:"/api/page/editor-gerber-dialog-show",bomDialogShow:"/api/page/editor-bom-dialog-show",organizations:"/api/org/getOrganizations",editorLog:"/api/editor/log"},disabledCmds:[],serverAjaxData:{},fileTabInfo:{}}},Na=function(){var e=location.hostname;return e.indexOf("lceda")>-1?"lceda":(e.indexOf("easyeda"),"easyeda")}(),Pa=!!t.querySelector('head meta[name="STATIC"][content="/editor/_src"]'),Ta=t.querySelector('head meta[name="STATIC"]').getAttribute("content");n.hooks={};n.wildcardHooks={};n.registerHook=function(e,t){if("string"==typeof e)if(e.indexOf("*")>=0){var r="^"+e.replace(/\*/g,".*")+"$";n.wildcardHooks[r]=t}else n.hooks[e]=t;else if(e instanceof RegExp)n.wildcardHooks[e]=t;else for(var i in e)j(e,i)&&n.registerHook(i,e[i])};var Oa,ka,Aa,Ea,Ia,ja,Ba=r("Mac OS")>0,Da=r("chromeframe")>0||r("x-clock")>0,Fa=(r("MSIE")>0||r("Trident")>=0)&&!Da,Ra=Fa&&r("MSIE 9.0")>0,Va=r("Edge/")>0,Ga=0===r("Opera/"),za=r("Firefox/")>0,Ha=(za&&navigator.userAgent.match(/Firefox\/(\d+(\.\d+)?)/)[1],r("AppleWebKit"),r("Chrome/")>0&&!Fa&&!Va&&!Ga&&!za),Ua=(Ha&&navigator.userAgent.match(/Chrome\/(\d+(\.\d+)?)/)[1],r("Safari/"),r("Electron/"),{getCacheObj:function(e){var t=B(ae("easyeda.preferences")||ae("preferences")||"{}");return t?t[e]:void 0}}),Ya={fileList:{}},Ja={},Wa={},Xa=null,Qa={on:!1,targets:null,bind:!1},Ka={},$a="shapeBox",qa=t.createDocumentFragment(),Za=1,eo=100,to=4;if(t.querySelector("#worker_main"))var no=new Worker(t.querySelector("#worker_main").value),ro=function(){no.terminate();no=new Worker(t.querySelector("#worker_main").value)};e.gClipboard=t.createDocumentFragment();e.easyeda={};e.callCommand=n
;var io='<?xml version="1.0" encoding="utf-8" standalone="no"?><svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>entry port pcb</title><g id="part(annotation)" c_partid="part_annotation" c_layer="" c_origin="0,0"><text x="0" y="0" font-family="simplex" font-size="12mm" fill="#FFFFFF" text-anchor="start" type="comment">Text</text></g><g id="part(pad)" c_partid="part_pad" c_type="pinpart" number="0" layerid="11" net="" c_origin="400,300" c_rotation="0" c_width="6" c_height="6" c_shape="ELLIPSE"><ellipse cx="400" cy="300" rx="3" ry="3" layerid="11" stroke="none" c_etype="pad_shell"/><circle cx="400" cy="300" r="1.8" layerid="11" stroke="none" c_etype="pad_hole"/></g><g id="part(via)" c_partid="part_via" c_type="pinpart" layerid="11" net="" c_origin="400,300"><circle cx="400" cy="300" r="1.2" stroke="none" c_etype="pad_shell"/><circle cx="400" cy="300" r="0.6" stroke="none" c_etype="pad_hole"/></g><g id="part(hole)" c_partid="part_hole" c_type="pinpart" layerid="11" c_origin="0,0"><path d="M-5,-5 L5,5 M-5,5 L5,-5" fill="none" stroke-width="0.8"/><circle cx="0" cy="0" r="4" stroke="none" /><ellipse cx="0" cy="0" rx="4" ry="4" stroke-width="0.5" fill="none" /></g><g id="part(pcbtext)" c_partid="part_pcbtext" c_origin="10,10" c_rotation="0" c_mirror="0"><path c_text="TEXT" c_fontsize="8" d="M 12.55 1.94L12.55 9.57 M 10 1.94L15.09 1.94 M 17.49 1.94L17.49 9.57 M 17.49 1.94L22.22 1.94 M 17.49 5.57L20.4 5.57 M 17.49 9.57L22.22 9.57 M 24.62 1.94L29.71 9.57 M 29.71 1.94L24.62 9.57 M 34.65 1.94L34.65 9.57 M 32.11 1.94L37.2 1.94 " fill="none" stroke-width="0.8"/></g><g id="part(lib_temp)" c_partid="part_lib_temp" c_origin="160,410" c_para="" c_shapetype="group" c_etype="pinpart" layerid="1"><g c_partid="part_pcbtext" c_origin="428.6,142.23046875" layerid="3"><path c_note="note_pre" c_fontsize="4.5" c_text="U2" d="M 217 133.55L217 136.61 L217.2 137.23 L217.61 137.64 L218.23 137.84 L218.64 137.84 L219.25 137.64 L219.66 137.23 L219.86 136.61 L219.86 133.55 M 221.62 133.55L223.87 133.55 L222.65 135.18 L223.26 135.18 L223.67 135.39 L223.87 135.59 L224.08 136.2 L224.08 136.61 L223.87 137.23 L223.46 137.64 L222.85 137.84 L222.24 137.84 L221.62 137.64 L221.42 137.43 L221.21 137.02" fill="none" stroke-width="0.7"/></g></g><g id="part(board_frame)" c_partid="part_board_frame" c_origin="160,410" c_para="" c_shapetype="group" c_etype="pinpart"></g><g id="part(lib_sheet)" c_origin="4574,3403" layerid="12" c_partid="part_sheet" display="none" c_shapetype="group" c_etype="pinpart"> <rect x="4000" y="3000" width="1149" height="806" stroke-width="1" fill="none" transform="" layerid="3"  c_etype="frame_outbox" locked="0" c_shapetype="line" class=""></rect> <rect x="4010" y="3010" width="1129" height="786" stroke-width="1" fill="none" transform="" layerid="3"  c_etype="frame_innerbox" locked="0" c_shapetype="line" ></rect> <rect x="4695" y="3716" width="444" height="80" stroke-width="1" fill="none" transform="" layerid="3"  c_etype="frame_hitarea" locked="0" c_shapetype="line"  class=""></rect> <g c_partid="part_pcbtext" c_origin="5021.5,3790.6" c_rotation="0" c_mirror="0"  locked="0" layerid="1" c_shapetype="group" c_etype="frame_drawn"><path c_fontsize="8" c_fontfamily="" fill="none" stroke-width="0.8" c_text="?" d="M5021.5,3787"></path></g> <g c_partid="part_pcbtext" c_origin="4860,3790.5" c_rotation="0" c_mirror="0"  locked="0" layerid="1" c_shapetype="group" c_etype="frame_date"><path c_fontsize="8" c_fontfamily="" c_text="?" d="M 4860.36 3784.8101 L 4860.36 3784.4501 L 4860.73 3783.7201 L 4861.09 3783.3601 L 4861.82 3783.0001 L 4863.27 3783.0001 L 4864 3783.3601 L 4864.36 3783.7201 L 4864.73 3784.4501 L 4864.73 3785.1801 L 4864.36 3785.9101 L 4863.64 3787.0001 L 4860 3790.6301 L 4865.09 3790.6301 M 4869.67 3783.0001 L 4868.58 3783.3601 L 4867.85 3784.4501 L 4867.49 3786.2701 L 4867.49 3787.3601 L 4867.85 3789.1801 L 4868.58 3790.2701 L 4869.67 3790.6301 L 4870.4 3790.6301 L 4871.49 3790.2701 L 4872.22 3789.1801 L 4872.58 3787.3601 L 4872.58 3786.2701 L 4872.22 3784.4501 L 4871.49 3783.3601 L 4870.4 3783.0001 L 4869.67 3783.0001 M 4874.98 3784.4501 L 4875.71 3784.0901 L 4876.8 3783.0001 L 4876.8 3790.6301 M 4883.93 3785.5401 L 4883.56 3786.6301 L 4882.84 3787.3601 L 4881.75 3787.7201 L 4881.38 3787.7201 L 4880.29 3787.3601 L 4879.56 3786.6301 L 4879.2 3785.5401 L 4879.2 3785.1801 L 4879.56 3784.0901 L 4880.29 3783.3601 L 4881.38 3783.0001 L 4881.75 3783.0001 L 4882.84 3783.3601 L 4883.56 3784.0901 L 4883.93 3785.5401 L 4883.93 3787.3601 L 4883.56 3789.1801 L 4882.84 3790.2701 L 4881.75 3790.6301 L 4881.02 3790.6301 L 4879.93 3790.2701 L 4879.56 3789.5401 M 4886.33 3787.3601 L 4892.87 3787.3601 M 4897.45 3783.0001 L 4896.36 3783.3601 L 4895.64 3784.4501 L 4895.27 3786.2701 L 4895.27 3787.3601 L 4895.64 3789.1801 L 4896.36 3790.2701 L 4897.45 3790.6301 L 4898.18 3790.6301 L 4899.27 3790.2701 L 4900 3789.1801 L 4900.36 3787.3601 L 4900.36 3786.2701 L 4900 3784.4501 L 4899.27 3783.3601 L 4898.18 3783.0001 L 4897.45 3783.0001 M 4903.49 3783.0001 L 4907.49 3783.0001 L 4905.31 3785.9101 L 4906.4 3785.9101 L 4907.13 3786.2701 L 4907.49 3786.6301 L 4907.85 3787.7201 L 4907.85 3788.4501 L 4907.49 3789.5401 L 4906.76 3790.2701 L 4905.67 3790.6301 L 4904.58 3790.6301 L 4903.49 3790.2701 L 4903.13 3789.9101 L 4902.76 3789.1801 M 4910.25 3787.3601 L 4916.8 3787.3601 M 4921.38 3783.0001 L 4920.29 3783.3601 L 4919.56 3784.4501 L 4919.2 3786.2701 L 4919.2 3787.3601 L 4919.56 3789.1801 L 4920.29 3790.2701 L 4921.38 3790.6301 L 4922.11 3790.6301 L 4923.2 3790.2701 L 4923.93 3789.1801 L 4924.29 3787.3601 L 4924.29 3786.2701 L 4923.93 3784.4501 L 4923.2 3783.3601 L 4922.11 3783.0001 L 4921.38 3783.0001 M 4931.05 3783.0001 L 4927.42 3783.0001 L 4927.05 3786.2701 L 4927.42 3785.9101 L 4928.51 3785.5401 L 4929.6 3785.5401 L 4930.69 3785.9101 L 4931.42 3786.6301 L 4931.78 3787.7201 L 4931.78 3788.4501 L 4931.42 3789.5401 L 4930.69 3790.2701 L 4929.6 3790.6301 L 4928.51 3790.6301 L 4927.42 3790.2701 L 4927.05 3789.9101 L 4926.69 3789.1801" fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="4891,3770" c_rotation="0" c_mirror="0" c_etype="frame_company"  locked="0" layerid="1" c_shapetype="group"><path c_fontsize="8" c_fontfamily="" c_text="Your Company" d="M 4891 3765.64 L 4893.91 3769.27 L 4893.91 3773.27 M 4896.82 3765.64 L 4893.91 3769.27 M 4901.04 3768.18 L 4900.31 3768.55 L 4899.58 3769.27 L 4899.22 3770.36 L 4899.22 3771.09 L 4899.58 3772.18 L 4900.31 3772.91 L 4901.04 3773.27 L 4902.13 3773.27 L 4902.85 3772.91 L 4903.58 3772.18 L 4903.95 3771.09 L 4903.95 3770.36 L 4903.58 3769.27 L 4902.85 3768.55 L 4902.13 3768.18 L 4901.04 3768.18 M 4906.35 3768.18 L 4906.35 3771.82 L 4906.71 3772.91 L 4907.44 3773.27 L 4908.53 3773.27 L 4909.25 3772.91 L 4910.35 3771.82 M 4910.35 3768.18 L 4910.35 3773.27 M 4912.75 3768.18 L 4912.75 3773.27 M 4912.75 3770.36 L 4913.11 3769.27 L 4913.84 3768.55 L 4914.56 3768.18 L 4915.65 3768.18 M 4929.11 3767.45 L 4928.75 3766.73 L 4928.02 3766 L 4927.29 3765.64 L 4925.84 3765.64 L 4925.11 3766 L 4924.38 3766.73 L 4924.02 3767.45 L 4923.65 3768.55 L 4923.65 3770.36 L 4924.02 3771.45 L 4924.38 3772.18 L 4925.11 3772.91 L 4925.84 3773.27 L 4927.29 3773.27 L 4928.02 3772.91 L 4928.75 3772.18 L 4929.11 3771.45 M 4933.33 3768.18 L 4932.6 3768.55 L 4931.87 3769.27 L 4931.51 3770.36 L 4931.51 3771.09 L 4931.87 3772.18 L 4932.6 3772.91 L 4933.33 3773.27 L 4934.42 3773.27 L 4935.15 3772.91 L 4935.87 3772.18 L 4936.24 3771.09 L 4936.24 3770.36 L 4935.87 3769.27 L 4935.15 3768.55 L 4934.42 3768.18 L 4933.33 3768.18 M 4938.64 3768.18 L 4938.64 3773.27 M 4938.64 3769.64 L 4939.73 3768.55 L 4940.45 3768.18 L 4941.55 3768.18 L 4942.27 3768.55 L 4942.64 3769.64 L 4942.64 3773.27 M 4942.64 3769.64 L 4943.73 3768.55 L 4944.45 3768.18 L 4945.55 3768.18 L 4946.27 3768.55 L 4946.64 3769.64 L 4946.64 3773.27 M 4949.04 3768.18 L 4949.04 3775.82 M 4949.04 3769.27 L 4949.76 3768.55 L 4950.49 3768.18 L 4951.58 3768.18 L 4952.31 3768.55 L 4953.04 3769.27 L 4953.4 3770.36 L 4953.4 3771.09 L 4953.04 3772.18 L 4952.31 3772.91 L 4951.58 3773.27 L 4950.49 3773.27 L 4949.76 3772.91 L 4949.04 3772.18 M 4960.16 3768.18 L 4960.16 3773.27 M 4960.16 3769.27 L 4959.44 3768.55 L 4958.71 3768.18 L 4957.62 3768.18 L 4956.89 3768.55 L 4956.16 3769.27 L 4955.8 3770.36 L 4955.8 3771.09 L 4956.16 3772.18 L 4956.89 3772.91 L 4957.62 3773.27 L 4958.71 3773.27 L 4959.44 3772.91 L 4960.16 3772.18 M 4962.56 3768.18 L 4962.56 3773.27 M 4962.56 3769.64 L 4963.65 3768.55 L 4964.38 3768.18 L 4965.47 3768.18 L 4966.2 3768.55 L 4966.56 3769.64 L 4966.56 3773.27 M 4969.33 3768.18 L 4971.51 3773.27 M 4973.69 3768.18 L 4971.51 3773.27 L 4970.78 3774.73 L 4970.05 3775.45 L 4969.33 3775.82 L 4968.96 3775.82" fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="5105,3741" c_rotation="0" c_mirror="0" c_etype="frame_version"  locked="0" layerid="1" c_shapetype="group"><path c_fontsize="8" c_fontfamily="" c_text="1.0" d="M 5105 3738.09 L 5105.73 3737.73 L 5106.82 3736.64 L 5106.82 3744.27 M 5109.58 3742.45 L 5109.22 3742.82 L 5109.58 3743.18 L 5109.95 3742.82 L 5109.58 3742.45 M 5114.53 3736.64 L 5113.44 3737 L 5112.71 3738.09 L 5112.35 3739.91 L 5112.35 3741 L 5112.71 3742.82 L 5113.44 3743.91 L 5114.53 3744.27 L 5115.25 3744.27 L 5116.35 3743.91 L 5117.07 3742.82 L 5117.44 3741 L 5117.44 3739.91 L 5117.07 3738.09 L 5116.35 3737 L 5115.25 3736.64 L 5114.53 3736.64" fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="4771.5,3741.86" c_rotation="0" c_mirror="0" c_etype="frame_title"  locked="0" layerid="1" c_shapetype="group"><path c_fontsize="8" c_fontfamily="" c_text="Sheet_1" d="M 4776.59 3738.59L4775.86 3737.86 L4774.77 3737.5 L4773.32 3737.5 L4772.23 3737.86 L4771.5 3738.59 L4771.5 3739.31 L4771.86 3740.04 L4772.23 3740.41 L4772.95 3740.77 L4775.14 3741.5 L4775.86 3741.86 L4776.23 3742.22 L4776.59 3742.95 L4776.59 3744.04 L4775.86 3744.77 L4774.77 3745.13 L4773.32 3745.13 L4772.23 3744.77 L4771.5 3744.04 M 4778.99 3737.5L4778.99 3745.13 M 4778.99 3741.5L4780.08 3740.41 L4780.81 3740.04 L4781.9 3740.04 L4782.63 3740.41 L4782.99 3741.5 L4782.99 3745.13 M 4785.39 3742.22L4789.75 3742.22 L4789.75 3741.5 L4789.39 3740.77 L4789.03 3740.41 L4788.3 3740.04 L4787.21 3740.04 L4786.48 3740.41 L4785.75 3741.13 L4785.39 3742.22 L4785.39 3742.95 L4785.75 3744.04 L4786.48 3744.77 L4787.21 3745.13 L4788.3 3745.13 L4789.03 3744.77 L4789.75 3744.04 M 4792.15 3742.22L4796.52 3742.22 L4796.52 3741.5 L4796.15 3740.77 L4795.79 3740.41 L4795.06 3740.04 L4793.97 3740.04 L4793.25 3740.41 L4792.52 3741.13 L4792.15 3742.22 L4792.15 3742.95 L4792.52 3744.04 L4793.25 3744.77 L4793.97 3745.13 L4795.06 3745.13 L4795.79 3744.77 L4796.52 3744.04 M 4800.01 3737.5L4800.01 3743.68 L4800.37 3744.77 L4801.1 3745.13 L4801.83 3745.13 M 4798.92 3740.04L4801.46 3740.04 M 4804.23 3747.68L4810.77 3747.68 M 4813.17 3738.95L4813.9 3738.59 L4814.99 3737.5 L4814.99 3745.13 " fill="none" stroke-width="0.8"></path></g> <polyline points="4695 3760 5139 3760" stroke-width="1" c_shapetype="line" stroke-linecap="round" fill="none" layerid="3" net="" locked="0"  class=""></polyline> <polyline points="4800 3777.5 5139 3777.4714" stroke-width="1" c_shapetype="line" stroke-linecap="round" fill="none" layerid="3" net="S$21" locked="0" ></polyline> <polyline points="4800 3760 4800 3796" stroke-width="1" c_shapetype="line" stroke-linecap="round" fill="none" layerid="3" net="" locked="0" ></polyline> <polyline points="5060 3760 5060 3716" stroke-width="1" c_shapetype="line" stroke-linecap="round" fill="none" layerid="3" net="S$21" locked="0" ></polyline> <polyline points="5060 3777.5 5060 3759.8049" stroke-width="1" c_shapetype="line" stroke-linecap="round" fill="none" layerid="3" net="S$21" locked="0" ></polyline> <g c_partid="part_pcbtext" c_origin="5065,3768.86" c_rotation="0" c_mirror="0"  locked="0" layerid="3" c_shapetype="group" ><path c_fontsize="8" c_fontfamily="" c_text="Sheet:" d="M 5070.09 3765.59L5069.36 3764.86 L5068.27 3764.5 L5066.82 3764.5 L5065.73 3764.86 L5065 3765.59 L5065 3766.31 L5065.36 3767.04 L5065.73 3767.41 L5066.45 3767.77 L5068.64 3768.5 L5069.36 3768.86 L5069.73 3769.22 L5070.09 3769.95 L5070.09 3771.04 L5069.36 3771.77 L5068.27 3772.13 L5066.82 3772.13 L5065.73 3771.77 L5065 3771.04 M 5072.49 3764.5L5072.49 3772.13 M 5072.49 3768.5L5073.58 3767.41 L5074.31 3767.04 L5075.4 3767.04 L5076.13 3767.41 L5076.49 3768.5 L5076.49 3772.13 M 5078.89 3769.22L5083.25 3769.22 L5083.25 3768.5 L5082.89 3767.77 L5082.53 3767.41 L5081.8 3767.04 L5080.71 3767.04 L5079.98 3767.41 L5079.25 3768.13 L5078.89 3769.22 L5078.89 3769.95 L5079.25 3771.04 L5079.98 3771.77 L5080.71 3772.13 L5081.8 3772.13 L5082.53 3771.77 L5083.25 3771.04 M 5085.65 3769.22L5090.02 3769.22 L5090.02 3768.5 L5089.65 3767.77 L5089.29 3767.41 L5088.56 3767.04 L5087.47 3767.04 L5086.75 3767.41 L5086.02 3768.13 L5085.65 3769.22 L5085.65 3769.95 L5086.02 3771.04 L5086.75 3771.77 L5087.47 3772.13 L5088.56 3772.13 L5089.29 3771.77 L5090.02 3771.04 M 5093.51 3764.5L5093.51 3770.68 L5093.87 3771.77 L5094.6 3772.13 L5095.33 3772.13 M 5092.42 3767.04L5094.96 3767.04 M 5098.09 3767.77L5097.73 3768.13 L5098.09 3768.5 L5098.45 3768.13 L5098.09 3767.77 M 5098.09 3770.31L5097.73 3770.68 L5098.09 3771.04 L5098.45 3770.68 L5098.09 3770.31 " fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="4950,3786.86" c_rotation="0" c_mirror="0" locked="0" layerid="3" c_shapetype="group" ><path c_fontsize="8" c_fontfamily="" c_text="Drawn By:" d="M 4950 3782.5001 L 4950 3790.1301 M 4950 3782.5001 L 4952.55 3782.5001 L 4953.64 3782.8601 L 4954.36 3783.5901 L 4954.73 3784.3101 L 4955.09 3785.4101 L 4955.09 3787.2201 L 4954.73 3788.3101 L 4954.36 3789.0401 L 4953.64 3789.7701 L 4952.55 3790.1301 L 4950 3790.1301 M 4957.49 3785.0401 L 4957.49 3790.1301 M 4957.49 3787.2201 L 4957.85 3786.1301 L 4958.58 3785.4101 L 4959.31 3785.0401 L 4960.4 3785.0401 M 4967.16 3785.0401 L 4967.16 3790.1301 M 4967.16 3786.1301 L 4966.44 3785.4101 L 4965.71 3785.0401 L 4964.62 3785.0401 L 4963.89 3785.4101 L 4963.16 3786.1301 L 4962.8 3787.2201 L 4962.8 3787.9501 L 4963.16 3789.0401 L 4963.89 3789.7701 L 4964.62 3790.1301 L 4965.71 3790.1301 L 4966.44 3789.7701 L 4967.16 3789.0401 M 4969.56 3785.0401 L 4971.02 3790.1301 M 4972.47 3785.0401 L 4971.02 3790.1301 M 4972.47 3785.0401 L 4973.93 3790.1301 M 4975.38 3785.0401 L 4973.93 3790.1301 M 4977.78 3785.0401 L 4977.78 3790.1301 M 4977.78 3786.5001 L 4978.87 3785.4101 L 4979.6 3785.0401 L 4980.69 3785.0401 L 4981.42 3785.4101 L 4981.78 3786.5001 L 4981.78 3790.1301 M 4989.78 3782.5001 L 4989.78 3790.1301 M 4989.78 3782.5001 L 4993.05 3782.5001 L 4994.15 3782.8601 L 4994.51 3783.2201 L 4994.87 3783.9501 L 4994.87 3784.6801 L 4994.51 3785.4101 L 4994.15 3785.7701 L 4993.05 3786.1301 M 4989.78 3786.1301 L 4993.05 3786.1301 L 4994.15 3786.5001 L 4994.51 3786.8601 L 4994.87 3787.5901 L 4994.87 3788.6801 L 4994.51 3789.4101 L 4994.15 3789.7701 L 4993.05 3790.1301 L 4989.78 3790.1301 M 4997.64 3785.0401 L 4999.82 3790.1301 M 5002 3785.0401 L 4999.82 3790.1301 L 4999.09 3791.5901 L 4998.36 3792.3101 L 4997.64 3792.6801 L 4997.27 3792.6801 M 5004.76 3785.7701 L 5004.4 3786.1301 L 5004.76 3786.5001 L 5005.13 3786.1301 L 5004.76 3785.7701 M 5004.76 3788.3101 L 5004.4 3788.6801 L 5004.76 3789.0401 L 5005.13 3788.6801 L 5004.76 3788.3101" fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="4810.5,3786.86" c_rotation="0" c_mirror="0" locked="0" layerid="3" c_shapetype="group" ><path c_fontsize="8" c_fontfamily="" c_text="Date:" d="M 4810.5 3782.5001 L 4810.5 3790.1301 M 4810.5 3782.5001 L 4813.05 3782.5001 L 4814.14 3782.8601 L 4814.86 3783.5901 L 4815.23 3784.3101 L 4815.59 3785.4101 L 4815.59 3787.2201 L 4815.23 3788.3101 L 4814.86 3789.0401 L 4814.14 3789.7701 L 4813.05 3790.1301 L 4810.5 3790.1301 M 4822.35 3785.0401 L 4822.35 3790.1301 M 4822.35 3786.1301 L 4821.63 3785.4101 L 4820.9 3785.0401 L 4819.81 3785.0401 L 4819.08 3785.4101 L 4818.35 3786.1301 L 4817.99 3787.2201 L 4817.99 3787.9501 L 4818.35 3789.0401 L 4819.08 3789.7701 L 4819.81 3790.1301 L 4820.9 3790.1301 L 4821.63 3789.7701 L 4822.35 3789.0401 M 4825.85 3782.5001 L 4825.85 3788.6801 L 4826.21 3789.7701 L 4826.94 3790.1301 L 4827.66 3790.1301 M 4824.75 3785.0401 L 4827.3 3785.0401 M 4830.06 3787.2201 L 4834.43 3787.2201 L 4834.43 3786.5001 L 4834.06 3785.7701 L 4833.7 3785.4101 L 4832.97 3785.0401 L 4831.88 3785.0401 L 4831.15 3785.4101 L 4830.43 3786.1301 L 4830.06 3787.2201 L 4830.06 3787.9501 L 4830.43 3789.0401 L 4831.15 3789.7701 L 4831.88 3790.1301 L 4832.97 3790.1301 L 4833.7 3789.7701 L 4834.43 3789.0401 M 4837.19 3785.7701 L 4836.83 3786.1301 L 4837.19 3786.5001 L 4837.55 3786.1301 L 4837.19 3785.7701 M 4837.19 3788.3101 L 4836.83 3788.6801 L 4837.19 3789.0401 L 4837.55 3788.6801 L 4837.19 3788.3101" fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="4810,3770" c_rotation="0" c_mirror="0" locked="0" layerid="3" c_shapetype="group" ><path c_fontsize="8" c_fontfamily="" c_text="Company:" d="M 4815.45 3767.45L4815.09 3766.73 L4814.36 3766 L4813.64 3765.64 L4812.18 3765.64 L4811.45 3766 L4810.73 3766.73 L4810.36 3767.45 L4810 3768.55 L4810 3770.36 L4810.36 3771.45 L4810.73 3772.18 L4811.45 3772.91 L4812.18 3773.27 L4813.64 3773.27 L4814.36 3772.91 L4815.09 3772.18 L4815.45 3771.45 M 4819.67 3768.18L4818.95 3768.55 L4818.22 3769.27 L4817.85 3770.36 L4817.85 3771.09 L4818.22 3772.18 L4818.95 3772.91 L4819.67 3773.27 L4820.76 3773.27 L4821.49 3772.91 L4822.22 3772.18 L4822.58 3771.09 L4822.58 3770.36 L4822.22 3769.27 L4821.49 3768.55 L4820.76 3768.18 L4819.67 3768.18 M 4824.98 3768.18L4824.98 3773.27 M 4824.98 3769.64L4826.07 3768.55 L4826.8 3768.18 L4827.89 3768.18 L4828.62 3768.55 L4828.98 3769.64 L4828.98 3773.27 M 4828.98 3769.64L4830.07 3768.55 L4830.8 3768.18 L4831.89 3768.18 L4832.62 3768.55 L4832.98 3769.64 L4832.98 3773.27 M 4835.38 3768.18L4835.38 3775.82 M 4835.38 3769.27L4836.11 3768.55 L4836.84 3768.18 L4837.93 3768.18 L4838.65 3768.55 L4839.38 3769.27 L4839.75 3770.36 L4839.75 3771.09 L4839.38 3772.18 L4838.65 3772.91 L4837.93 3773.27 L4836.84 3773.27 L4836.11 3772.91 L4835.38 3772.18 M 4846.51 3768.18L4846.51 3773.27 M 4846.51 3769.27L4845.78 3768.55 L4845.05 3768.18 L4843.96 3768.18 L4843.24 3768.55 L4842.51 3769.27 L4842.15 3770.36 L4842.15 3771.09 L4842.51 3772.18 L4843.24 3772.91 L4843.96 3773.27 L4845.05 3773.27 L4845.78 3772.91 L4846.51 3772.18 M 4848.91 3768.18L4848.91 3773.27 M 4848.91 3769.64L4850 3768.55 L4850.73 3768.18 L4851.82 3768.18 L4852.55 3768.55 L4852.91 3769.64 L4852.91 3773.27 M 4855.67 3768.18L4857.85 3773.27 M 4860.04 3768.18L4857.85 3773.27 L4857.13 3774.73 L4856.4 3775.45 L4855.67 3775.82 L4855.31 3775.82 M 4862.8 3768.91L4862.44 3769.27 L4862.8 3769.64 L4863.16 3769.27 L4862.8 3768.91 M 4862.8 3771.45L4862.44 3771.82 L4862.8 3772.18 L4863.16 3771.82 L4862.8 3771.45 " fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="5065.5,3741" c_rotation="0" c_mirror="0" locked="0" layerid="3" c_shapetype="group" ><path c_fontsize="8" c_fontfamily="" c_text="REV:" d="M 5065.5 3736.64L5065.5 3744.27 M 5065.5 3736.64L5068.77 3736.64 L5069.86 3737 L5070.23 3737.36 L5070.59 3738.09 L5070.59 3738.82 L5070.23 3739.55 L5069.86 3739.91 L5068.77 3740.27 L5065.5 3740.27 M 5068.05 3740.27L5070.59 3744.27 M 5072.99 3736.64L5072.99 3744.27 M 5072.99 3736.64L5077.72 3736.64 M 5072.99 3740.27L5075.9 3740.27 M 5072.99 3744.27L5077.72 3744.27 M 5080.12 3736.64L5083.03 3744.27 M 5085.94 3736.64L5083.03 3744.27 M 5088.7 3739.91L5088.34 3740.27 L5088.7 3740.64 L5089.06 3740.27 L5088.7 3739.91 M 5088.7 3742.45L5088.34 3742.82 L5088.7 3743.18 L5089.06 3742.82 L5088.7 3742.45 " fill="none" stroke-width="0.8"></path></g> <g c_partid="part_pcbtext" c_origin="4707.5,3731.86" c_rotation="0" c_mirror="0" locked="0" layerid="3" c_shapetype="group" ><path c_fontsize="8" c_fontfamily="" c_text="TITLE:" d="M 4710.05 3727.5001 L 4710.05 3735.1301 M 4707.5 3727.5001 L 4712.59 3727.5001 M 4714.99 3727.5001 L 4714.99 3735.1301 M 4719.94 3727.5001 L 4719.94 3735.1301 M 4717.39 3727.5001 L 4722.48 3727.5001 M 4724.88 3727.5001 L 4724.88 3735.1301 M 4724.88 3735.1301 L 4729.25 3735.1301 M 4731.65 3727.5001 L 4731.65 3735.1301 M 4731.65 3727.5001 L 4736.37 3727.5001 M 4731.65 3731.1301 L 4734.55 3731.1301 M 4731.65 3735.1301 L 4736.37 3735.1301 M 4739.14 3730.7701 L 4738.77 3731.1301 L 4739.14 3731.5001 L 4739.5 3731.1301 L 4739.14 3730.7701 M 4739.14 3733.3101 L 4738.77 3733.6801 L 4739.14 3734.0401 L 4739.5 3733.6801 L 4739.14 3733.3101" fill="none" stroke-width="0.8"></path></g> <path d="M 4710.4182 3769.4993 L 4709.3209 3769.708 L 4708.2286 3770.2267 L 4707.1363 3770.7455 L 4706.1505 3771.6676 L 4705.1648 3772.5897 L 4704.207 3772.5915 L 4703.2492 3772.5933 L 4702.461 3772.8031 C 4702.0276 3772.9185 4701.3512 3773.1673 4700.9581 3773.3559 L 4700.2433 3773.6989 L 4699.3013 3774.636 L 4698.3594 3775.573 L 4697.8735 3776.5988 L 4697.3876 3777.6247 L 4697.3876 3779.3604 L 4697.3876 3781.096 L 4697.9542 3782.243 L 4698.5208 3783.3899 L 4699.5074 3784.294 L 4700.4941 3785.198 L 4701.5335 3785.6058 L 4702.5729 3786.0136 L 4702.5729 3786.1507 C 4702.5729 3786.226 4702.7685 3786.5704 4703.0077 3786.916 L 4703.4425 3787.5443 L 4704.2605 3788.0361 L 4705.0784 3788.5279 L 4706.0513 3788.6187 L 4707.0241 3788.7096 L 4707.8625 3788.4659 L 4708.7008 3788.2221 L 4709.4576 3787.5417 L 4710.2144 3786.8613 L 4710.5268 3786.216 L 4710.8392 3785.5706 L 4710.8392 3785.0456 L 4710.8392 3784.5206 L 4711.0271 3784.2784 L 4711.2149 3784.0361 L 4714.033 3782.5834 C 4715.5829 3781.7844 4716.8511 3781.1066 4716.8511 3781.0772 C 4716.8511 3781.0329 4715.6937 3779.117 4715.545 3778.9151 C 4715.5198 3778.8809 4714.2221 3779.4727 4712.6613 3780.2302 C 4711.1005 3780.9877 4709.7559 3781.6075 4709.6734 3781.6075 C 4709.5909 3781.6075 4709.4305 3781.4953 4709.3171 3781.3582 C 4709.2036 3781.221 4708.7726 3780.9511 4708.3593 3780.7584 L 4707.6078 3780.4081 L 4706.6157 3780.4066 L 4705.6237 3780.4052 L 4705.1128 3780.5793 C 4704.8318 3780.6751 4704.3064 3780.9544 4703.9451 3781.2001 L 4703.2884 3781.6467 L 4702.8931 3782.2987 C 4702.6756 3782.6573 4702.4523 3782.9528 4702.3967 3782.9554 C 4702.3411 3782.9581 4702.003 3782.738 4701.6452 3782.4664 L 4700.9948 3781.9726 L 4700.5624 3781.1712 L 4700.1301 3780.3698 L 4700.1233 3779.4481 L 4700.1164 3778.5264 L 4700.424 3777.8501 L 4700.7315 3777.1738 L 4701.2389 3776.6625 L 4701.7462 3776.1513 L 4702.4977 3775.7998 L 4703.2492 3775.4483 L 4704.2513 3775.4468 L 4705.2533 3775.4454 L 4705.9176 3775.7301 L 4706.582 3776.0149 L 4706.7546 3775.5423 C 4706.8495 3775.2823 4707.2226 3774.6976 4707.5837 3774.243 L 4708.2403 3773.4164 L 4709.0544 3772.9304 L 4709.8685 3772.4445 L 4710.8932 3772.1917 L 4711.9179 3771.9388 L 4713.0348 3772.1124 L 4714.1517 3772.2861 L 4714.7875 3772.6063 C 4715.1371 3772.7825 4715.7149 3773.1631 4716.0713 3773.4521 L 4716.7193 3773.9777 L 4717.0859 3774.5584 C 4717.2875 3774.8778 4717.5963 3775.5772 4717.772 3776.1125 L 4718.0916 3777.0859 L 4718.7864 3777.1872 L 4719.4813 3777.2884 L 4720.0073 3777.5555 C 4720.2966 3777.7024 4720.7282 3778.0277 4720.9664 3778.2785 L 4721.3995 3778.7344 L 4721.5967 3779.4946 L 4721.7939 3780.2549 L 4721.5967 3781.0151 L 4721.3995 3781.7753 L 4720.9664 3782.2309 C 4720.7282 3782.4814 4720.3304 3782.7958 4720.0824 3782.9294 L 4719.6316 3783.1724 L 4717.8507 3783.257 L 4716.0699 3783.3416 L 4715.6338 3783.8296 L 4715.1978 3784.3176 L 4715.1978 3784.7777 L 4715.1978 3785.2378 L 4715.6371 3785.6771 L 4716.0765 3786.1164 L 4717.7097 3786.1164 L 4719.343 3786.1164 L 4720.1893 3785.896 C 4721.2317 3785.6245 4721.8047 3785.2836 4722.7341 3784.382 L 4723.4542 3783.6834 L 4723.8064 3783.0533 C 4724.0001 3782.7068 4724.2477 3782.1047 4724.3567 3781.7154 L 4724.5549 3781.0077 L 4724.4848 3779.8422 L 4724.4147 3778.6767 L 4723.9557 3777.775 L 4723.4967 3776.8732 L 4722.6162 3776.0431 L 4721.7357 3775.213 L 4721.1057 3774.9346 L 4720.4757 3774.6561 L 4719.9126 3773.6931 L 4719.3494 3772.7301 L 4718.5514 3771.946 L 4717.7535 3771.1619 L 4716.8161 3770.5934 L 4715.8787 3770.025 L 4714.8995 3769.7208 L 4713.9203 3769.4167 L 4712.7179 3769.3536 L 4711.5155 3769.2905 L 4710.4182 3769.4993 M 4735.9401 3770.5254 L 4735.5657 3770.7186 L 4735.5209 3771.0154 C 4735.4963 3771.1786 4735.4437 3771.4644 4735.404 3771.6504 L 4735.3318 3771.9885 L 4732.4212 3771.9885 L 4729.5106 3771.9885 L 4729.4064 3772.8231 L 4729.3021 3773.6577 L 4729.4826 3773.8752 L 4729.6631 3774.0927 L 4736.0813 3774.0927 L 4742.4994 3774.0927 L 4742.8038 3773.7545 C 4742.9713 3773.5685 4743.1549 3773.3338 4743.2119 3773.2329 L 4743.3156 3773.0494 L 4743.0896 3772.6124 L 4742.8635 3772.1753 L 4742.6202 3772.0819 L 4742.3769 3771.9885 L 4739.98 3771.9885 L 4737.583 3771.9885 L 4737.6251 3771.1995 L 4737.6672 3770.4104 L 4736.9908 3770.3713 L 4736.3145 3770.3323 L 4735.9401 3770.5254 M 4748.5997 3770.7848 C 4748.2475 3770.8599 4747.753 3771.0431 4747.5008 3771.1919 L 4747.0423 3771.4625 L 4745.9243 3773.2055 L 4744.8063 3774.9485 L 4744.8063 3775.256 L 4744.8063 3775.5635 L 4745.044 3775.6547 C 4745.1748 3775.7049 4745.6103 3775.746 4746.0118 3775.746 L 4746.7419 3775.746 L 4747.5992 3774.3557 C 4748.0706 3773.5911 4748.5313 3772.9145 4748.6228 3772.8522 L 4748.7891 3772.7388 L 4750.2151 3772.777 L 4751.641 3772.8152 L 4752.0924 3774.2806 L 4752.5439 3775.746 L 4753.3987 3775.746 L 4754.2535 3775.746 L 4754.4763 3775.5231 L 4754.6991 3775.3003 L 4754.2099 3773.6537 L 4753.7206 3772.0072 L 4753.46 3771.6096 L 4753.1995 3771.2119 L 4752.6732 3770.992 L 4752.1469 3770.7721 L 4750.6934 3770.7102 L 4749.24 3770.6482 L 4748.5997 3770.7848 M 4758.5772 3770.9061 C 4758.5364 3770.9721 4758.4253 3771.6315 4758.3302 3772.3715 C 4758.2351 3773.1115 4758.0322 3774.6638 4757.8793 3775.8211 C 4757.7264 3776.9784 4757.4466 3779.1359 4757.2575 3780.6156 L 4756.9137 3783.3059 L 4756.7108 3783.5088 L 4756.5079 3783.7117 L 4755.5752 3783.7117 L 4754.6424 3783.7117 L 4754.3084 3783.9457 L 4753.9744 3784.1796 L 4753.9744 3784.6913 L 4753.9744 3785.2029 L 4754.3125 3785.5214 L 4754.6507 3785.8399 L 4755.8531 3785.7903 L 4757.0554 3785.7407 L 4757.7188 3785.2898 L 4758.3821 3784.8389 L 4758.6584 3784.3032 L 4758.9347 3783.7675 L 4759.7775 3777.5033 L 4760.6204 3771.2392 L 4760.5335 3771.0127 L 4760.4466 3770.7862 L 4759.5489 3770.7862 L 4758.6513 3770.7862 L 4758.5772 3770.9061 M 4763.0075 3777.5871 C 4762.4931 3781.2449 4762.0349 3784.4575 4761.9894 3784.7262 L 4761.9066 3785.2147 L 4766.2873 3785.2147 L 4770.6679 3785.2147 L 4771.0271 3784.9793 L 4771.3863 3784.7439 L 4771.542 3784.2973 L 4771.6977 3783.8507 L 4771.5705 3783.5182 C 4771.5005 3783.3353 4771.2933 3783.0504 4771.1101 3782.8851 L 4770.7769 3782.5845 L 4768.0117 3782.5376 L 4765.2466 3782.4907 L 4765.2451 3782.3873 C 4765.2443 3782.3304 4765.3589 3781.5568 4765.4997 3780.6682 L 4765.7558 3779.0525 L 4768.3617 3779.0525 L 4770.9675 3779.0525 L 4771.4767 3778.8398 L 4771.9858 3778.627 L 4772.1482 3778.3236 C 4772.2375 3778.1567 4772.3106 3777.8504 4772.3106 3777.6429 L 4772.3106 3777.2657 L 4771.9482 3776.844 L 4771.5858 3776.4223 L 4768.8671 3776.3752 L 4766.1484 3776.3282 L 4766.1598 3776.1498 C 4766.1661 3776.0517 4766.2527 3775.4642 4766.3523 3774.8442 L 4766.5333 3773.717 L 4769.5347 3773.6338 C 4771.1854 3773.588 4772.5503 3773.5373 4772.5677 3773.521 C 4772.5852 3773.5048 4772.7374 3773.3435 4772.9059 3773.1626 L 4773.2123 3772.8336 L 4773.2123 3772.2536 L 4773.2123 3771.6736 L 4772.8147 3771.305 L 4772.417 3770.9365 L 4768.1799 3770.9365 L 4763.9427 3770.9365 L 4763.0075 3777.5871 M 4775.4152 3771.0492 C 4775.377 3771.1112 4775.3012 3771.5001 4775.2466 3771.9134 C 4775.1921 3772.3267 4775.0156 3773.6117 4774.8545 3774.769 C 4774.0394 3780.6215 4773.5129 3784.5921 4773.5129 3784.8866 L 4773.5129 3785.2147 L 4776.5057 3785.2147 L 4779.4984 3785.2147 L 4780.6239 3784.9993 L 4781.7494 3784.784 L 4782.5072 3784.3999 L 4783.2651 3784.0159 L 4784.0726 3783.225 L 4784.8802 3782.4342 L 4785.4228 3781.3464 L 4785.9655 3780.2586 L 4786.1454 3779.3925 L 4786.3253 3778.5264 L 4786.2525 3777.2467 L 4786.1796 3775.967 L 4785.6447 3774.8093 L 4785.1099 3773.6516 L 4784.3806 3772.9223 L 4783.6514 3772.1931 L 4782.8078 3771.794 L 4781.9642 3771.3949 L 4780.6497 3771.1657 L 4779.3351 3770.9365 L 4777.4098 3770.9365 L 4775.4845 3770.9365 L 4775.4152 3771.0492 M 4792.6437 3771.2746 C 4792.5645 3771.378 4792.2421 3771.9359 4791.9273 3772.5146 C 4791.6125 3773.0932 4789.9444 3776.0794 4788.2204 3779.1506 C 4786.4963 3782.2218 4785.0858 3784.8088 4785.0858 3784.8995 L 4785.0858 3785.0644 L 4786.5651 3785.0644 L 4788.0444 3785.0644 L 4788.8372 3783.6333 L 4789.63 3782.2022 L 4792.4211 3782.243 L 4795.2123 3782.2839 L 4795.4177 3783.1105 C 4795.5307 3783.5651 4795.6896 3784.1908 4795.7709 3784.5007 L 4795.9187 3785.0644 L 4797.2656 3785.0644 L 4798.6125 3785.0644 L 4798.6125 3784.8366 C 4798.6125 3784.4694 4796.9287 3777.7877 4796.8001 3777.6443 L 4796.6828 3777.5136 L 4795.8763 3777.9751 L 4795.0697 3778.4365 L 4794.8028 3779.0415 L 4794.5359 3779.6464 L 4794.0873 3779.9659 L 4793.6386 3780.2853 L 4793.0767 3780.3607 L 4792.5147 3780.4361 L 4791.9763 3780.2111 L 4791.4379 3779.9862 L 4791.0173 3779.4347 L 4790.5967 3778.8833 L 4790.5967 3778.2372 L 4790.5967 3777.5911 L 4790.9342 3777.1172 L 4791.2717 3776.6432 L 4791.7217 3776.4105 L 4792.1718 3776.1777 L 4792.7632 3776.1695 L 4793.3545 3776.1614 L 4793.7823 3776.3386 L 4794.2102 3776.5158 L 4795.2089 3775.9668 C 4795.7583 3775.6648 4796.2077 3775.3855 4796.2077 3775.3461 C 4796.2077 3775.2774 4795.6 3772.8249 4795.2919 3771.6504 L 4795.1441 3771.0868 L 4793.9659 3771.0868 L 4792.7877 3771.0868 L 4792.6437 3771.2746 M 4755.7087 3772.477 C 4755.6045 3772.8044 4754.4059 3780.9786 4754.3924 3781.454 L 4754.3795 3781.909 L 4754.6511 3782.2092 L 4754.9227 3782.5093 L 4755.4022 3782.5093 L 4755.8816 3782.5093 L 4756.1432 3782.2203 L 4756.4048 3781.9313 L 4757.0683 3777.3106 C 4757.4332 3774.7692 4757.7318 3772.5998 4757.7318 3772.4895 L 4757.7318 3772.2891 L 4756.7501 3772.2891 L 4755.7685 3772.2891 L 4755.7087 3772.477 M 4781.0045 3774.1 L 4781.7041 3774.4094 L 4782.1312 3774.8147 C 4782.3661 3775.0376 4782.6975 3775.4905 4782.8676 3775.8211 L 4783.177 3776.4223 L 4783.2473 3777.4026 L 4783.3177 3778.383 L 4783.1429 3779.2062 L 4782.9681 3780.0294 L 4782.5554 3780.629 L 4782.1427 3781.2286 L 4781.5296 3781.6403 L 4780.9165 3782.0521 L 4780.0388 3782.2807 L 4779.1611 3782.5093 L 4777.9123 3782.5093 L 4776.6634 3782.5093 L 4776.7389 3782.1711 C 4776.7804 3781.9851 4777.0544 3780.1421 4777.3478 3778.0756 C 4777.6412 3776.009 4777.9166 3774.1564 4777.9598 3773.9586 L 4778.0383 3773.5991 L 4779.1716 3773.6949 L 4780.3049 3773.7907 L 4781.0045 3774.1 M 4738.9589 3776.2344 C 4738.6778 3777.247 4738.15 3778.921 4737.7861 3779.9543 C 4737.4221 3780.9876 4737.0698 3782.0027 4737.0033 3782.2101 L 4736.8823 3782.5872 L 4737.0073 3782.9252 L 4737.1323 3783.2632 L 4737.5057 3783.4334 L 4737.8791 3783.6035 L 4738.3205 3783.4206 L 4738.762 3783.2377 L 4739.4425 3781.4671 C 4739.8167 3780.4933 4740.4353 3778.6216 4740.8171 3777.3079 C 4741.1989 3775.9942 4741.5471 3774.801 4741.5908 3774.6563 L 4741.6703 3774.3933 L 4740.5701 3774.3933 L 4739.4699 3774.3933 L 4738.9589 3776.2344 M 4730.9053 3775.2575 C 4730.9532 3775.6501 4731.1553 3777.475 4731.3546 3779.3126 L 4731.7168 3782.6539 L 4731.8694 3782.9389 L 4732.0219 3783.224 L 4732.3783 3783.2921 L 4732.7347 3783.3603 L 4733.0494 3783.2439 L 4733.3641 3783.1275 L 4733.5451 3782.7892 L 4733.7261 3782.451 L 4733.2983 3778.4973 L 4732.8706 3774.5436 L 4731.8445 3774.5436 L 4730.8183 3774.5436 L 4730.9053 3775.2575 M 4746.9115 3776.2796 C 4746.2841 3776.5593 4745.7525 3777.0334 4745.4806 3777.5559 L 4745.2817 3777.938 L 4744.7298 3780.8426 L 4744.1778 3783.7473 L 4744.4286 3784.4039 L 4744.6794 3785.0606 L 4745.1561 3785.4006 L 4745.6329 3785.7407 L 4748.8643 3785.7906 L 4752.0957 3785.8405 L 4752.5709 3785.5862 L 4753.0462 3785.3318 L 4753.1325 3785.0102 C 4753.2726 3784.4879 4753.2392 3784.3292 4752.9223 3784.0123 L 4752.6217 3783.7117 L 4749.5531 3783.7117 L 4746.4846 3783.7117 L 4746.4216 3783.5238 C 4746.387 3783.4205 4746.4115 3783.0992 4746.4761 3782.8099 C 4746.5406 3782.5206 4746.7348 3781.4723 4746.9076 3780.4803 C 4747.0804 3779.4883 4747.2577 3778.5584 4747.3016 3778.4137 L 4747.3816 3778.1507 L 4749.4756 3778.1507 L 4751.5696 3778.1507 L 4751.5576 3778.4137 C 4751.551 3778.5584 4751.4325 3779.0825 4751.2944 3779.5785 L 4751.0433 3780.4803 L 4749.8257 3780.5555 L 4748.6082 3780.6306 L 4748.3752 3780.8246 C 4748.2471 3780.9314 4748.0987 3781.1921 4748.0455 3781.4042 L 4747.9488 3781.7897 L 4748.1845 3782.1495 L 4748.4203 3782.5093 L 4750.0098 3782.5093 L 4751.5993 3782.5093 L 4752.1017 3782.2709 L 4752.6041 3782.0325 L 4752.8262 3781.6936 L 4753.0483 3781.3546 L 4753.454 3779.6577 L 4753.8598 3777.9608 L 4753.6878 3777.3869 L 4753.5159 3776.8131 L 4753.0312 3776.4674 L 4752.5465 3776.1217 L 4749.9915 3776.0836 L 4747.4365 3776.0455 L 4746.9115 3776.2796 M 4792.1556 3777.5779 L 4791.8491 3777.9068 L 4791.8491 3778.1456 C 4791.8491 3778.2769 4791.9544 3778.5347 4792.0831 3778.7184 L 4792.3171 3779.0525 L 4792.8239 3779.0525 L 4793.3306 3779.0525 L 4793.5668 3778.8163 L 4793.803 3778.5801 L 4793.803 3778.1633 L 4793.803 3777.7464 L 4793.5281 3777.4977 L 4793.2533 3777.2489 L 4792.8577 3777.2489 L 4792.462 3777.2489 L 4792.1556 3777.5779 M 4707.405 3783.2729 L 4707.7084 3783.4353 L 4707.9196 3783.9408 L 4708.1309 3784.4464 L 4708.0436 3784.7178 C 4707.9956 3784.8671 4707.8874 3785.1339 4707.8031 3785.3108 L 4707.6499 3785.6323 L 4707.2836 3785.7992 C 4706.8093 3786.0154 4706.2925 3786.011 4705.8001 3785.7866 L 4705.406 3785.607 L 4705.1918 3785.1929 L 4704.9776 3784.7787 L 4704.9776 3784.3839 L 4704.9776 3783.9892 L 4705.417 3783.5498 L 4705.8563 3783.1105 L 4706.4789 3783.1105 L 4707.1015 3783.1105 L 4707.405 3783.2729 M 4727.7664 3784.1814 C 4727.7147 3784.4397 4727.6724 3784.832 4727.6724 3785.0531 L 4727.6724 3785.4551 L 4727.8528 3785.6355 L 4728.0331 3785.8158 L 4734.9236 3785.8158 L 4741.814 3785.8158 L 4742.1829 3785.4469 L 4742.5518 3785.078 L 4742.5518 3784.7289 L 4742.5518 3784.3798 L 4742.3178 3784.0457 L 4742.0839 3783.7117 L 4734.9721 3783.7117 L 4727.8603 3783.7117 L 4727.7664 3784.1814"  stroke="none" layerid="1" locked="0" logotype="zh"></path> <path d="M 4710.5 3768 L 4709.8233 3768.1398 L 4708.6987 3768.7074 L 4707.574 3769.2751 L 4706.6684 3770.1186 L 4705.7628 3770.9621 L 4704.3587 3771.0403 L 4702.9546 3771.1186 L 4701.7269 3771.7289 L 4700.4993 3772.3391 L 4699.8693 3772.9877 C 4699.5228 3773.3444 4699.0059 3774.0257 4698.7207 3774.5017 L 4698.202 3775.3671 L 4698.0176 3776.3449 L 4697.8331 3777.3227 L 4697.9406 3778.1838 C 4698.066 3779.1869 4698.3599 3779.9851 4698.9519 3780.9301 L 4699.3759 3781.6069 L 4700.1547 3782.2578 C 4700.9855 3782.9522 4701.6583 3783.3345 4702.5671 3783.6284 L 4703.131 3783.8108 L 4703.131 3784 C 4703.131 3784.1041 4703.3763 3784.504 4703.676 3784.8887 L 4704.2209 3785.5882 L 4705.0119 3785.9752 L 4705.8029 3786.3622 L 4706.61 3786.4454 L 4707.4171 3786.5286 L 4708.2357 3786.2854 C 4709.982 3785.7666 4711.252 3784.2374 4711.252 3782.6533 L 4711.252 3782.1656 L 4713.9965 3780.7967 C 4715.5061 3780.0438 4716.831 3779.3695 4716.9408 3779.2981 L 4717.1405 3779.1685 L 4716.4971 3778.0942 C 4715.7184 3776.7943 4716.1651 3776.7595 4712.934 3778.372 L 4710.2249 3779.7239 L 4709.4651 3779.2126 L 4708.7054 3778.7014 L 4707.941 3778.5374 C 4706.8751 3778.3088 4706.5704 3778.3288 4705.6039 3778.6904 L 4704.757 3779.0073 L 4704.1251 3779.6303 C 4703.7775 3779.973 4703.3918 3780.4146 4703.2679 3780.6116 L 4703.0427 3780.9699 L 4702.5981 3780.7379 C 4701.9668 3780.4084 4701.3932 3779.7603 4701.0378 3778.9751 L 4700.7314 3778.2983 L 4700.7281 3777.4811 L 4700.7248 3776.6638 L 4701.0235 3776.0524 C 4701.1878 3775.7161 4701.5383 3775.2117 4701.8024 3774.9316 L 4702.2825 3774.4222 L 4703.0997 3774.048 L 4703.9169 3773.6739 L 4704.8466 3773.6739 L 4705.7763 3773.6739 L 4706.4038 3773.994 L 4707.0313 3774.3142 L 4707.4441 3773.4712 L 4707.8568 3772.6282 L 4708.5254 3772.0397 L 4709.194 3771.4512 L 4710.1575 3770.9768 L 4711.121 3770.5025 L 4712.2827 3770.4353 L 4713.4443 3770.368 L 4714.4911 3770.7839 C 4715.0669 3771.0126 4715.8264 3771.3964 4716.1788 3771.6368 L 4716.8196 3772.0739 L 4717.3342 3772.8382 L 4717.8489 3773.6024 L 4718.113 3774.4841 L 4718.3771 3775.3658 L 4718.9104 3775.3658 L 4719.4438 3775.3658 L 4720.247 3775.7721 L 4721.0501 3776.1785 L 4721.4297 3776.8261 L 4721.8092 3777.4738 L 4721.8092 3778.3532 L 4721.8092 3779.2326 L 4721.5829 3779.6678 C 4721.3035 3780.205 4720.8144 3780.6588 4720.1248 3781.0209 L 4719.5985 3781.2973 L 4717.9475 3781.3394 L 4716.2965 3781.3816 L 4715.9398 3781.7383 L 4715.5831 3782.0949 L 4715.5831 3782.6596 L 4715.5831 3783.2242 L 4715.9726 3783.6136 L 4716.362 3784.003 L 4717.4096 3784.0622 L 4718.4573 3784.1214 L 4719.4791 3783.9457 L 4720.5008 3783.77 L 4721.3279 3783.3955 L 4722.1551 3783.021 L 4722.9565 3782.2387 L 4723.758 3781.4565 L 4724.0264 3780.9301 C 4724.1741 3780.6406 4724.3804 3780.0406 4724.4849 3779.5968 L 4724.6748 3778.7898 L 4724.5982 3777.8673 L 4724.5216 3776.9448 L 4724.1463 3776.1177 L 4723.7709 3775.2906 L 4723.0207 3774.5353 L 4722.2704 3773.78 L 4721.4349 3773.3708 L 4720.5993 3772.9617 L 4720.1396 3772.1582 C 4719.8867 3771.7162 4719.399 3771.0356 4719.0557 3770.6456 L 4718.4316 3769.9365 L 4717.5307 3769.3247 C 4717.0352 3768.9883 4716.2149 3768.5424 4715.7079 3768.334 L 4714.7861 3767.9551 L 4712.9814 3767.9077 L 4711.1768 3767.8603 L 4710.5 3768 M 4729.5437 3773.3731 C 4729.4108 3774.2623 4729.2298 3775.5989 4729.1416 3776.3433 C 4729.0534 3777.0877 4728.7819 3778.9704 4728.5383 3780.527 C 4728.2947 3782.0836 4728.0954 3783.4879 4728.0954 3783.6476 L 4728.0954 3783.9379 L 4731.9019 3783.9379 L 4735.7084 3783.9379 L 4736.0376 3783.6312 L 4736.3667 3783.3246 L 4736.3667 3782.8274 L 4736.3667 3782.3302 L 4736.0506 3782.0437 L 4735.7345 3781.7572 L 4733.334 3781.7092 L 4730.9335 3781.6611 L 4731.0101 3781.258 C 4731.0522 3781.0363 4731.1642 3780.3643 4731.2589 3779.7646 L 4731.4311 3778.6743 L 4733.8114 3778.6743 L 4736.1917 3778.6743 L 4736.4352 3778.5809 L 4736.6786 3778.4875 L 4736.9105 3778.0391 L 4737.1423 3777.5907 L 4736.9699 3777.1745 L 4736.7975 3776.7583 L 4736.4247 3776.5884 L 4736.0518 3776.4185 L 4733.8681 3776.4185 L 4731.6844 3776.4185 L 4731.7574 3776.1553 C 4731.7976 3776.0106 4731.8747 3775.503 4731.9288 3775.0274 L 4732.0271 3774.1627 L 4734.43 3774.1627 L 4736.8328 3774.1627 L 4737.2743 3773.9344 L 4737.7158 3773.706 L 4737.8095 3773.3328 L 4737.9032 3772.9596 L 4737.8063 3772.5737 L 4737.7095 3772.1878 L 4737.1933 3771.9721 L 4736.6771 3771.7565 L 4733.2313 3771.7565 L 4729.7855 3771.7565 L 4729.5437 3773.3731 M 4768.0258 3771.9445 C 4767.9313 3772.225 4766.484 3781.91 4766.374 3782.9979 L 4766.2789 3783.9379 L 4770.0837 3783.9331 L 4773.8884 3783.9283 L 4774.127 3783.7451 C 4774.2583 3783.6443 4774.4475 3783.4083 4774.5474 3783.2206 L 4774.7292 3782.8794 L 4774.5344 3782.4731 L 4774.3396 3782.0668 L 4773.9636 3781.8767 L 4773.5876 3781.6865 L 4771.3694 3781.6843 L 4769.1512 3781.682 L 4769.1512 3781.4089 C 4769.1512 3781.147 4769.3791 3779.7206 4769.534 3779.0127 L 4769.6081 3778.6743 L 4772.0866 3778.6743 L 4774.5652 3778.6743 L 4774.8659 3778.3735 L 4775.1667 3778.0727 L 4775.1667 3777.5573 L 4775.1667 3777.0419 L 4774.7705 3776.7302 L 4774.3742 3776.4185 L 4772.1285 3776.4185 L 4769.8829 3776.4185 L 4769.9593 3776.1553 C 4770.0013 3776.0106 4770.0813 3775.503 4770.1371 3775.0274 L 4770.2386 3774.1627 L 4772.6418 3774.1627 L 4775.0451 3774.1627 L 4775.4881 3773.901 L 4775.931 3773.6393 L 4776.0163 3773.2995 L 4776.1016 3772.9596 L 4776.0048 3772.5737 L 4775.908 3772.1878 L 4775.3918 3771.9721 L 4774.8756 3771.7565 L 4771.4823 3771.7565 L 4768.0891 3771.7565 L 4768.0258 3771.9445 M 4777.6756 3775.7041 C 4777.3622 3777.7926 4777.0085 3780.3135 4776.8896 3781.3061 C 4776.7708 3782.2986 4776.6323 3783.3027 4776.582 3783.5374 L 4776.4905 3783.9641 L 4779.7011 3783.9041 L 4782.9117 3783.8441 L 4783.879 3783.4774 L 4784.8464 3783.1107 L 4785.649 3782.3787 L 4786.4515 3781.6466 L 4787.0126 3780.4988 L 4787.5737 3779.351 L 4787.5737 3777.6968 L 4787.5737 3776.0425 L 4787.152 3775.1402 L 4786.7303 3774.2379 L 4786.2497 3773.7347 C 4785.9853 3773.458 4785.4863 3773.0352 4785.1407 3772.795 L 4784.5123 3772.3584 L 4783.439 3772.1326 L 4782.3657 3771.9069 L 4780.3055 3771.9069 L 4778.2453 3771.9069 L 4777.6756 3775.7041 M 4792.8388 3772.9109 C 4792.5158 3773.4631 4792.144 3774.1229 4792.0127 3774.3771 C 4791.8814 3774.6314 4791.4981 3775.3131 4791.1609 3775.8921 C 4789.7876 3778.2502 4788.852 3779.898 4788.852 3779.9584 C 4788.852 3779.9937 4788.5947 3780.4466 4788.2801 3780.9651 C 4787.9656 3781.4835 4787.4579 3782.367 4787.152 3782.9284 L 4786.5957 3783.9492 L 4787.987 3783.9059 L 4789.3783 3783.8627 L 4790.0389 3782.622 L 4790.6995 3781.3813 L 4793.1422 3781.3813 L 4795.5849 3781.3813 L 4795.9377 3782.6596 L 4796.2904 3783.9379 L 4797.534 3783.9379 C 4798.218 3783.9379 4798.7776 3783.9134 4798.7776 3783.8834 C 4798.7776 3783.8535 4798.5098 3782.8815 4798.1825 3781.7235 C 4797.8553 3780.5655 4797.4776 3779.135 4797.3434 3778.5446 C 4797.2091 3777.9542 4797.0635 3777.4712 4797.0198 3777.4712 C 4796.9761 3777.4712 4796.6243 3777.6162 4796.238 3777.7934 L 4795.5357 3778.1156 L 4795.2944 3778.6807 L 4795.053 3779.2459 L 4794.6417 3779.5154 L 4794.2305 3779.7849 L 4793.5339 3779.7845 L 4792.8373 3779.7842 L 4792.416 3779.5077 L 4791.9948 3779.2312 L 4791.7769 3778.8098 L 4791.559 3778.3885 L 4791.559 3777.9906 L 4791.559 3777.5928 L 4791.8138 3777.1614 L 4792.0686 3776.73 L 4792.7048 3776.3925 L 4793.341 3776.055 L 4794.0825 3776.2451 L 4794.8241 3776.4351 L 4795.6729 3776.0332 C 4796.1398 3775.8122 4796.5218 3775.6036 4796.5218 3775.5698 C 4796.5218 3775.516 4796.2313 3774.3469 4795.7519 3772.4708 L 4795.6078 3771.9069 L 4794.517 3771.9069 L 4793.4261 3771.9069 L 4792.8388 3772.9109 M 4782.7885 3774.3879 L 4783.5471 3774.6132 L 4783.9479 3774.9285 L 4784.3488 3775.2438 L 4784.6803 3775.8687 L 4785.0119 3776.4937 L 4785.0145 3777.6968 L 4785.0171 3778.8999 L 4784.5659 3779.7228 L 4784.1148 3780.5457 L 4783.6017 3780.8897 C 4783.3195 3781.0789 4782.7489 3781.3346 4782.3337 3781.4579 L 4781.5788 3781.682 L 4780.5042 3781.682 L 4779.4297 3781.682 L 4779.4835 3781.1933 C 4779.5132 3780.9245 4779.7514 3779.2326 4780.0129 3777.4336 L 4780.4883 3774.1627 L 4781.2591 3774.1627 L 4782.03 3774.1627 L 4782.7885 3774.3879 M 4740.7863 3775.0154 L 4740.0174 3775.2424 L 4739.1832 3775.8972 L 4738.3489 3776.5519 L 4737.8466 3777.5724 L 4737.3442 3778.5928 L 4737.3442 3779.799 L 4737.3442 3781.0053 L 4737.767 3781.8662 L 4738.1897 3782.727 L 4738.8131 3783.2606 L 4739.4365 3783.7943 L 4740.1847 3784.0164 C 4741.5405 3784.4191 4742.5492 3784.2614 4743.6351 3783.4772 L 4744.2113 3783.0612 L 4744.752 3783.4281 C 4745.354 3783.8366 4745.8301 3783.991 4746.2428 3783.9115 L 4746.5179 3783.8586 L 4746.7033 3781.9808 C 4746.8053 3780.948 4746.9846 3779.4601 4747.1017 3778.6743 L 4747.3146 3777.2456 L 4747.1407 3776.8696 L 4746.9668 3776.4937 L 4746.3202 3776.447 L 4745.6736 3776.4003 L 4745.149 3775.8197 L 4744.6244 3775.239 L 4743.9277 3775.0016 L 4743.231 3774.7642 L 4742.393 3774.7763 L 4741.5551 3774.7885 L 4740.7863 3775.0154 M 4750.9294 3775.0011 L 4750.2277 3775.2171 L 4749.843 3775.6742 L 4749.4583 3776.1314 L 4749.2948 3776.7387 L 4749.1313 3777.346 L 4749.2258 3777.7762 L 4749.3203 3778.2063 L 4749.8028 3778.8161 L 4750.2853 3779.4258 L 4751.3269 3780.1757 C 4751.8998 3780.5882 4752.4286 3781.033 4752.5021 3781.1643 L 4752.6356 3781.4029 L 4752.3732 3781.6929 L 4752.1108 3781.9828 L 4751.5972 3781.9828 L 4751.0837 3781.9828 L 4750.4175 3781.5244 C 4750.051 3781.2723 4749.7512 3781.0016 4749.7512 3780.9229 C 4749.7512 3780.6035 4749.4371 3780.8225 4748.7624 3781.6123 L 4748.0511 3782.4449 L 4748.4589 3782.8705 L 4748.8666 3783.2961 L 4749.6863 3783.7108 L 4750.5059 3784.1255 L 4751.1683 3784.2002 L 4751.8308 3784.2748 L 4752.613 3784.0872 L 4753.3952 3783.8995 L 4754.039 3783.2796 L 4754.6828 3782.6596 L 4754.8682 3782.0349 L 4755.0537 3781.4103 L 4754.9497 3780.8559 L 4754.8457 3780.3016 L 4754.218 3779.6206 C 4753.8728 3779.246 4753.1664 3778.6371 4752.6483 3778.2674 L 4751.7062 3777.5952 L 4751.7062 3777.4012 C 4751.7062 3777.2945 4751.805 3777.1253 4751.9257 3777.0251 L 4752.1451 3776.843 L 4752.605 3776.944 L 4753.0649 3777.0451 L 4753.5818 3777.5326 L 4754.0987 3778.0201 L 4754.6319 3777.2459 C 4754.9252 3776.8201 4755.1652 3776.37 4755.1652 3776.2457 L 4755.1652 3776.0197 L 4754.8268 3775.7021 C 4754.6407 3775.5274 4754.1839 3775.2464 4753.8117 3775.0776 L 4753.1349 3774.7708 L 4752.383 3774.778 L 4751.6311 3774.7852 L 4750.9294 3775.0011 M 4756.3223 3775.0213 L 4756.251 3775.1402 L 4756.8955 3776.9448 C 4757.25 3777.9374 4757.8497 3779.6223 4758.2283 3780.6892 L 4758.9165 3782.6288 L 4757.5672 3784.8552 C 4756.8251 3786.0797 4756.2179 3787.1186 4756.2179 3787.164 C 4756.2179 3787.2093 4756.7852 3787.2464 4757.4785 3787.2464 L 4758.7391 3787.2464 L 4759.3366 3786.3065 C 4759.6652 3785.7895 4760.0623 3785.1504 4760.219 3784.8862 C 4761.0099 3783.5529 4764.8825 3777.1741 4765.8163 3775.6665 C 4765.9956 3775.377 4766.1426 3775.0868 4766.1429 3775.0215 L 4766.1435 3774.9029 L 4764.8364 3774.9463 L 4763.5293 3774.9898 L 4762.0166 3777.4925 C 4761.1846 3778.8689 4760.4724 3779.9654 4760.434 3779.929 C 4760.3955 3779.8926 4759.9843 3778.7664 4759.5203 3777.4263 L 4758.6766 3774.9898 L 4757.5351 3774.9461 L 4756.3936 3774.9024 L 4756.3223 3775.0213 M 4743.8459 3777.2547 C 4744.0413 3777.3828 4744.3331 3777.7038 4744.4943 3777.9681 L 4744.7873 3778.4487 L 4744.7879 3779.0972 L 4744.7884 3779.7456 L 4744.405 3780.556 L 4744.0217 3781.3664 L 4743.1985 3781.7691 L 4742.3753 3782.1719 L 4741.7526 3782.0884 L 4741.13 3782.0049 L 4740.7503 3781.7214 C 4740.5414 3781.5655 4740.2383 3781.2607 4740.0766 3781.0442 L 4739.7827 3780.6504 L 4739.7827 3779.825 L 4739.7827 3778.9996 L 4740.1944 3778.2971 L 4740.6061 3777.5945 L 4741.3814 3777.2253 L 4742.1566 3776.856 L 4742.8236 3776.9389 L 4743.4906 3777.0219 L 4743.8459 3777.2547 M 4792.9984 3777.4067 L 4792.7621 3777.6431 L 4792.7621 3777.9976 L 4792.7621 3778.352 L 4792.9984 3778.5884 L 4793.2347 3778.8247 L 4793.5766 3778.8247 L 4793.9186 3778.8247 L 4794.1674 3778.5497 L 4794.4163 3778.2746 L 4794.4163 3777.9589 L 4794.4163 3777.6431 L 4794.18 3777.4067 L 4793.9437 3777.1704 L 4793.5892 3777.1704 L 4793.2347 3777.1704 L 4792.9984 3777.4067 M 4707.9928 3781.3878 L 4708.3834 3781.6951 L 4708.4775 3782.1967 L 4708.5716 3782.6982 L 4708.3383 3783.1494 L 4708.105 3783.6006 L 4707.8615 3783.6941 C 4707.0739 3783.9963 4706.1974 3783.7829 4705.7917 3783.1901 L 4705.5372 3782.8182 L 4705.5372 3782.389 L 4705.5372 3781.9597 L 4705.9768 3781.5201 L 4706.4164 3781.0805 L 4707.0093 3781.0805 L 4707.6021 3781.0805 L 4707.9928 3781.3878" stroke="none" layerid="1" locked="0" logotype="en"></path> </g></svg>',ao='<?xml version="1.0" encoding="utf-8" standalone="no"?><svg id="root" width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>entry port sch</title><g id="part(annotation)" c_partid="part_annotation" c_origin="0,0"><text x="0" y="0" font-family="Verdana" font-size="9pt" fill="#0000FF" text-anchor="start" type="comment">Text</text></g><g id="part(pin)" c_partid="part_pin" c_show="show" c_elec="0" c_spicepin="1" c_origin="0,0"><text x="-22" y="3" font-family="Verdana" font-size="7pt" fill="#0000FF" text-anchor="end" c_pinname="1">1</text><text x="-15" y="-1" font-family="Verdana" font-size="7pt" fill="#0000FF" text-anchor="start" c_pinnumber="1">1</text><circle c_pindot="true" class="pindot" cx="0" cy="0" r="2" fill="#4F4F4F" stroke="none" /><path d="M0,0 h-20" fill="none" stroke="#880000" stroke-width="1"/><circle cx="-17" cy="0" r="3" fill="none" stroke="#880000" stroke-width="1" display="none" /><path d="M-20,-3 L-23,0 -20,3" fill="none" stroke="#880000" stroke-width="1" display="none" /></g><g id="part(junction)" c_partid="part_junction" c_etype="pinpart" c_origin="220,200"><circle c_pindot="true" class="pindot" cx="220" cy="200" r="2" fill="#4F4F4F" stroke="none" /><circle cx="220" cy="200" r="2.5" fill="#CC0000" stroke-width="1"/></g><g id="part(netLabel_text)" c_partid="part_netLabel_text" c_etype="pinpart" c_origin="220,200"><circle c_pindot="true" class="pindot" cx="220" cy="200" r="1" fill="#ff0000" stroke="none" /><text x="222" y="197.5" font-family="Times New Roman" font-size="7pt" fill="#0000ff" text-anchor="start">netLabel?</text><path d="M 220 199 L 220 201 M 219 200 L 221 200" stroke-width="0.1"></path></g><g id="part(netLabel_netPort)" c_partid="part_netLabel_netPort" c_etype="pinpart" c_origin="420,310"><circle c_pindot="true" class="pindot" cx="420" cy="310" r="2" fill="#ff0000" stroke="none" /><g c_partid="part_annotation" c_shapetype="group"><text x="398.5" y="315" font-family="Times New Roman" font-size="8pt" fill="#0000FF"  c_note="note_netflag" text-anchor="end">label?</text></g><polyline points="420 310 415 315 400 315 400 305 415 305 420 310" stroke="#0000FF" stroke-width="1" fill="transparent" /></g><g id="part(netLabel_volProbe)" c_partid="part_netLabel_volProbe" c_etype="pinpart" c_origin="0,0"><circle c_pindot="true" class="pindot" cx="0" cy="0" r="2" fill="#ff0000" stroke="none" /><g c_partid="part_annotation" c_shapetype="group"><text x="13" y="-4" font-family="Times New Roman" font-size="9pt" fill="#0000FF" text-anchor="start" c_note="note_netflag">volProbe</text></g><path d="M0 0 6 -6 L 8 -10 18 -20 20 -18 10 -8 6 -6M19 -19 C 28 -29 27 -14 38 -23" stroke="#000000" stroke-width="1" fill="none" /></g><g id="part(netLabel_VCC)" c_partid="part_netLabel_VCC" c_etype="pinpart" c_origin="400,310"><circle c_pindot="true" class="pindot" cx="400" cy="310" r="1" fill="#4F4F4F" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text x="388" y="298" c_note="note_netflag" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start">VCC</text></g><polyline points="400 300 400 310" stroke="#000000" stroke-width="1" fill="none" /><polyline points="395 300 405 300" stroke="#000000" stroke-width="1" fill="transparent" /></g><g id="part(netLabel_+5V)" c_partid="part_netLabel_+5V" c_etype="pinpart" c_origin="400,310"><circle c_pindot="true" class="pindot" cx="400" cy="310" r="1" fill="#4F4F4F" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text c_note="note_netflag" x="390" y="298" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start">+5V</text></g><polyline points="400 300 400 310" stroke="#000000" stroke-width="1" fill="none" /><polyline points="395 300 405 300" stroke="#000000" stroke-width="1" fill="transparent" /></g><g id="part(netLabel_-5V)" c_partid="part_netLabel_-5V" c_etype="pinpart" c_origin="400,300"><circle c_pindot="true" class="pindot" cx="400" cy="300" r="1" fill="#000000" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text x="391" y="321" c_note="note_netflag" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start">-5V</text></g><polyline points="400 300 400 310" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="395 310 405 310" stroke="#000000" stroke-width="1" fill="transparent"/></g><g id="part(netLabel_VEE)" c_partid="part_netLabel_VEE" c_etype="pinpart" c_origin="400,300"><circle c_pindot="true" class="pindot" cx="400" cy="300" r="1" fill="#000000" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text x="388" y="321" c_note="note_netflag" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start">VEE</text></g><polyline points="400 300 400 310" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="395 310 405 310" stroke="#000000" stroke-width="1" fill="transparent"/></g><g id="part(netLabel_Bar)" c_partid="part_netLabel_Bar" c_etype="pinpart" c_origin="400,310"><circle c_pindot="true" class="pindot" cx="400" cy="310" r="1" fill="none" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text c_note="note_netflag" x="380" y="288" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start" dominant-baseline="central" display="">netName</text></g><path d="M 400 300 v 10" fill="none" stroke="#000000" stroke-width="1"/><ellipse cx="400" cy="297" rx="3" ry="3" stroke="#000000" stroke-width="1" fill="none" /></g><g id="part(netLabel_gnD)" c_partid="part_netLabel_gnD" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text c_note="note_netflag" x="387" y="316" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start" display="">GND</text></g><polyline points="400 300 400 290" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="391,300 409,300" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="394,302 406,302" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="397,304 403,304" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="399,306 401,306" stroke="#000000" stroke-width="1" fill="transparent" /></g><g id="part(netLabel_GnD)" c_partid="part_netLabel_GnD" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text c_note="note_netflag" x="385" y="318" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start" dominant-baseline="central" display="">GND</text></g><polyline points="400 290 400 300 395 310" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="385 310 390 300 410 300 405 310" stroke="#000000" stroke-width="1" fill="transparent" /></g><g id="part(netLabel_gNd)" c_partid="part_netLabel_gNd" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text c_note="note_netflag" x="387" y="312" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start" display="">GND</text></g><rect x="390" y="300" width="20" height="1" stroke="#000000" stroke-width="1" fill="#000000" c_shapetype="line" class=""></rect><polyline points="400 290 400 300" stroke="#000000" stroke-width="1" fill="transparent" c_shapetype="line"></polyline></g><g id="part(netLabel_GNd)" c_partid="part_netLabel_GNd" c_etype="pinpart" c_origin="400,290"><circle c_pindot="true" class="pindot" cx="400" cy="290" r="1" fill="#4F4F4F" stroke="none"/><g c_partid="part_annotation" c_shapetype="group"><text c_note="note_netflag" x="387" y="315" font-family="Times New Roman" font-size="9pt" fill="#000000" text-anchor="start" display="">GND</text></g><polyline points="400 300 400 290" stroke="#000000" stroke-width="1" fill="transparent" /><polyline points="400 300 410 300 400 306 390 300 400 300" stroke="#000000" stroke-width="1" fill="transparent" /></g><g id="part(busentry)" c_partid="part_busentry" c_origin="0,0"><circle c_pindot="true" class="pindot" cx="0" cy="0" r="2" fill="#4F4F4F" stroke="none" /><circle c_pindot="true" class="pindot" cx="10" cy="-10" r="2" fill="#4F4F4F" stroke="none" /><line x1="0" y1="0" x2="10" y2="-10" stroke="#008800" stroke-width="1"/></g><g id="part(lib_temp)" c_partid="part_lib_temp" c_origin="160,410" c_para="" c_shapetype="group" c_etype="pinpart" xmlns="http://www.w3.org/2000/svg" class=""><g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" id="tmplName"><text c_note="note_name" x="165" y="423" font-family="Times New Roman" font-size="7pt" fill="#000080" text-anchor="start">470NF</text></g><g xmlns="http://www.w3.org/2000/svg" c_partid="part_annotation" id="tmplPre"><text c_note="note_pre" x="165" y="397" font-family="Times New Roman" font-size="7pt" fill="#000080" text-anchor="start">C1</text></g></g><g id="part(arrowhead)" c_partid="part_arrowhead" c_origin="15,0" arrowtype="3" arrowsize="15" c_rotation="0"><path d="M15,0 L0,7.5 3.75,0 0,-7.5Z" fill="#000000" stroke="none" style="shape-rendering:auto;"/></g><g id="part(no_connect_flag)" c_partid="part_no_connect_flag" c_origin="0,0"><path d="M-4 -4L4 4M4 -4L-4 4" stroke="#33cc33" fill="none" stroke-width="1" style="shape-rendering:auto;"/></g><g id="part(lib_sheet)" c_partid="part_lib_sheet" c_origin="550,400.5" c_para="package`NONE`BOM_Manufacturer Part`?`spicePre`.`" display="none" c_shapetype="group" c_etype="pinpart"> <rect x="550" y="400.5" width="0" height="0" class="hitbox"></rect> <path d="M 206 10 L 206 0 M 206 796 L 206 806 M 402 10 L 402 0 M 402 796 L 402 806 M 598 10 L 598 0 M 598 796 L 598 806 M 794 10 L 794 0 M 794 796 L 794 806 M 990 10 L 990 0 M 990 796 L 990 806 M 10 206 L 0 206 M 1139 206 L 1149 206 M 10 402 L 0 402 M 1139 402 L 1149 402 M 10 598 L 0 598 M 1139 598 L 1149 598 M 10 794 L 0 794 M 1139 794 L 1149 794" c_etype="frame_tick" stroke="#880000" stroke-width="1" fill="none"></path> <g c_partid="part_annotation" c_origin="1.5,108" c_etype="frame_tick" c_shapetype="group"><text x="1.5" y="108" font-family="Verdana" font-size="7pt" fill="#880000" font-style="" text-anchor="start" type="comment" font-weight="">A</text></g> <g c_partid="part_annotation" c_origin="1140.5,108" c_etype="frame_tick" c_shapetype="group"><text x="1140.5" y="108" font-family="Verdana" font-size="7pt" fill="#880000" font-style="" text-anchor="start" type="comment" font-weight="">A</text></g> <g c_partid="part_annotation"  c_etype="frame_tick" locked="0" c_origin="1.5,304.000025" c_shapetype="group"><text x="1.5" y="304.000025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">B</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="1140.49995,304.000025" c_shapetype="group"><text x="1140.49995" y="304.000025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">B</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="1.5,500" c_shapetype="group"><text x="1.5" y="500" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">C</text></g> <g c_partid="part_annotation"  c_etype="frame_tick" locked="0" c_origin="1140.49995,500" c_shapetype="group"><text x="1140.49995" y="500" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">C</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="1.5,696.000025" c_shapetype="group"><text x="1.5" y="696.000025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">D</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="1140.49995,696.000025" c_shapetype="group"><text x="1140.49995" y="696.000025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">D</text></g> <g c_partid="part_annotation"  c_etype="frame_tick" locked="0" c_origin="108,8.5" c_shapetype="group"><text x="108" y="8.5" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">1</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="108,804.500025" c_shapetype="group"><text x="108" y="804.500025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">1</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="303.99995,8.5" c_shapetype="group"><text x="303.99995" y="8.5" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">2</text></g><g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="303.99995,804.500025" c_shapetype="group"><text x="303.99995" y="804.500025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">2</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="499.99995,8.5" c_shapetype="group"><text x="499.99995" y="8.5" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">3</text></g><g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="499.99995,804.500025" c_shapetype="group"><text x="499.99995" y="804.500025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">3</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="695.99995,8.5" c_shapetype="group"><text x="695.99995" y="8.5" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">4</text></g><g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="695.99995,804.500025" c_shapetype="group"><text x="695.99995" y="804.500025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">4</text></g> <g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="891.99995,8.5" c_shapetype="group"><text x="891.99995" y="8.5" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">5</text></g><g c_partid="part_annotation" c_etype="frame_tick" locked="0" c_origin="891.99995,804.500025" c_shapetype="group"><text x="891.99995" y="804.500025" fill="#880000" font-family="Verdana" font-size="7pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">5</text></g> <rect  c_etype="frame_innerbox" locked="0" x="10" y="10" width="1129" height="786" stroke="#880000" stroke-width="1" fill="none" class=""></rect> <rect c_etype="frame_outbox" locked="0" x="-0" y="0" width="1149" height="806" stroke="#880000" stroke-width="1" fill="none"></rect> <rect c_etype="frame_hitarea" locked="0" x="694.99995" y="716.000025" width="444" height="80" stroke="#880000" stroke-width="1" fill="none" class=""></rect> <polyline points="695.1 755.25 1138.63 755.25" stroke="#880000" locked="0" stroke-width="1" fill="none" stroke-linecap="round"></polyline> <polyline points="799.63 775.25 1138.63 775.25" stroke="#880000" locked="0" stroke-width="1" fill="none" stroke-linecap="round"></polyline> <polyline points="1059.61 716.07 1059.63 755.25" stroke="#880000" locked="0" stroke-width="1" fill="none" stroke-linecap="round"></polyline> <polyline points="1059.63 755.25 1059.63 775.25" stroke="#880000" locked="0" stroke-width="1" fill="none" stroke-linecap="round"></polyline> <g c_partid="part_annotation" locked="0" c_origin="699.99995,729.000025" c_shapetype="group" c_etype="pinpart"><text x="699.99995" y="729.000025" fill="#880000" font-family="Verdana" font-size="8pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">TITLE:</text></g> <g c_partid="part_annotation" c_etype="frame_title" locked="0" c_origin="757.62495,741.593775" c_shapetype="group" class=""><text x="757.62495" y="741.593775" fill="#0000FF" font-family="Verdana" font-size="10pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">New Schematic</text></g> <g c_partid="part_annotation" locked="0" c_origin="1064.62495,742.250025" c_shapetype="group" c_etype="pinpart"><text x="1064.62495" y="742.250025" fill="#880000" font-family="Verdana" font-size="8pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">REV:</text></g> <g c_partid="part_annotation" c_etype="frame_version" locked="0" c_origin="1102.62495,742.250025" c_shapetype="group"><text x="1102.62495" y="742.250025" fill="#0000FF" font-family="Verdana" font-size="9pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">1.0</text></g> <g c_partid="part_annotation" locked="0" c_origin="804.62495,791.000025" c_shapetype="group" c_etype="pinpart"><text x="804.62495" y="791.000025" fill="#880000" font-family="Verdana" font-size="8pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">Date:</text></g> <g c_partid="part_annotation" c_etype="frame_date" locked="0" c_origin="851.62495,791.4844" c_shapetype="group" class=""><text x="851.62495" y="791.4844" fill="#0000FF" font-family="Verdana" font-size="9pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">2018-12-10</text></g> <g c_partid="part_annotation" locked="0" c_origin="1063.62495,771.000025" c_shapetype="group" c_etype="pinpart"><text x="1063.62495" y="771.000025" fill="#880000" font-family="Verdana" font-size="8pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">Sheet:</text></g> <g c_partid="part_annotation" c_etype="frame_sheet" locked="0" c_origin="1108.62495,771.4844" c_shapetype="group"><text x="1108.62495" y="771.4844" fill="#0000FF" font-family="Verdana" font-size="9pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">1/1</text></g> <g c_partid="part_annotation" locked="0" c_origin="943.62495,791.250025" c_shapetype="group" c_etype="pinpart" class=""><text x="943.62495" y="791.250025" fill="#880000" font-family="Verdana" font-size="8pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">Drawn By:</text></g> <g c_partid="part_annotation" c_etype="frame_drawn" locked="0" c_origin="1008.63,791.250025" c_shapetype="group"><text x="1008.63" y="791.250025" fill="#0000FF" font-family="Verdana" font-size="9pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment"></text></g> <g c_partid="part_annotation" locked="0" c_origin="804.62495,769.250025" c_shapetype="group" c_etype="pinpart"><text x="804.62495" y="769.250025" fill="#880000" font-family="Verdana" font-size="8pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">Company:</text></g><g c_partid="part_annotation" c_etype="frame_company" locked="0" c_origin="871.24995,769.363775" c_shapetype="group"><text x="871.24995" y="769.363775" fill="#0000FF" font-family="Verdana" font-size="9pt" font-weight="" font-style="" dominant-baseline="" text-anchor="start" type="comment">Your Company</text></g> <polyline points="799.63 755.25 799.63 795.25" stroke="#880000" locked="0" stroke-width="1" fill="none" stroke-linecap="round"></polyline> <g c_partid="part_image" c_origin="744,791" c_etype="frmae_image" c_shapetype="group"><image logotype="en" locked="0" x="694.99995" y="768.000025" width="104" height="20" preserveAspectRatio="none" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iNTIwIg0KCSB2aWV3Qm94PSIwIDAgMTY5Mi45IDM0MS41IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxNjkyLjkgMzQxLjU7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtmaWxsOiM1NTg4RkY7fQ0KPC9zdHlsZT4NCjxnPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05MDEuNywxNjEuMWMyLjMtMS44LDUuMS0yLjcsOC4zLTIuN2M0LjMsMCw4LjksMS42LDEzLjgsNC43YzQuOSwzLjEsOS42LDgsMTQuMSwxNC43bDE3LjQtMjcuOQ0KCQljLTUuNC03LjgtMTIuMS0xMy45LTIwLjItMTguMmMtOC4xLTQuMy0xNi43LTYuNC0yNS43LTYuNGMtMTIuOCwwLTI0LDMuOS0zMy40LDExLjdjLTkuNCw3LjgtMTQuMSwxOC0xNC4xLDMwLjQNCgkJYzAsOC45LDMsMTcuNCw5LDI1LjRjNC4zLDUuNywxMi4xLDEyLjYsMjMuMywyMC42YzkuNyw2LjksMTUuNywxMS43LDE3LjksMTQuNGMyLjIsMi43LDMuMyw1LjMsMy4zLDcuOWMwLDMuMi0xLjQsNS45LTQuMyw4LjMNCgkJYy0yLjksMi4zLTYuNywzLjUtMTEuNSwzLjVjLTEyLjEsMC0yMy4zLTYuNy0zMy41LTIwLjJsLTIyLjUsMjYuMmMxMCwxMC42LDE5LjEsMTgsMjcuMiwyMmM4LjEsNCwxNy4yLDYsMjcuMSw2DQoJCWMxNy4yLDAsMzAuMy00LjksMzkuNC0xNC43YzkuMS05LjgsMTMuNi0yMC4zLDEzLjYtMzEuM2MwLTguNC0yLjItMTYuMS02LjYtMjMuM2MtNC40LTcuMS0xMy42LTE1LjctMjcuNi0yNS43DQoJCWMtOC44LTYuMy0xNC0xMC41LTE1LjctMTIuN2MtMS44LTIuMi0yLjctNC40LTIuNy02LjZDODk4LjIsMTY0LjksODk5LjQsMTYyLjksOTAxLjcsMTYxLjF6Ii8+DQoJPHBvbHlnb24gY2xhc3M9InN0MCIgcG9pbnRzPSIxMDM4LjcsMjE3LjIgMTAwOS44LDEyOS4xIDk3NCwxMjkuMSAxMDE1LjgsMjU3LjQgOTczLjYsMzMyIDEwMTIuMSwzMzIgMTEyOC44LDEyOS4xIDEwODkuNSwxMjkuMSAJDQoJCSIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik02NTEuNSwxNTQuMWwtNzAuNCwwbDUuOC00MS43YzAsMCw3NC43LTAuMSw3NS4xLTAuMWM5LjgsMCwxNy44LTgsMTcuOC0xNy44YzAtOS44LTgtMTcuOC0xNy44LTE3LjgNCgkJYy0wLjMsMC0xMDguNCwwLTEwOC40LDBMNTI2LDI3Ny43aDExMy4ydjBjOS41LTAuMiwxNy4yLTgsMTcuMi0xNy41YzAtOS43LTcuOS0xNy42LTE3LjYtMTcuNmMtMC40LDAtNzAuMiwwLjEtNzAuMiwwLjFsNy40LTUzLjMNCgkJYzAsMCw3MS43LDAuMSw3Mi4zLDAuMWM5LjgsMCwxNy44LTgsMTcuOC0xNy44QzY2Ni4zLDE2Mi44LDY1OS45LDE1NS41LDY1MS41LDE1NC4xeiIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMjY4LjQsNzYuOGMtMC4zLDAtMTA4LjQsMC0xMDguNCwwbC0yNy40LDIwMC44aDExMy4zdjBjOS41LTAuMiwxNy4yLTgsMTcuMi0xNy41YzAtOS43LTcuOS0xNy42LTE3LjYtMTcuNg0KCQljLTAuNCwwLTcwLjIsMC4xLTcwLjIsMC4xbDcuNC01My4zYzAsMCw3MS43LDAuMSw3Mi40LDAuMWM5LjgsMCwxNy44LTgsMTcuOC0xNy44YzAtOC44LTYuNC0xNi4xLTE0LjgtMTcuNWwtNzAuNCwwbDUuOC00MS43DQoJCWMwLDAsNzQuNy0wLjEsNzUuMS0wLjFjOS44LDAsMTcuOC04LDE3LjgtMTcuOEMxMjg2LjIsODQuOCwxMjc4LjMsNzYuOCwxMjY4LjQsNzYuOHoiLz4NCgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTQ3MC43LDE3M2MwLTE5LjctNC42LTM3LjItMTMuNy01Mi4zYy05LjEtMTUuMS0yMC45LTI2LjItMzUuNS0zMy4yYy0xNC42LTcuMS0zNi43LTEwLjYtNjYuNi0xMC42aC0zMS44DQoJCWwtMjcuNCwyMDAuOGg2Mi40YzI2LjIsMCw0Ni43LTMuOSw2MS40LTExLjdjMTQuNy03LjgsMjctMjAuMiwzNi43LTM3LjFDMTQ2NS45LDIxMS45LDE0NzAuNywxOTMuMywxNDcwLjcsMTczeiBNMTQyMS4zLDIxNC41DQoJCWMtNy4zLDExLTE2LjksMTguOC0yOC45LDIzLjNjLTguNiwzLjItMjIuNCw0LjgtNDEuNSw0LjhoLTEyLjRsMTcuNy0xMzAuNGg5LjVjMTUuNSwwLDI3LjksMi40LDM3LjIsNy4zDQoJCWM5LjMsNC45LDE2LjUsMTEuOCwyMS43LDIwLjhjNS4xLDksNy43LDIwLjEsNy43LDMzLjRDMTQzMi4yLDE4OS44LDE0MjguNiwyMDMuNSwxNDIxLjMsMjE0LjV6Ii8+DQoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTE2MTkuMiwxNzAuN2wtMjIuMywxMi4zYy0xLjgsMTYuMi0xNS42LDI4LjctMzIuMiwyOC43Yy0xNy45LDAtMzIuNC0xNC41LTMyLjQtMzIuNA0KCQljMC0xNy45LDE0LjUtMzIuNCwzMi40LTMyLjRjNi45LDAsMTMuMywyLjIsMTguNSw1LjhsMjcuNy0xNS4zbC0xNS02MC4yaC0zMS43bC0xMDgsMjAwaDQwLjRsMjIuOC00Mi42aDc5LjRsMTAuNiw0Mi42aDM2LjQNCgkJTDE2MTkuMiwxNzAuN3oiLz4NCgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTU1Mi44LDE3OC41YzAsNi45LDUuNiwxMi41LDEyLjUsMTIuNWM2LjksMCwxMi41LTUuNiwxMi41LTEyLjVjMC02LjktNS42LTEyLjUtMTIuNS0xMi41DQoJCUMxNTU4LjQsMTY2LDE1NTIuOCwxNzEuNiwxNTUyLjgsMTc4LjV6Ii8+DQoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTgxNC44LDE1Mi41QzgxNC44LDE1Mi41LDgxNC44LDE1Mi40LDgxNC44LDE1Mi41bC0xMi41LDBsLTEuMy0yLjRjLTUuMS04LjEtMTEuNS0xNC4yLTE5LjItMTguNA0KCQljLTcuOC00LjItMjAuMS02LjMtMjkuMy02LjNjLTEzLjcsMC0yNi44LDMuNy0zOS4zLDExLjFjLTEyLjUsNy40LTIyLjUsMTcuNy0yOS45LDMxYy03LjQsMTMuMi0xMS4yLDI3LjItMTEuMiw0MS44DQoJCWMwLDE5LjIsNS44LDM2LDE3LjQsNTAuNWMxMS42LDE0LjUsMjcuMywyMS43LDQ3LDIxLjdjOC42LDAsMTYuMy0xLjQsMjMuMi00LjRjNi45LTIuOSwxNC4zLTgsMjIuMi0xNS40YzAsMCw5LjMsOC4xLDkuNCw4DQoJCWM1LjgsNC42LDEzLDcuNSwyMC44LDhoMy42bDAuNS00LjNsMTIuNy0xMDYuOWMtMC4xLDAtMC4xLDAtMC4yLDBDODI4LjcsMTU4LjgsODIyLjUsMTUyLjYsODE0LjgsMTUyLjV6IE03ODUuNiwyMjQuMg0KCQljLTQuNSw4LjUtMTAuMSwxNC44LTE2LjgsMTguOGMtNi43LDQtMTQuNSw2LTIzLjUsNmMtMTAuOCwwLTE5LjYtMy41LTI2LjUtMTAuN2MtNi45LTcuMS0xMC4zLTE2LjUtMTAuMy0yOC4xDQoJCWMwLTE1LjEsNC41LTI3LjQsMTMuNi0zN2M5LjEtOS42LDIwLjEtMTQuMywzMy4xLTE0LjNjMTEuMiwwLDIwLjIsMy42LDI3LDEwLjdjNi44LDcuMiwxMC4yLDE2LjYsMTAuMiwyOC40DQoJCUM3OTIuNCwyMDYuOSw3OTAuMSwyMTUuNyw3ODUuNiwyMjQuMnoiLz4NCgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDA0LjMsOTYuM2MtNy41LTE5LjktMTkuNy0zNy44LTM1LjgtNTIuM2MtMjQuNy0yMi4yLTU2LjctMzQuNS05MC0zNC41Yy0yOC44LDAtNTYuMyw5LTc5LjUsMjYNCgkJYy0xMS4yLDguMi0yMC45LDE3LjktMjguOSwyOC45Yy01LTAuNy0xMC4xLTEuMS0xNS4zLTEuMWMtMjguNywwLTU1LjgsMTEuMi03Ni4xLDMxLjVjLTIwLjMsMjAuMy0zMS41LDQ3LjMtMzEuNSw3Ni4xDQoJCWMwLDI2LjcsOS45LDUyLjMsMjcuOCw3Mi4xYzE0LjIsMTUuNywzMi42LDI2LjgsNTIuOSwzMmM4LjgsMjYuMiwzMy42LDQ1LjEsNjIuNyw0NS4xYzM2LjUsMCw2Ni4yLTI5LjcsNjYuMi02Ni4yDQoJCWMwLTIuMS0wLjEtNC4zLTAuMy02LjRsOTIuOS00OC44bC0yMC4zLTM1LjJsLTg4LjgsNDYuNmMtMTIuMS0xMy44LTI5LjktMjIuNS00OS43LTIyLjVjLTI4LjcsMC01My4yLDE4LjQtNjIuNCw0NA0KCQljLTIzLjQtMTAuMy0zOS44LTMzLjYtMzkuOC02MC44YzAtMzYuNiwyOS43LTY2LjQsNjYuNC02Ni40YzEyLjksMCwyNSwzLjcsMzUuMiwxMC4xYzEyLjMtMzcuMSw0Ny4zLTYzLjksODguNS02My45DQoJCWM0OCwwLDg3LjQsMzYuMiw5Mi43LDgyLjdjMS43LTAuMiwzLjQtMC4zLDUuMS0wLjNjMjguNywwLDUyLDIzLjMsNTIsNTJjMCwyNy4yLTIwLjksNDkuNS00Ny41LDUxLjhsLTI5LjcsMA0KCQljLTEuMy0wLjMtMi43LTAuNC00LjEtMC40Yy0xMS41LDAtMjAuOCw5LjMtMjAuOCwyMC44YzAsMTAuOSw4LjQsMTkuOCwxOS4xLDIwLjd2MC4ybDM1LjUsMGwxLjgsMGwxLjgtMC4yDQoJCWMyMy4yLTIsNDQuNy0xMi41LDYwLjUtMjkuN2MxNS45LTE3LjMsMjQuNy0zOS43LDI0LjctNjMuMkM0NjkuNiwxNDMuNiw0NDIuMSwxMDguMiw0MDQuMyw5Ni4zeiBNMTkwLjYsMjI4LjMNCgkJYzE0LjEsMCwyNS42LDExLjUsMjUuNiwyNS42YzAsMTQuMS0xMS41LDI1LjYtMjUuNiwyNS42Yy0xNC4xLDAtMjUuNi0xMS41LTI1LjYtMjUuNkMxNjUsMjM5LjgsMTc2LjUsMjI4LjMsMTkwLjYsMjI4LjN6Ii8+DQo8L2c+DQo8L3N2Zz4NCg==" c_shapetype="line" c_rotation="0" class=""></image><image logotype="zh" locked="0" x="694.99995" y="768.000025" width="104" height="20" preserveAspectRatio="none" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMTY5Mi45IDM0MS41IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxNjkyLjkgMzQxLjU7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtmaWxsOiM1NTg4RkY7fQ0KPC9zdHlsZT4NCjxnPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMTk4LjIsNDguNGMtMC4zLDAtMTE2LjgsMC0xMTYuOCwwbC0yOS42LDIxNi41aDEyMi4xdjBjMTAuMy0wLjIsMTguNi04LjYsMTguNi0xOC45DQoJCWMwLTEwLjUtOC41LTE4LjktMTguOS0xOC45Yy0wLjQsMC03NS43LDAuMS03NS43LDAuMWw4LTU3LjRjMCwwLDc3LjMsMC4xLDc4LDAuMWMxMC42LDAsMTkuMi04LjYsMTkuMi0xOS4yDQoJCWMwLTkuNS02LjktMTcuNC0xNi0xOC45bC03NS45LDBsNi4yLTQ0LjljMCwwLDgwLjUtMC4xLDgxLTAuMWMxMC42LDAsMTkuMi04LjYsMTkuMi0xOS4yQzEyMTcuNCw1NywxMjA4LjgsNDguNCwxMTk4LjIsNDguNHoiLz4NCgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTQwOS45LDE1Mi4xYzAtMjEuMy00LjktNDAuMS0xNC43LTU2LjRjLTkuOC0xNi4zLTIyLjYtMjguMi0zOC4zLTM1LjhjLTE1LjctNy42LTM5LjYtMTEuNC03MS44LTExLjRoLTM0LjMNCgkJbC0yOS42LDIxNi41aDY3LjNjMjguMiwwLDUwLjMtNC4yLDY2LjItMTIuNmMxNS45LTguNCwyOS4xLTIxLjcsMzkuNS00MEMxNDA0LjcsMTk0LDE0MDkuOSwxNzMuOSwxNDA5LjksMTUyLjF6IE0xMzU2LjcsMTk2LjgNCgkJYy03LjgsMTEuOS0xOC4yLDIwLjMtMzEuMiwyNS4yYy05LjIsMy40LTI0LjEsNS4yLTQ0LjcsNS4yaC0xMy40bDE5LjEtMTQwLjVoMTAuMmMxNi43LDAsMzAsMi42LDQwLjEsNy45DQoJCWMxMCw1LjMsMTcuOCwxMi43LDIzLjMsMjIuNGM1LjUsOS43LDguMywyMS43LDguMywzNkMxMzY4LjQsMTcwLjMsMTM2NC41LDE4NC45LDEzNTYuNywxOTYuOHoiLz4NCgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMTU2NS45LDE0OS44bC0yMy43LDEzYy0yLDE3LjEtMTYuNSwzMC41LTM0LjIsMzAuNWMtMTksMC0zNC40LTE1LjQtMzQuNC0zNC40YzAtMTksMTUuNC0zNC40LDM0LjQtMzQuNA0KCQljNy4zLDAsMTQuMSwyLjMsMTkuNiw2LjJsMjkuNC0xNi4ybC0xNS45LTYzLjloLTMzLjZsLTExNC42LDIxMi4yaDQyLjlsMjQuMS00NS4xaDg0LjJsMTEuMyw0NS4xaDM4LjdMMTU2NS45LDE0OS44eiIvPg0KCQ0KCQk8ZWxsaXBzZSB0cmFuc2Zvcm09Im1hdHJpeCgxLjA2MzY3NGUtMDIgLTAuOTk5OSAwLjk5OTkgMS4wNjM2NzRlLTAyIDEzMzQuNjAzOSAxNjY1LjE2NzgpIiBjbGFzcz0ic3QwIiBjeD0iMTUwOC44IiBjeT0iMTU4LjEiIHJ4PSIxMy4zIiByeT0iMTMuMyIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05NDIuNSwyMTkuOGMyLjUsMi44LDYuMiw0LjUsMTAsNC41aDAuNWM3LjUsMCwxMy44LTUuNiwxNC44LTEzbDIwLTE0MS44SDk1OWwtMTkuOCwxMzkuOA0KCQlDOTM4LjgsMjEzLDkzOS45LDIxNi45LDk0Mi41LDIxOS44eiIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05NzYuOCwyMzUuN2MtMC4zLDIuMi0xLjUsNC41LTMuNCw2LjVjLTEuOCwxLjctMy43LDIuNS02LDIuNWgtMTkuNmMtNy4zLDAtMTMuOCw1LjctMTQuOCwxM2wtMC4xLDAuNQ0KCQljLTAuNSwzLjksMC43LDcuNywzLjIsMTAuNmMyLjUsMi44LDYuMiw0LjUsMTAsNC41aDE5LjZjNS4zLDAsMTAuMS0xLDE0LjUtMy4yYzEzLjYtNS42LDIyLjktMTcuNiwyNC44LTMyLjNsMjQuOC0xOTEuMWgtMjguNQ0KCQlMOTc2LjgsMjM1Ljd6Ii8+DQoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTkzMy44LDExOC43YzMuNiwwLDYuNS0yLjksNi41LTYuNWMwLTAuNy0wLjEtMS4zLTAuMy0xLjljMCwwLDAsMCwwLjEsMGwtMTEuOS00MS41bC0wLjEtMC4yDQoJCWMtMy04LTYuOS0xNC4xLTExLjctMTcuOWwtMC41LTAuNGMtNS42LTMuNi0xMi45LTUuNC0yMi40LTUuNGgtMzIuMmMtOS4xLDAtMTYuNywxLjktMjIuNSw1LjVjLTYuMiwzLjktMTEuNSw5LjYtMTUuNiwxNi44DQoJCWMwLDAtMTYuNSwyNy42LTI1LjEsNDEuOWwwLjEsMC4xYy0wLjUsMC45LTAuOCwxLjktMC44LDNjMCwzLjYsMi45LDYuNSw2LjUsNi41YzAuMSwwLDAuMiwwLDAuMiwwaDIwLjRjMS42LTIuNywzLjMtNS4zLDQuOS04DQoJCWwwLjUtMC44YzUuMy05LjIsMTItMjAuNSwxNy4zLTI5LjFsMC4xLTAuMmMxLjQtMi40LDMuMy00LjQsNS4zLTUuN2MxLjYtMSw0LTEuNSw3LTEuNWgzMi4yYzIuNywwLDQuNywwLjQsNS43LDEuMQ0KCQljMS40LDEuMSwyLjYsMi44LDMuMiw0LjZsMTEuNCwzOS41aDIwLjhjMCwwLDAtMC4xLDAtMC4xQzkzMy4yLDExOC43LDkzMy41LDExOC43LDkzMy44LDExOC43eiIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik05MDAuNSwxMjcuNWgtNjAuMWMtOC4zLDAtMTYuNywzLjMtMjMuNiw5LjJjLTYuNyw1LjctMTEuMiwxMy40LTEyLjcsMjEuNkw3ODkuOSwyMzZjLTAuOSw1LTAuNyw5LjksMC41LDE0LjINCgkJYzIuMiw5LjEsOCwxNi4xLDE2LjIsMTkuN2MzLjksMi4yLDguNCwzLjMsMTMuOCwzLjNoODMuMWM3LjQsMCwxMy45LTUuNSwxNS4yLTEyLjlsMC4xLTAuNWMwLjctMy45LTAuMy03LjctMi43LTEwLjYNCgkJYy0yLjQtMi44LTUuOC00LjQtOS44LTQuNGgtODMuMWMtMS44LDAtMy4zLTAuNy00LjQtMmwtMC4yLTAuMmMtMC42LTAuNy0xLjQtMS45LTAuOS00LjZsMTQuMy03Ny44YzAuMy0xLjUsMC43LTIuMiwxLjktMy4xDQoJCWwwLjUtMC40YzAuNy0wLjcsMS40LTEsMy4yLTFoNjAuMWMwLjgsMCwxLjIsMC4xLDEuMiwwLjFsMC4zLDAuNGMwLjIsMC4zLDAuNSwwLjYsMC4yLDJsLTcuNSwzMi44Yy0wLjUsMi43LTIuNSw0LjUtNSw0LjVoLTI2LjkNCgkJYy03LjMsMC0xNCw1LjctMTUuMiwxMi45bC0wLjEsMC43Yy0wLjYsMy43LDAuMyw3LjQsMi43LDEwLjJjMi40LDIuOSw2LDQuNSw5LjgsNC41aDI2LjljMC44LDAsMS41LDAsMi4zLTAuMQ0KCQljMC42LDAsMS4yLDAuMSwxLjgsMC4xYzE2LjMsMCwyOC4zLTEwLjQsMjkuOS0yMy44YzEtMy43LDkuNi0zOS44LDkuNi0zOS44YzAuOC00LjMsMC42LTguNi0wLjYtMTIuMw0KCQlDOTIzLjgsMTM1LjUsOTEzLjUsMTI3LjUsOTAwLjUsMTI3LjV6Ii8+DQoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTc0OC41LDI0NC41SDU0NmwtMi4xLDIyLjFjMCwwLDAsMCwwLjEsMGMwLDAsMCwwLjEsMCwwLjFjMCwzLjYsMi45LDYuNiw2LjYsNi42YzAsMCwwLDAsMCwwYzAsMCwwLDAsMCwwDQoJCWgxOTYuMmM3LjIsMCwxMy42LTUuNywxNC42LTEzbDAuMS0wLjdjMC41LTMuOS0wLjctNy44LTMuMi0xMC43Qzc1NS43LDI0Ni4xLDc1Mi4yLDI0NC41LDc0OC41LDI0NC41eiIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik02ODkuMSwyMzguMmwxLjUsMC40YzEuMiwwLjMsMi40LDAuNSwzLjYsMC41aDBjNS42LDAsMTAuOS0zLjQsMTMuNC04LjZjMTUuNC0zMy4xLDI3LjItODUsMzkuNy0xMjYuNg0KCQlsMC4xLTAuM2MwLjEtMC4zLDAuMS0wLjUsMC4yLTAuOGgtMjkuNmMtMTEuNywzOC44LTIyLjQsODcuNi0zNi4yLDExNy4yYy0xLjYsMy42LTEuNiw3LjYsMCwxMS4yDQoJCUM2ODMuMSwyMzQuNCw2ODUuNywyMzYuOSw2ODkuMSwyMzguMnoiLz4NCgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNjAzLjEsMjI1LjFjMSw2LjQsNi4zLDEwLjgsMTIuOSwxMC44YzEsMCwyLTAuMSwzLTAuM2wwLjMtMC4xYzctMS45LDExLjctOC4zLDExLjEtMTUuMmwtMTEuOS0xMTUuMWgtMjgNCgkJYzAsMCwwLDAuMSwwLDAuMWwxMi42LDExOS40TDYwMy4xLDIyNS4xeiIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03NTgsNjVoLTcxLjZsMy44LTI0LjloLTIyLjRjMCwwLDAsMCwwLDBjLTAuMSwwLTAuMiwwLTAuNCwwYy0zLjMsMC02LDIuNS02LjQsNS44YzAsMCwwLDAsMCwwTDY1Ny43LDY1DQoJCWMwLDAtODYuOCwwLTg3LjMsMC4xbC0xLjksMjAuMmMtMC4xLDAuNC0wLjEsMC44LTAuMSwxLjNjMCwzLjYsMi45LDYuNSw2LjUsNi42YzAsMCwwLDAuMSwwLDAuMWMzNC4zLDAuMSwxODEuNSwwLDE4MS41LDANCgkJYzcuNSwwLDEzLjgtNS41LDE0LjgtMTIuOGwwLTAuMmMwLjUtNC0wLjYtNy44LTMuMS0xMC43Qzc2NS43LDY2LjUsNzYyLjEsNjUsNzU4LDY1eiIvPg0KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00MzMsMTA1LjNjLTcuMi0xOC45LTE4LjgtMzYuMS0zNC4yLTQ5LjljLTIzLjYtMjEuMi01NC0zMi45LTg1LjgtMzIuOWMtMjcuNSwwLTUzLjcsOC42LTc1LjgsMjQuOA0KCQljLTEwLjcsNy44LTE5LjksMTcuMS0yNy42LDI3LjVjLTQuOC0wLjctOS43LTEtMTQuNi0xYy0yNy40LDAtNTMuMiwxMC43LTcyLjUsMzAuMWMtMTkuNCwxOS40LTMwLjEsNDUuMS0zMC4xLDcyLjUNCgkJYzAsMjUuNSw5LjQsNDkuOSwyNi41LDY4LjhjMTMuNiwxNSwzMS4xLDI1LjUsNTAuNCwzMC41YzguNCwyNSwzMi4xLDQzLDU5LjgsNDNjMzQuOCwwLDYzLjEtMjguMyw2My4xLTYzLjFjMC0yLTAuMS00LjEtMC4zLTYuMQ0KCQlsODguNi00Ni41bC0xOS40LTMzLjZsLTg0LjcsNDQuNWMtMTEuNi0xMy4xLTI4LjUtMjEuNS00Ny40LTIxLjVjLTI3LjQsMC01MC43LDE3LjUtNTkuNSw0MS45Yy0yMi4zLTkuOC0zNy45LTMyLTM3LjktNTgNCgkJYzAtMzQuOSwyOC4zLTYzLjMsNjMuMy02My4zYzEyLjMsMCwyMy44LDMuNSwzMy42LDkuNmMxMS43LTM1LjQsNDUuMS02MC45LDg0LjQtNjAuOWM0NS43LDAsODMuNCwzNC41LDg4LjQsNzguOQ0KCQljMS42LTAuMiwzLjItMC4yLDQuOC0wLjJjMjcuNCwwLDQ5LjYsMjIuMiw0OS42LDQ5LjZjMCwyNS45LTE5LjksNDcuMi00NS4zLDQ5LjRsLTI4LjQsMGMtMS4zLTAuMy0yLjYtMC40LTMuOS0wLjQNCgkJYy0xMC45LDAtMTkuOCw4LjktMTkuOCwxOS44YzAsMTAuNCw4LDE4LjksMTguMiwxOS43djAuMmwzMy44LDBsMS43LDBsMS43LTAuMWMyMi4xLTEuOSw0Mi42LTExLjksNTcuNy0yOC4zDQoJCWMxNS4yLTE2LjUsMjMuNi0zNy45LDIzLjYtNjAuM0M0OTUuMiwxNTAuMyw0NjksMTE2LjYsNDMzLDEwNS4zeiBNMjI5LjIsMjMxLjJjMTMuNCwwLDI0LjQsMTAuOSwyNC40LDI0LjQNCgkJYzAsMTMuNC0xMC45LDI0LjQtMjQuNCwyNC40Yy0xMy40LDAtMjQuNC0xMC45LTI0LjQtMjQuNEMyMDQuOCwyNDIuMSwyMTUuOCwyMzEuMiwyMjkuMiwyMzEuMnoiLz4NCjwvZz4NCjwvc3ZnPg0K" c_shapetype="line" c_rotation="0" class=""></image></g> </g></svg>'
;!function(){if(!e.console){var t=function(){};return{log:t,info:t,warn:t,error:t}}var n={};["log","info","warn","error"].forEach(function(t){n[t]=e.console[t].bind(e.console)})}();ua.ini=ua.removeOne=ua.clear=ua.setPreData=function(){};ua.getNewPre=function(e){if(e&&(e.length||e.pre)&&(me(wo)||wo==ia.SCHMODULE)){return pn("project_getNewPre",[e,!1])}return e};ua.getNewPreArr=function(e,t){return e&&e.length&&(me(wo)||wo==ia.SCHMODULE)?pn("project_getNewPre",[e,t]):e};ua.isUsed=function(e,t){return pn("checkPreIsUsed",[e,t])};ua.checkPreDuplicate=function(e){return pn("checkPreDuplicate",[e])};ua._sortByCols=function(e,t){var n=e.x-t.x;0===n&&(n=e.y-t.y);return n};ua._sortByRows=function(e,t){var n=e.y-t.y;0===n&&(n=e.x-t.x);return n};ua._getPreArr=function(e){var t=ha.gJsonCache.schlib,n=[];for(var r in t)if(j(t,r)){if(0===r.indexOf("frame_"))continue;var i=null;for(var a in t[r].annotation)if(j(t[r].annotation,a)&&"P"==t[r].annotation[a].mark){i=t[r].annotation[a];break}if(i){var o=(i.string||"").trim();n.push({pre:"keepOld"==e||o.indexOf("?")>=0?o:(o||"").replace(/\d+/,"?"),schlibId:r,preId:a,x:+t[r].head.x||1,y:+t[r].head.y||1})}}return n};ua._setNewPre=function(e,t,n){var r=v(n);if(r){Nt(r.childNodes[0],e);r=ha.gJsonCache.schlib[t].annotation[n];r.string=e}};ua.annotion=function(e){if(e&&e.length){for(var t=[],n=ha.gJsonCache.schlib,r=0;r<e.length;r++){var i=e[r],a=i.preId,o=i.preNew,s=i.schlibId,c=n[s],l=c&&c.annotation&&c.annotation[a];if(l&&l.string!=o){var d=v(a),u=L("#"+a+' > text[c_note="note_pre"]',d);if(!d||!d.id||!u)continue;var h=d.cloneNode(!0);Nt(u,o);var f=d.cloneNode(!0);t.push(["node",d.id,h,f]);l.string=o}}t.length&&La.save(t);return t.length}};var oo=function(){var e=function(){var e={red:["#610000","#FF0000"],yellow:["#595900","#FFFF00"],green:["#005000","#00FF00"],blue:["#003399","#33CCFF"]};return{colorMap:e,colorLight:function(t,n,r){if(!e[n])return!1;w(t,"stroke",e[n][r]);w(t,"fill",e[n][r]);w(t,"state",r)}}}(),t=function(e){e=e.toUpperCase();var t,n,r=ha.gJsonCache.schlib;for(var i in r)if(j(r,i)){if(i.indexOf("frame_lib")>=0)continue;n=r[i].annotation;for(var a in n)if("P"===n[a].mark){var o=0===n[a].string.indexOf("X")?n[a].string:"X"+n[a].string;e=0===e.indexOf("X")?e:"X"+e;if(o===e){t=v(i);return t}}}return null};return{findObjByPre:t,showResult:function(e){for(var n in e)if(j(e,n)){var r=e[n],i=t(n);if(i){var a=Wa.c_paraToJson(w(i,"c_para")).spiceSymbolName,o=i.childNodes.filter(function(e){return"part_annotation"===w(e,"c_partid")}),s=i.childNodes.filter(function(e){return"path"===e.tagName||"polyline"===e.tagName||"text"===e.tagName});switch(a){case"LOGICPROBE":o[2]&&(o[2].childNodes[0].textContent=r);break;case"MULTIMETER":m=w(i,"c_rotation");m&&"0"!==m&&lo.g(i,+m);s.forEach(function(e){i.removeChild(e)});o[2]&&i.removeChild(o[2]);var c,l=i.childNodes.filter(function(e){return"rect"===e.tagName});c=l[l.length-1];var d=Wa.svg.getBBox(c),u=2,h=Wt("g",{c_partid:"part_annotation",c_shapetype:"group",id:Wa.newId()}),f=Wt("text",{type:"spice_res",abs_type:"multimeter"});h.appendChild(f);var p=Wa.c_paraToJson(w(i,"c_para")),g="Amper"===p["Multimeter Type"]?"A":"V";f.innerHTML=r+g;i.appendChild(h);var y=Wa.svg.getBBox(f);if(y.width>45){w(f,{textLength:45,lengthAdjust:"spacingAndGlyphs"});y=Wa.svg.getBBox(f)}var x=d.x+d.width/2-(y.x+y.width/2),v=d.y+u-y.y;St(f,x,v);m&&"0"!==m&&lo.g(i,360-m);break;case"WATTMETER":var m=w(i,"c_rotation");m&&"0"!==m&&lo.g(i,+m);var L,_,b,S,C,M=i.children.filter(function(e){return"rect"===e.tagName}),N=i.children.filter(function(e){return"spice_res"===w(e.childNodes[0],"type")}),P=M[M.length-2],T=M[M.length-1],O=Wa.svg.getBBox(P),k=Wa.svg.getBBox(T);u=0;C=-2.5;if(N.length)N.forEach(function(e){i.removeChild(e)});else{o=i.children.filter(function(e){return"part_annotation"===w(e,"c_partid")});s=[s[0],s[1],o[2]];s.forEach(function(e){i.removeChild(e)})}b=Wt("g",{c_partid:"part_annotation",c_shapetype:"group",id:Wa.newId()});S=Wt("g",{c_partid:"part_annotation",c_shapetype:"group",id:Wa.newId()});L=Wt("text",{type:"spice_res",abs_type:"wattmeter_freq"});_=Wt("text",{type:"spice_res",abs_type:"wattmeter_rate"});b.appendChild(L);S.appendChild(_);w(_,"font-size","11px");L.innerHTML=r.Freq;_.innerHTML=r.Rate;i.appendChild(b);i.appendChild(S);var A=Wa.svg.getBBox(L),E=Wa.svg.getBBox(_),I=O.x+O.width/2-(A.x+A.width/2),B=k.x+k.width/2-(E.x+E.width/2),D=O.y+u-A.y,F=k.y+C-E.y;St(L,I,D);St(_,B,F);if(A.width>60){A=Wa.svg.getBBox(L);w(L,{textLength:60,lengthAdjust:"spacingAndGlyphs"});w(L,"x",A.x+A.width/2-30)}if(E.width>20){E=Wa.svg.getBBox(_);w(_,{textLength:20,lengthAdjust:"spacingAndGlyphs"});w(_,"x",E.x+E.width/2-10)}m&&"0"!==m&&lo.g(i,360-m)}ha.updateOne(i)}}},showMovingResult:function(n){function r(n){for(var r in n)if(j(n,r)){var a=t(r),o=n[r],s=Wa.c_paraToJson(w(a,"c_para")),c=s.spiceSymbolName;switch(c){case"TRAFFICLIGHT":var l,d={red:0,yellow:1,green:2},u=a.childNodes.filter(function(e){return"ellipse"===e.tagName});for(var h in o)if(j(o,h)){l=u[d[h]];e.colorLight(l,h,o[h])}break;case"BCDSEGMENT":case"SEVENSEGMENT":var f="Common Cathode"===s.Type,p="SEVENSEGMENT"===s.spiceSymbolName;d={0:p?3:[0,1,2,4,5,6],1:p?5:[2,6],2:p?1:[0,2,3,4,5],3:p?2:[0,2,3,4,6],4:p?0:[1,2,3,6],5:p?4:[0,1,3,4,6],6:p?6:[0,1,3,4,5,6],7:[0,2,6],8:[0,1,2,3,4,5,6],9:[0,1,2,3,4,6],10:[0,1,2,3,5,6],11:p?[0,1,2,3,4,5,6]:[1,3,4,5,6],12:[0,1,4,5],13:p?[0,1,2,4,5]:[2,3,4,5,6],14:[0,1,3,4,5],15:[0,1,3,5]};u=a.childNodes.filter(function(e){return"polygon"===e.tagName});u.shift();var g,y,x=s.Color.toLowerCase();u.forEach(function(t){e.colorLight(t,x,0)});if(p){y=f?o.num:i(o.num);for(v=0;v<y.length;v++)y[v]&&e.colorLight(u[d[v]],x,parseInt(y[v]))}else{g=f?parseInt(o.num,2):parseInt(i(o.num),2);for(var v=0;v<d[g].length;v++){y=d[g][v];e.colorLight(u[y],x,1)}}break;case"LED":var m=a.childNodes.filter(function(e){return"ellipse"===e.tagName})[0];x=s.Color?s.Color.toLowerCase():s.Colour.toLowerCase();var L=o.state?e.colorMap[x][1]:"none";w(m,"fill",L);break;case"LAMP":m=a.childNodes.filter(function(e){return"ellipse"===e.tagName})[0];var _=Wa.c_paraToJson(w(a,"c_para"))["Dropout Voltage"]||12;L=o.value>=_?"#FFFFA0":"none";w(m,"fill",L);break;case"LOGICPROBE":var b=a.childNodes.filter(function(e){return"part_annotation"===w(e,"c_partid")})[2];b.childNodes[0].textContent=o.state}}}function i(e){var t,n=[];"string"!=typeof e&&e.toString();for(var r=0;r<e.length;r++){t="1"===e[r]?"0":"1";n.push(t)}n=n.join("");return n}var a=Object.keys(n);if(a.length){var o,s,c=n[a[0]].length,l=0;!function e(){setTimeout(function(){var t={};for(s=0;s<a.length;s++){o=a[s];t[o]=n[o][l]}r(t);l++;l<c&&e()},150)}()}}}}(),so={uplock:!0,findPointInArr:function(e,t,n){for(var r=0,i=n?n.length:0;r<i;r++)if(n[r].x==e&&n[r].y==t)return r;return-1},findWires:function(e){if(!e||e.length<2)return!1;var t,n,r,i=e.length,a=ha.getWires(),o={},s=[];for(t in a)if(j(a,t)&&a[t]){s=a[t];for(n=0;n<i;n+=2){r=so.findPointInArr(e[n],e[n+1],s);if(r>-1){o[t]=r;break}}}return o},deleteWires:function(e){var t=so.findWires(e);for(var r in t){var i=v(r);i&&la.select(i)}n("delete")},calFollowing:function(e){var t,n,r,i,a,o,s,c,l,d,u,h=e.length,f={},p={},g=[],y={},x={},m={},L={};for(t=0;t<h;t++){a=e[t];o=w(a,"c_etype");if("wire"===o)f[a.id]=1;else if("pinpart"===o){p[a.id]=1;g.push(a)}}for(t=0,h=g.length;t<h;t++){a=g[t];s=ha.getPinDots(a);r=[];i=[];for(n=1;n<s.length;n+=2){c=so.findWires([s[n-1],s[n]]);for(l in c)if(j(c,l))if(j(f,l))delete c[l];else if(v(l))y[l]=1;else{delete y[l];delete c[l]}r.push(c);d=so.findNoConnectFlags([s[n-1],s[n]]);for(u in d)if(j(d,u))if(j(p,u))delete d[u];else if(v(u))x[u]=1;else{delete x[u];delete d[u]}i.push(d)}m[a.id]=r;L[a.id]=i}return{followingMap:m,followingWireIds:y,followingMapFlag:L,followingNoConnectFlagIds:x}},moveFollowing:function(e){var t,n,r,i,a,o,s,c,l,d,u,h,f,p,g,y,m={};for(t in e)if(j(e,t)){n=ha.getPinDots(v(t));r=e[t];if(!n||!r)continue;for(c=0,l=r.length;c<l;c++){i=r[c];u=n[2*c];h=n[2*c+1];f={x:u,y:h};for(a in i)if(j(i,a)&&!po.isLocked(v(a))){o=i[a];s=function(e,t){if(t)return e?t[e]:t}(a,m)||ha.getWires(a);if(!s)continue;s=D(s);if(go.isPointEqual(s[o],f));else if(s.length>=3){p=s[o];g=s[o-1];y=s[o+1];var L=null,_=null;if(g)if(g.x==p.x){o-1==0&&g.x!=u&&(L={x:g.x,y:g.y});g.x=u}else if(g.y==p.y){o-1==0&&g.y!=h&&(L={x:g.x,y:g.y});g.y=h}if(y)if(y.x==p.x){o+1===s.length-1&&y.x!=u&&(_={x:y.x,y:y.y});y.x=u}else if(y.y==p.y){o+1===s.length-1&&y.y!=h&&(_={x:y.x,y:y.y});y.y=h}p.x=u;p.y=h;_&&s.push(_);L&&s.unshift(L)}else{p=s[0];g=s[1];if(!this.uplock||p.x!=g.x&&p.y!=g.y)this.uplock=!1;else{p.x,p.y,g.x,g.y;p.x==g.x?u!=p.x&&s.splice(1,0,new x(p.x,h)):p.y==g.y&&h!=p.y&&s.splice(1,0,new x(u,p.y));s.length>2&&o>0&&o++}s[o].x=u;s[o].y=h}d=H(s);if(d.indexOf("NaN")>=0);else{w(v(a),{points:d});m[a]=s}}}}},appendWire:function(e){function t(e){for(var t,n,r,i,a=ha.gJsonCache.schlib,o=Object.keys(a),s=0;s<o.length;s+=1){r=a[o[s]];n=Object.keys(r.pin||{});for(i=0;i<n.length;i+=1){t=r.pin[n[i]];if(t.pinDot.x===+e.x&&t.pinDot.y===+e.y)return e}}return!1}function n(e){var t=Wt("polyline",{points:e.x+" "+e.y+" "+e.x+" "+e.y,"stroke-width":1,stroke:"#008800",fill:"none",c_shapetype:"line",c_etype:"wire"}),n=Rt(t);Ji.appendChild(t);ha.updateOne(t);r[n]=1}var r={};e.forEach(function(e){var r,i=de(e),a=e.id,o=!1;switch(i){case"busentry":r=ha.gJsonCache[i][a];o=t({x:r.x1,y:r.y1});o=o||t({x:r.x2,y:r.y2})}o&&n(o)});return!!Object.keys(r).length&&r},addBusEntry:function(e,t){function n(n){var r=s[n],i=nt({x:r.x1,y:r.y1},a);i=i>-1?i:nt({x:r.x2,y:r.y2},a);-1!==i&&(t&&i-1!==t||-1===e.indexOf(v(n))&&o.push(v(n)))}var r,i,a,o=[],s=ha.gJsonCache.busentry||{};for(r=0;r<e.length;r+=1){a=e[r];i=de(a);"bus"===i&&"polyline"===a.tagName&&Object.keys(s).forEach(n)}return o},dragWires:function(e,t,n,r){var i=e.length;if(i<2)return!1;var a,o,s=B(r),c="",l=[];if(s)for(var d in s)if(j(s,d)&&s[d]){l=ha.getWires(d);for(var u=0;u<i;u+=2){o=so.findPointInArr(e[u],e[u+1],l);if(o>-1){l[o].x-=-t;l[o].y-=-n;c=H(l);a=v(d);w(a,{points:c});break}}}},findNoConnectFlags:function(e){if(!e||e.length<2)return!1;var t,n,r,i=e.length,a=ha.getNoConnectFlags(),o={},s=[];for(t in a)if(j(a,t)&&a[t]){s=[a[t]];for(n=0;n<i;n+=2){r=so.findPointInArr(e[n],e[n+1],s);r>-1&&(o[t]=r)}}return o},moveFollowingNoConnectFlags:function(e){var t,n,r,i,a,o,s,c,l,d;for(t in e)if(j(e,t)){n=ha.getPinDots(v(t));r=e[t];if(!n||!r)continue;for(s=0,c=r.length;s<c;s++){i=r[s];for(a in i)if(j(i,a)){o=ha.getNoConnectFlags(a);if(!o)continue;o.x=n[2*s];o.y=n[2*s+1];l=v(a);if(po.isLocked(l))continue;noConnectFlagKeyObjChildren=l.children;w(l,{c_origin:n[2*s]+","+n[2*s+1]});if(noConnectFlagKeyObjChildren&&"path"===noConnectFlagKeyObjChildren[0].tagName){d="M "+String(n[2*s]-4)+" "+String(n[2*s+1]-4)+" L "+String(n[2*s]+4)+" "+String(n[2*s+1]+4)+" M "+String(n[2*s]+4)+" "+String(n[2*s+1]-4)+" L "+String(n[2*s]-4)+" "+String(n[2*s+1]+4);w(noConnectFlagKeyObjChildren[0],{d:d})}}}}}};Wa.camelize=function(e){return e.replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase()})};Wa.dasherize=function(e){return e.replace(/[a-z][A-Z]/g,function(e){return e.charAt(0)+"-"+e.charAt(1).toLowerCase()})};Wa.extractDocType=function(e){return"string"==typeof e?e.split(oa)[0]:e.docType};Wa.json2EntitiedStr=function(e){return(JSON.stringify(e)||"").replace(/"/g,"&quot;")};Wa.newId=function(){return"gge"+ ++to};Wa.toHexColor=function(e){if(/^#.{6}$/.text(e))return e.toUpperCase();if(/^#...$/.text(e))return e.replace(/[^#]/g,"$&$&").toUpperCase();if(/^rgb\((\d+).+(\d+).+(\d+)\)$/.text(e)){e="#"+(+RegExp.$1+256).toString(16)+(+RegExp.$2+256).toString(16)+(+RegExp.$3+256).toString(16);return e.replace(/1(..)/g,"$1").toUpperCase()}return e};Wa.isValidImageURL=function(e,t){var n=/^(https)?\/\/[\w.-]+\/[\w.%\/~!()-]+[^\s#?"]+\.(jpg|jpeg|png|gif|svg|webp)$/i,r=/^data:image\/(jpeg|png|gif|svg\+xml|webp);base64,[\dA-Za-z\/+]+={0,2}$/,i=/^\/assets\/static\/images\/[\w.%\/-]+\.(jpg|jpeg|png|gif|svg|webp)$/;t=t||{};return!0===t.strict?!!e&&r.test(e):!!e&&(n.test(e)||r.test(e)||i.test(e))};Wa.numberlistToArray=function(e,t){if(!e)return[];var n,r=e.trim().split(t||/[\s,]+/g);for(n=0;n<r.length;n++)r[n]=+r[n];return r};Wa.extend=function(){var e,t=0,n=arguments,r=n.length,i=!1;if(r<1)return{};if("boolean"==typeof n[0]){i=n[0];e=n[1];t=1}else if("boolean"==typeof n[r-1]){i=n[r-1];e=n[0];r--}else e=n[0];(!e||"object"!=typeof e&&"function"!=typeof e)&&(e={});for(;t<r;t++){var a=n[t];if(a&&"object"==typeof a){if(a==e)continue;for(var o in a)j(a,o)&&(i&&a[o]&&"object"==typeof a[o]?e[o]=Wa.extend({},a[o]):e[o]=a[o])}}return e};Wa.cloneJSON=function(e){return e&&"object"==typeof e?B(JSON.stringify(e)):e};Wa.getVendorProperty=function(e,t){if(j(e,t))return e[t];var n=t.charAt(0).toUpperCase()+t.substr(1);return e["webkit"+n]||e["moz"+n]||e["o"+n]||e["ms"+n]};Wa.getErrorInfo=function(t){var n="",r=navigator,i=t.stack||t.error&&t.error.stack;"object"==typeof wa&&(n+="#build: "+wa.version+", "+wa.buildDate+";\n");var a=se();a&&(n+="#browser: "+a+";\n");n+="#userAgent: "+r.userAgent+";\n";r.platform&&(n+="#platform: "+r.platform+";\n");r.language&&(n+="#language: "+r.language+";");r.languages&&(n+=" langs:"+r.languages+";");r.systemLanguage&&(n+=" sysLang:"+r.systemLanguage+";");r.userLanguage&&(n+=" userLang:"+r.userLanguage+";");r.browserLanguage&&(n+=" browserLang:"+r.browserLanguage+";");n+="\n";"object"==typeof Locale&&Locale&&Locale._curr&&(n+="#Locale._curr: "+Locale._curr+";\n");var o=location.protocol+"//"+location.host;n+="#location: "+location.href.replace(o,"")+";\n";try{if(e!=top)n+="#top.location: "+top.location.href.replace(o,"")+";\n";else{var s=$("#tabbar_bodies .editframe").toArray();s.length&&(n+="#iframes: "+s.map(function(e){return e.getAttribute("src")}).join("  ")+"\n")}}catch(e){}n+="#tostring: "+t.toString()+";\n";t.toString()!=Object.prototype.toString.call(t)&&(n+="#tostring2: "+Object.prototype.toString.call(t)+";\n");t.type&&(n+="#type: "+t.type+";\n");var c=t.filename||t.fileName||t.error&&t.error.filename||t.error&&t.error.fileName||"";c=c.replace(/[^#?]+\//,"");var l=t.lineno||t.lineNumber||t.error&&t.error.lineno||t.error&&t.error.lineNumber||"",d=t.colno||t.columnNumber||t.error&&t.error.colno||t.error&&t.error.columnNumber||"";if(!c&&i)if(i.match(/\/([^\/]+):(\d+):(\d+)\)/)){c=RegExp.$1;l=RegExp.$2;d=RegExp.$3}else if(i.match(/\/([^\/]+):(\d+)\)/)){c=RegExp.$1;l=RegExp.$2}n+="#file: "+c+"; #line:"+l+"; #col:"+d+";\n";t.message?n+="#message: "+t.message+";\n":t.description?n+="#message: "+t.description+";\n":t.error&&t.error.message?n+="#message: "+t.error.message+";\n":t.error&&t.error.description&&(n+="#message: "+t.error.description+";\n");if(i){o=o.replace(/[\/:]/g,"\\$&");i=i.replace(new RegExp(o,"g"),"");i=i.replace(/\n(\S)/g,"\n  $1");n+="#stack: "+i+";\n";if(i.indexOf("this.get(...).querySelectorAll")>0){if(!top._querySelectorAll_err&&top.$&&top.$.messager&&top.$.messager.error){top._querySelectorAll_err=1;setTimeout(function(){"function"==typeof notifyReportBug?notifyReportBug():pn("notifyReportBug")},500)}for(var u=[[Element,"Element","innerHTML","__INNERHTML_DESCRIPTOR"],[Node,"Node","textContent","__TEXTCONTENT_DESCRIPTOR"]],h=0;h<u.length;h++){var f=u[h],p=f[1],g=f[2],y=e[f[3]];if(y)try{var x,v;x=Object.getOwnPropertyDescriptor(f.prototype,g);if(!x||x.set!=y.set){v={}.toString.call(x.set);n+="-----------------------\n"+p+" "+g+" set was overide:\n"+v+"\n";v.indexOf("[native code]")<0&&Object.defineProperty(f.prototype,g,y)}}catch(e){}}}}return{detail:n,file:c,lineno:l,colno:d}};Wa.submitJsError=function(e,t){try{if(!(e&&e.file&&e.lineno&&e.colno))return;if(e.detail.indexOf("https://embed.tawk.to/")>0)return;var n=e.detail.match(/#file:.+\n#message:.+\n#stack:.*\n.*(?:\n.*)?/);n||(n=e.detail.match(/#file:.+\n#message:.+/));!e.key&&n&&n[0]&&(e.key=MD5(n[0]).substr(8,16));if(!e.key)return;var r=wa.bugLog.lastSent,i=wa.bugLog.interval,a=16===e.key.length,o=Date.now(),s=e.key;if(a&&!t&&r[s]&&o-r[s]<i)return;var c={};t&&$.extend(c,t);$.extend(c,{keyId:e.key,file:e.file,detail:e.detail});e.fid&&c.detail&&(c.detail="#fid: "+e.fid+";\n"+c.detail);e.docType&&c.detail&&(c.detail="#docType: "+e.docType+";\n"+c.detail);$.extend(c,{locale:Locale._curr,build:wa.version+","+wa.buildDate,login:0|isLogined()});$.extend(c,Wa.getEnvInfo());if(c.browser.match(/^IE|^Edge|^Safari|^other/))return;if(c.browser.match(/^Chrome/)){var l=+c.browser.split(" ")[1];if(l&&l<65)return}if(c.browser.match(/^Firefox/)){var l=+c.browser.split(" ")[1];if(l&&l<60)return}e.fid&&$.extend(c,{fid:e.fid,docType:e.docType});if("function"==typeof editorCall){var d=editorCall("getLogs");d&&$.extend(c,{logs:d})}r[s]=o;$.postJSON({url:wa.apis.others.bugReport,data:{bugInfo:JSON.stringify(c)},timeout:6e4}).then(function(e){e&&e.success})}catch(e){}};Wa.reportError=function(e){if(e&&"object"==typeof e)try{var t=Wa.getErrorInfo(e);t.file&&t.lineno&&t.colno&&(void 0!==pn?pn("triggerEvent",["error",t]):Wa.submitJsError(t))}catch(e){}};Wa.getEnvInfo=function(){var n=navigator,r=n.userAgent.replace(/Mozilla\/\S*|AppleWebKit\/\S*|KHTML, like Gecko|/,""),i=t.body,a={os:[["Windows 10",/Windows NT (?:10\.|6\.4)/],["Windows 8.1",/Windows (?:8\.1|NT 6\.3)/],["Windows 8",/Windows (?:8|NT 6\.2)/],["Windows 7",/Windows (?:7|NT 6\.1)/],["Windows Phone",/Windows Phone/],["$1",/((?:Windows (?:NT )?|WinNT) \d+\.?\d*)/],["Mac OS",/Mac OS X|MacPPC|MacIntel|Mac_PowerPC|Macintosh/],["$&",/iPhone|iPad|iPod|OpenBSD|FreeBSD|Ubuntu|Linux|Unix|BlackBerry|OS\/2|Android/]],browser:[["IEMobile $1",/ IEMobile\/(\d+)/],["IE 11",/Edge\/12|Trident\/7.* rv:11/],["IE 10",/MSIE 10|Trident\/6/],["IE 9",/MSIE 9|Trident\/5/],["IE $1",/MSIE (\d+)/],["Electron $1",/Electron\/(\d+)/],["Firefox $1",/Firefox\/(\d+)/],["Opera $1",/Opera\/.*Version\/(\d+)/],["Chrome $1 Edg",/Chrome\/(\d+).+ Edg\//],["Chrome $1",/Chrome\/(\d+)/],["Safari $1",/Version\/(\d+).* Safari/,/Android/]]},o={platform:n.platform||"",language:n.language||n.userLanguage||"",os:"other",browser:"other",screen:{width:screen.width,height:screen.height,devicePixelRatio:e.devicePixelRatio||1,touch:0|("ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch)},features:{applicationCache:0|!!e.applicationCache,IndexedDB:0|!!Wa.getVendorProperty(e,"indexedDB"),FileSystem:0|!!Wa.getVendorProperty(e,"requestFileSystem"),WebWorker:0|!!e.Worker,history:"pushState"in e.history|0,hashchange:"onhashchange"in e|0,draganddrop:0|("draggable"in i||"ondragstart"in i&&"ondrop"in i)}};a.os.some(function(e){var t,n=e[0],i=e[1],a=e[2];if(t=r.match(i)){n=n.indexOf("$")<0?n:"$&"==n?t[0]:n.replace("$1",t[1]);if(!a||!a.test(r)){o.os=n;return!0}}});a.browser.some(function(e){var t,n=e[0],i=e[1],a=e[2];if(t=r.match(i)){n=n.indexOf("$")<0?n:"$&"==n?t[0]:n.replace("$1",t[1]);if(!a||!a.test(r)){o.browser=n;return!0}}});return o};Wa.c_paraToJson=function(e){if(!e)return{};if("string"!=typeof e)return e;for(var t=e.split(sa),n={},r=0,i=t.length-1;r<i;r+=2)t[r]&&(n[te(t[r])]=te(X(t[r+1]||"")));return n};Wa.jsonToC_para=function(e){var t="";if("string"==typeof e)return e;for(var n in e)if(n&&j(e,n)&&0!==n.indexOf("attr-")){var r=""+e[n];t+=ee(n)+sa+ee(r)+sa}return t};Wa.sortC_paraJson=function(e){var t=["name","package","Package Display","pre","BOM_Supplier","BOM_Supplier Part","BOM_Manufacturer","BOM_Manufacturer Part"],n=["Contributor"],r={};t.forEach(function(t){j(e,t)&&(r[t]=e[t])});for(var i in e)j(e,i)&&-1===t.indexOf(i)&&-1===n.indexOf(i)&&(r[i]=e[i]);n.forEach(function(t){j(e,t)&&(r[t]=e[t])});return r};Wa.getSCHCmdKey=function(e){if(!e||!e.tagName||e==Ji||b(e,$a)||e.contains(Ji))return"";var t=Tt(e);if("object"!=typeof t)return"";var n=t.c_partid,r=function(e){return e?0===e.indexOf("part_annotation")?"annotation":0===e.indexOf("part_pin")?"pin":0===e.indexOf("part_junction")?"junction":0===e.indexOf("part_busentry")?"busentry":0===e.indexOf("part_netLabel_text")?"netlabel":0===e.indexOf("part_netLabel_")?"netflag":0===e.indexOf("part_lib_")?"schlib":0===e.indexOf("part_arrowhead")?"arrowhead":0===e.indexOf("part_no_connect_flag")?"noconnectflag":0===e.indexOf("part_svg")?"svgnode":0===e.indexOf("part_image")?"pimage":"":""}(n);if(r)return r;var i=e.tagName;if("polyline"==i&&"wire"==t.c_etype)r="wire";else if("polyline"==i&&"bus"==t.c_etype)r="bus";else{r=i||"";"path"==r&&(r="arc1"==t.c_helper_type||"pie1"==t.c_helper_type?"arc":"path")}return r.toLowerCase()};Wa.getPCBCmdKey=function(e){if(!e||!e.tagName||e==Ji||b(e,$a)||e.contains(Ji))return"";var t=e.tagName,n=w(e,"c_partid")||"",r="";switch(t){case"g":if(!e.childNodes.length)return"";switch(n){case"part_sheet":r="SHEET";break;case"part_pad":r="PAD";break;case"part_via":r="VIA";break;case"part_hole":r="HOLE";break;case"part_pcbtext":r="TEXT";break;case"part_svg":r="SVGNODE";break;case"part_plane":r="PLANEZONE";break;case"part_intelligentruler":r="INTELLIGENTRULER";break;case"":e.id&&e.id.match(/^layer_/)||(r="SVGNODE");break;default:r=0===n.indexOf("part_lib_")?"FOOTPRINT":""}break;case"polyline":r="TRACK";break;case"path":w(e,"attachedcopperid")?r="":-1!=["cutout","npth","solid"].indexOf(w(e,"type"))?r="SOLIDREGION":w(e,"thermal")&&w(e,"copper")?r="COPPERAREA":"group"==w(e,"c_shapetype")?r="DIMENSION":"protractor"==w(e,"c_shapetype")?r="PROTRACTOR":"none"!=w(e,"stroke")&&(w(e,"stroke")||"part_sheet"!==w(e.parentNode,"c_partid"))||w(e,"fill")?(w(e,"d")||"").indexOf("A")>0&&(r="ARC"):r="SVGNODE";break;case"line":r="RATLINE";break;case"rect":r="RECT";break;case"circle":r="CIRCLE";break;case"text":r="SVGNODE";break;default:r=(t||"").toUpperCase();j(Mo,r)||(r=t.match(/^(ellipse|image|a)$/)?"SVGNODE":"")}return r};Wa.createPolylineForOvalPad=function(e,t,n,r,i){e=+e;t=+t;n=+n;r=+r;i=i||0;i=+i;var a=new x(0,0),o=new x(0,0),s=0,c=(n>r?r:n)/2;if(n<r){a.x=o.x=e;s=r/2-c;a.y=t-s;o.y=t+s}else{a.y=o.y=t;s=n/2-c;a.x=e-s;o.x=e+s}var l=[a.x,a.y,o.x,o.y];l=Fe(l,(360-i)%360,e,t);return l};Wa.convertRect2Polygon=function(e,t,n,r){return[+e,+t,+e+n,+t,+e+n,+t+r,+e,+t+r]};Wa.Dots={eachAdd:function(e,t,n){var r;for(r=0;r<e.length-1;r+=2){e[r]+=t;e[r+1]+=n}return e}};Wa.units={decimals:{pixel:2,mil:3,mm:3,inch:3},isUnit:function(e){return/^(pixel|mil|mm|inch)$/i.test(e)},changeElementsUnit:function(e,t,n){if(t!=n&&Wa.units.isUnit(t)&&Wa.units.isUnit(n))for(var r,i,a,o=0;o<e.length;o++){r=e[o].getAttribute("oldval")||e[o].value.toLowerCase();a=r.replace(/\D+$/,"");if(a&&isFinite(a)){i=Wa.units.convert(+a,t,n);e[o].value=Wa.formatLengthShow(i)+n;e[o].setAttribute("oldval",i+n)}}},convert:function(e,t,n){if(t==n)return 1*e;if("string"==typeof e){if(2==arguments.length){n=t;t=e.replace(/^[-+.\d\s]+/,"");e=e.replace(/[^-+.\d\s]+$/,"")}e=+e}if("number"!=typeof e||!isFinite(e))return 0;t=t.toLowerCase();n=n.toLowerCase();if("cm"==t){t="mm";e*=10}else"px"==t&&(t="pixel");if("cm"==n){n="mm";e*=.1}else"px"==n&&(n="pixel");if(t==n)return 1*e;if(!Wa.units.isUnit(t)||!Wa.units.isUnit(n))throw Error("Not supported unit convert "+t+" to "+n);switch(t+"2"+n){case"mil2pixel":return.1*e;case"mil2mm":return.0254*e;case"mil2inch":return.001*e;case"mm2pixel":return e/.254;case"mm2mil":return e/.0254;case"mm2inch":return e/25.4;case"pixel2mil":return 10*e;case"pixel2mm":return.254*e;case"pixel2inch":return.01*e;case"inch2pixel":return 100*e;case"inch2mil":return 1e3*e;case"inch2mm":return 25.4*e}throw Error("Not supported unit convert "+t+" to "+n)}};Wa.formatDate=function(e,t){if(e&&"[object Date]"==Object.prototype.toString.call(e)){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,e.getFullYear()));/(Z+)/.test(t)&&(t=t.replace(RegExp.$1,function(e,t){var n=15*-Math.round(e.getTimezoneOffset()/15),r=~~(n/60),i=~~n%60,a="+";n<0&&(a="-");return a+("00"+r).substr((""+r).length)+t+("00"+i).substr((""+i).length)}(e,1==RegExp.$1.length?":":"")));for(var r in n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}};Wa.formatLengthShow=function(e,t){t=t||wa;return Wa.toFixed(e,t.decimalPlacesShow,t.fixedDecimal)};Wa.formatLengthSave=function(e,t){t=t&&"number"==typeof t.decimalPlaces?t:wa;return Wa.toFixed(e,t.decimalPlaces)};x.prototype={toString:function(){return Wa.toFixed(this.x,3)+"_"+Wa.toFixed(this.y,3)}};Wa.modifyFileNameByInsertTimeString=function(e){var t=Wa.formatDate(new Date,"yyyy-MM-dd");return e&&e.replace(/\.[^.]+$/,"_"+t+"$&")};Wa.findItemFromArrWithKey=function(e,t,n){void 0===e&&(e=[]);void 0===t&&(t="");void 0===n&&(n="");for(var r=null,i=0;i<e.length;i++)if(void 0!==e[i][t]&&e[i][t]===n){r=e[i];break}return r};Wa.arc={c_helper_lines:[{type:"path_arc"},{from:0,to:1},{type:"rect_center_corner",center:0,corner:1},{from:0,to:2,ray:1},{from:0,to:3,ray:1}],c_helper_lines_pie1:[{type:"path_arc"},{from:0,to:1},{type:"rect_center_corner",center:0,corner:1},{from:2,to:0,ray:-1},{from:3,to:0,ray:-1}],getDotByAngle:function(e,t,n){var r=Math.PI,i=.5*r,a=r+r;n%=a;n<0&&(n+=a);if(0===n)return{x:e,y:0};if(n==i)return{x:0,y:t};if(n==r)return{x:-e,y:0};if(n==1.5*r)return{x:0,y:-t};var o=Math.tan(n),s=Math.sqrt(1/(1/(e*e)+o*o/(t*t)));n>i&&n<1.5*r&&(s=-s);var c=s?s*o:n<r?t:-t;n>r!=c<0&&(c=-c);return{x:s,y:c}},getAngle:function(e,t){if(0===e&&0===t)return null;var n=Math.atan2(t,e);return n<0?n+Math.PI+Math.PI:n},getArcParams:function(e,t,n,r,i,a,o,s){var c={fa:1,fs:0,angle:0},l=Wa.arc.getAngle(i-e,a-t),d=Wa.arc.getAngle(o-e,s-t);if(null===l||null===d)return null;var u=Wa.arc.getDotByAngle(n,r,l),h=Wa.arc.getDotByAngle(n,r,d);c.x1=e+u.x;c.y1=t+u.y;c.x2=e+h.x;c.y2=t+h.y;c.a1=l;c.a2=d;var f=Math.PI,p=f+f,g=(d<l?p:0)+d-l;c.fa=g>=f?1:0;c.fs=1;return c},getArcParamsByCRA:function(e,t,n,r,i,a,o){var s={angle:0,fa:1,fs:0},c=Wa.arc.getDotByAngle(n,r,i),l=Wa.arc.getDotByAngle(n,r,a);s.x1=e+c.x;s.y1=t+c.y;s.x2=e+l.x;s.y2=t+l.y;s.rx=n;s.ry=r;var d=Math.PI,u=d+d,h=(a-i)%u;h<0&&(h+=u);s.fs=o?1:0;s.fa=o?h>=d?1:0:h>=d?0:1;return s},convertSvgParam2CanvasParam:function(e){e=X(e.replace(/[^0-9\., \-]/gi," "));var t=e.split(/[ ,]+/g);return 9!==t.length?null:Wa.arc.getCenterParam(+t[0],+t[1],+t[7],+t[8],+t[5],+t[6],+t[2],+t[3],+t[4])||null},getCenterParam:function(e,t,n,r,i,a,o,s,c){function l(e,t,n,r){var i=e*n+t*r,a=Math.sqrt((e*e+t*t)*(n*n+r*r)),o=Math.acos(i/a);e*r-t*n<0&&(o=-o);return o}function d(e){for(;e>=y;)e-=y;for(;e<0;)e+=y;return e}function u(e){e.rx=o;e.ry=s;e.startAngle=e.theta1;e.endAngle=d(e.theta1+e.delta_theta);return e}var h,f,p,g,y=2*Math.PI;o<0&&(o=-o);s<0&&(s=-s);o==s&&(c=0);var x=Math.sin(c),v=Math.cos(c),m=(e-n)/2,L=(t-r)/2,_=(e+n)/2,b=(t+r)/2;if(o<1e-5||s<1e-5){p=l(1,0,n-e,r-t);return u({cx:_,cy:b,theta1:p,delta_theta:Math.PI})}var S=v*m+x*L,C=v*L-x*m,M=S*S/(o*o)+C*C/(s*s);if(M>1){o*=Math.sqrt(M);s*=Math.sqrt(M)}var w=o*s,N=o*C,P=s*S,T=N*N+P*P;if(!T)return u({cx:_,cy:b,theta1:0,delta_theta:0});var O=(w*w-T)/T;O=Math.sqrt(Math.abs(O));i==a&&(O=-O);var k=O*N/s,A=-O*P/o;h=v*k-x*A+_;f=x*k+v*A+b;var E=(S-k)/o,I=(S+k)/o,j=(C-A)/s,B=(C+A)/s;p=l(1,0,E,j);g=l(E,j,-I,-B);for(;g>y;)g-=y;for(;g<0;)g+=y;!1!==a&&0!==a||(g-=y);return u({cx:h,cy:f,theta1:p,delta_theta:g})},calculateArcHelperDots:function(e){var t,n,r,i,a,o,s,c,l,d,u,h=e.pathSegList,f=h.numberOfItems,p=f>0&&h.getItem(0),g=f>1&&h.getItem(1),y=f>2&&h.getItem(2);if(f<2)return[];if(2==f&&"A"==g.pathSegTypeAsLetter){u=g;t=p.x;n=p.y}else{if(!(f>=3&&"L"==g.pathSegTypeAsLetter&&"A"==y.pathSegTypeAsLetter))return[];u=y;t=g.x;n=g.y}r=u.x,i=u.y,a=u.largeArcFlag,o=u.sweepFlag,s=u.r1,c=u.r2,l=u.angle,d=l*Math.PI/180;var x=Wa.arc.getCenterParam(t,n,r,i,a,o,s,c,d),v=Wa.toFixed(x.cx,2),m=Wa.toFixed(x.cy,2),L=l%180==90||l%180==-90,_=v+(L?c:s),b=m+(L?s:c),S=[v,m,_,b,t,n,r,i];S.path_arc=["M"+t,n+"A"+s,c,l,1-a,1-o,r,i].join(" ");return S},getArcParamsBy3Points:function(e,t,n,r,i,a){function o(e,t,n){var r=Math.acos(e/n);return t>=0?r:2*Math.PI-r}var s=n-e,c=i-e,l=r-t,d=a-t,u=e*e,h=n*n,f=i*i,p=t*t,g=r*r,y=a*a,x=(l*(y-p+f-u)-d*(g-p+h-u))/(2*c*l-2*s*d),v=(s*(f-u+y-p)-c*(h-u+g-p))/(2*d*s-2*l*c);if(isFinite(x)&&isFinite(v)){var m=Math.sqrt((e-x)*(e-x)+(t-v)*(t-v)),L=[e-i,t-a],_=[n-i,r-a],b=L[0]*_[0]+L[1]*_[1],S=b<0?0:1,C=o(e-x,t-v,m),M=o(n-x,r-v,m),w=o(i-x,a-v,m),N=0;w>C?(M>w||M<C)&&(N=1):M>w&&M<C&&(N=1);return{r1:m,r2:m,angle:0,largeArcFlag:S,sweepFlag:N,x:n,y:r,cx:x,cy:v}}},getCenterPoint:function(e,t,n,r,i,a,o,s,c){var l=Wa.arc.getCenterParam(e,t,n,r,i,a,o,s,c);return{x:l.cx,y:l.cy}}};Wa.fileType={getIcon:function(e){var t="";switch(e+""){case ia.SCH:case ia.SCHMODULE:t="icon-eda-sch";break;case ia.SCHLIB:case ia.SUBPART:t="icon-eda-eelib";break;case ia.PCB:case ia.PCBMODULE:t="icon-eda-pcb";break;case ia.PCBLIB:t="icon-pcblib";break;case ia.SPICESYMBOL:t="icon-spicesymbol";break;case ia.SUBCKT:t="icon-subckt";break;case ia.WAVEFORM:t="icon-waveform";break;case ia.PHOTOVIEW:t="icon-eda-pcb";break;case ia.PRJ:t="icon-prj";break;case ia.PCBLIB3D:t="icon-3d"}return t},getNewTitle:function(e){var t="New";switch(e+""){case ia.PRJ:t="New Project";break;case ia.SCH:case ia.SUBCKT:t="Sheet";break;case ia.SCHMODULE:t="New Schematic Module";break;case ia.SUBCKT:t="Sheet";break;case ia.SCHLIB:t="New_Symbol";break;case ia.SPICESYMBOL:t="New_Spice_Symbol";break;case ia.PCB:t="NEW_PCB";break;case ia.PCBMODULE:t="New PCB Module";break;case ia.PCBLIB:t="NEW_FOOTPRINT";break;case ia.WAVEFORM:t="WaveForm";break;case ia.PHOTOVIEW:t=Locale.i18n("Photo View");break;case ia.VIEW3D:t=Locale.i18n("3D View")}return t},getSaveAsDlgTitle:function(e){var t="Save as";switch(e+""){case ia.PRJ:t="Save as a new project";break;case ia.SCH:t="Save as a schematic";break;case ia.SCHLIB:t="Save as Symbol";break;case ia.SPICESYMBOL:t="Save as a spice Symbol";break;case ia.SUBCKT:t="Save as a spice subckt";break;case ia.PCB:t="Save as a PCB file";break;case ia.PCBLIB:t="Save as Footprint";break;case ia.PHOTOVIEW:t="Save as a Photo View";break;case ia.WAVEFORM:t="Save as a WaveForm";break;case ia.SCHMODULE:t="Save as a Schematic Module";break;case ia.PCBMODULE:t="Save as a PCB Module";break;case ia.PCBLIB3D:t="Save as 3D Model"}return t},getAbstractFileType:function(e){switch(e+""){case ia.SCH:case ia.SUBCKT:case ia.SCHMODULE:return"sch";case ia.SCHLIB:case ia.SUBPART:case ia.SPICESYMBOL:return"schlib";case ia.PCB:case ia.PCBMODULE:return"pcb";case ia.PCBLIB:return"pcblib";case ia.WAVEFORM:return"waveform";case ia.PHOTOVIEW:return"photoview";case ia.VIEW3D:return"3Dview";default:return}},mergeFileType:function(e){return e==ia.PCB||e==ia.PCBLIB||e==ia.PHOTOVIEW?"pcb_pcblib":"sch_schlib_waveform"},isLib:function(e){var t=Wa.fileType.getAbstractFileType(e);return"schlib"==t||"pcblib"==t},isModule:function(e){return e==ia.SCHMODULE||e==ia.PCBMODULE},isComponent:function(e){return Wa.fileType.isLib(e)||Wa.fileType.isModule(e)},isDocument:function(e){return me(e)||e==ia.PCB||e==ia.WAVEFORM},getApi:function(e,t){var n;switch(e+""){case ia.PRJ:n=wa.apis.projects;break;case ia.SCH:case ia.SUBCKT:case ia.PCB:case ia.WAVEFORM:n=wa.apis.document;break;case ia.SCHLIB:case ia.SUBPART:case ia.SPICESYMBOL:case ia.SCHMODULE:case ia.PCBMODULE:case ia.PCBLIB:case ia.PCBLIB3D:n=wa.apis.components;break;case ia.PHOTOVIEW:}if(n&&!t)return n;if(!n||!t||!n[t])throw Error("No such api");return n[t]},needProject:function(e){return me(e)||e==ia.PCB||e==ia.WAVEFORM}};Wa.toFixed=function(e,t,n){"number"!=typeof e&&(e=+e);if(isNaN(e))return NaN;t|=0;if(t<=0||!e&&!n)return Math.round(e);var r=Ki[t]||Math.pow(10,t)||10;if(n){var i=e<0?"-":"";e=e<0?-e:e;e=Math.round(e*r)+"";for(;e.length<=t;)e="0"+e;e=e.slice(0,-t)+"."+e.slice(-t);return i+e}return Math.round(e*r+1e-10)/r};Wa.fixLongNumberString=function(e,t){if(!e||"string"!=typeof e)return"";var n=/\d+\.\d{12,}/g,r=Ki[t]||Math.pow(10,t)||10;return e.replace(n,function(e){return Math.round(e*r+1e-10)/r})};Wa.isDotInRect=function(e,t,n){return 3==arguments.length?e>=n.x&&e<=n.x+n.width&&t>=n.y&&t<=n.y+n.height:Wa.isDotInRect(e.x,e.y,t)};Wa.isDotInArea=function(e,t,n,r,i,a){if(n>i){var o=n;n=i;i=o}if(r>a){var s=r;r=a;a=s}return e>=n&&e<=i&&t>=r&&t<=a};Wa.bbox2Polygon=function(e){
return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]};Wa.isRectInRect=function(e,t){return Wa.isDotInRect(e.x,e.y,t)&&Wa.isDotInRect(e.x+e.width,e.y,t)&&Wa.isDotInRect(e.x,e.y+e.height,t)&&Wa.isDotInRect(e.x+e.width,e.y+e.height,t)};Wa.combineBox=function(e,t){var n=Math.max(e.x+e.width,t.x+t.width),r=Math.max(e.y+e.height,t.y+t.height),i=Math.min(e.x,t.x),a=Math.min(e.y,t.y);return{x:i,y:a,width:n-i,height:r-a}};Wa.combineMultiBox=function(e){if(W(e)){for(var t=[],n=[],r=[],i=[],a=0;a<e.length;a++){t.push(e[a].x+e[a].width);n.push(e[a].y+e[a].height);r.push(e[a].x);i.push(e[a].y)}var o=Math.max.apply(null,t),s=Math.max.apply(null,n),c=Math.min.apply(null,r),l=Math.min.apply(null,i);return{x:c,y:l,width:o-c,height:s-l}}};Wa.isRectTouchRect=function(e,t){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y};Wa.isPolylineTouchRect=function(e,t){for(var n=e.points,r=n.length||n.numberOfItems,i=0;i<r;i++)if(Wa.isDotInRect(n.getItem(i).x,n.getItem(i).y,t))return!0;var a,o,s,c,l,d,u,h,f={x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height};for(i=1;i<r;i++){a={x1:n.getItem(i-1).x,y1:n.getItem(i-1).y,x2:n.getItem(i).x,y2:n.getItem(i).y};o=a.x2-a.x1;s=a.y2-a.y1;c={};if(o>0){c.x1=a.x1;c.x2=a.x2}else{c.x1=a.x2;c.x2=a.x1}if(s>0){c.y1=a.y1;c.y2=a.y2}else{c.y1=a.y2;c.y2=a.y1}if(!(c.x1>f.x2||c.x2<f.x1||c.y1>f.y2||c.y2<f.y1)){l=s*(f.x1-a.x1)-o*(f.y1-a.y1);d=s*(f.x1-a.x1)-o*(f.y2-a.y1);u=s*(f.x2-a.x1)-o*(f.y1-a.y1);h=s*(f.x2-a.x1)-o*(f.y2-a.y1);if(!(l>0&&d>0&&u>0&&h>0||l<0&&d<0&&u<0&&h<0))return!0}}return!1};Wa.isPolygonTouchRect=function(e,t){for(var n=e.points,r=n.length||n.numberOfItems,i=0;i<r;i++)if(Wa.isDotInRect(n.getItem(i).x,n.getItem(i).y,t))return!0;var a,o,s,c,l,d,u,h,f={x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y+t.height};for(i=0;i<r;i++){a=0===i?{x1:n.getItem(r-1).x,y1:n.getItem(r-1).y,x2:n.getItem(i).x,y2:n.getItem(i).y}:{x1:n.getItem(i-1).x,y1:n.getItem(i-1).y,x2:n.getItem(i).x,y2:n.getItem(i).y};o=a.x2-a.x1;s=a.y2-a.y1;c={};if(o>0){c.x1=a.x1;c.x2=a.x2}else{c.x1=a.x2;c.x2=a.x1}if(s>0){c.y1=a.y1;c.y2=a.y2}else{c.y1=a.y2;c.y2=a.y1}if(!(c.x1>f.x2||c.x2<f.x1||c.y1>f.y2||c.y2<f.y1)){l=s*(f.x1-a.x1)-o*(f.y1-a.y1);d=s*(f.x1-a.x1)-o*(f.y2-a.y1);u=s*(f.x2-a.x1)-o*(f.y1-a.y1);h=s*(f.x2-a.x1)-o*(f.y2-a.y1);if(!(l>0&&d>0&&u>0&&h>0||l<0&&d<0&&u<0&&h<0))return!0}}return!1};Wa.svg={getRefPoint:function(e){var t;switch(e&&e.tagName){case"path":var n=e.pathSegList.getItem(0);n&&"M"==n.pathSegTypeAsLetter&&(t=[n.x,n.y]);break;case"svg":case"text":case"rect":case"image":t=[+w(e,"x"),+w(e,"y")];break;case"circle":case"ellipse":t=[+w(e,"cx"),+w(e,"cy")];break;case"line":t=[+w(e,"x1"),+w(e,"y1")];break;case"polygon":case"polyline":var r=e.points.getItem(0);r&&(t=[r.x,r.y]);break;case"g":var i=w(e,"c_origin");if(i){i=i.replace(/\s+/g,"").split(/,/);i[0]-=0;i[1]-=0;t=i}else{var a=L("g[c_origin], svg, path, text, rect, image, circle, ellipse, line, polygon, polyline",e);a&&(t=Wa.svg.getRefPoint(a))}}if(t)return{x:t[0],y:t[1]}},transformPoint:function(e,t){return{x:e.x*t.a+e.y*t.c+t.e,y:e.x*t.b+e.y*t.d+t.f}},transformBox:function(e,t){for(var n,r=[e.x,e.x+e.width,e.x,e.x+e.width],i=[e.y,e.y,e.y+e.height,e.y+e.height],a=0;a<4;a++){n=Wa.svg.transformPoint({x:r[a],y:i[a]},t);r[a]=n.x;i[a]=n.y}var o=Math.min.apply(0,r),s=Math.min.apply(0,i);return{x:o,y:s,width:Math.max.apply(0,r)-o,height:Math.max.apply(0,i)-s}},isZeroBox:function(e){return!(e.x||e.y||e.width||e.height)},getPlainBBox:function(e){if(w(e,"c_para")){var t=m('[c_partid="part_annotation"]',e),n=m('[c_partid="part_pcbtext"]',e),r=Wa.svg.getOutline(e),i=m('[c_shapetype="line-cross"]',e),a=[],o=[],s=r&&"none"!==r.style.display,c=i.length&&"none"!==i[0].style.display;s&&(r.style.display="none");c&&i.forEach(function(e){e.style.display="none"});t.length&&t.forEach(function(e){if("none"!==e.style.display){a.push(e);e.style.display="none"}});n.length&&n.forEach(function(e){if("none"!==e.style.display){o.push(e);e.style.display="none"}});var l=Wa.svg.getBBox(e);s&&(r.style.display="");c&&i.forEach(function(e){e.style.display=""});a.length&&a.forEach(function(e){e.style.display=""});o.length&&o.forEach(function(e){e.style.display=""});return l}return Wa.svg.getBBox(e)},getBBox:function(e){function t(e){var t,n;try{n=e.cloneNode(!0);S(n,"enforceShow");Ji.appendChild(n);n.style.display="inline";var r=n.getBBox();n.style.display="";t={x:r.x,y:r.y,width:r.width,height:r.height};M(n)}catch(e){if(n){n.style.display="";M(n)}t={x:0,y:0,width:0,height:0}}return t}var n,r;try{r=e.getBBox();n={x:r.x,y:r.y,width:r.width,height:r.height}}catch(r){n=t(e)}try{n.x||n.y||n.width||n.height||(n=t(e))}catch(e){}return n},getBBoxAbout:function(e){var t,n=e.tagName;if("none"==w(e,"display"))return null;var r=function(e,t){return parseFloat(w(e,t))};switch(n){case"text":t=[r(e,"x"),r(e,"y"),1,1];break;case"image":case"rect":t=[r(e,"x"),r(e,"y"),r(e,"width"),r(e,"height")];t[2]+=t[0];t[3]+=t[1];break;case"circle":case"ellipse":var i,a,o=r(e,"cx"),s=r(e,"cy");if("circle"==n)i=a=r(e,"r");else{i=r(e,"rx");a=r(e,"ry")}t=[o-i,s-a,o+i,s+a];break;case"line":var c=r(e,"x1"),l=r(e,"y1"),d=r(e,"x2"),u=r(e,"y2");t=[Math.min(c,d),Math.min(l,u),Math.max(c,d),Math.max(l,u)];break;case"polyline":case"polygon":t=function(e){var t,n,r,i,a=z(e);if(!a.length)return null;t=r=a[0].x;n=i=a[0].y;for(var o=1;o<a.length;o++){var s=a[o];t-s.x>0&&(t=s.x);n-s.y>0&&(n=s.y);r-s.x<0&&(r=s.x);i-s.y<0&&(i=s.y)}return[t,n,r,i]}(w(e,"points"));break;case"path":var h=e.getPathData({normalize:!0});t=function(e){if(!e.length)return null;for(var t,n=0;n<e.length;n++){var r=e[n].values,i=e[n].type;if(t)switch(i){case"M":case"L":t[0]-r[0]>0&&(t[0]=r[0]);t[1]-r[1]>0&&(t[1]=r[1]);t[2]-r[0]<0&&(t[2]=r[0]);t[3]-r[1]<0&&(t[3]=r[1]);break;case"C":t[0]-r[4]>0&&(t[0]=r[4]);t[1]-r[5]>0&&(t[1]=r[5]);t[2]-r[4]<0&&(t[2]=r[4]);t[3]-r[5]<0&&(t[3]=r[5])}else{if("M"!=i)return null;t=r.concat(r)}}return t}(h);break;default:for(var f=e.children,p=0;p<f.length;p++)if("none"!=w(f[p],"display")){var g=Wa.svg.getBBoxSimple(f[p]);if(g){var y={l:g.x,t:g.y,r:g.x+g.width,b:g.y+g.height};if(t){isFinite(y.l)&&t.l-y.l>0&&(t.l=y.l);isFinite(y.t)&&t.t-y.t>0&&(t.t=y.t);isFinite(y.r)&&t.r-y.r<0&&(t.r=y.r);isFinite(y.b)&&t.b-y.b<0&&(t.b=y.b)}else t=y}}t=t&&[t.l,t.t,t.r,t.b]}if(!t||!isFinite(t[0])||!isFinite(t[1]))return null;isFinite(t[2])||(t[2]=t[0]);isFinite(t[3])||(t[3]=t[1]);if(w(e,"transform")){var x=e.getCTM(),v="object"==typeof fa?fa:L("svg"),m=v.createSVGPoint();m.x=t[0];m.y=t[1];m.matrixTransform(x);t[0]=m.x;t[1]=m.y;m.x=t[2];m.y=t[3];m.matrixTransform(x);t[2]=m.x;t[3]=m.y}return function(e){var t={x:e[0],y:e[1],width:e[2]-e[0],height:e[3]-e[1]};if(t.width<0){t.x=e[2];t.width=-t.width}if(t.height<0){t.y=e[3];t.height=-t.height}return t}(t)},getBBoxMerged:function(e,t){if(!e||!e.length)return{x:0,y:0,width:0,height:0};for(var n,r=0;r<e.length;r++)if(e[r]){var i=Wa.svg.getViewBBox(e[r],t);if(i.x||i.y||i.width||i.height)if(n){n.width=Math.max(i.x+i.width,n.x+n.width)-Math.min(i.x,n.x);n.height=Math.max(i.y+i.height,n.y+n.height)-Math.min(i.y,n.y);n.x=Math.min(i.x,n.x);n.y=Math.min(i.y,n.y)}else n=i}return n||{x:0,y:0,width:0,height:0}},getElementsCenter:function(e,t){if(!e||!e[0])return{x:0,y:0};if(Qa.origin)return Qa.origin;if(v("selectionBox")){var n=v("selectionBox").getBBox();return{x:n.x+n.width/2,y:n.y+n.height/2}}var r=Wa.svg.getBBoxMerged(e,t);return{x:Wa.formatLengthSave(r.x+r.width/2),y:Wa.formatLengthSave(r.y+r.height/2)}},getBBoxFixed:function(t,n){function r(t){var n=e.getComputedStyle&&getComputedStyle(t);return!n||"none"==n.display}function i(e){for(var t,n,a,c=e.children||[].filter.call(e.childNodes,function(e){return 1===e.nodeType}),l=0,d=c.length;l<d;l++){a=c[l];if(o){if("text"==a.tagName)continue;if("g"==a.tagName){var u=w(a,"c_partid");if("part_annotation"==u||"part_pcbtext"==u)continue}}if((!s||!b(a,"pindot"))&&("none"!=w(a,"display")&&"none"!=a.style.display&&!r(a))){try{n=a.getBBox();if(!(n.width||n.height||n.x||n.y))continue}catch(e){continue}"g"==a.tagName?n=i(a):"path"==a.tagName&&(n=Wa.svg.getBBoxForPath(a));if(n&&(n.width||n.height)){if(w(a,"transform"))try{var h=a.getTransformToElement(e);n=Wa.svg.transformBox(n,h)}catch(e){}t=t?Wa.combineBox(t,n):n}}}return t||{x:0,y:0,width:0,height:0}}var a,o=n&&n.excludeText,s=n&&n.excludePindot;if("g"!=t.tagName){var c=w(t,"display")||"",l=t.style.display;w(t,"display","");t.style.display="inline !important";a="path"==t.tagName?Wa.svg.getBBoxForPath(t):Wa.svg.getBBox(t);w(t,"display",c);t.style.display=l;return a}a=Wa.svg.getBBox(t);if(!a.width&&!a.height)return a;if((a.x||a.y)&&!o)return a;a=i(t);a.width||a.height||(a=Wa.svg.getPlainBBox(t));return a},getBBoxExcludeText:function(e){return Wa.svg.getBBoxFixed(e,{excludeText:!0})},hasBBoxBugForPath:void 0!==t&&function(){var e=t.createElement("div");e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"><path d="M 0 0 C 0 100 100 0 10 10"/></svg>';t.body.appendChild(e);var n=!1;try{var r=e.querySelector("path").getBBox();n=47!=(0|r.width)||44!=(0|r.height)}catch(e){}t.body.removeChild(e);return n}(),getBBoxForPath:function(e,t){var n,r,i=Wa.svg.getBBox(e);if(!(i.width||i.height||i.x||i.y)){n=e.getPointAtLength(0);return{x:n.x,y:n.y,width:0,height:0}}if(!Wa.svg.hasBBoxBugForPath)return i;if(!/[cqst]/i.test(w(e,"d")))return i;if(navigator.userAgent.indexOf("AppleWebKit")<0)return i;r=e.getTotalLength();if(r<=0){n=e.getPointAtLength(0);return{x:n.x,y:n.y,width:0,height:0}}("number"!=typeof t||t<=0)&&(t=5);t=Math.min(.1*r,Math.max(t,.01*r));for(var a=0,o=[],s=[];a<r;){n=e.getPointAtLength(a);o.push(n.x);s.push(n.y);a+=t}n=e.getPointAtLength(r);o.push(n.x);s.push(n.y);i.x=Math.min.apply(0,o);i.y=Math.min.apply(0,s);i.width=Math.max.apply(0,o)-i.x;i.height=Math.max.apply(0,s)-i.y;return i},getViewBBox:function(e,t){var n=Wa.svg.getBBoxFixed(e,{excludeText:t});if(w(e,"transform")){var r=fa&&fa.contains(e)?fa:e.parentNode;if(r)try{var i=e.getTransformToElement(r);n=Wa.svg.transformBox(n,i)}catch(e){}}n.x=Wa.formatLengthSave(n.x);n.y=Wa.formatLengthSave(n.y);n.width=Wa.formatLengthSave(n.width);n.height=Wa.formatLengthSave(n.height);return n},setTooltip:function(e,t){if(e&&e.tagName&&e.children){var n,r;for(n=0;n<e.children.length;n++)if("title"==e.children[n].tagName){r=e.children[n];break}if(t){r||(r=e.appendChild(Wt("title")));Wa.node.setTextContent(r,t)}else r&&e.removeChild(r)}},getPathHelperType:function(e){if(e&&"path"==e.tagName){for(var t=e.pathSegList,n=t.numberOfItems,r="",i=0;i<n&&i<5;i++)r+=t.getItem(i).pathSegTypeAsLetter;return"MA"==r?t.getItem(1).r1!=t.getItem(1).r2||wo!=ia.PCBLIB&&wo!=ia.PCB&&wo!=ia.PCBMODULE?"arc1":"arc2":/^(?:MALZ|MLAZ|MLLAZ?)$/.test(r)?wo==ia.PCBLIB||wo==ia.PCB||wo==ia.PCBMODULE?void 0:"pie1":void 0}},deletePathPointAtCdot:function(e,t){if(!(!e||"path"!=e.tagName||isNaN(t)||t<0)){if(!Wa.svg.getPathHelperType(e)){for(var n=ho.get(e),r=n.dotsGroup||[],i=-1,a=-1,o=0;o<r.length;o++)if(r[o].end>=t){i=o;a=t-r[o].start;break}if(!(i<0||a<0)&&t==r[i].end){var s=r[i].type;if(1!=s){if((2==s||3==s)&&i+1<r.length){var c=i+1,l=r[c].end,d=n[2*l],u=n[2*l+1],h=e.pathSegList.getItem(i);h.x=d;h.y=u;i=c}e.pathSegList.removeItem(i);!function(e){for(var t=[],n=[],r=[],i=[],a=e.numberOfItems,o=0;o<a;o++){t[o]=e.getItem(o);n[o]=t[o].pathSegType;r[o]=t[o].pathSegTypeAsLetter.toUpperCase();0===o||"M"==r[o]?i.push([o]):i[i.length-1].push(o)}for(var s=[],c=0;c<i.length;c++){for(var l=i[c],d=l.length-1;d>=1;d--){var o=l[d];if("Z"==r[o]&&("Z"==r[o-1]||"M"==r[o-1])){l.splice(d,1);s.push(o)}}if("Z"==r[l[0]]){s.push(l[0]);l.splice(0,1)}if(1===l.length&&"M"==r[l[0]]){s.push(l[0]);l.splice(0,1)}}if(s.length>0)for(var d=s.length-1;d>=0;d--)e.removeItem(s[d])}(e.pathSegList)}}}}},fixOperaPathDAttribute:function(e){var t,n,r,i=e.pathSegList,a=i.numberOfItems,o="";for(n=0;n<a;n++){t=i.getItem(n);r=t.pathSegTypeAsLetter;switch(r.toUpperCase()){case"M":case"L":case"T":o+=r+t.x+" "+t.y;break;case"H":o+=r+t.x;break;case"V":o+=r+t.y;break;case"C":o+=r+t.x1+" "+t.y1+" "+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"S":o+=r+t.x2+" "+t.y2+" "+t.x+" "+t.y;break;case"Q":o+=r+t.x1+" "+t.y1+" "+t.x+" "+t.y;break;case"A":o+=r+t.r1+" "+t.r2+" "+t.angle+" "+ +t.largeArcFlag+" "+ +t.sweepFlag+" "+t.x+" "+t.y;break;case"Z":o+=r}}e.setAttribute("d",o)},fixOrigin:function(e){var t=w(e,"c_origin");if(t){var n=Wa.svg.getBBox(e);if(n.x||n.y||n.width||n.height){var r=t.split(","),i=+r[0],a=+r[1],o=ba.adsorbGrid.gridSize,s=n.x+n.width/2,c=n.y+n.height/2,l=0,d=0;(i<n.x-10||i>n.x+n.width+10)&&(l=Math.round((s-i)/o));(a<n.y-10||a>n.y+n.height+10)&&(d=Math.round((c-a)/o));if(l||d){w(e,"c_origin",i+l*o+","+(a+d*o));return!0}}}},isPointInBbox:function(e,t){var n=e.x,r=e.y,i=t.x,a=t.y,o=t.width,s=t.height;return void 0!==n&&void 0!==r&&void 0!==i&&void 0!==a&&void 0!==o&&void 0!==s&&!(n<i||n>i+o||r<a||r>a+s)},getOutline:function(e){return L('g[c_etype="outline3D"]',e)},getCss3:function(e,t){var n;n="string"!=typeof e?w(e,"transform"):e;var r={scale:"1",rotate:"0",translate:"0,0"};if(!n)return r[t]?r[t]:"";var i=new RegExp(t+"\\(.*?\\)");if(n.match(i)){var a=n.match(i)[0],o=new RegExp(t+"\\((.*?)\\)");return"rotate"===t?a.match(o)[1].split(" ")[0]:a.match(o)[1]}return r[t]?r[t]:""},get3dViewSrc:function(){var e=ia.VIEW3D;e=!L('head>link[href$="/css_src/main.css"]')?"lceda"==Na?Ta+"/htm_cn/editorpage"+e+".html":Ta+"/htm/editorpage"+e+".html":"lceda"==Na?Ta+"/htm_debug_cn/editorpage"+e+".html":Ta+"/htm_debug/editorpage"+e+".html";return e+"?version="+Wi},createOutlineSvg:function(e,t){if(t&&!isNaN(e.width)&&!isNaN(e.height)){Wa.svg.getOutline(t)&&t.removeChild(Wa.svg.getOutline(t));var n=w(t,"c_rotation")||0,r=Ue(e.rotateX||0)||+n,i=Ue(e.rotateY||0)||+n,a=Ue(e.rotateZ||0)||+n,o=Wa.svg.getPlainBBox(t),s=o.x+o.width/2,c=o.y+o.height/2,l=Wt("g",{c_width:e.width,c_height:e.height,c_rotation:r+","+i+","+a,z:e.z,c_origin:e.center.x+","+e.center.y,uuid:e.uuid,c_etype:"outline3D",id:t.id+"_outline",title:e.title,layerid:na.MODEL3D});e.outlines.forEach(function(e,n){var r=Wt("polyline",{fill:"none",id:t.id+"_line"+n,c_shapetype:"line",points:e.join(" ")});l.appendChild(r)});t.appendChild(l);var d=at(e.outlines);e.center=e.center||{};var u={x:e.center.x||d.xMin+(d.xMax-d.xMin)/2,y:e.center.y||d.yMin+(d.yMax-d.yMin)/2};St(l,s-u.x,c-u.y);a?Wa.svg.update3Doutline(t,"attr-footprint-3d-outline-rotateZ",a):e.width>e.height!=o.width>o.height&&Wa.svg.update3Doutline(t,"attr-footprint-3d-outline-rotateZ",90);return l}},outlineScaleSuitLib:function(e,t,n){var r=Wa.svg.getPlainBBox(t),i=Wa.svg.getBBox(e),a=r.width/(i.width||1)||1;Wa.svg.scaleOutline(e,a);n?w(e,{c_height:i.width*a,c_width:i.height*a}):w(e,{c_width:i.width*a,c_height:i.height*a})},moveOutline:function(e,t,n){for(var r=Wa.svg.getPlainBBox(e),i=r.x+r.width/2,a=r.y+r.height/2,o=w(e,"transform"),s=0,c=e.childNodes.length;s<c;s++)co.move(e.childNodes[s],t,n);var l=Wa.svg.getBBox(e),d=Wa.svg.getCss3(o,"scale"),u=1*i+1*t,h=1*a+1*n,f=-(l.width*d-l.width)/2/d,p=-(l.height*d-l.height)/2/d;w(e,{transform:ye("{scale} translate({translateX}, {translateY})",{scale:"scale("+d+")",translateX:-(l.x*d-l.x)/d+f,translateY:-(l.y*d-l.y)/d+p}),c_origin:Wa.toFixed(u,4)+","+Wa.toFixed(h,4)})},scaleOutline:function(e,t){var n=(w(e,"transform"),Wa.svg.getBBox(e));(t===1/0||isNaN(t))&&(t=1);var r=-(n.width*t-n.width)/2/t,i=-(n.height*t-n.height)/2/t;w(e,{transform:ye("scale({scale}) translate({translateX}, {translateY})",{scale:t,translateX:-(n.x*t-n.x)/t+r,translateY:-(n.y*t-n.y)/t+i})})},rotateZOutline:function(e,t,n,r){var i=Tt(e),a=(i.c_rotation||"0,0,0").split(","),o=Ue(360-(t-a[2]));a[2]=Ue(t);lo.g(e,o,n,r);w(e,"c_rotation",a.join(","))},getOutlineBBox:function(e){var t,n=Tt(e),r=(n.c_rotation||"0,0,0").split(","),i=Wa.svg.getBBox(e),a=i.x+i.width/2,o=i.y+i.height/2;r[2]&&lo.g(e,-r[2],a,o);t=Wa.svg.getBBox(e);r[2]&&lo.g(e,r[2],a,o);return t},update3Doutline:function(e,t,n){var r,i=t.split("attr-footprint-3d-outline-")[1],a=Wa.svg.getOutline(e),o=!(!ha||!ha.updateOne),s=(w(e,"c_origin")||w(e.childNodes[0],"c_origin")||"0,0").split(","),c=+s[0],l=+s[1];if(a){var d=Wa.svg.getOutlineBBox(a),u=Tt(a),h=(u.c_rotation||"0,0,0").split(","),f=d.x+d.width/2,p=d.y+d.height/2;switch(i){case"width":r=n/d.width;Wa.svg.scaleOutline(a,r);w(a,"c_width",n);w(a,"c_height",d.height*r);o&&pn("updateAttrPanel");break;case"height":r=n/d.height;Wa.svg.scaleOutline(a,r);w(a,"c_height",n);w(a,"c_width",d.width*r);o&&pn("updateAttrPanel");break;case"rotateZ":h[2]=Ue(n);var g=Wa.svg.getBBox(a);Wa.svg.rotateZOutline(a,n,g.x+g.width/2,g.y+g.height/2);break;case"rotateY":h[1]=Ue(n);w(a,"c_rotation",h.join(","));break;case"rotateX":h[0]=Ue(n);w(a,"c_rotation",h.join(","));break;case"x":Wa.svg.moveOutline(a,n+c-f,0);break;case"y":Wa.svg.moveOutline(a,0,n+l-p);break;case"z":w(a,"z",n)}}else o&&pn("warnOutlineNeeded")}};Wa.node={clearChildNodes:function(e){for(;e&&e.lastChild;)e.removeChild(e.lastChild)},getRefId:function(e){return e.nextElementSibling?e.nextElementSibling.id:e.parentNode?"<"+e.parentNode.id:""},getParentNodeId:function(e){return e.parentNode?"<"+e.parentNode.id:""},isSame:function(e,t){if(!e||!t)return!1;var n=new XMLSerializer;return n.serializeToString(e)==n.serializeToString(t)},contains:function(e,t){return e.contains?e!=t&&e.contains(t):20==e.compareDocumentPosition(t)},children:function(e){return e.children||[].filter.call(e.childNodes,function(e){return 1===e.nodeType})},setTextContent:function(t,n){if(t)try{t.textContent=n}catch(t){try{var r=e.__TEXTCONTENT_DESCRIPTOR;if(r){var i={}.toString.call(r.set);i.indexOf("[native code]")<0&&Object.defineProperty(Node.prototype,"textContent",r)}}catch(e){}}}};Wa.svgOutline={};var co={move:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||co[e.tagName](e,t,n)},g:function(e,t,n){"FOOTPRINT"===de(e)&&b(e.parentNode,$a)&&yn();isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)&&(!e||"part_plane"!==w(e,"c_partid"))){var r="outline3D"===w(e,"c_etype"),i=w(e,"c_origin");if(i){i=Wa.numberlistToArray(i);i[0]=Wa.toFixed(i[0]+t,4);i[1]=Wa.toFixed(i[1]+n,4);w(e,"c_origin",i.join(","))}if(r)Wa.svg.moveOutline(e,t,n);else for(var a=e.children,o=a.length,s=0;s<o;s++)j(co,a[s].tagName)&&co[a[s].tagName](a[s],t,n)}},svg:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){0!==t&&w(e,{x:+(w(e,"x")||0)+t});0!==n&&w(e,{y:+(w(e,"y")||0)+n})}},rect:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||co.svg(e,t,n)},text:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){var r,i=+(w(e,"x")||0),a=+(w(e,"y")||0),o=w(e,"transform")||"";if(o&&(r=o.match(/rotate\((-?[\d.]+)[,\s].+\)/)))if("multimeter"===w(e,"type")&&"270"===w(e.parentNode,"c_rotation")&&"Y"!==w(e,"rotated")){var s=w(e.parentNode,"c_origin").split(",").map(function(e){return+e});w(e,{x:i+t,y:a+n,transform:"rotate("+r[1]+","+s[0]+","+s[1]+")"})}else w(e,{x:i+t,y:a+n,transform:"rotate("+r[1]+","+(i+t)+","+(a+n)+")"});else w(e,{x:i+t,y:a+n});for(var c=m("tspan",e),l=c.length,d=0;d<l;d++)w(c[d],{x:i+t})}},image:function(e,t,n){function r(e){return new RegExp(e+"\\((.*?)\\)")}isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){w(e,{x:+(w(e,"x")||0)+t,y:+(w(e,"y")||0)+n});var i,a,o,s=w(e,"transform"),c=0,l=0;if(s&&s.match(r("translate"))&&s.match(r("rotate"))){o=s.match(r("translate"))[1].split(",");c=+o[0];l=+o[1];var d=s.match(r("rotate"))[1].split(/[,\s]/)[0];if(90==d){c+=t;l-=t;l+=n;c+=n}else if(180==d){c+=2*t;l+=2*n}else if(270==d){c+=t;l+=t;l+=n;c-=n}s=s.replace(r("translate"),"translate("+c+","+l+")")}if(s&&s.match(r("scale"))){var u,h,f=s.match(r("scale"))[1];if(f.indexOf(",")>-1){f=f.split(",");u=parseFloat(f[0]);h=parseFloat(f[1])}else u=h=parseFloat(f);u<0&&(i=!0);h<0&&(a=!0)}if(s&&s.match(r("translate"))){o=s.match(r("translate"))[1].split(",");c=+o[0];l=+o[1];if(i&&a){c-=2*t;l-=2*n}else i?c-=2*t:a&&(l-=2*n);s=s.replace(r("translate"),"translate("+c+","+l+")");w(e,"transform",s)}}},circle:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||w(e,{cx:+w(e,"cx")+t,cy:+w(e,"cy")+n})},ellipse:function(e,t,n){co.circle(e,t,n)},line:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);!e||0===t&&0===n||w(e,{x1:+w(e,"x1")+t,x2:+w(e,"x2")+t,y1:+w(e,"y1")+n,y2:+w(e,"y2")+n})},polyline:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){for(var r=X(w(e,"points")).split(/[\s\,]+/g),i=0;i<r.length-1;i+=2){r[i]=Wa.toFixed(+r[i]+t,4);r[i+1]=Wa.toFixed(+r[i+1]+n,4)}w(e,{points:r.join(" ")})}},polygon:function(e,t,n){co.polyline(e,t,n)},path:function(e,t,n){isFinite(t)||(t=0);isFinite(n)||(n=0);if(e&&(0!==t||0!==n)){if(Ga);!function(t,n){function r(e,t,n){e[t]=Wa.toFixed(e[t]+n,4)}for(var i=e.getPathData(),a=i.length,o=0;o<a;o++){var s=i[o],c=s.type,l=s.values;switch(c){case"M":case"L":case"T":r(l,0,t);r(l,1,n);break;case"H":r(l,0,t);break;case"V":r(l,0,n);break;case"C":r(l,0,t);r(l,1,n);r(l,2,t);r(l,3,n);r(l,4,t);r(l,5,n);break;case"S":case"Q":r(l,0,t);r(l,1,n);r(l,2,t);r(l,3,n);break;case"A":r(l,5,t);r(l,6,n)}}e.setPathData(i)}(t,n)}}},lo={rotate:function(e,t,n,r,i,a){if(J(e))if(v("selectionBox")){var o=+w(v("selectionBox"),"c_rotate")||0;w(v("selectionBox"),{c_rotate:Ue(o+t)});lo.rotateOne(v("selectionBox"),t,n,r)}else e.forEach(function(e){i&&i(e);Wa.svg.fixOrigin(e);lo.rotateOne(e,t,n,r);a&&a(e)});else{Wa.svg.fixOrigin(e);lo.rotateOne(e,t,n,r)}},rotateOne:function(e,t,n,r){var i,a;if(void 0===n||void 0===r)if(Qa.origin){n=Number(Qa.origin.x);r=Number(Qa.origin.y)}else if("g"!==e.tagName||"part_annotation"==w(e,"c_partid")){i=Wa.svg.getViewBBox(e);n=Wa.toFixed(i.x+i.width/2,3);r=Wa.toFixed(i.y+i.height/2,3)}else{var o=w(e,"c_origin");if(o){a=o.split(",");n=+a[0];r=+a[1];if("TEXT"===de(e)&&Layer.front==na.BOTTOMLAYER&&"note_pre"===w(e.childNodes[0],"c_note")){i=Wa.svg.getViewBBox(e);n=Wa.toFixed(i.x+i.width/2,3);r=Wa.toFixed(i.y+i.height/2,3)}}else{i=Wa.svg.getViewBBox(e);n=Wa.toFixed(i.x+i.width/2,3);r=Wa.toFixed(i.y+i.height/2,3)}}if("g"!=e.tagName||"part_annotation"!=w(e,"c_partid"))lo[e.tagName]&&lo[e.tagName](e,t,n,r);else if("note_package"===w(e.childNodes[0],"c_note")){var s=Wa.svg.getPlainBBox(e.parentNode),c=Wa.svg.getBBox(e),l=s.y+s.height+2,d=c.y,u=s.x-c.x,h=l-d;co.g(e,u,h)}else lo.annotation(e,t,n,r)},groupRotate:function(e,t,n,r){var i,a,o,s,c=e.length;if(c)if(c<2)lo.rotate(e[0],t,n,r);else if(void 0===n||void 0===r){for(i=0;i<c;i++)if("text"!=e[i].tagName&&!w(e[i],"c_origin")){a=!0;break}if(a)for(i=0;i<c;i++){s=function(e){try{return e.getBBox()}catch(e){}}(e[i]);if(s)if(o){o.x=Math.min(o.x,s.x);o.y=Math.min(o.y,s.y);o.x2=Math.max(o.x2,s.x+s.width);o.y2=Math.max(o.y2,s.y+s.height)}else o={x:s.x,y:s.y,x2:s.x+s.width,y2:s.y+s.height}}else for(i=0;i<c;i++){s=function(e){if(e){var t=e.split(",");return{x:+t[0],y:+t[1]}}}(w(e[i],"c_origin"));s||"text"!=e[i].tagName||(s={x:+w(e[i],"x"),y:+w(e[i],"y")});if(s)if(o){o.x=Math.min(o.x,s.x);o.y=Math.min(o.y,s.y);o.x2=Math.max(o.x2,s.x);o.y2=Math.max(o.y2,s.y)}else o={x:s.x,y:s.y,x2:s.x,y2:s.y}}if(o){n=Wa.toFixed((o.x+o.x2)/2,3);r=Wa.toFixed((o.y+o.y2)/2,3);for(i=0;i<c;i++)lo.rotate(e[i],t,n,r)}}else for(i=0;i<c;i++)lo.rotate(e[i],t,n,r)},g:function(e,t,n,r){void 0===t&&(t=270);if(t%360!=0){var i,a,o,s=w(e,"c_origin"),c="outline3D"==w(e,"c_etype"),l=s&&s.split(",");if(void 0===n||void 0===r)if(l){n=+l[0];r=+l[1]}else{i=e.getBBox();n=i.x+i.width/2|0;r=i.y+i.height/2|0}else if(l){a=[+l[0],+l[1]];a=Fe(a,t,n,r);w(e,"c_origin",a.join(","))}if(s){if(c){var d=w(e,"c_rotation").split(",");o=+d[2]}else o=+(w(e,"c_rotation")||0);o=Ue(o-t);if(c){d[2]=o;w(e,"c_rotation",d.join(","))}else w(e,"c_rotation",o)}if("part_pin"!=w(e,"c_partid")){if("part_plane"!=w(e,"c_partid")){var u,h,f,p,g,y,x,v=e.children||e.childNodes,L=v.length;if(c){var _=Wa.svg.getCss3(e,"scale");Wa.svg.scaleOutline(e,1);for(y=0;y<L;y++)lo.rotate(v[y],t,n,r);Wa.svg.scaleOutline(e,_)}else{for(y=0;y<L;y++){var b=m("[c_note]",v[y]);if(void 0!==wo&&(wo==ia.SCH||wo==ia.SCHMODULE||wo==ia.SUBCKT)&&"g"==v[y].tagName&&b.length>0){u=w(v[y].firstChild,"c_note");if("note_pre"==u){h=v[y].firstChild;continue}if("note_name"==u){f=v[y].firstChild;continue}if("note_verify"==u){p=v[y].firstChild;continue}if("note_mounted"==u){g=v[y].firstChild;continue}if("note_netflag"==u&&"part_netLabel_netPort"!=w(e,"c_partid")){b[0].parentNode.parentNode&&"part_netLabel_netPort"!==w(b[0].parentNode.parentNode,"c_partid")&&(x=v[y].firstChild);x=v[y].firstChild;continue}}lo.rotate(v[y],t,n,r)}(h||f)&&Wr(h,f,p,g);x&&Qr(x);(p||g)&&Xr(p,g)}}}else lo.pin(e,t,n,r)}},svg:function(e,t,n,r){var i=w(e,"x"),a=w(e,"y");if(void 0===n||void 0===r)lo.rotate(e,t,i,a);else if(null===i||null===a)for(var o=e.children||e.childNodes,s=o.length,c=0;c<s;c++)lo.hasOwnProperty(o[c].tagName)&&lo.rotate(o[c],t,n,r);else null!==i&&null!==a&&lo.image(e,t,n,r)},rect:function(e,t,n,r){var i={x:+w(e,"x"),y:+w(e,"y"),width:+w(e,"width"),height:+w(e,"height")},a=Re(i,t,n,r);if(t%90){pn("messagerShow",[{title:"Notice",msg:"The rectangle does not support non-90 degree rotation. Please use Solid Region instead.",timeout:3e3,showType:"slide"}]);w(e,i)}else w(e,a)},text:function(e,t,n,r){void 0===t&&(t=270);var i,a,o=w(e,"text-anchor")||"start",s=w(e,"transform");i="end"==o?s?270:180:s?90:0;a=Ue(i-t);var c,l,d,u;c=Wa.svg.getBBox(e);if(0!==c.width&&0!==c.height){var h=dt(e),f=Re(h,t,n,r),p=0===a||90==a?"start":"end",g=0===a||180==a?"":"rotate(270,"+f.x+","+f.y+")";w(e,{x:f.x,y:f.y,"text-anchor":p,transform:g});var y=dt(e),x=f.x-y.x,v=f.y-y.y,L=g?"rotate(270,"+(f.x+x)+","+(f.y+v)+")":"";w(e,{x:f.x+x,y:f.y+v,"text-anchor":p,transform:L});l=m("tspan",e);for(d=0,u=l.length;d<u;d++)w(l[d],{x:f.x+x});"multimeter"===w(e,"type")&&w(e,"rotated","Y")}else{var _={},b=+w(e,"x"),S=+w(e,"y"),C=[b,S];void 0!==n&&void 0!==r&&(C=Fe(C,t,n,r));_.x=C[0];_.y=C[1];o=0===a||90==a?"start":"end";s=0===a||180==a?"":"rotate(270,"+_.x+","+_.y+")";_["text-anchor"]=o;_.transform=s;w(e,_);l=m("tspan",e);for(d=0,u=l.length;d<u;d++)w(l[d],{x:_.x})}},pin:function(e,t,n,r){for(var i=m("text",e),a=i[0],o=i[1],s=L("circle",e),c=w(a,"x")-w(s,"cx"),l=w(a,"y")-w(s,"cy"),d=w(o,"x")-w(s,"cx"),u=w(o,"y")-w(s,"cy"),h=e.children||e.childNodes,f=h.length,p=0;p<f;p++){var g=h[p],y=g.tagName;y&&g!=a&&g!=o&&lo[y]&&lo[y](h[p],t,n,r)}var x,v,_=+w(s,"cx"),b=+w(s,"cy"),S={},C=w(a,"text-anchor")||"start",M=w(a,"transform");x="end"==C?M?90:0:M?270:180;v=Ue(x-t);p=x/90|0;var N=[c,-l,-c,l][p],P=[l,c,l,c][p];p=v/90|0;var T=[N,P,-N,P][p],O=[P,-N,P,N][p],k=_+T,A=b+O;S.x=k;S.y=A;S["text-anchor"]=0===v||90==v?"end":"start";S.transform=90==v||270==v?"rotate(270,"+k+","+A+")":"";w(a,S);p=x/90|0;var E=[d,-u,-d,u][p],I=[u,d,u,d][p];p=v/90|0;var j=[E,I,-E,I][p],B=[I,-E,I,E][p],D=_+j,F=b+B;S.x=D;S.y=F;S["text-anchor"]=0===v||90==v?"start":"end";S.transform=90==v||270==v?"rotate(270,"+D+","+F+")":"";w(o,S)},image:function(e,t,n,r){if(0!==t){if(w(e,"xlink:href")){var i=Wa.svg.getViewBBox(e);if(void 0===n||void 0===r){n=Wa.toFixed(i.x+i.width/2,3);r=Wa.toFixed(i.y+i.height/2,3)}var a=(w(e,"x"),w(e,"y"),+w(e,"width")||0),o=+w(e,"height")||0,s=Ue(360-(w(e,"c_rotation")||0)),c=Ue(s+t),l=Re(i,t,n,r),d={x:l.x,y:l.y,c_rotation:Ue(360-c)};i={x:d.x,y:d.y,width:a,height:o};d.transform=ut(i,c,w(e,"transform"));w(e,d)}}},circle:function(e,t,n,r){var i=[w(e,"cx"),w(e,"cy")];i=Fe(i,t,n,r);w(e,{cx:i[0],cy:i[1]})},ellipse:function(e,t,n,r){var i=[w(e,"cx"),w(e,"cy")];i=Fe(i,t,n,r);w(e,{cx:i[0],cy:i[1]});if(t%180!=0){var a=w(e,"rx");w(e,{rx:w(e,"ry"),ry:a})}},line:function(e,t,n,r){var i=[w(e,"x1"),w(e,"y1"),w(e,"x2"),w(e,"y2")];i=Fe(i,t,n,r);w(e,{x1:i[0],y1:i[1],x2:i[2],y2:i[3]})},polyline:function(e,t,n,r){void 0===t&&(t=270);var i=X(w(e,"points")).split(/[\s\,]+/);i=Fe(i,t,n,r);w(e,{points:i.join(" ")})},polygon:function(e,t,n,r){lo.polyline(e,t,n,r)},path:function(e,t,n,r){if(t%360!=0){t=Ue(t);for(var i,a,o,s,c,l,d,u,h,f=Ga,p=e.pathSegList,g=p.numberOfItems,y=0;y<g;y++){i=null;a=p.getItem(y);o=a.pathSegType;h=o%2==0;if(0!=o&&1!=o){if(h){s=o;c=n;l=r}else{s=o-1;c=0;l=0}a._owningPathSegList=null;switch(s){case 2:case 4:i=Fe([a.x,a.y],t,c,l);a.x=i[0];a.y=i[1];break;case 6:i=Fe([a.x,a.y,a.x1,a.y1,a.x2,a.y2],t,c,l);a.x=i[0];a.y=i[1];a.x1=i[2];a.y1=i[3];a.x2=i[4];a.y2=i[5];break;case 8:i=Fe([a.x,a.y,a.x1,a.y1],t,c,l);a.x=i[0];a.y=i[1];a.x1=i[2];a.y1=i[3];break;case 10:i=Fe([a.x,a.y],t,c,l);a.x=i[0];a.y=i[1];if(a.r1!=a.r2){a.angle=(a.angle-t)%180;if(90==a.angle||-90==a.angle){a.angle=0;var x=a.r1,v=a.r2;a.r1=v;a.r2=x}}else a.angle=0;break;case 12:if(180==t)a.x=h?n+n-a.x:-a.x;else{d=Xi[t];u=h?e.createSVGPathSegLinetoVerticalAbs((a.x-n)*d+r):e.createSVGPathSegLinetoVerticalRel(a.x*d);p.replaceItem(u,y)}break;case 14:if(180==t)a.y=h?r+r-a.y:-a.y;else{d=Xi[t];u=h?e.createSVGPathSegLinetoHorizontalAbs(n-(a.y-r)*d):e.createSVGPathSegLinetoHorizontalRel(-a.y*d);p.replaceItem(u,y)}break;case 16:i=Fe([a.x,a.y,a.x2,a.y2],t,c,l);a.x=i[0];a.y=i[1];a.x2=i[2];a.y2=i[3];break;case 18:i=Fe([a.x,a.y],t,c,l);a.x=i[0];a.y=i[1]}a._owningPathSegList=p}}p.segmentChanged();f&&Wa.svg.fixOperaPathDAttribute(e);Ra&&w(e,"d",w(e,"d"))}},annotation:function(e,t,n,r){void 0===t&&(t=270);if(t%360!=0){var i,a,o,s,c,l,d,u,h,f,p,g,y,x,v=L("text",e);a=dt(e);o=a.x+a.width/2;s=a.y+a.height/2;i=Fe([o,s],t,n,r);n=i[0];r=i[1];p=+(w(e,"c_rotation")||0);var _,b=w(v,"transform");if(b){_=b.match(/[\d\.\-]+/)[0];_!=p&&(p=_)}p=Ue(p-t);w(e,"c_rotation",p);w(e,"c_origin",Wa.toFixed(n,2)+","+Wa.toFixed(r,2));switch(p){case 0:case 180:g="";break;case 90:g="270";break;case 270:g="90";break;default:return}w(v,"text-anchor","");w(v,"transform",g?"rotate("+g+","+w(v,"x")+","+w(v,"y")+")":"");c=dt(e);l=c.x+c.width/2;d=c.y+c.height/2;u=Wa.toFixed(+w(v,"x")+n-l,2);h=Wa.toFixed(+w(v,"y")+r-d,2);g=g?"rotate("+g+","+u+","+h+")":"";w(v,{x:u,y:h,transform:g});f=m("tspan",v);for(y=0,x=f.length;y<x;y++)w(f[y],"x",u)}}},uo={point:function(e,t,n){null!==t&&(e.x=2*t-e.x);null!==n&&(e.y=2*n-e.y)},element:function(e,t,n){e.tagName&&uo[e.tagName](e,t,n)},elementsFlipH:function(e,t){if(0!==e.length){var n,r;if(wo===ia.PCB&&!isLayerVisible(na.MECHANICAL)&&w(e[0],"layerid")==na.MECHANICAL){var i=getStyleSheetRuleByLayerId(v("pcblayerStyle").sheet,na.MECHANICAL);i.style.display=""}if(void 0===t||null===t){var a,o,s,c,l=w(e[0],"c_origin");if(l)a=o=+l.split(",")[0];else try{c=e[0].getBBox();a=c.x;o=c.x+c.width}catch(e){a=Number.MAX_VALUE;o=-Number.MAX_VALUE}for(n=0,r=e.length;n<r;n++){l=w(e[n],"c_origin");if(l){s=+l.split(",")[0];s<a?a=s:s>o&&(o=s)}else{if("none"==e[n].style.display)continue;try{c=e[n].getBBox();c.x<a&&(a=c.x);c.x+c.width>o&&(o=c.x+c.width)}catch(e){}}}t=(a+o)/2}if(wo===ia.PCB&&!isLayerVisible(na.MECHANICAL)&&w(e[0],"layerid")==na.MECHANICAL){i=getStyleSheetRuleByLayerId(v("pcblayerStyle").sheet,na.MECHANICAL);i.style.display="none"}for(n=0,r=e.length;n<r;n++)uo[e[n].tagName](e[n],t,null)}},elementsFlipV:function(e,t){if(e.length){var n,r;if(void 0===t||null===t){var i,a,o,s,c=w(e[0],"c_origin");if(c)i=a=+c.split(",")[1];else try{s=e[0].getBBox();i=s.y;a=s.y+s.height}catch(e){Number.MAX_VALUE;-Number.MAX_VALUE}for(n=1,r=e.length;n<r;n++){c=w(e[n],"c_origin");if(c){o=+c.split(",")[1];o<i?i=o:o>a&&(a=o)}else{if("none"==e[n].style.display)continue;try{s=e[n].getBBox();s.y<i&&(i=s.y);s.y+s.height>a&&(a=s.y+s.height)}catch(e){}}}t=(i+a)/2}for(n=0,r=e.length;n<r;n++)uo[e[n].tagName](e[n],null,t)}},flipH:function(e,t){if(e instanceof NodeList||Array.isArray(e))return uo.elementsFlipH(e,t);if(void 0===t||null===t)try{var n=e.getBBox();t=n.x+n.width/2}catch(n){var r=e.tagName;if("rect"!=r&&"image"!=r)return;t=+w(e,"x")+w(e,"width")/2}uo[e.tagName](e,t,null)},flipV:function(e,t){if(e instanceof NodeList||Array.isArray(e))return uo.elementsFlipV(e,t);if(void 0===t||null===t)try{var n=e.getBBox();t=n.y+n.height/2}catch(n){var r=e.tagName;if("rect"!=r&&"image"!=r)return;t=+w(e,"y")+w(e,"height")/2}uo[e.tagName](e,null,t)},g:function(e,t,n){var r,i,a,o,s=w(e,"c_origin");if(s){r=s.split(",");o={x:+r[0],y:+r[1]};uo.point(o,t,n);w(e,"c_origin",o.x+","+o.y)}var c;if("part_pin"!=w(e,"c_partid")){
if("part_plane"!=w(e,"c_partid")){var l=e.children||e.childNodes;a=l.length;for(i=0;i<a;i++){var d=l[i].tagName;if(d&&j(lo,d)){if("outline3D"===w(l[i],"c_etype")){c=Wa.svg.getCss3(l[i],"scale");Wa.svg.scaleOutline(l[i],1)}else c=!1;uo[d](l[i],t,n);c&&Wa.svg.scaleOutline(l[i],c)}}w(e,"c_partid")}}else uo.pin(e,t,n)},svg:{},rect:function(e,t,n){null!==t&&w(e,"x",2*t-w(e,"x")-w(e,"width"));null!==n&&w(e,"y",2*n-w(e,"y")-w(e,"height"))},text:function(e,t,n){var r=void 0!==t&&null!==t,i=void 0!==n&&null!==n,a=parseFloat(w(e,"font-size")||"7pt");if(r||i){var o,s=Ve(e),c="text-anchor";if(r){if("spice_res"===w(e,"type")){var l=p(e,t,n,r);if("quit"===l)return}else w(e,"x",2*t-w(e,"x"));if(0===s||180==s){o=w(e,c);w(e,c,"start"!=o&&o?"start":"end")}}if(i){if("spice_res"===w(e,"type")){l=p(e,t,n,r);if("quit"===l)return}else w(e,"y",2*n-w(e,"y")+a);if(270==s||90==s){o=w(e,c);w(e,c,"start"!=o&&o?"start":"end")}}w(e,"transform")&&w(e,"transform","rotate("+s+","+w(e,"x")+","+w(e,"y")+")")}},pin:function(e,t,n){var r,i=m("text",e),a=i[0],o=i[1],s=L("circle",e),c=!!w(a,"transform"),l=null!==n,d={};if(c!==l)var u=w(a,"x")-w(s,"cx"),h=w(a,"y")-w(s,"cy"),f=w(o,"x")-w(s,"cx"),p=w(o,"y")-w(s,"cy");for(var g=e.children||e.childNodes,y=g.length,x=0;x<y;x++){var v=g[x],_=v.tagName;_&&v!=a&&v!=o&&uo[_](g[x],t,n)}if(c==l){w(e,"c_rotation",Ue((w(e,"c_rotation")||0)-180));d["text-anchor"]="end"==w(a,"text-anchor")?"start":"end";r={x:+w(a,"x"),y:+w(a,"y")};uo.point(r,t,n);d.x=r.x;d.y=r.y;c&&(d.transform=w(a,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+d.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+d.y));w(a,d);d["text-anchor"]="end"==w(o,"text-anchor")?"start":"end";r={x:+w(o,"x"),y:+w(o,"y")};uo.point(r,t,n);d.x=r.x;d.y=r.y;c&&(d.transform=w(o,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+d.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+d.y));w(o,d)}else{var b=+w(s,"cx"),S=+w(s,"cy");d.x=b+u;d.y=S+h;c&&(d.transform=w(a,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+d.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+d.y));w(a,d);d.x=b+f;d.y=S+p;c&&(d.transform=w(o,"transform").replace(/([\-.\d]+[\s,]+)[\-]?[.\d]+/,"$1"+d.x).replace(/(([\-.\d]+[\s,]+){2})[\-]?[.\d]+/,"$1"+d.y));w(o,d)}},image:function(e,t,n){function r(e){return new RegExp(e+"\\((.*?)\\)")}var i=w(e,"transform"),a=1,o=1,s=1,c=1,l=0,d=0;if(null!==t){t<0&&(s=-1);l=2*Math.abs(t)*s;a=-1}if(null!==n){n<0&&(c=-1);d=2*Math.abs(n)*c;o=-1}var u=0,h=0;i||(i="scale(1,1) translate(0,0)");var f,p,g,y=1,x=1;if(i.match(r("scale"))){g=!0;f=i.match(r("scale"))[1];if(f.indexOf(",")>-1){f=f.split(",");y=parseFloat(f[0]);x=parseFloat(f[1])}else y=x=parseFloat(f);if(null!==t){a*=y;o=x}if(null!==n){o*=x;a=y}}null!==t&&1==y&&(l=-l);null!==n&&1==x&&(d=-d);if(i.match(r("translate"))){p=i.match(r("translate"))[1].split(",");u=+p[0];h=+p[1];u=l+u;h=d+h;i=i.replace(r("translate"),"translate("+u+","+h+")")}if(g){var v="scale("+a+","+o+")";w(e,"transform",i.replace(r("scale"),v))}else w(e,"transform","scale("+a+","+o+") "+i)},circle:function(e,t,n){null!==t&&w(e,"cx",2*t-w(e,"cx"));null!==n&&w(e,"cy",2*n-w(e,"cy"))},ellipse:function(e,t,n){uo.circle(e,t,n)},line:function(e,t,n){if(null!==t){w(e,"x1",2*t-w(e,"x1"));w(e,"x2",2*t-w(e,"x2"))}if(null!==n){w(e,"y1",2*n-w(e,"y1"));w(e,"y2",2*n-w(e,"y2"))}},polyline:function(e,t,n){var r,i,a=X(w(e,"points")).split(/[\s\,]+/);if(null!==t){var o=2*t;for(r=0,i=a.length-1;r<i;r+=2)a[r]=o-a[r]}if(null!==n){var s=2*n;for(r=0,i=a.length-1;r<i;r+=2)a[r+1]=s-a[r+1]}w(e,{points:a.join(" ")})},polygon:function(e,t,n){uo.polyline(e,t,n)},path:function(e,t,n){if(Ga)var r=!0;var i,a,o,s,c,l=e.pathSegList,d=l.numberOfItems,u=2*t,h=2*n;if(null!==t){for(c=0;c<d;c++){i=l.getItem(c);switch(i.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:case SVGPathSeg.PATHSEG_LINETO_ABS:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:i.x=u-i.x;break;case SVGPathSeg.PATHSEG_MOVETO_REL:case SVGPathSeg.PATHSEG_LINETO_REL:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:i.x=-i.x;break;case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:i.x=u-i.x;i.x1=u-i.x1;i.x2=u-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:i.x=-i.x;i.x1=-i.x1;i.x2=-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:i.x=u-i.x;i.x2=u-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:i.x=-i.x;i.x2=-i.x2;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:i.x=u-i.x;i.x1=u-i.x1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:i.x=-i.x;i.x1=-i.x1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:i.x=u-i.x;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:i.x=-i.x;break;case SVGPathSeg.PATHSEG_ARC_ABS:i.x=u-i.x;i.sweepFlag=1-i.sweepFlag;break;case SVGPathSeg.PATHSEG_ARC_REL:i.x=-i.x;i.sweepFlag=1-i.sweepFlag}}a=w(e,"c_helper_dots");if(a){o=a.split(/[\s\,]+/);for(c=0,d=o.length-1;c<d;c+=2)o[c]=u-o[c];s=o.splice(4,2);o.push(s[0],s[1]);w(e,"c_helper_dots",o.join(","))}}if(null!==n){for(c=0;c<d;c++){i=l.getItem(c);switch(i.pathSegType){case SVGPathSeg.PATHSEG_MOVETO_ABS:case SVGPathSeg.PATHSEG_LINETO_ABS:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:i.y=h-i.y;break;case SVGPathSeg.PATHSEG_MOVETO_REL:case SVGPathSeg.PATHSEG_LINETO_REL:case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:i.y=-i.y;break;case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:i.y=h-i.y;i.y1=h-i.y1;i.y2=h-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:i.y=-i.y;i.y1=-i.y1;i.y2=-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:i.y=h-i.y;i.y2=h-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:i.y=-i.y;i.y2=-i.y2;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:i.y=h-i.y;i.y1=h-i.y1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:i.y=-i.y;i.y1=-i.y1;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:i.y=h-i.y;break;case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:i.y=-i.y;break;case SVGPathSeg.PATHSEG_ARC_ABS:i.y=h-i.y;i.sweepFlag=1-i.sweepFlag;break;case SVGPathSeg.PATHSEG_ARC_REL:i.y=-i.y;i.sweepFlag=1-i.sweepFlag}}a=w(e,"c_helper_dots");if(a){o=a.split(/[\s\,]+/);for(c=0,d=o.length-1;c<d;c+=2)o[c+1]=h-o[c+1];s=o.splice(4,2);o.push(s[0],s[1]);w(e,"c_helper_dots",o.join(","))}}r&&Wa.svg.fixOperaPathDAttribute(e);Ra&&w(e,"d",w(e,"d"))}},ho={get:function(e){var t=e.tagName;if("path"==t&&void 0!==wo&&(wo==ia.PCB||wo==ia.PCBMODULE||wo==ia.PCBLIB)){var n=de(e);"DIMENSION"!=n&&"PROTRACTOR"!=n||(t=n)}if("g"==t&&void 0!==wo&&(wo==ia.PCB||wo==ia.PCBMODULE||wo==ia.PCBLIB)){n=de(e);"FOOTPRINT"==n&&(t=n)}return ho[t]?ho[t].get.apply(e,arguments):[]},set:function(e){var t=e.tagName;if("path"==t&&void 0!==wo&&(wo==ia.PCB||wo==ia.PCBMODULE||wo==ia.PCBLIB)){var n=de(e);"DIMENSION"!=n&&"PROTRACTOR"!=n||(t=n)}if("g"==t&&void 0!==wo&&(wo==ia.PCB||wo==ia.PCBMODULE||wo==ia.PCBLIB)){n=de(e);"FOOTPRINT"==n&&(t=n)}ho[t]&&ho[t].set.apply(e,arguments)},text:{get:function(e){var t=e.getBBox(),n=t.x,r=t.y,i=t.width,a=t.height,o=[n,r,n+i,r,n+i,r+a,n,r+a];o.onlyLines=1;o.c_helper_lines=[{type:"rect",data:t}];return o},set:function(e,t,n,r,i){co.text(e,r,i)}},g:{get:function(e){if("part_annotation"===w(e,"c_partid"))return[];var t=e.getBBox(),n=t.x,r=t.y,i=t.width,a=t.height;return[n,r,n+i,r,n,r+a,n+i,r+a]},set:function(e,t,n,r,i){co.g(e,r,i)}},svg:{get:function(e){return ho.rect.get(e)},set:function(e,t,n,r,i){return ho.rect.set(e,t,n,r,i)}},image:{get:function(e){var t=Wa.svg.getViewBBox(e),n=[t.x,t.y,t.x+t.width,t.y,t.x+t.width,t.y+t.height,t.x,t.y+t.height];n.c_helper_lines=[{from:0,to:1},{from:1,to:2},{from:2,to:3},{from:3,to:0}];return n},set:function(e,t,n,r,i){var a={x:t[0],y:t[1],width:t[2]-t[0],height:t[5]-t[1]};if(0===n||3==n){a.x+=r;a.width-=r}if(0===n||1==n){a.y+=i;a.height-=i}1!=n&&2!=n||(a.width+=r);2!=n&&3!=n||(a.height+=i);if(0!==a.width&&0!==a.height){if(a.width<0){a.width=-a.width;a.x-=a.width}if(a.height<0){a.height=-a.height;a.y-=a.height}var o=Ve(e);90!=o&&270!=o||(a.width=[a.height,a.height=a.width][0]);a.transform=o?ut(a,o,w(e,"transform")):"";w(e,a)}}},rect:{get:function(e){var t=+w(e,"x"),n=+w(e,"y"),r=+w(e,"width"),i=+w(e,"height");return[t,n,t+r,n,t+r,n+i,t,n+i]},set:function(e,t,n,r,i){t||(t=ho.rect.get(e));var a={x:t[0],y:t[1],width:t[2]-t[0],height:t[5]-t[1]};if(0===n||3==n){a.x+=r;a.width-=r}if(0===n||1==n){a.y+=i;a.height-=i}1!=n&&2!=n||(a.width+=r);2!=n&&3!=n||(a.height+=i);if(0!==a.width&&0!==a.height){if(a.width<0){a.width=-a.width;a.x-=a.width}if(a.height<0){a.height=-a.height;a.y-=a.height}w(e,a)}}},circle:{get:function(e){var t=+w(e,"cx"),n=+w(e,"cy"),r=+w(e,"r");return[t,n,t,n-r,t,n+r,t-r,n,t+r,n]},set:function(e,t,n,r,i){t||(t=ho.circle.get(e));var a={cx:t[0],cy:t[1],r:t[1]-t[3]};if(0===n){a.cx+=r;a.cy+=i}1==n&&(a.r-=i);2==n&&(a.r+=i);3==n&&(a.r-=r);4==n&&(a.r+=r);if(0!==a.r){a.r<0&&(a.r=-a.r);w(e,a)}}},ellipse_0:{get:function(e){var t=+w(e,"cx"),n=+w(e,"cy"),r=+w(e,"rx"),i=+w(e,"ry");return[t,n,t,n-i,t,n+i,t-r,n,t+r,n]},set:function(e,t,n,r,i){t||(t=ho.ellipse_0.get(e));var a={cx:t[0],cy:t[1],rx:t[0]-t[6],ry:t[1]-t[3]};if(0===n){a.cx+=r;a.cy+=i}1==n&&(a.ry-=i);2==n&&(a.ry+=i);3==n&&(a.rx-=r);4==n&&(a.rx+=r);if(0!==a.rx&&0!==a.ry){a.rx<0&&(a.rx=-a.rx);a.ry<0&&(a.ry=-a.ry);w(e,a)}}},ellipse:{get:function(e){var t=+w(e,"cx"),n=+w(e,"cy"),r=+w(e,"rx"),i=+w(e,"ry");return[t-r,n-i,t+r,n-i,t-r,n+i,t+r,n+i]},set:function(e,t,n,r,i){t||(t=ho.ellipse.get(e));var a={cx:(t[0]+t[2])/2,cy:(t[1]+t[5])/2,rx:(t[2]-t[0])/2,ry:(t[5]-t[1])/2};a.cx+=r/2;a.cy+=i/2;0===n||2==n?a.rx-=r/2:a.rx+=r/2;0===n||1==n?a.ry-=i/2:a.ry+=i/2;if(0!==a.rx&&0!==a.ry){a.rx<0&&(a.rx=-a.rx);a.ry<0&&(a.ry=-a.ry);w(e,a)}}},line:{get:function(e){return[+w(e,"x1"),+w(e,"y1"),+w(e,"x2"),+w(e,"y2")]},set:function(e,t,n,r,i){t||(t=ho.line.get(e));var a={x1:t[0],y1:t[1],x2:t[2],y2:t[3]};if(0===n){a.x1+=r;a.y1+=i}if(1==n){a.x2+=r;a.y2+=i}w(e,a)}},polyline:{get:function(e){for(var t=X(w(e,"points")).split(/[\s\,]+/g),n=0;n<t.length;n++)t[n]=+t[n];for(n=t.length-2;n>=2;n-=2)t.splice(n,0,(t[n-2]+t[n])/2,(t[n-1]+t[n+1])/2);t.lightDots="odd";return t},set:function(e,t,n,r,i){var a=t.slice(0);a[2*n]+=r;a[2*n+1]+=i;if(n%2&&(!Ye(2*a[2*n],a[2*n-2]+a[2*n+2])||!Ye(2*a[2*n+1],a[2*n-1]+a[2*n+3]))){a.splice(2*n+2,0,0,0);a.splice(2*n,0,0,0)}for(var o=4,s=a.slice(0,2);o<a.length-1;o+=4)s.push(a[o],a[o+1]);for(var c=!0,l=2;l<s.length-1;l+=2)if(s[l]!=s[0]||s[l+1]!=s[1]){c=!1;break}if(!c){w(e,{points:Wa.fixLongNumberString(s.join(" "))})}}},polygon:{get:function(e){for(var t=X(w(e,"points")).split(/[\s\,]+/g),n=0;n<t.length;n++)t[n]=+t[n];for(n=t.length-2;n>=2;n-=2)t.splice(n,0,(t[n-2]+t[n])/2,(t[n-1]+t[n+1])/2);n=t.length-2;t.push((t[0]+t[n])/2,(t[1]+t[n+1])/2);t.lightDots="odd";return t},set:function(e,t,n,r,i){var a,o=t.slice(0),s=2*n;o[s]+=r;o[s+1]+=i;if(n==o.length/2-1)Ye(2*o[s],o[0]+o[s-2])&&Ye(2*o[s+1],o[1]+o[s-1])||o.splice(s,0,0,0);else if(n%2&&(!Ye(2*o[s],o[s-2]+o[s+2])||!Ye(2*o[s+1],o[s-1]+o[s+3]))){o.splice(s+2,0,0,0);o.splice(s,0,0,0)}for(s=4,a=o.slice(0,2);s<o.length-1;s+=4)a.push(o[s],o[s+1]);for(var c,l={},d=[],u=0;u<a.length-1&&d.length<4;u+=2){c=a[u]+"_"+a[u+1];if(!l[c]){l[c]=!0;d.push(u)}}if(!(d.length<=2)){var h,f,p,g,y,x,v=!0;for(n=2;n<d.length;n++){h=a[d[0]],f=a[d[0]+1],p=a[d[1]],g=a[d[1]+1],y=a[d[n]],x=a[d[n]+1];if(!Ye((h-p)*(x-g),(y-p)*(f-g))){v=!1;break}}if(!v){w(e,{points:Wa.fixLongNumberString(a.join(" "))})}}}},path:{get:function(e){var t=Wa.svg.getPathHelperType(e);if(t){var n=e.tagName+"_"+t;if(ho[n]&&ho[n].get)return ho[n].get.apply(e,arguments)}var r,i,a,o,s=e.pathSegList,c=s.numberOfItems,l=0,d=0,u=[],h=0,f=0,p=[],g=[],y=[];for(r=0;r<c;r++){a=s.getItem(r);o=a.pathSegType;i=u.length/2-1;y[r]={start:i+1,type:o};switch(o){case 1:u.push((l+h)/2,(d+f)/2);g.push(i+1);l=h;d=f;break;case 2:l=a.x;d=a.y;h=l;f=d;u.push(l,d);break;case 4:u.push((l+a.x)/2,(d+a.y)/2);g.push(i+1);u.push(l=a.x,d=a.y);break;case 12:u.push(l=a.x,d);break;case 14:u.push(l,d=a.y);break;case 6:p.push({from:i,to:i+1},{from:i+2,to:i+3});u.push(a.x1,a.y1,a.x2,a.y2,l=a.x,d=a.y);break;case 16:p.push({from:i+1,to:i+2});u.push(a.x2,a.y2,l=a.x,d=a.y);break;case 8:p.push({from:i,to:i+1},{from:i+1,to:i+2});u.push(a.x1,a.y1,l=a.x,d=a.y);break;case 18:case 10:u.push(l=a.x,d=a.y);break;case 3:l+=a.x;d+=a.y;h=l;f=d;u.push(l,d);break;case 5:u.push((l+l+a.x)/2,(d+d+a.y)/2);g.push(i+1);u.push(l+=a.x,d+=a.y);break;case 13:u.push(l+=a.x,d);break;case 15:u.push(l,d+=a.y);break;case 7:p.push({from:i,to:i+1},{from:i+2,to:i+3});u.push(l+a.x1,d+a.y1,l+a.x2,d+a.y2,l+=a.x,d+=a.y);break;case 17:p.push({from:i+1,to:i+2});u.push(l+a.x2,d+a.y2,l+=a.x,d+=a.y);break;case 9:p.push({from:i+1,to:i+2});u.push(l+a.x1,d+a.y1,l+=a.x,d+=a.y);break;case 19:case 11:u.push(l+=a.x,d+=a.y);break;default:throw new Error("unexpected path segment type")}Object.assign(y[r],{end:u.length/2-1})}p.length&&(u.c_helper_lines=p);u.lightDots=g;u.dotsGroup=y;return u},set:function(e,t,n,r,i,a){if(0!==r||0!==i){var o=Wa.svg.getPathHelperType(e);if(o){var s=e.tagName+"_"+o;if(ho[s]&&ho[s].set){ho[s].set.apply(e,arguments);return}}var c,l,d;if(!/[ahvqtscz]/i.test(a)){c=!0;l=t.slice(0);if(2*n+1<l.length){l[2*n]+=r;l[2*n+1]+=i}for(d=2;d<l.length-1;d+=2)if(l[d]!=l[0]||l[d+1]!=l[1]){c=!1;break}if(c)return}var u,h,f,p,g,y,x,v,m,L,_,b,S,C=e.pathSegList,M=(C.numberOfItems,n);a&&w(e,{d:a});var N=t,P=N.lightDots||[],T=N.dotsGroup||[],O=-1,k=-1;for(u=0;u<T.length;u++)if(T[u].end>=n){O=u;k=n-T[u].start;break}if(!(O<0||k<0)){h=C.getItem(O);f=h.pathSegType;if(P.includes(M))if(10==f&&0===k){u=T[O].start-1;if(u<0)return;p={x:t[2*u],y:t[2*u+1]};g=t[2*M];y=t[2*M+1];x=Pe({x:p.x,y:p.y},{x:h.x,y:h.y},{x:g+r,y:y+i});x<4&&(x=4);x=Math.sqrt(x);v=h.sweepFlag;m=h.r1;L=Be(p.x,p.y,h.x,h.y);m*m-L/4;_=(h.x-p.x)*(y-p.y)-(g-p.x)*(h.y-p.y);b=(h.x-p.x)*(y+i-p.y)-(g+r-p.x)*(h.y-p.y);_*b<0&&(v^=1);m=L/(8*x)+x/2;S=m>x?0:1;m=Wa.formatLengthSave(m);h.r1=m;h.r2=m;h.largeArcFlag=S;h.sweepFlag=v}else if(10==f||11==f){if(0===k)return;h.x+=r;h.y+=i}else[1,4,5].includes(f)&&C.insertItemBefore(e.createSVGPathSegLinetoAbs(t[2*M]+r,t[2*M+1]+i),O);else switch(f){case 1:break;case 2:case 3:case 4:case 5:h.x=Wa.formatLengthSave(h.x+r);h.y=Wa.formatLengthSave(h.y+i);break;case 12:case 13:h.x=Wa.formatLengthSave(h.x+r);break;case 14:case 15:h.y=Wa.formatLengthSave(h.y+i);break;case 6:case 7:if(0===k){h.x1=Wa.formatLengthSave(h.x1+r);h.y1=Wa.formatLengthSave(h.y1+i)}else if(1===k){h.x2=Wa.formatLengthSave(h.x2+r);h.y2=Wa.formatLengthSave(h.y2+i)}else if(2===k){h.x=Wa.formatLengthSave(h.x+r);h.y=Wa.formatLengthSave(h.y+i)}break;case 16:case 17:if(0===k){h.x2=Wa.formatLengthSave(h.x2+r);h.y2=Wa.formatLengthSave(h.y2+i)}else if(1===k){h.x=Wa.formatLengthSave(h.x+r);h.y=Wa.formatLengthSave(h.y+i)}break;case 8:case 9:if(0===k){h.x1=Wa.formatLengthSave(h.x1+r);h.y1=Wa.formatLengthSave(h.y1+i)}else if(1===k){h.x=Wa.formatLengthSave(h.x+r);h.y=Wa.formatLengthSave(h.y+i)}break;case 18:case 19:if(0===k){h.x=Wa.formatLengthSave(h.x+r);h.y=Wa.formatLengthSave(h.y+i)}break;case 10:case 11:if(0===k){var A=Wa.formatLengthSave(h.x+r),E=Wa.formatLengthSave(h.y+i),I=T[O].start-1,j=N[2*I],B=N[2*I+1];if(Ye(A,j,.001)&&Ye(E,B,.001))break;h.x=A;h.y=E}break;default:throw new Error("unexpected path segment type")}}}else a&&w(e,{d:a})}},path_arc1:{get:function(e){var t=Wa.arc.calculateArcHelperDots(e);t.c_helper_lines=Wa.arc.c_helper_lines;return t},set:function(e,t,n,r,i,a){var o,s,c,l,d=t?t.slice(0):ho.path_arc1.get(e),u=!(wo==ia.PCBLIB||wo==ia.PCB);if(0===n){a&&w(e,{d:a});Wa.Dots.eachAdd(d,r,i);co.path(e,r,i)}else{d[2*n]+=r;d[2*n+1]+=i;o=Math.abs(d[0]-d[2]);s=Math.abs(d[1]-d[3]);if(0===o||0===s)return;if(u){o=Math.abs(d[0]-d[2]);s=Math.abs(d[1]-d[3])}else o=s=De(d[0],d[1],d[2],d[3]);c=Wa.arc.getArcParams(d[0],d[1],o,s,d[4],d[5],d[6],d[7]);if(null===c)return;c.x1=Wa.formatLengthSave(c.x1);c.y1=Wa.formatLengthSave(c.y1);o=Wa.formatLengthSave(o);s=Wa.formatLengthSave(s);c.x2=Wa.formatLengthSave(c.x2);c.y2=Wa.formatLengthSave(c.y2);l="M"+c.x1+","+c.y1+" A"+o+","+s+" 0 "+c.fa+" "+c.fs+" "+c.x2+","+c.y2;w(e,{d:l})}w(e,{c_helper_dots:d.join(",")})}},path_arc2:{get:function(e){var t,n=[],r=e.getPathData();for(t=0;t<r.length;t++)if("A"==r[t].type){var i=r[t-1].values,a=r[t].values,o=Wa.arc.getCenterParam(i[0],i[1],a[5],a[6],a[3],a[4],a[0],a[1],a[2]),s=o.cx,c=o.cy,l=Ge([i[0],i[1]],[s,c],o.delta_theta/2),d=rt(w(e,"d")),u=it(d);n.push(i[0],i[1],a[5],a[6],l[0],l[1],u.x,u.y);break}return n},set:function(e,t,n,r,i,a){if(0!==r||0!==i){var o,s,c,l=t?t.slice(0):ho.path_arc2.get(e);if(3===n){l[0]+=r;l[1]+=i;l[2]+=r;l[3]+=i}if(!(0===n&&Ye(l[0]+r,l[2])&&Ye(l[1]+i,l[3])||1===n&&Ye(l[2]+r,l[0])&&Ye(l[3]+i,l[1])||2===n&&Ye((l[2]-l[0])*(l[5]+i-l[1]),(l[3]-l[1])*(l[4]+r-l[0])))){var d=Ua.getCacheObj("arc-type");if("twoPointArc"===d){if(2===n){o=Pe({x:l[0],y:l[1]},{x:l[2],y:l[3]},{x:l[4]+r,y:l[5]+i});if(o<4)return;o=Math.sqrt(o)}a&&w(e,"d",a)}var u=e.pathSegList.getItem(1),h=u.r1,f=+u.largeArcFlag,p=+u.sweepFlag;if("twoPointArc"===d){var g=Be(l[0],l[1],l[2],l[3]),y=h*h-g/4;if(2==n){s=(l[2]-l[0])*(l[5]-l[1])-(l[4]-l[0])*(l[3]-l[1]);l[2*n]+=r;l[2*n+1]+=i;c=(l[2]-l[0])*(l[5]-l[1])-(l[4]-l[0])*(l[3]-l[1]);s*c<0&&(p^=1)}else{o=h+(f?1:-1)*(y>0?Math.sqrt(y):0);l[2*n]+=r;l[2*n+1]+=i;g=Be(l[0],l[1],l[2],l[3])}h=g/(8*o)+o/2;f=h>o?0:1}else if(0===n||1===n){var x=l[2*n]+r,v=l[2*n+1]+i,m=je(l[6],l[7],x,v);l[2*n]=l[6]+h*Math.cos(m);l[2*n+1]=l[7]+h*Math.sin(m);var L=180*Ze({x:l[0]-l[6],y:l[1]-l[7]},{x:l[2]-l[6],y:l[3]-l[7]})/Math.PI;f=Ue(L)<180?1:0;if(p){p=1;f=1-f}else p=0}else if(2===n){var _=Wa.arc.getArcParamsBy3Points(l[0],l[1],l[2],l[3],l[4]+r,l[5]+i);h=_.r1;f=_.largeArcFlag;p=_.sweepFlag;l[6]=_.cx;l[7]=_.cy}l[0]=Wa.formatLengthSave(l[0]);l[1]=Wa.formatLengthSave(l[1]);h=Wa.formatLengthSave(h);l[2]=Wa.formatLengthSave(l[2]);l[3]=Wa.formatLengthSave(l[3]);w(e,"d","M"+l[0]+","+l[1]+" A"+h+","+h+" 0 "+f+" "+p+" "+l[2]+","+l[3])}}else a&&w(e,{d:a})}},path_pie1:{get:function(e){var t=Wa.arc.calculateArcHelperDots(e);t.c_helper_lines=Wa.arc.c_helper_lines_pie1;return t},set:function(e,t,n,r,i,a){var o=t?t.slice(0):ho.path_pie1.get(e);if(0===n){a&&w(e,{d:a});Wa.Dots.eachAdd(o,r,i);co.path(e,r,i)}else{o[2*n]+=r;o[2*n+1]+=i;var s=Math.abs(o[0]-o[2]),c=Math.abs(o[1]-o[3]);if(0===s||0===c)return;var l=Wa.arc.getArcParams(o[0],o[1],s,c,o[4],o[5],o[6],o[7]);if(!l)return;l.x1=Wa.formatLengthSave(l.x1);l.y1=Wa.formatLengthSave(l.y1);s=Wa.formatLengthSave(s);c=Wa.formatLengthSave(c);l.x2=Wa.formatLengthSave(l.x2);l.y2=Wa.formatLengthSave(l.y2);w(e,{d:"M"+o[0]+","+o[1]+" L"+l.x1+","+l.y1+" A"+s+","+c+" 0 "+l.fa+" "+l.fs+" "+l.x2+","+l.y2+"Z"})}}},DIMENSION:{get:function(e){return go.getStartAndEndPointByDimensionElement(e)},set:function(e,t,n,r,i,a){4===t.length&&(t=t.concat(t));if(!(t.length<8)){var o=w(e,"c_fontsize"),s=w(e,"c_unit"),c=w(e,"c_precision"),l=w(e,"layerid"),d=l==na.BOTTOMSILKLAYER||l==na.BOTTOMASSEMBLY,u=Layer.getActiveLayer(),h=t.slice(2*n,2*n+1+1),f=h[0]+r,p=h[1]+i,g=ha.ifFind(f,p,"",u,"ALL");if(g&&g.type){f=Wa.formatLengthSave(g.X);p=Wa.formatLengthSave(g.Y)}var y,x=(t[3]-t[1])/(t[2]-t[0]),v=-1/x;if(!w(e,"measuring_type")){y=0===x||-1===x?"level":x===1/0||x===-1/0||isNaN(x)?"vertical":"straight";w(e,"measuring_type",y)}var m,L,_,b,S,C,M,N,P={x:f,y:p};if(2===n||3===n){m=p-v*f;L=v==1/0||v==-1/0?{x:f,y:0}:{x:0,y:m};_={x:t[0],y:t[1]};b={x:t[2],y:t[3]};S=Te(P,L,_,b);2===n?obj={fromP:{x:f,y:p},toP:{x:t[6],y:t[7]},A:S,B:{x:t[2],y:t[3]}}:3===n&&(obj={fromP:{x:t[4],y:t[5]},toP:{x:f,y:p},A:{x:t[0],y:t[1]},B:S})}else if(0===n||1===n){m=p-x*f;L=x==1/0||x==-1/0?{x:f,y:0}:{x:0,y:m};if(0===n){M=f-t[0];N=p-t[1];_={x:t[6],y:t[7]};m=_.y-v*_.x;b=v==1/0||v==-1/0?{x:_.x,y:0}:{x:0,y:m};C=Te(P,L,_,b);obj={fromP:{x:t[4]+M,y:t[5]+N},toP:{x:t[6],y:t[7]},A:{x:f,y:p},B:C}}else if(1===n){M=f-t[2];N=p-t[3];_={x:t[4],y:t[5]};m=_.y-v*_.x;b=v==1/0||v==-1/0?{x:_.x,y:0}:{x:0,y:m};C=Te(P,L,_,b);obj={fromP:{x:t[4],y:t[5]},toP:{x:t[6]+M,y:t[7]+N},A:C,B:{x:f,y:p}}}}var T=go.getMeasuringGuide(obj);w(e,{d:go.getDimensionPath({fromP:T.mainLineData.fromP,toP:T.mainLineData.toP,fontSize:o,precision:c,unit:s,mirror:d})+T.startLine+" "+T.endLine})}}},PROTRACTOR:{getAngle:function(e){var t=ho.PROTRACTOR.get(e),n=De(t[0],t[1],t[2],t[3]),r=De(t[0],t[1],t[4],t[5]),i=De(t[2],t[3],t[4],t[5]),a=(Math.pow(r,2)+Math.pow(n,2)-Math.pow(i,2))/(2*n*r);return(180*Math.acos(a)/Math.PI).toFixed(3)},get:function(e){var t=e.getPathData();return t.length<7?[]:t[0].values.concat(t[1].values,t[3].values,t[6].values)},setAngle:function(e,t){t%=360;t>180&&(t-=180);points=ho.get(e);var n=et({x:points[4],y:points[5]},{x:points[0],y:points[1]},{x:points[2],y:points[3]}),r=180*Math.atan((points[3]-points[1])/(points[2]-points[0]))/Math.PI,i=r>0;r=points[2]>points[0]?r:r>0?180-r:180+r;var a=t-ho.PROTRACTOR.getAngle(e);"顺时针"===n&&points[2]>points[0]&&(a*=-1);points[2]<points[0]&&i&&"逆时针"===n&&(a*=-1);points[2]<points[0]&&!i&&"顺时针"===n&&(a*=-1);var o=r+a;points[2]<points[0]&&i&&(o*=-1);var s=De(points[0],points[1],points[2],points[3]),c=Math.cos(o*Math.PI/180)*s,l=Math.sin(o*Math.PI/180)*s,d=points[0]+c,u=points[1]+l,h=d-points[2],f=u-points[3];ho.PROTRACTOR.set(e,points,1,h,f);Ar(ho.get(e))},set:function(e,t,n,r,i,a){var o;if(!(t.length<8)){var s=[t[0],t[1]],c=[t[2],t[3]],l=[t[4],t[5]],d=[],u=w(e,"c_fontsize"),h=w(e,"c_precision"),f=w(e,"layerid"),p=f==na.BOTTOMSILKLAYER||f==na.BOTTOMASSEMBLY;if(0===n){s[0]+=r;s[1]+=i}else if(1===n){c[0]+=r;c[1]+=i}else if(2===n){l[0]+=r;l[1]+=i}else{if(3!==n)return;d[0]=t[6]+r;d[1]=t[7]+i}o=go.getProtractorPath(s,c,l,{fontPoint:d,fontSize:u,canAdjustLineLength:!0,precision:h,mirror:p});o&&w(e,"d",o)}}},FOOTPRINT:{get:function(e){if("part_annotation"===w(e,"c_partid"))return[];var t=w(e,"id"),n=w(e,"c_origin"),r=w(e,"layerid"),i=w(e,"c_rotation"),a=n.split(","),o=+a[0],s=+a[1];if(0===o&&0===s){var c=Wa.svg.getBBox(e);o=c.x;s=c.y}null==i&&(i=0);w(e,"start_rotate")||w(e,"start_rotate",i);var l={};if(j(Ka,t)){if((o!==Ka[t].co.x||s!==Ka[t].co.y||Ka[t].layer!==r)&&!Qa.on){lo.g(e,parseFloat(i).toFixed(2));l=Wa.svg.getPlainBBox(e);d=0;e.childNodes.forEach(function(e){"part_pad"===w(e,"c_partid")&&[na.TOPLAYER,na.BOTTOMLAYER].includes(+w(e,"layerid"))&&e.childNodes.forEach(function(e){"TRACK"===de(e)&&(d=+w(e,"stroke-width")/2)})});l.x-=d;l.width+=2*d;Ka[t]=l;Ka[t].co={x:o,y:s};Ka[t].layer=r;lo.g(e,360-parseFloat(i).toFixed(2))}l=Ka[t]}else{lo.g(e,parseFloat(i).toFixed(2));l=Wa.svg.getPlainBBox(e);var d=0;e.childNodes.forEach(function(e){"part_pad"===w(e,"c_partid")&&[na.TOPLAYER,na.BOTTOMLAYER].includes(+w(e,"layerid"))&&e.childNodes.forEach(function(e){"TRACK"===de(e)&&(d=+w(e,"stroke-width")/2)})});l.x-=d;l.width+=2*d;Ka[t]=l;Ka[t].co={x:o,y:s};Ka[t].layer=r;lo.g(e,360-parseFloat(i).toFixed(2))}var u={dots1:[l.x-.5,l.y-.5],centP1:[o,l.y+.5],dots2:[l.x+l.width+.5,l.y-.5],centP2:[l.x+l.width+.5,s],dots3:[l.x-.5,l.y+l.height+.5],centP3:[o,l.y+l.height+.5],dots4:[l.x+l.width+.5,l.y+l.height+.5],centP4:[l.x-.5,s]};if(s<l.y){u.dots1=[l.x-.5,s];u.dots2=[l.x+l.width+.5,s]}var h=[o,l.y-5],f=[o,s],p=He(h,f,i),g=He(u.dots1,f,parseFloat(i).toFixed(2)),y=He(u.dots2,f,parseFloat(i).toFixed(2)),x=He(u.dots3,f,parseFloat(i).toFixed(2)),v=He(u.dots4,f,parseFloat(i).toFixed(2)),m=He(u.centP1,f,parseFloat(i).toFixed(2)),L=He(u.centP2,f,parseFloat(i).toFixed(2)),_=He(u.centP3,f,parseFloat(i).toFixed(2)),b=He(u.centP4,f,parseFloat(i).toFixed(2)),S=[p[0],p[1],o,s,g[0],g[1],m[0],m[1],y[0],y[1],L[0],L[1],x[0],x[1],_[0],_[1],v[0],v[1],b[0],b[1]];S.c_helper_lines=[{from:0,to:7},{from:2,to:4},{from:4,to:8},{from:8,to:6},{from:6,to:2},{from:3,to:7},{from:5,to:9}];S.visible_dots=[0,1,2,3,4,5,6,7,8,9];S.isRotate=!0;return S},set:function(e,t,n,r,i){if(0===n){w(Lo.children[0],{visibility:"hidden"});var a=w(e,"c_rotation")||0,o=w(e,"start_rotate"),s=[];w(e,"c_origin").split(",").forEach(function(e,t){s[t]=+e});var c=w(e,"id"),l=0,d=t[0]+r,u=t[1]+i,h=d-t[2],f=u-t[3],p=Math.sqrt(Math.pow(h,2)+Math.pow(f,2)),g=h/p,y=Math.acos(g),x=180/(Math.PI/y);f>0&&(x=360-x);var m;l=360-(90-x);l=Wa.toFixed(l,0);if(isNaN(l))return"";var L;if(Ua.getCacheObj("trackFollow")){if(j(Ka[c],"followingInfo")&&Ka[c].followingInfo.followingWires.length)L=Ka[c].followingInfo;else{L=so.calFollowing([e]);Ka[c].followingInfo=L}if(L.followingWires.length>0){var _=JSON.parse(JSON.stringify(L));_.followingWires.length=1;for(n=0;n<L.followingWires.length;n++){_.followingWires[0]=L.followingWires[n];var b=v(_.followingWires[0][0]),S={};b&&(S[_.followingWires[0][0]]=go.calcTrack(b));var C=[_.followingWires[0][2].x,_.followingWires[0][2].y],M=ze(C,s,360-(parseFloat(a).toFixed(3)-parseFloat(o).toFixed(3))),N=M[0]-C[0],P=M[1]-C[1];so.moveFollowing(_,N,P,S)}}}m=Ue(360-(parseFloat(l).toFixed(3)-parseFloat(a).toFixed(3)));lo.g(e,m)}else{s=w(e,"c_origin");var T=s.split(",");Tn(e,Number(T[0])+r,Number(T[1])+i)}}},alwaysNotSnap:function(e,t){var n=ho.getHelperType(e);return n&&(("arc1"==n||"pie1"==n)&&(2==t||3==t)||"arc2"==n&&2==t)},getHelperType:function(e){var t=w(e,"c_helper_type");if(t)return t;if("path"==e.tagName){var n=e.pathSegList,r=n.numberOfItems;if(2==r&&"A"==n.getItem(1).pathSegTypeAsLetter)return wo==ia.PCB||wo==ia.PCBLIB?"arc2":"arc1";if(4==r&&"L"==n.getItem(1).pathSegTypeAsLetter&&"A"==n.getItem(2).pathSegTypeAsLetter)return"pie1"}return""}},fo={_PCBSnapStack:[.2,.25,.5,1,1.25,2.5,5,10],altKeyEnabled:!1,getSanpSize:function(e){return fo.altKeyEnabled?+ba.adsorbGrid.altSnapSize||1:+ba.adsorbGrid["distance"+e]||1},getPCBSnapSizeList:function(){var e=ba.canvas.unit,t="";fo._PCBSnapStack.forEach(function(n){t+='<option value="'+Wa.toFixed(Wa.units.convert(n,"pixel",e),Wa.units.decimals[e])+'">'});return t}},po=function(){function e(){if(!r){r=!0;t=v("gControlLocks");n=t&&L("g",t);var e=function(){};for(var o in i)j(i,o)&&(a[o]=n||"function"!=typeof i[o]?i[o]:e);n&&t.addEventListener("click",function(e){var t=e.target.parentNode.id,n=t&&v(t.replace("lock",""));n&&i.unlockObjs([n])},!1)}}var t,n,r,i={attName:"locked",init:e,isLocked:function(e){return"1"===w(e,"locked")},updateOne:function(e){e&&Ji.contains(e)&&i.isLocked(e)?i.lockObjs([e]):i.unlockObjs([e])},updateMore:function(e){for(var t=0;t<e.length;t++)e[t]&&i.updateOne(e[t])},createLockUi:function(e){!e||e.length},lockObjs:function(e){po.setLockStatus(e,!0)},unlockObjs:function(e,t){po.setLockStatus(e,!1,t)},setLockStatus:function(e,n,r){if(1===arguments.length){n=e;e=void 0}var a=e||Zt();if(a&&a.length){var o=n?1:"",s=[].map.call(a,function(e){if(w(e,"locked")!=o)return e.id}).join(",");_e(wo)&&(a=filterHilightSeginSelected(a));la.select(a);w(a,"locked",o);ha.updateMore(a,{notCopper:!0,noRebuildPlane:!0});if(o)i.createLockUi(a);else for(var c=0;c<a.length;c++){var l=v("lock"+a[c].id,t);l&&t.removeChild(l)}r&&r.noHistory||La.save(["attr",s,{locked:n?"":"1"},{locked:o}])}},resize:function(){for(var e=m('g:not([display="none"])',t),n=20/Za,r=0;r<e.length;r++){var i=L("rect",e[r]),a={x:+w(i,"x"),y:+w(i,"y"),width:+w(i,"width"),height:+w(i,"height")};w(L("use",e[r]),{x:a.width>n?a.x:a.x+(a.width-n)/2,y:a.y-n,width:n,height:n})}}},a={};for(var o in i)j(i,o)&&("function"==typeof i[o]?a[o]=function(t,a){return function(){r||e();return n?a.apply(i,arguments):void 0}}(0,i[o]):a[o]=i[o]);return a}();!function(){function e(n){this.ready=0;this.start=0;if(n)for(var r in n)j(n,r)&&(this[r]=n[r]);e.instance=this;t.addEventListener("mousedown",this.mdown,!1)}e.prototype={mdown:function(n){var r=e.instance;n.button==Zi&&n.preventDefault();if((n.button===ea||n.button===Zi)&&!(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey)&&n.target!=t.documentElement&&fa.contains(n.target)&&!r.ready){(wo==ia.PCB||wo==ia.PCBMODULE)&&ja.showAll();var i=n.clientX,a=n.clientY;r.lastX=i;r.lastY=a;r.ready=1;r.start=0;r.helperCursorBefore=ma;bn("grabbing");t.addEventListener("mousemove",r.mmove,!1);t.addEventListener("mouseup",r.mup,!1);t.addEventListener("contextmenu",r.contextmenu,!1)}},contextmenu:function(t){var n=e.instance;n.ready&&!t.defaultPrevented&&n.mupRight(t)},timer:null,doDrag:function(e,t,n){var r=this;if(r.timer)if(r.waitDrag){r.waitDrag.x+=e;r.waitDrag.y+=t}else r.waitDrag={x:e,y:t};else r.timer=setTimeout(function(){if(r.waitDrag){r.ondrag({dx:e+r.waitDrag.x,dy:t+r.waitDrag.y,originalEvent:n});r.waitDrag=null}else r.ondrag({dx:e,dy:t,originalEvent:n});r.timer=null},30)},mmove:function(t){var n=e.instance;if(n.ready&&(!t.buttons||6&t.buttons)){var r=t.clientX,i=t.clientY,a=r-n.lastX,o=i-n.lastY;if(!n.start){if(a*a+o*o<=36)return}n.lastX=r;n.lastY=i;if(!n.start){wa.dragpanning=!0;n.start=1;n.rootcursor=b(fa,"cursor-none");n.ondragstart&&n.ondragstart({dx:a,dy:o,originalEvent:t})}n.ondrag&&n.doDrag(a,o,t)}},mup:function(t){var n=e.instance;t.button!==ea&&t.button!==Zi||n.mupRight(t)},mupRight:function(n){var r=e.instance;if(r.ready){t.removeEventListener("mousemove",r.mmove,!1);t.removeEventListener("mouseup",r.mup,!1);t.removeEventListener("contextmenu",r.contextmenu,!1);var i=r.start;r.ready=0;r.start=0;if("grabbing"==ma){var a=r.helperCursorBefore;a?r.rootcursor?bn(a,!0):bn(a):bn()}i&&r.ondragend&&r.ondragend({originalEvent:n})}}};ka=function(){Oa=new e({ondrag:function(e){var t=e.dx,n=e.dy,r=So.getViewBox();r[0]-=t/Za;r[1]-=n/Za;So.setViewBox(r)},ondragend:function(e){wa.dragpanning=!0;setTimeout(function(){wa.dragpanning=!1},5)}})}}();var go={checkNCFlagInBridgeWire:function(e,t){var n,r,i,a,o=ha.gJsonCache.wire,s=ha.ifFind(e,t);if(3!==s.type)return!1;r=o[s.wireId];i=r.pointArr.length-1;e===r.pointArr[0].x&&t===r.pointArr[0].y&&(a=r.pointArr[i]);e===r.pointArr[i].x&&t===r.pointArr[i].y&&(a=r.pointArr[0]);if(!a)return!1;n=ha.ifFind(a.x,a.y);return 1===n.type},makePArrFromStr:function(e){for(var t=[],n=e.replace(/[\s,]+/g,","),r=n.split(","),i=r.length,a=0;a<i-1;a++){var o=new x(r[a],r[a+1]);t.push(o)}return t},distancePointToPoint:function(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},ptOnLine:function(e,t,n){var r=Math.min,i=Math.max;return r(t.x,n.x)<=e.x&&e.x<=i(t.x,n.x)&&r(t.y,n.y)<=e.y&&e.y<=i(t.y,n.y)&&(e.x-t.x)*(n.y-t.y)==(n.x-t.x)*(e.y-t.y)},ptOnPolyline:function(e,t){if(!t||!t.length)return!1;for(var n=t.length,r=0;r<n-1;r++)if(go.ptOnLine(e,t[r],t[r+1]))return!0;return!1},getWireByXY:function(e,t){for(var n,r=m(".shapeBox > polyline[c_etype=wire]",Ji),i=r.length,a=0;a<i;a+=1){n={x:e,y:t};if(go.isPointOnPolyline(n,r[a]))return r[a]}return!1},getPinByXY:function(e,t){var n,r,i,a,o=ha.gJsonCache.schlib,s=Object.keys(o||{}),c=s.length;for(r=0;r<c;r+=1){a=o[s[r]];n=Object.keys(a.pin||{});for(i=0;i<n.length;i+=1)if(e===a.pin[n[i]].pinDot.x&&t===a.pin[n[i]].pinDot.y)return{schlib:a,pin:a.pin[n[i]].pinDot}}return!1},getNoConnectFlagByXY:function(e,t){var n,r,i=ha.gJsonCache.noconnectflag||{},a=Object.keys(i),o=a.length;for(n=0;n<o;n+=1){r=i[a[n]];if(+r.x===e&&+r.y===t)return r}return!1},getLengthOfTrackAndArc:function(e,t){if(!e||!e.d&&!e.pointArr)return 0;for(var n=e.d?convertArcToTrackPoints(e,!1):e.pointArr,r=0,i=0,a=n.length-1;i<a;i++)r+=go.distancePointToPoint(n[i],n[i+1]);t&&(r=Wa.units.convert(r,"pixel",ba.canvas.unit));return Wa.formatLengthSave(r)},isPointOnPolyline:function(e,t){var n=t.getBBox(),r=e.x,i=e.y;if(r<n.x||r>n.x+n.width||i<n.y||i>n.y+n.height)return!1;var a=t.points;if(r==a.getItem(0).x&&i==a.getItem(0).y)return!0;for(var o=1,s=a.length||a.numberOfItems;o<s;o++)if(go.ptOnLine(e,a.getItem(o-1),a.getItem(o)))return!0;return!1},formatWirePoints:function(e,t,n,r,i){function a(e,t){return Math.abs(e-t)}n=+n;r=+r;if(0===t)return e.join(" ")+" "+n+" "+r;var o=e.length;if(!(o<2)){for(var s=0;s<o;s++)e[s]=+e[s];var c=new x(n,r),l=new x(e[o-2],e[o-1]),d=new x(0,0),u=a(c.x,l.x),h=a(c.y,l.y);if(90===t){if(u&&h){var f=i.points.numberOfItems-o/2,p=De(l.x,l.y,n,r),g=!0;if(p<30/Za)g=u>h;else if(f<=0)g=u>h;else if(f>0){var y=i.points.getItem(o/2);g=y.y==l.y}}else g=!h;if(u&&h){if(g){d.x=c.x;d.y=l.y}else{d.x=l.x;d.y=c.y}return e.concat([d.x,d.y,n,r]).join(" ")}return e.join(" ")+" "+n+" "+r}if(u>h){var v=a(c.y,l.y);d.y=l.y;c.x>l.x?d.x=c.x-v:d.x=c.x+v;return e.concat([d.x,d.y,n,r]).join(" ")}if(u<h){var m=a(c.x,l.x);d.x=l.x
;c.y>l.y?d.y=c.y-m:d.y=c.y+m;return e.concat([d.x,d.y,n,r]).join(" ")}return e.join(" ")+" "+n+" "+r}},simplifyWire:function(e){var t,n,r=z(w(e,"points")),i=ha.getWires();e.getBBox();for(var a in i)if(j(i,a)&&a!=e.id&&v(a)){var o=i[a],s=[],c=r[0],l=r[r.length-1],d=go.ptOnPolyline(c,o),u=go.ptOnPolyline(l,o);if(!d&&!u)continue;if(o.length<2)continue;if(d&&u)return{status:"invalidWire"};d&&(r=r.reverse());if(r.length>2)for(t=1,n=r.length-1;t<n;t++)go.ptOnPolyline(r[t],o)&&s.push(r[t]);for(t=0,n=o.length;t<n;t++)go.ptOnPolyline(o[t],r)&&s.push(o[t]);var h=!1;if(s.length>0){var f=[],p=0,g=s.length;for(t=0,n=r.length;t<n-1;t++){h=!1;f.push(r[t]);for(p=0;p<g;p++)if(go.ptOnLine(s[p],r[t],r[t+1])){h=!0;break}if(h){f.push(s[p]);break}}r=f}var y=go.isPointEqual(r[r.length-1],o[0])&&!ha.hasJunctionAtXY(o[0].x,o[0].y),x=go.isPointEqual(r[r.length-1],o[o.length-1])&&!ha.hasJunctionAtXY(o[o.length-1].x,o[o.length-1].y);if(h&&(y||x)){x&&o.reverse();r.pop();r=r.concat(o);var m=v(a).cloneNode(!0);w(v(a),"points",H(r));return{status:"merge",wireId:a,oldNode:m}}}w(e,"points",H(r));return{status:"add"}},isPointEqual:function(e,t){return e.x==t.x&&e.y==t.y},approximateDistancesPoint2Point:function(e,t){return Be(e.x,e.y,t.x,t.y)},distancesPoint2Point:function(e,t){return Math.sqrt(this.approximateDistancesPoint2Point(e,t))}};tn.unSelectShadowNode=function(){var e,t=m(".shadow-node");for(e=0;e<t.length;e+=1){la.unselect(t[e]);la.unhighlight(t[e])}};Dn.data={clientX:null,clientY:null,lastUpX:null,lastUpY:null,uplock:!1,currAbsX:null,currAbsY:null};t.addEventListener("click",function(e){pn("triggerClick",[e])},!1);ha.checkJsonCache=function(e){if(!Pa||parent.IS_PRIVATE)return!0;if(Co.target&&"draw(track)"===va||Qa.pasting)return!0;if("convertToPCB"==pn("getOrSetGVarsValueByKey",["cmdToken"]))return!0;var t=ha.gJsonCache;if([ia.SCH,ia.PCBLIB,ia.PCB,ia.PCBMODULE].indexOf(wo)<0)return!0;var n,r,i,a,o,s=m(ha.check_selector),c=ha.check_cmdKeys,l="";r=Ce(t,c);i=r.length-s.length;if(i>0){l="Jsoncache more than dom";a=!0}else if(i<0){l="Jsoncache less than dom";o=!0}else{n=Se(s);for(var d=0;d<n.length;d++)if(r.indexOf(n[d])<0){l="Jsoncache mismatches dom";o=!0;break}}if(l){!function(t){function n(e){var t;if("string"==typeof e[1]&&e[1].match(/^gge/)){var n;n="add"===e[0]?v(e[1]):"del"===e[0]?L("#"+e[1],qa):v(e[1]);t=e[1]+"("+de(n)+")"}o+=e[0]+s+t+s;if(e[2])if("object"==typeof e[2])if(e[2].tagName){i=Wt("g");i.appendChild(y(e[2]));o+=i.innerHTML+s}else o+=JSON.stringify(e[2])+s;else o+=e[2]+s;if(e[3])if("object"==typeof e[3])if(e[3].tagName){i=Wt("g");i.appendChild(y(e[3]));o+=i.innerHTML+s}else o+=JSON.stringify(e[3])+s;else o+=e[3]+s;o+=r(2)}function r(e){for(var t="",n=0;n<e;n++)t+="\n";return t}pn("submitCheckJsonCacheError",[t]);var i,a=La.records,o="Time: "+ve(new Date)+r(1),s="    ";o+=t.type+":"+r(2);o+=t.detail+r(2);o+=r(3)+"历史记录："+r(2);a.forEach(function(e){W(e[0])?e.forEach(function(e){n(e)}):n(e)});e||pn("bugRecord",[o]);ha.calAll({notCopper:!0,noRebuildPlane:!0})}({type:l,detail:a||o});return!1}return!a&&!o};var yo=function(){function e(){for(var o=Date.now();n.length&&Date.now()-o<100;)n.shift()();if(t){var s=n.length&&i?1-n.length/i:1;t(s)}if(n.length)setTimeout(e,0);else{r="idle";a&&a()}}var t,n=[],r="idle",i=0,a=null;return{addTask:function(e,t){t?n.unshift(e):n.push(e);return yo},run:function(){if("idle"==r){r="running";i=n.length;e()}},onFinish:function(e){a=e},onProgress:function(e){t=e}}}(),xo={getSheetInfo:function(e){if(!e){e=pa&&pa.id.match(/^frame_lib_/)&&pa;e||(e=la.get().filter(function(e){return e.id.match(/^frame_lib_/)})[0]);e||(e=L(".shapeBox > g[id^=frame_lib_]"))}if(e&&e.id.match(/^frame_lib_/)){var t=L("rect[c_etype=frame_outbox]",e),n=xo.getSheetText(e)||{};return Wa.extend(n,{id:e.id,width:+w(t,"width")+20,height:+w(t,"height")+20})}},setSheetInfo:function(e){if(e.width&&e.height){var t={},r=xo.getSheetText("LAST");r=Wa.extend({},t,r);e.title&&(r.title=e.title);e.drawn&&(r.drawn=e.drawn);xo.updateSheetText(v("part(lib_sheet)"),r);xo.setSheetSize(v("part(lib_sheet)"),e);n("changeLogo");"place"===e.op&&sr("place_part(lib_sheet)");return{options:e,info:r,elem:y(v("part(lib_sheet)"),!0),docType:ia.SCHLIB}}},updateSheetText:function(e,t){var n=e.nodeType?e:v(e);if(n)for(var r in t)if(j(t,r)){var i=t[r];switch(r){case"date":i&&"?"!=i||(i=Wa.formatDate(new Date,"yyyy-MM-dd"));break;case"product":i="EASYEDA V"+Wi}i&&"?"!=i&&function(e,t){for(var r='g[c_etype="frame_?"] text, text[c_etype="frame_?"]'.replace(/\?/g,e),i=m(r,n),a=0;a<i.length;a++)Nt(i[a],t||"?")}(r,i)}},getSheetText:function(e){if("FIRST"==e){e=L('.shapeBox > g[id^="frame_lib_"]');e||(e=v("part(lib_sheet)"))}else if("LAST"==e){e=m('.shapeBox > g[id^="frame_lib_"]');e.length&&(e=e[e.length-1]);e||(e=v("part(lib_sheet)"))}var t=e.nodeType?e:v(e);if(t){for(var n,r,i="%1 g%2 text, %1 text%2".replace(/%1/g,t.id?"#"+t.id:"").replace(/%2/g,'[c_etype^="frame_"]:not([c_etype="frame_tick"])'),a=m(i,t),o={},s=/^frame_(.+)/,c=0;c<a.length;c++)for(var l=a[c];l!=t;){r=w(l.parentNode,"c_etype")||w(l,"c_etype");n=r.match(s);if(n){o[n[1]]=Pt(a[c]);break}l=l.parentNode}return o}},setSheetSize:function(e,t){var n,r,i,a,o,s,c={A4:{w:1169,h:826},A3:{w:1652,h:1169},A2:{w:2338,h:1652},A1:{w:3304,h:2338},A0:{w:4676,h:3304},A:{w:1100,h:850},B:{w:1700,h:1100},C:{w:2200,h:1700},D:{w:3400,h:2200},E:{w:4400,h:3400},USLetter:{w:1100,h:850},USLegal:{w:1400,h:850},USLedger:{w:1700,h:1100}},l={stroke:"#880000","stroke-width":1,fill:"none"},d={type:"comment",fill:"#880000","font-family":"Verdana","font-size":"7pt","text-anchor":"start"},u=function(){var e=Wt("g",{id:"gge?",c_etype:"frame_tick",c_origin:"0,0",c_partid:"part_annotation"});e.appendChild(Wt("text",Wa.extend(d,{x:0,y:0})));return function(t,n,r){var i=e.cloneNode(!0);Nt(i.children[0],t,"\\n");w(i,"c_origin",n+","+r);w(i.children[0],{x:n,y:r});return i}}(),h=function(t){return e.insertBefore(t,p)};if(t.width&&t.height){r=t.width;i=t.height}else if(t.size){n=c[t.size]||{};r=n.w;i=n.h}if(r&&i){a=t.orientation||(r>=i?"L":"P");r<i!=("P"==a)&&(r=[i,i=r][0]);r-=20;i-=20;var f=L("[c_etype=frame_outbox]",e),p=L("[c_etype=frame_innerbox]",e);if(f&&p){var g=P(f);o=+g.x+(g.width-r);s=+g.y+(g.height-i);var y={x:o,y:s,width:r,height:i},x={x:o+10,y:s+10,width:r-20,height:i-20};w(f,y);w(p,x);w(e,"c_origin",o+","+s);var v,_,b,S,C,N,T=[],O=x.x,k=x.y,A=Math.floor(x.width/196),E=Math.floor(x.height/196),I=m("[c_etype=frame_tick]",e);for(_=0;_<I.length;_++)M(I[_]);for(_=1,b=O;_<=A;_++){b+=196;T.push(["M",b,k,"L",b,k-10].join(" "));T.push(["M",b,k+x.height,"L",b,k+x.height+10].join(" "))}for(_=1,S=k;_<=E;_++){S+=196;T.push(["M",O,S,"L",O-10,S].join(" "));T.push(["M",O+x.width,S,"L",O+x.width+10,S].join(" "))}C=T.join("").replace(/\s*([a-z])\s*/gi,"$1");v=Wt("path",{id:"gge?",c_etype:"frame_tick",d:C});w(v,l);h(v);for(_=1;_<=E;_++){S=x.y+196*(_-.5);N=function(e){if(e<1)return"";var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ";if(e<=26)return t[e-1];for(var n="",r=1,i=26;(e-=r)>=0;r=i,i*=26)n=t[e%i/r|0]+n;return n}(_);h(u(N,x.x-10+1.5,S));h(u(N,x.x+x.width+1.5,S))}for(_=1;_<=A;_++){b=x.x+196*(_-.5);N=_+"";h(u(N,b,x.y-1.5));h(u(N,b,x.y+x.height+10-1.5))}Rt(e);w(L(".hitbox",e),{x:o,y:s,width:0,height:0});co.move(e,g.x-w(f,"x"),g.y-w(f,"y"))}}},setSheetAttr:function(e,t){var n=L("rect[c_etype=frame_outbox]",e),r=+w(n,"width")+20,i=+w(n,"height")+20,a=r>=i?"L":"P";if(t["attr-sheet-size-template"]){a=t["attr-sheet-orientation"]||a;xo.setSheetSize(e,{size:t["attr-sheet-size-template"],orientation:a})}else if(t["attr-sheet-orientation"]){r=+t["attr-width"]||r;i=+t["attr-height"]||i;xo.setSheetSize(e,{width:r,height:i,orientation:t["attr-sheet-orientation"]})}else if(t["attr-width"]){r=+t["attr-width"];i=+t["attr-height"]||i;xo.setSheetSize(e,{width:r,height:i})}else if(t["attr-height"]){r=+t["attr-width"]||r;i=+t["attr-height"];xo.setSheetSize(e,{width:r,height:i})}"attr-sheet-x"in t&&co.move(e,t["attr-sheet-x"]-w(n,"x"),0);"attr-sheet-y"in t&&co.move(e,0,t["attr-sheet-y"]-w(n,"y"));if(t["attr-color"]){w(m("rect,polyline,path",e),"stroke",t["attr-color"]);w(m("g[c_etype=frame_tick]>text, g[c_etype=frame_product]>text, g:not([c_etype=frame_])>text",e),"fill",t["attr-color"])}},getSheetAttr:function(e){var t=L("rect[c_etype=frame_outbox]",e),n=+w(t,"width")+20,r=+w(t,"height")+20,i={};i["attr-sheet-size-template"]="";i["attr-sheet-orientation"]=n>=r?"L":"P";i["attr-width"]=n;i["attr-height"]=r;i["attr-color"]=w(t,"stroke")||"#880000";i["attr-sheet-x"]=+w(t,"x");i["attr-sheet-y"]=+w(t,"y");return i},isFrameTick:function(e){"text"===de(e)&&(e=e.parentNode);return e&&e.id&&"frame_tick"==w(e,"c_etype")&&e.parentNode&&"schlib"===de(e.parentNode)},size2Frame:function(e,t){for(var n in ta)if(j(ta,n)&&ta[n].W==e&&ta[n].H==t)return n;return"none"}},Ji=v("g1"),vo=v("selectBox1"),mo=v("gControlDots"),Lo=v("gRotateHelper"),_o=v("gControlRects"),bo=v("gControlLines");v("gCopperAreaOutlineCushions"),v("gPanelizedOutlines"),v("gPanelizedOutlinesOverG1");ti.prototype={mdown:function(e){var n=Aa,r=pa,i=e.originalTarget||e.target||e.srcElement;if(e.button===qi&&r&&"cdot"==w(i,"c_shapetype")&&!po.isLocked(r)){var a=ln(e,!1);fa.style.cursor="move";n.ready=!0;n.start=!1;n.target=r;n.x0=a.x;n.y0=a.y;n.dotIndex=+w(i,"id").substr(4);n.targetX0=+w(i,"cx");n.targetY0=+w(i,"cy");n.movedX=0;n.movedY=0;n.alwaysNotSnap=ho.alwaysNotSnap(r,n.dotIndex);n.unitSnap=!0;var o=de(r);n.unitSnap="wire"==o||"bus"==o;n.effectD0=ho.get(r);n.pathD0=w(r,"d")||void 0;n.attrs=P(r);t.addEventListener("mousemove",n.mmove,!1);t.addEventListener("mouseup",n.mup,!1)}},mmove:function(e){var t,n,r,i,a,o,s,c,l=Aa,d=l.target;if(d&&l.ready){fo.altKeyEnabled=e.altKey;var u=ln(e,!1);t=u.x-l.x0;n=u.y-l.y0;if(l.start||!((t*t+n*n)*Za*Za<9)){if(ba.adsorbGrid.enabled&&!l.alwaysNotSnap){r={x:t+l.targetX0,y:n+l.targetY0};i=_t(r);var h,f=w(d,"c_etype");if("wire"==f){h=ha.ifFind(t+l.targetX0,n+l.targetY0);h&&h.type&&(h.wireId&&h.wireId==d.id||Be(r.x,r.y,h.X,h.Y)<=Be(r.x,r.y,i.x,i.y)&&(i={x:h.X,y:h.Y}))}a=i.x-l.targetX0;o=i.y-l.targetY0}else{a=t;o=n}if(l.unitSnap)if("path"!=d.tagName){a=Math.round(a+l.targetX0)-l.targetX0;o=Math.round(o+l.targetY0)-l.targetY0}else{a=(a+l.targetX0).toFixed(2)-l.targetX0;o=(o+l.targetY0).toFixed(2)-l.targetY0}s=a-l.movedX;c=o-l.movedY;if(s||c){l.movedX=a;l.movedY=o;if(!l.start){l.start=!0;l.ondragstart&&l.ondragstart()}ho.set(d,l.effectD0,l.dotIndex,l.movedX,l.movedY,l.pathD0);vn(d);l.ondrag&&l.ondrag()}}}},mup:function(e){var n=Aa;if(e.button===qi&&n.ready){t.removeEventListener("mousemove",n.mmove,!1);t.removeEventListener("mouseup",n.mup,!1);n.ready=!1;fa.style.cursor="";if(n.start){n.start=!1;n.ondragend&&n.ondragend()}}}};ni.prototype={mdown:function(e){var n;if(va)return!1;if(!Qa.on&&e.button===qi&&!e.ctrlKey&&!e.metaKey){var r=e.target;if(r!=t.documentElement&&!/^(input|textarea|button|a)/i.test(r.tagName||"")&&"cdot"!=w(r,"c_shapetype")){if(Ea.stopMove(e))return!1;3==r.nodeType&&(r=r.parentNode);"tspan"==r.tagName&&(r=r.parentNode);var i=gr(r),a=i;!a&&Xa&&(a=Xa.target);if(a){for(;a&&!b(a.parentNode,$a);)a=a.parentNode;var o=w(a,"c_shapetype");if("group"==o||"line"==o){var s=Ea,c=ln(e,!1);s.ready=!0;s.start=!1;s.target=a;s.evtTarget=r;s.selectedObjs=Zt().filter(function(e){return!po.isLocked(e)});n=so.addBusEntry(s.selectedObjs);s.selectedObjs=s.selectedObjs.concat(n);s.x0=c.x;s.y0=c.y;s.lastX=s.x0;s.lastY=s.y0;s.lastDX=0;s.lastDY=0;s.movedX=0;s.movedY=0;delete s.oldAttrs;if(!s.onready||!1!==s.onready()){s.autoLine();s.atPartText="group"==o&&"text"==r.tagName&&"part_pin"==w(a,"c_partid");s.atPartNoteText="group"==o&&Rr(r);if(!s.atPartText&&!s.atPartNoteText||!po.isLocked(i.parentNode)){fa.style.cursor="move";s.snapped=ba.adsorbGrid.enabled;s.unitSnap=!0;"part_annotation"===w(r.parentNode,"c_partid")?s.refPoint=Fn([r.parentNode]):s.refPoint=Lt(s.selectedObjs);t.addEventListener("mousemove",s.mmove,!1);t.addEventListener("mouseup",s.mup,!1)}}}}}}},autoLine:function(){var e=Ea;e.addWire=[];var t=["schlib","busentry","netlabel","netflag"];!function(){function n(n,r){function a(t,n){if(t.x==n.x&&t.y==n.y){u=Wt("polyline",{points:t.x+" "+t.y+" "+t.x+" "+t.y,"stroke-width":1,stroke:ba.colors.wire||"#008800",fill:"none",c_shapetype:"line",c_etype:"wire"});d=Rt(u);e.addWire.push(d);Ji.appendChild(u);ha.updateOne(u)}}for(var o in ha.gJsonCache)if(j(ha.gJsonCache,o)&&-1!==t.indexOf(o))for(i in ha.gJsonCache[o])if(i!==r&&j(ha.gJsonCache[o],i)&&!(e.selectedObjs.indexOf(v(i))>-1))if(o==t[0]){c=ha.gJsonCache[o][i].pin;for(s in c)if(j(c,s)){l=c[s].pinDot;a(n,l)}}else if(o==t[1]){c=ha.gJsonCache[o][i];a(n,{x:c.x1,y:c.y1});a(n,{x:c.x2,y:c.y2})}else{l=ha.gJsonCache[o][i].pinDot;a(n,l)}}var r,i,a,o,s,c,l,d,u;e.selectedObjs.forEach(function(e){var i,s,c=de(e);r=e.id;if(c===t[0]){i=ha.gJsonCache.schlib[r];if(i){s=i.pin;for(o in s)if(j(s,o)){a=s[o].pinDot;n(a,r)}}}else if(c===t[1]){i=ha.gJsonCache[c][r];n({x:i.x1,y:i.y1},r);n({x:i.x2,y:i.y2},r)}else if(c===t[2]||c===t[3]){i=ha.gJsonCache[c][r];if(i){a=i.pinDot;n(a,r)}}})}()},mmove:function(e){var t=Ea;if(t.ready){var n=t.target,r=t.selectedObjs.filter(function(e){return!po.isLocked(e)}),i=w(n,"c_shapetype");if(n&&("group"==i||"line"==i)){fo.altKeyEnabled=e.altKey;var a,o,s,c,l,d=ln(e,!1),u=d.x,h=d.y,f=u-t.x0,p=h-t.y0;if(!t.start){if((f*f+p*p)*Za*Za<9)return;t.start=!0;if(t.ondragstart){a=t.ondragstart();if(!1===a){t.ready=!1;t.start=!1;return!1}}}t.lastX=u;t.lastY=h;t.lastDX=f;t.lastDY=p;var g,y,x,v=n.getBBox(),m={x:v.x+v.width/2,y:v.y+v.height/2},L=(t.atPartNoteText||t.atPartText)&&1===r.length,_="schlib"===de(n)&&!L;if(_)for(var b=0;b<r.length;b++){var S=r[b].id;if(ha.gJsonCache.schlib[S]&&ha.gJsonCache.schlib[S].pin){var C=ha.gJsonCache.schlib[S].pin;for(var M in C){g=C[M].pinDot;if(g)break}}if(g)break}g||(g=t.refPoint);if(_&&1===r.length&&!t.dragCenter){if(w(r[0],"c_origin")){t.dragCenter=Wa.numberlistToArray(w(r[0],"c_origin"));t.dragCenter={x:t.dragCenter[0],y:t.dragCenter[1]}}else t.dragCenter={x:m.x,y:m.y}}if(t.snapped)if(e.shiftKey&&1===r.length&&_){y={x:g.x+u-t.dragCenter.x,y:g.y+h-t.dragCenter.y};x=_t(y);o=x.x-g.x;s=x.y-g.y}else if(g){y={x:g.x+f,y:g.y+p};x=_t(y);o=x.x-g.x;s=x.y-g.y}else{x=_t({x:f,y:p});o=x.x;s=x.y}else if(t.unitSnap)if(g){y={x:Math.round(g.x+f),y:Math.round(g.y+p)};o=y.x-g.x;s=y.y-g.y}else{o=Math.round(f);s=Math.round(p)}else{o=f;s=p}c=o-t.movedX;l=s-t.movedY;if(c||l){t.movedX=o;t.movedY=s;if((t.atPartNoteText||t.atPartText)&&1===r.length){if(po.isLocked(gr(t.evtTarget)))return;t.atPartText?co.move(t.evtTarget,c,l):co.move(t.evtTarget.parentNode,c,l);t.atPartText&&function(e){var t=e.children[0];t&&"circle"==t.tagName&&w(e,{c_origin:w(t,"cx")+","+w(t,"cy")})}(t.evtTarget.parentNode)}else Ct(r,c,l);t.ondrag&&t.ondrag()}}}},mup:function(e){if(e.button===qi){var n=Ea,r=n.selectedObjs;Mt(r);if(n.addWire.length){var i;n.addWire.forEach(function(e){i=v(e);if(i&&i.points&&2===i.points.numberOfItems&&i.points[0].x===i.points[1].x&&i.points[0].y===i.points[1].y){M(i);ha.removeOne(i)}})}t.removeEventListener("mousemove",n.mmove,!1);t.removeEventListener("mouseup",n.mup,!1);if(n.ready){n.ready=!1;n.dragCenter=null;fa.style.cursor="";if(n.start){n.start=!1;var a=n.evtTarget.parentNode;if((n.atPartNoteText||n.atPartText)&&1===r.length&&a!=n.target){en();pa=a;la.select(pa);var o=ki(pa);pn("noneselected");pn("show_attrpanel",[o])}n.ondragend&&n.ondragend()}}}},stopMove:function(e){var t,n=Zt();if(1===n.length&&!e.shiftKey){t=de(n[0]);if("wire"===t||"bus"===t)return!st(n[0])}return!1}};ri.prototype={mdown:function(e){if(e.button===qi&&!(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||"cdot"==w(e.target,"c_shapetype")||Xa)){var t,n=this;n.mouseIsDown=!0;if(!(n.strictMousedownTarget&&n.strictMousedownTarget!=e.target&&wo!=ia.WAVEFORM||n.mousedownTarget instanceof Function&&!0!==n.mousedownTarget(e,n))){if(n.onmousedown){t=n.onmousedown.call(n.mousedownTarget,e,n);if(!1===t)return!1}if(n.downcursor){n.oldDownCursor=n.mousedownTarget.style.cursor;n.mousedownTarget.style.cursor=n.downcursor}var r=ln(e,!1);n.ready=!0;n.x0=r.x;n.y0=r.y;n.dx=0;n.dy=0;n.x1=n.x0;n.y1=n.y0;if(n.onready){t=n.onready.call(n.mousedownTarget,e,n);if(!1===t){n.ready=!1;return!1}}n.mousedownTarget instanceof Function?fa.addEventListener("mousemove",n.e.mmove,!1):n.mousemoveTarget.addEventListener("mousemove",n.e.mmove,!1);n.mousedownTarget instanceof Function?fa.addEventListener("mouseup",n.e.mup,!1):n.mouseupTarget.addEventListener("mouseup",n.e.mup,!1);n.bind=!0}}},mmove:function(e){var t=this;if(t.mouseIsDown&&t.ready){var n,r=ln(e,!1),i=r.x,a=r.y,o=i-t.x0,s=a-t.y0;if(!t.start){if((o*o+s*s)*Za*Za<9)return;if(t.mousemoveTarget instanceof Function&&!0!==t.mousemoveTarget(e,t))return;if(t.ondragstart){n=t.ondragstart.call(t.mousedownTarget,e,t);if(!1===n){t.ready=!1;t.start=!1;return!1}}t.start=!0;if(t.cursor){t.oldMoveCursor=t.mousemoveTarget.style.cursor;t.mousemoveTarget.style.cursor=t.cursor}t.downcursor&&(t.mousedownTarget.style.cursor=t.oldDownCursor)}t.x1=i;t.y1=a;t.dx=o;t.dy=s;if(t.ondrag){if(t.mousemoveTarget instanceof Function&&!0!==t.mousemoveTarget(e,t))return;n=t.ondrag.call(t.mousedownTarget,e,t);if(!1===n){t.cursor&&(t.mousemoveTarget.style.cursor=t.oldMoveCursor);t.ready=!1;t.start=!1;return!1}}}},mup:function(e){var t=this;wo===ia.WAVEFORM&&(Ma.isDrawingSelectBox=!1);if(e.button===qi){t.endEvent=null;t.mouseIsDown=!1;if(t.bind){t.mousedownTarget instanceof Function?fa.removeEventListener("mousemove",t.e.mmove,!1):t.mousemoveTarget.removeEventListener("mousemove",t.e.mmove,!1);t.mousedownTarget instanceof Function?fa.removeEventListener("mouseup",t.e.mup,!1):t.mouseupTarget.removeEventListener("mouseup",t.e.mup,!1);t.bind=!1}if(t.ready&&t.start){t.ready=!1;t.start=!1;t.start&&t.downcursor&&(t.mousedownTarget.style.cursor=t.oldDownCursor);t.cursor&&(t.mousemoveTarget.style.cursor=t.oldMoveCursor);if(t.ondragend){t.ondragend.call(t.mousedownTarget,e,t);t.endEvent=e}}}},destroy:function(){var e=this;e.mousedownTarget instanceof Function?fa.removeEventListener("mousedown",e.e.mdown,!1):e.mousedownTarget.removeEventListener("mousedown",e.e.mdown,!1);if(e.bind){e.mousedownTarget instanceof Function?fa.removeEventListener("mousemove",e.e.mmove,!1):e.mousemoveTarget.removeEventListener("mousemove",e.e.mmove,!1);e.mousedownTarget instanceof Function?fa.removeEventListener("mouseup",e.e.mup,!1):e.mouseupTarget.removeEventListener("mouseup",e.e.mup,!1);e.bind=!1}}};gi.prototype={updateFollowingWires:function(e){var t,n=e||this.followingInfo.followingWireIds,r=Object.keys(n||{}),i=0;if(r.length)for(;i<r.length;i+=1){t=v(r[i]);yt(t);if(1===t.points.numberOfItems){w(t,"points",w(this.history.wire[i][2],"points"));ha.removeOne(t);M(t);qa.appendChild(t);this.history.wire[i]=["del",t.id,Wa.node.getRefId(t)]}else ha.updateOne(t)}},mdown:function(e){var n=e.button,r=Ba?e.metaKey:e.ctrlKey;if(n==qi&&!r&&!va){var i=e.target;if("polyline"!=i.tagName&&"polygon"!=i.tagName){if("cdot"==w(i,"c_shapetype"))return;if(!Xa||!Xa.target||"polyline"!=Xa.target.tagName&&"polygon"!=Xa.target.tagName)return;i=Xa.target}if(O(i)){i=v(w(i,"for"))}if(b(i.parentNode,$a)&&!(i.points.numberOfItems<2||po.isLocked(i))){var a,o=gi.instance,s=!1,c=Zt().filter(function(e){return!!e&&("part_pcbtext"===w(e,"c_partid")||b(e.parentNode,$a)||O(e))&&!po.isLocked(e)});if(wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE){if(e.button!==qi||e.shiftKey||o.ready||c.length>1||1===c.length&&"TRACK"===de(c[0])){if(e.shiftKey||1!==c.length)return;if(O(c[0])){if(st(v(w(c[0],"for"))))return}else if(st(c[0]))return}s=ba.adsorbGrid.enabled&&(wo==ia.PCB||wo==ia.PCBLIB)&&"TRACK"==de(i)}else{if(e.button!==qi||e.shiftKey||o.ready||c.length>1||1===c.length&&("wire"===de(c[0])||"bus"===de(c[0]))&&st(c[0]))return;a=Wa.fileType.getAbstractFileType(wo);if("sch"==a||"schlib"==a){cmd=de(i);if("wire"!==cmd&&"bus"!==cmd)return}s=ba.adsorbGrid.enabled}var l=gt({x:e.clientX,y:e.clientY}),d=vt(i),u=Oe(l,i,3);if(!(u<0||u%2==0)){var h=u>>1,f=d[h],p=d[h+1];o.target=i;o.startX=l.x;o.startY=l.y;o.A=f;o.B=p;o.ready=1;o.start=0;o.snap=s;o.pIndex=u;o.oldPoints=d;o.polylinePoints=w(i,"points");t.addEventListener("mousemove",o.mmove,!1);t.addEventListener("mouseup",o.mup,!1)}}}},mmove:function(e){var t=gi.instance,n=t.target;if(t.ready&&wo!==ia.WAVEFORM){var r=gt({x:e.clientX,y:e.clientY}),i=(vt(n),t.pIndex);if(!(i<0||i%2==0)){var a,o,s=t.startX,c=t.startY,l=(t.A,t.B,r.x),d=r.y;if(!(De(s,c,l,d)*Za<2)){la.select(n);pa=n;a=l-t.startX;o=d-t.startY;if(!t.start){if(De(s,c,l,d)*Za<2)return;t.start=1;t.ondragstart&&t.ondragstart({target:n,x0:t.startX,y0:t.startY,x1:l,y1:d,dx:a,dy:o,originalEvent:e})}t.ondrag&&t.ondrag({target:n,x0:t.startX,y0:t.startY,x1:l,y1:d,dx:a,dy:o,originalEvent:e})}}}},mup:function(e){if(e.button===qi){var n=gi.instance;if(n.ready){t.removeEventListener("mousemove",n.mmove,!1);t.removeEventListener("mouseup",n.mup,!1);var r=n.start;n.ready=0;n.start=0;r&&n.ondragend&&n.ondragend({target:n.target,originalEvent:e});n.oldPoints=null;n.target=null}}},mover:function(e){var t=e.target;if("polyline"==t.tagName&&t===pa){if(wo==ia.PCB||wo==ia.PCBLIB){if(e.shiftKey||e.altKey||e.ctrlKey||e.metaKey){bn();return}}else if(!e.shiftKey){bn();return}var n=gt({x:e.clientX,y:e.clientY}),r=Oe(n,t,9);(r>0||r%2!=0)&&yi(t,r)}},mout:function(e){var t=e.target;"polyline"==t.tagName&&t===pa&&bn()},dblclick:function(e){var t=e.target;if("polyline"==t.tagName&&t===pa){var n=w(t,"points"),r=w(t,"layerid"),i=de(t);wo==ia.PCB||wo==ia.PCBLIB||wo==ia.PCBMODULE?isSignalLayer(r)&&!isPlaneLayer(r)&&yt(t):"wire"!=i&&"bus"!=i||yt(t);var a=(w(t,"points"),gt({x:e.clientX,y:e.clientY})),o=Oe(a,t,9);if(o<0)w(t,"points",n);else{0===o?o=1:o%2==0&&(o-=1);w(t,"stroke-opacity","0.5");var s=o>>1,c=t.points.getItem(s),l=t.points.getItem(s+1),d=getComputedStyle(t)||{},u=d.stroke||w(t,"stroke")||"#ffff66",h=d.strokeWidth||w(t,"stroke-width")||"1";h=h.replace(/[\D]+$/,"");var f={x1:c.x,y1:c.y,x2:l.x,y2:l.y,stroke:u,"stroke-width":1.1*h},p=gi.instance;p.target=t;if(p.controlLine){f.visibility="visible";w(p.controlLine,f);w(p.controlLine2,f)}else{var g=Wt("line",f);g.style.stroke=u;g.style.strokeDasharray="none";g.style.cursor="row-resize";fa.appendChild(g);p.controlLine=g;g.addEventListener("mousedown",this.mdown,!1)}}}},handleBusentry:function(e,t){function n(e,t){var n,i=Object.keys(e);for(r=0;r<i.length;r+=1){Sa.solveItem(v(i[r]),"old");n="node"===t?v(i[r]).cloneNode(!0):Wa.node.getRefId(v(i[r]));this.history.wire.push([t,i[r],n,null])}}var r,i,a,o;this.history={busEntry:[],wire:[]};this.busEntry=[];this.followingInfo={};if(!me(wo)||"bus"!==de(e))return!1;this.busEntry=so.addBusEntry([e],t);for(r=0,i=this.busEntry.length;r<i;r+=1)this.history.busEntry.push(["node",this.busEntry[r].id,this.busEntry[r].cloneNode(!0),null]);this.followingInfo=so.calFollowing(this.busEntry);a=this.followingInfo.followingWireIds;o=Object.keys(a);if(o.length)n.call(this,a,"node");else{a=so.appendWire(this.busEntry);if(a){this.followingInfo=so.calFollowing(this.busEntry);n.call(this,a,"add")}}return!0},updateNodeInHistory:function(e){var t,n,r,i;if(wo!==ia.SCH||"bus"!==de(e))return!1;n=this.followingInfo.followingWireIds;r=Object.keys(n||{});i=r.length;for(t=0;t<i;t+=1)v(r[t])&&(this.history.wire[t][3]=v(r[t]).cloneNode(!0));for(t=0;t<this.history.busEntry.length;t+=1)this.history.busEntry[t][3]=this.busEntry[t].cloneNode(!0);return!0},changePolyline:function(e){var t=e.i,n=e.oldPoints,r=e.ps,i=n[t-1],a=n[t],o=n[t+1],s=n[t+2];if(!i||!s)return t;if(a.y===o.y){if(i.x!==a.x){r.insertItemBefore(mt(a),t);n.splice(t,0,{x:a.x,y:a.y});t+=1;this.pIndex=this.pIndex+2}if(s.x!==o.x){r.insertItemBefore(mt(o),t+1);n.splice(t+1,0,{x:o.x,y:o.y})}}if(a.x===o.x){if(i.y!==a.y){r.insertItemBefore(mt(a),t);n.splice(t,0,{x:a.x,y:a.y});t+=1;this.pIndex=this.pIndex+2}if(s.y!==o.y){r.insertItemBefore(mt(o),t+1);n.splice(t+1,0,{x:o.x,y:o.y})}}return t},changeIntersectionForbus:function(e,t){var n,r,i=e.A2,a=e.B2,o=e.C,s=e.A,c=e.B,l=e.D;if("CA"===t){c.x===l.x&&(n=Te(i,a,{x:s.x,y:s.y+10},o));c.y===l.y&&(n=Te(i,a,{x:s.x+10,y:s.y},o))}else if("BD"===t){o.x===s.x&&(r=Te(i,a,{x:c.x,y:c.y+10},l));o.y===s.y&&(r=Te(i,a,{x:c.x+10,y:c.y},l))}return n||r},getAngleAOB:function(e,t,n){var r=e.x-t.x,i=e.y-t.y,a=n.x-t.x,o=n.y-t.y,s=r*a+i*o,c=Math.sqrt(r*r+i*i),l=Math.sqrt(a*a+o*o),d=s/(c*l);d=d>1?1:d<-1?-1:d;return Math.acos(d)},getAngleSeg:function(e,t,n,r){var i=e.x-t.x,a=e.y-t.y,o=n.x-r.x,s=n.y-r.y,c=i*o+a*s,l=Math.sqrt(i*i+a*a),d=Math.sqrt(o*o+s*s),u=c/(l*d);u=u>1?1:u<-1?-1:u;return Math.acos(u)},getNewDot:function(e,t,n){var r,i=e.x-t.x,a=e.y-t.y,o=n.x-t.x,s=n.y-t.y,c=i*s-a*o,l=Fe([n.x,n.y],c>0?-135:135,t.x,t.y),d={x:l[0],y:l[1]},u=t.y==d.y?null:(t.x-d.x)/(t.y-d.y);r=null===u?{x:e.x+1,y:e.y}:0===u?{x:e.x,y:e.y+1}:{x:e.x+1,y:1/u+e.y};return Te(e,r,t,n)},trimPolyline:function(e,t,n){if(!(e.length<4)){var r,i,a,o=t,s=e.getItem(o),c=e.getItem(o+1),l=e.getItem(o-1),d=e.getItem(o+2);if(De(s.x,s.y,l.x,l.y)<n){r={x:l.x,y:l.y};i={x:l.x+(c.x-s.x),y:l.y+(c.y-s.y)};a=Te(r,i,c,d);if(a){c.x=a.x;c.y=a.y;e.removeItem(o);return}}if(De(c.x,c.y,d.x,d.y)<n){r={x:d.x+(s.x-c.x),y:d.y+(s.y-c.y)};i={x:d.x,y:d.y};a=Te(r,i,l,s);if(a){s.x=a.x;s.y=a.y;e.removeItem(o+1);return}}}}};Sa.addJunction=function(e){var t=v("part(junction)");if(t&&!ha.hasJunctionAtXY(e.x,e.y)){var n=t.cloneNode(!0);w(n,{id:"gge"+ ++to,c_shapetype:"group"});w(n,{c_origin:e.x+","+e.y});w(n,{display:""});w(n.childNodes[0],{cx:e.x,cy:e.y});w(n.childNodes[1],{cx:e.x,cy:e.y});N(n,"pointer-events");Ji.appendChild(n);ha.updateOne(n);Sa.logJunctionOp("add",n.id);return n}};Sa.removeJunction=function(e){var t=v(e);ha.removeOne(t);qa.appendChild(t);Sa.logJunctionOp("del",e);return e};Sa.logJunctionOp=function(e,t){Sa._historyList[e].push(t)};Sa.getHistoryCmd=function(e){return[e,Sa._historyList[e].join(",")]};Sa.batHistoryCmd=function(e){var t=[];Array.isArray(e[0])?t=e.slice(0):t.push(e);Sa._historyList.add.length>0&&t.push(Sa.getHistoryCmd("add"));Sa._historyList.del.length>0&&t.push(Sa.getHistoryCmd("del"));Sa._clear();return t};Sa.solveItem=function(e,t){var n=w(e,"c_etype"),r=w(e,"c_partid");if("wire"==n){var i=X(w(e,"points")).replace(/ +/g,",");Sa._todoList.push({type:"wire",id:e.id,pointArr:z(i),isOldItem:"old"==t})}else if("pinpart"==n&&-1==(r||"").indexOf("part_pin")&&"part_netLabel_text"!=r)if("part_junction"!=w(e,"c_partid")){for(var a,o=m("circle.pindot",e),s=o.length,c=[],l=0;l<s;l++){a=o[l];c.push({x:a.cx.baseVal.value,y:a.cy.baseVal.value,hide:"none"===w(a.parentElement,"display")})}c.length>0&&Sa._todoList.push({type:"pinPart",id:e.id,pointArr:c,isOldItem:"old"==t})}else{var d=w(e,"c_origin").split(",");Sa._todoList.push({type:"junction",id:e.id,pointArr:[{x:d[0],y:d[1]}],isOldItem:"old"==t})}};Sa.solveItems=function(e,t){for(var n=e||Zt(),r=0,i=n.length;r<i;r++)Sa.solveItem(n[r],t)};Sa._clear=function(){Sa._todoList=[];Sa._historyList={add:[],del:[]}};Sa.solveTodoList=function(){for(var e=0,t=Sa._todoList.length;e<t;e++){var n=Sa._todoList[e];switch(n.type){case"wire":Sa.solveWire(n);break;case"pinPart":Sa.solvePinPart(n);break;case"junction":Sa.solveJunction(n)}}var r=m('#g1 > g[c_partid="part_junction"]');if(r.length)for(var i=null,e=r.length-1;e>=0;e--){var a=r[e];a.nextElementSibling!==i&&Ji.insertBefore(a,i);i=a}};Sa.solveJunction=function(e){var t=e.pointArr;Sa.checkJunctionValid(t[0]).needAddJunction&&Sa.addJunction(t[0])};Sa.solvePinPart=function(e){var t=e.pointArr;if(!(t.length<=0)){t.forEach(function(e){Sa.checkJunctionValid(e).needAddJunction&&Sa.addJunction(e)});if(t.length>=2){var n=e.id,r=ha.getWires();for(var i in r)if(j(r,i))for(var a=r[i],o=0,s=0;s<t.length;s++)if(go.ptOnPolyline(t[s],a)){o++;if(o>=2){Sa.splitWireByParts({id:i,pointArr:a},[n]);break}}}}};Sa.splitByTwoPoints=function(e,t,n,r){if(go.isPointEqual(t,n))return null;e=D(e);var i,a,o,s,c=(e.length,function(t){for(var n=e.length-1;n>=0;n--)if(go.isPointEqual(t,e[n]))return{index:n,insert:!1};for(n=e.length-1;n>0;n--)if(go.ptOnLine(t,e[n],e[n-1])){e.splice(n,0,t);return{index:n,insert:!0}}return{index:-1,insert:!1}});i=c(t);o=i.index;if(o<0)return null;a=c(n);s=a.index;if(s<0)return null;a.insert&&s<=o&&o++;s<o&&(o=[s,s=o][0]);for(var l=o+1;l<s;l++)if(!go.ptOnLine(e[l],t,n))return null;r&&function(){for(var t=0;t<r.length;t++)for(var n=r[t],i=o;i<s;i++)if(!go.isPointEqual(n,e[i])&&!go.isPointEqual(n,e[i+1])&&go.ptOnLine(n,e[i],e[i+1]))return null}();return 0===o&&s===e.length-1?[]:0===o?[e.slice(s)]:s===e.length-1?[e.slice(0,o+1)]:[e.slice(0,o+1),e.slice(s)]};Sa.solveWire=function(e){var t=ha.getWires(),n=ha.getPinDots(),r=ha.junctions,i={},a=e.pointArr,o=[];if(!(a.length<2)){i[U(a[0])]=a[0];i[U(a[a.length-1])]=a[a.length-1];for(var s in t)if(j(t,s)&&t[s]&&s!=e.id){o=t[s];var c=o[0],l=o[o.length-1];go.ptOnPolyline(c,a)&&(i[U(c)]=c);go.ptOnPolyline(l,a)&&(i[U(l)]=l)}for(var d in r)j(r,d)&&go.ptOnPolyline(r[d],a)&&(i[U(r[d])]=r[d]);var u,h,f={};for(var p in n)if(j(n,p)&&go.ptOnPolyline(n[p],a)){i[U(n[p])]=n[p];h=p.split("_")[0];f[h]=(f[h]||0)+1}u=Object.keys(f).filter(function(e){return f[e]>=2});var g=[],y={};for(var x in i)if(j(i,x)){var m=Sa.checkJunctionValid(i[x]);m.needAddJunction&&Sa.addJunction(i[x]);m.needJunction&&(y[x]=i[x])}var L=v(e.id);L&&b(L.parentNode,$a)&&t[e.id]&&!e.isOldItem&&Sa.splitWireByParts(e,u);g.forEach(function(e){e&&Sa.addJunction(e)})}};Sa.splitWireByParts=function(e,t){var n=e.pointArr,r={},i=function(e){var t=e.x+","+e.y;j(r,t)||(r[t]=e)},a=ha.junctions,o=[];for(var s in a)if(j(a,s)&&go.ptOnPolyline(a[s],n)){i(a[s]);o.push(a[s])}i(n[0]);i(n[n.length-1]);var c=function(e,t){var n=function(t){var n,r,i,a,o,s,c=ha.gJsonCache.schlib[t],l=c&&c.pin||{},d=Object.keys(l),u=d.length;if(u<2)return[];for(var h=d.map(function(t){return go.ptOnPolyline(l[t].pinDot,e)}),f=0;f<u;f++)if(h[f]){n=l[d[f]];i=n.configure.rotation%180==0;o=i?[]:[n.pinDot];s=i?[n.pinDot]:[];for(var p=f+1;p<u;p++)if(h[p]){r=l[d[p]];a=r.configure.rotation%180==0;i&&a&&n.pinDot.y==r.pinDot.y?s.push(r.pinDot):i||a||n.pinDot.x!=r.pinDot.x||o.push(r.pinDot)}if(o.length>1)return o;if(s.length>1)return s}return[]},r={};t.forEach(function(e){var t=n(e);t.length>=2&&(r[e]=t)});return r}(n,t);Object.values||(Object.values=function(e){var t=[];for(var n in e)j(e,n)&&t.push(e[n]);return t});var l=function(e,t,n){var r,i,a,o,s,c,l=[e];for(a=0;a<t.length;a++){s=t[a][0];c=t[a][1];for(o=0;o<l.length;o++){r=Sa.splitByTwoPoints(l[o],s,c,n);if(r)if(0===r.length){l.splice(o,1);o--;i=!0}else if(1===r.length){l[o]=r[0];i=!0}else{l.splice.apply(l,[o,1].concat(r));o+=r.length-1;i=!0}}}return i?l:null}(n,Object.values(c),o);if(l&&l.length){var d=v(e.id);if(!d)return;ha.removeOne(d);qa.appendChild(d);Sa.logJunctionOp("del",e.id);for(var u=0;u<l.length;u++){var h=d.cloneNode(!1);w(h,{points:H(l[u]),id:Wa.newId(),class:""});Ji.appendChild(h);ha.updateOne(h);Sa.logJunctionOp("add",h.id)}d==pa&&en()}Object.keys(r).forEach(function(e){var t=r[e];Sa.checkJunctionValid(t).needAddJunction&&Sa.addJunction(t)})};Sa.checkJunctionValid=function(e){var t=ha.getWires(),n=ha.getPinDots(),r=ha.junctions,i=[],a=0,o=0,s=0;for(var c in t)if(j(t,c)){i=t[c];if(!i)continue;var l=i[0],d=i[i.length-1];if(go.ptOnPolyline(e,i)&&!e.hide){if(go.isPointEqual(e,l)||go.isPointEqual(e,d)){!0;o++}else a++;if(o>=3&&a>=1)break}}for(var u in r)if(j(r,u)&&go.isPointEqual(e,r[u])){s=u;break}for(var h in n)if(j(n,h)&&go.isPointEqual(e,n[h])){o++;!0;if(o>=3)break}var f=Sa.needJunction(o,a),p=!!s;p&&!f&&Sa.removeJunction(s);return{needJunction:f,hasJunction:p,removed:!f&&p,needAddJunction:f&&!p}};Sa.needJunction=function(e,t){return e>=3||e>=1&&t>=1};var So={clear:function(e,t){var n=!!la.count();dr();en();for(var r,i="NotSaveHistory"==e,a=Ji.childNodes,o=a.length,s=[],c=[];--o>=0;){r=a[o];if(r&&r.id&&de(r))if(t||!po.isLocked(r))if(i)Ji.removeChild(r);else{s.push(r.id);qa.appendChild(r)}else c.push(r)}ha.calAll();if(!i){s=s.join(",");La.save(["del",s])}n&&pn("triggerEvent",["select_change"])},getCanvasAttrs:function(){var e,t,n,r={};e=So.getViewBox();n=e[2];t=e[3];r["attr-width"]=n;r["attr-canvas-height"]=t;r["attr-canvas-bgcolor"]=w(v("gridBg"),"fill")||"#000000"
;r["attr-canvas-grid-visible"]="none"==w(v("grid1"),"display")?"none":"yes";r["attr-canvas-grid-color"]=w(v("gridCell"),"fill");r["attr-canvas-grid-style"]="url(#gridPattern)"==w(v("grid1"),"fill")?"dot":"line";r["attr-canvas-grid-size"]=ba.adsorbGrid.gridSize;r["attr-canvas-snap-size"]=ba.adsorbGrid.distanceX;r["attr-canvas-alt-snap-size"]=ba.adsorbGrid.altSnapSize;r["attr-canvas-snap"]=ba.adsorbGrid.enabled?"yes":"none";r["attr-canvas-frame-size"]=xo.size2Frame(n,t);r["attr-canvas-origin-x"]=ba.canvas.originX;r["attr-canvas-origin-y"]=ba.canvas.originY;var i=w(Ji,"c_para")||"",a=Wa.c_paraToJson(i),o=Wa.fileType.getAbstractFileType(wo),s=ha.gJsonCache.head;if("schlib"==o){j(a,"package")||(a.package="");j(a,"name")||(a.name="");j(a,"pre")||(a.pre="");j(a,"Contributor")||(a.Contributor="");j(a,"libConvert")||(a.libConvert="none"==s.convert_to_pcb?"No":"Yes");j(a,"Add into BOM")||(a["Add into BOM"]="none"==s.add_into_bom?"No":"Yes");i=Wa.jsonToC_para(a)}else if("sch"==o){j(a,"Prefix Start")||(a["Prefix Start"]=1);i=Wa.jsonToC_para(a)}r.c_para=i;return r},modify_canvas:function(e){var r,i;for(i in e)if(j(e,i)){r=e[i];if("attr-width"==i);else if("attr-canvas-height"==i);else if("attr-canvas-bgcolor"==i){r=r.toUpperCase();w(v("gridBg"),{fill:r});t.body.style.backgroundColor=r;ba.canvas.bgcolor=r;var a=parseInt(r.substr(1),16),o=a>>16,s=a>>8&255,c=255&a;ba.canvas.fgcolor=.213*o+.715*s+.072*c<128?"#FFFFFF":"#000000";var l=w(v("gridCell"),"fill");if(l==r){w(v("gridCell"),{fill:ba.canvas.fgcolor});w(v("gridCell2"),{stroke:ba.canvas.fgcolor})}}else if("attr-canvas-grid-visible"==i){ba.adsorbGrid.visible="none"!==r;w(v("grid1"),"display","none"==r?r:"")}else if("attr-canvas-grid-color"==i){w(v("gridCell"),{fill:r});w(v("gridCell2"),{stroke:r})}else if("attr-canvas-grid-size"==i){if(+r<1)continue;for(var d=+r;d*Za<5;)d*=d*Za*2>=5?2:d*Za*5>=5?5:10;w([v("gridPattern"),v("gridPattern2")],{width:d,height:d});w(v("gridCell2"),{d:"M10 0V10H-10".replace(/10/g,d)});ba.adsorbGrid.gridSize=+r}else if("attr-canvas-snap-size"==i){r=r||10;ba.adsorbGrid.distanceX=ba.adsorbGrid.distanceY=+r;j(e,"attr-canvas-snap")||(ba.adsorbGrid.enabled=r>1e-4)}else if("attr-canvas-snap"==i)ba.adsorbGrid.enabled="yes"==r;else if("attr-canvas-alt-snap-size"==i)ba.adsorbGrid.altSnapSize=+r||1;else if("attr-canvas-grid-style"==i)w(v("grid1"),"fill","dot"==r?"url(#gridPattern)":"url(#gridPattern2)");else if("c_para"==i)w(Ji,{c_para:r});else{if("name"==i&&(wo===ia.SUBCKT||wo===ia.SPICESYMBOL)){var u=new RegExp("^[0-9a-zA-Z_]+$");if(r.trim().length<3){parent.$.messager.alert("The title can not less than 3 charaters!");pn("updateAttrPanel");continue}if(!u.test(r)){var h=wo==ia.SUBCKT?"Spice subckt title just allow [0-9][a-z][A-Z] and _":"Spice symbol title just allow [0-9][a-z][A-Z] and _";parent.$.messager.error(h)}Ai(Ji,i,r);continue}if(!("libConvert"!=i&&"Add into BOM"!=i||wo!==ia.SCHLIB&&wo!==ia.SPICESYMBOL)){i="libConvert"==i?"convert_to_pcb":"add_into_bom";r="No"==r?"none":"yes";ha.gJsonCache.head[i]=r;w(Ji,i,r);continue}var f=Wa.fileType.isLib(wo),p=r.trim();if((i+r).indexOf(sa)>=0)continue;if(f&&"pre"==i&&!p){parent.$.messager.error("This field can't be removed!");continue}if("spicePre"==i&&!r.match(/^[a-zA-z]+$/)){pn("updateAttrPanel");continue}if("name"==i&&(wo==ia.PCBMODULE||wo==ia.SCHMODULE||f)&&p.length<3){parent.$.messager.alert("The title can not less than 3 charaters!");pn("updateAttrPanel");delete e[i];continue}Ai(Ji,i,r);pn("updateAttrPanel")}}j(e,"attr-canvas-unit")&&on();if(j(e,"attr-canvas-origin-x")||j(e,"attr-canvas-origin-y")){var g=ba.canvas.originX,y=ba.canvas.originY;j(e,"attr-canvas-origin-x")&&(g=+e["attr-canvas-origin-x"]);j(e,"attr-canvas-origin-y")&&(y=+e["attr-canvas-origin-y"]);isFinite(g)&&isFinite(y)&&n("setOriginXY",[{x:g,y:y}])}},getViewBox:function(){return w(fa,"viewBox").split(" ").map(parseFloat)},setViewBox:function(){var e=v("gridBg"),t=v("grid1"),n=v("gridOH"),r=v("gridOV");return function(i){w(fa,"viewBox",i.join(" "));var a={x:i[0],y:i[1],width:i[2],height:i[3]};w(e,a);w(t,a);w(n,{x1:i[0],x2:i[0]+i[2]});w(r,{y1:i[1],y2:i[1]+i[3]});pn("updateRuler",[{vbX:i[0],vbY:i[1]}])}}()},Co={version:1,readyed:!1,started:!1,dots:[],line:null,mockX:null,mockY:null,STATUSEXIT:1,ready:function(){var e=va;if(!Co.readyed){Co.readyed=!0;Co.forcedPixelSnap=!1;t.addEventListener("mousedown",Co.mousedown,!1);t.addEventListener("mousemove",Co.mousemove,!1);t.addEventListener("mouseup",Co.mouseup,!1);_(Ji,"events-none",!0);bn("draw(freedraw)"==va?"cursor-freedraw":"cross-red");va.match(/^place_part\(/)&&(e="place_part");Co[e]&&"function"==typeof Co[e].ready&&Co[e].ready()}},mousedown:function(e){e.button==qi&&Co.mousedownLeft(e)},mousedownLeft:function(e){Co[va]&&"function"==typeof Co[va].mousedownLeft&&Co[va].mousedownLeft(e)},mouseup:function(e){e.button==qi?Co.mouseupLeft(e):e.button==ea&&Co.mouseupRight(e)},mouseupLeft:function(e){var n,r,i,a=Co;if(Ga||e.target!=t.documentElement&&e.target!=t.body){var o=a.dots;n=ln(e);!ba.adsorbGrid.enabled||"draw(arc)"!=va&&"draw(pie)"!=va||4!=o.length&&6!=o.length||n.x!=o[0]&&n.y!=o[1]&&(n=ln(e,!1));r=n.x;i=n.y;en();if(!a.started){a.started=!0;o.length=0}if(Co[va]&&"function"==typeof Co[va].mouseupLeft){if(Co[va].mouseupLeft(e)===Co.STATUSEXIT)return}if("draw(wire)"==va||"place_part(pin)"==va||"place_part(lib)"==va){r=Math.round(r);i=Math.round(i)}a.draw(r,i,!0);va||a.end()}},mouseupRight:function(e){var n,r,i,a=Co;if((Ga||e.target!=t.documentElement&&e.target!=t.body)&&!wa.dragpanning){var o=a.dots;n=ln(e);!ba.adsorbGrid.enabled||"draw(arc)"!=va&&"draw(pie)"!=va||4!=o.length&&6!=o.length||n.x!=o[0]&&n.y!=o[1]&&(n=ln(e,!1));r=n.x;i=n.y;Co[va]&&"function"==typeof Co[va].mouseupRight&&Co[va].mouseupRight(e);en();if(va&&a.started&&0!==va.indexOf("place_part")&&"draw(freedraw)"!==va&&"draw(image)"!==va&&0!==a.dots.length)a.next(r,i);else{a.end();lr()}wa.contextmenuDisableOnce=!0;setTimeout(function(){wa.contextmenuDisableOnce=!1},5)}},mousemove:function(e){var n,r,i,a=Co;if(a.started&&("object"!=typeof Oa||!Oa.ready)){var o,s;if(!ba.adsorbGrid.enabled&&Co.forcedPixelSnap){o=Wa.extend({},ba.adsorbGrid);Wa.extend(ba.adsorbGrid,{distanceX:1,distanceY:1,enabled:!0});s=function(){Wa.extend(ba.adsorbGrid,o)}}if(Ga||e.target!=t.documentElement&&e.target!=t.body){if(Co[va]&&"function"==typeof Co[va].mousemove){if(Co[va].mousemove(e)===Co.STATUSEXIT){s&&s();return}}var c=a.dots;n=ln(e);!ba.adsorbGrid.enabled||"draw(arc)"!=va&&"draw(pie)"!=va||4!=c.length&&6!=c.length||n.x!=c[0]&&n.y!=c[1]&&(n=ln(e,!1));r=n.x;i=n.y;if(c.length>0&&a.mockX==r&&a.mockY==i)s&&s();else{if("draw(wire)"==va||"place_part(pin)"==va||"place_part(lib)"==va){r=Math.round(r);i=Math.round(i)}a.draw(r,i,!1);a.mockX=r;a.mockY=i;s&&s()}}else{if(0===va.indexOf("place_part")){Tn(va.substr(6))}s&&s()}}},draw:function(e,t,n){var r=Co,i=r.dots,a=i.length,o=va;r.lastX=e;r.lastY=t;if(e!=i[a-2]||t!=i[a-1]){n&&r.dots.push(e,t);0===va.indexOf("place_part")&&(o="place_part");Co[o]&&"function"==typeof Co[o].draw&&Co[o].draw(e,t,n);r.target&&!r.target.id&&w(r.target,{id:Wa.newId()})}},next:function(e,t){var n=Co,r=n.dots,i=v("pdot0"),a=void 0!==e&&void 0!==t;a&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(a=!1);i&&"none"!=w(i,"display")&&w(i,"display","none");Co[va]&&"function"==typeof Co[va].next&&Co[va].next(e,t);n.target=null;n.dots.length=0;n.mockX=null;n.mockY=null},end:function(e){var n=Co,r=va;0===va.indexOf("place_part")&&(r="place_part");Co[r]&&"function"==typeof Co[r].end&&Co[r].end(e);n.mockX=null;n.mockY=null;n.target=null;n.started=!1;n.dots.length=0;n.readyed=!1;t.removeEventListener("mousedown",n.mousedown,!1);t.removeEventListener("mouseup",n.mouseup,!1);t.removeEventListener("mousemove",n.mousemove,!1);_(Ji,"events-none",!1);bn();var i=v("pdot0");i&&"none"!=w(i,"display")&&w(i,"display","none")},restart:function(e){var t=Co;if(va)if(t.started&&t.dots.length){var n=va;t.end(27);va="";sr(n)}else{t.end(27);va=""}},canBackStep:function(){var e=Co,t=va;return e.started&&("draw(polyline)"==t||"draw(polygon)"==t||"draw(bezier)"==t||"draw(wire)"==t||"draw(bus)"==t||"draw(track)"==t)&&e.dots.length>=4},backStep:function(){var e=Co;if(e.canBackStep()){e.dots.length-=2;e.draw(e.lastX,e.lastY)}}};!function(e){e.nameObj={};e.cancelNextName=function(){function t(t){var n=e.nameObj[va+t];if("string"==typeof n&&n&&n.match(/\d$/)){var r=e.resolveNextName(n),i=r.num,a=r.name;e.nameObj[va+t]=a+(i-1)}}if("place_part(pin)"==va){t(0);t(1)}else t("")};e.updateNextDrawLineName=function(t,n){e.nameObj[t]=n};e.resolveNextName=function(e){var t,n=e.match(/\d+$/)[0],r=e.split(new RegExp(n+"$"))[0];if(!isNaN(n)&&n.length>1){var i=n.match(/^0+/);n=Number(n);if(i){t=i[0];String(n+1).length!=String(n).length&&(t=t.substr(0,t.length-1));r+=t}}return{name:r,num:Number(n)}};e.getNextName=function(t){void 0===t&&(t="");var n,r,i="",a=e.nameObj[va+t],o="place_part(pcbtext)"==va;if(o){a||(e.nameObj[va+t]={});var s=v("part(pcbtext)").childNodes[0];e.nameObj[va+t].c_text=w(s,"c_text");e.nameObj[va+t].d=w(s,"d");a=e.nameObj[va+t]}if(a){if((o?a.c_text:a).match(/\d$/)){r=e.resolveNextName(o?a.c_text:a);n=r.num;i=r.name.replace(/\\n/g,"\n");if(o){e.nameObj[va+t].c_text=i+(n+1);var c=Tt(e.target.childNodes[0]),l=Tt(e.target),d={text:i+(n+1),x:l.c_origin.split(",")[0],y:l.c_origin.split(",")[1],degree:l.c_rotation,fontSize:c.c_fontsize,fontFamily:c.c_fontfamily},u=Layer.getValidLayer("TEXT",Layer.getActiveLayer())||+Layer.getActiveLayer();if(isBottomLayer(u)){d.mirror="1";w(e.target,"c_mirror","1")}if(wa.pcbServersFonts.indexOf(c.c_fontfamily)>-1){w(e.target,"locked","1");d.callback=function(t){w(e.target,"locked","0");if(t){w(e.target.childNodes[0],{d:t,c_text:i+(n+1)});setCushionForText(e.target)}};pn("getFontPath",[d])}else e.nameObj[va+t].d=pn("getFontPath",[d])}else e.nameObj[va+t]=i+(n+1)}else if(!(o?a.c_text:a).match(/\d$/))return e.nameObj[va+t]}else if("place_part(pin)"==va||"place_part(netLabel_text)"==va||"place_part(netLabel_netPort)"==va||"place_part(netLabel_volProbe)"==va||"place_part(pad)"==va||"place_part(annotation)"==va){"place_part(netLabel_text)"==va?i="netLabel":"place_part(netLabel_netPort)"==va?i="netPort":"place_part(netLabel_volProbe)"==va?i="volProbe":"place_part(annotation)"==va&&(i="Text");var h,f,p,g=va.match(/\((.*?)\)$/)[1],y=m('.shapeBox > g[c_partid="part_'+g+'"]',fa).filter(function(t){return t!=e.target}),x=0;for(h=0;h<y.length;h++){if("pad"===g){f=y[h];p=f&&w(f,"number")}else{f=y[h].childNodes["pin"===g?t||0:1];p=f&&f.textContent}if(p){n=p.match(/\d+$/)?p.match(/\d+$/)[0]:"";if(n&&n>x){r=e.resolveNextName(p);n=r.num;x=n}}}x+=1;e.nameObj[va+t]=i+x}else if(o){var L=w(v("part(pcbtext)").childNodes[0],"c_text");e.nameObj[va+t]={c_text:L};if(L.match(/\d$/))return e.getNextName()}return e.nameObj[va+t]}}(Co);Co["draw(wire)"]={ready:function(){Co.started=!0;Co.forcedPixelSnap=!0},mouseupLeft:function(e){var t=Co,n=ln(e),r=n.x,i=n.y,a=ha.ifFind(r,i);if(a.type){bn("cross-red",a.X,a.Y);if(t.dots.length>=2){if(a.X===t.dots[t.dots.length-2]&&a.Y===t.dots[t.dots.length-1])return Co.STATUSEXIT;t.next(a.X,a.Y)}else t.draw(a.X,a.Y,!0);return Co.STATUSEXIT}},draw:function(e,t,n){var r,i,a,o,s=Co,c=s.dots;if(c.length>=2){var l=ha.ifFind(e,t);if(l.type){e=l.X;t=l.Y;bn("cross-red",e,t)}r=n?c.join(" "):c.join(" ")+" "+e+" "+t;if(s.target){if(!n){r=go.formatWirePoints(c,90,e,t,s.target);w(s.target,{points:r})}a=z(w(s.target,"points"));i=a.length;n&&c.length+2==2*i&&c.splice(c.length-2,0,a[i-2].x,a[i-2].y)}else{o="polyline";var d={points:r,stroke:ba.colors&&ba.colors.wire||"#008800","stroke-width":ba.canvas.strokeWidth,fill:"none",id:Wa.newId(),c_shapetype:"line"};d.c_etype="wire";s.target=Wt(o,d);Ji.appendChild(s.target)}}ha.checkShow(e,t)},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target){yt(n.target);if(n.target.points.numberOfItems<2){M(n.target);n.target=null}}if(n.started&&n.target){var a=["add",n.target.id],o=n.target,s=go.simplifyWire(o);switch(s.status){case"merge":M(o);o=v(s.wireId);a=["node",o.id,s.oldNode,o.cloneNode(!0)];break;case"invalidWire":M(o);o=null;return}if(o){ha.updateOne(o);Sa.solveItem(o);Sa.solveTodoList();La.save(Sa.batHistoryCmd(a))}}n.started=!0},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(bus)"]={ready:function(){Co.started=!0;Co.forcedPixelSnap=!0},mouseupLeft:function(e){var t=Co,n=ln(e),r=n.x,i=n.y,a=ha.ifFind(r,i);if(a.type){bn("cross-red",a.X,a.Y);if(t.dots.length>=2){if(a.X===t.dots[t.dots.length-2]&&a.Y===t.dots[t.dots.length-1])return;t.next(a.X,a.Y)}else t.draw(a.X,a.Y,!0)}else;},draw:function(e,t,n){var r,i,a,o,s=Co,c=s.dots;if(c.length>=2){var l=ha.ifFind(e,t);if(l.type){e=l.X;t=l.Y;bn("cross-red",e,t)}r=n?c.join(" "):c.join(" ")+" "+e+" "+t;if(s.target){n||w(s.target,{points:r});a=z(w(s.target,"points"));i=a.length;n&&c.length+2==2*i&&c.splice(c.length-2,0,a[i-2].x,a[i-2].y)}else{o="polyline";var d={points:r,stroke:ba.colors&&ba.colors.bus||"#008800","stroke-width":ba.canvas.strokeWidth,fill:"none",id:Wa.newId(),c_shapetype:"line"};d["stroke-width"]="2";d.c_etype="bus";s.target=Wt(o,d);Ji.appendChild(s.target)}}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target){yt(n.target);if(n.target.points.numberOfItems<2){M(n.target);n.target=null}}if(n.started&&n.target)if(r.length<4)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!0},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(polyline)"]={ready:null,mouseupLeft:function(e){var t=ln(e);wi(t.x,t.y)},mouseupRight:function(e){var t=ln(e);wi(t.x,t.y)},draw:function(e,t,n){var r,i,a=Co,o=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",s=a.dots;if(s.length>=2){r=n?s.join(" "):s.join(" ")+" "+e+" "+t;if(a.target)w(a.target,{points:r});else{i="polyline";a.target=Wt(i,{points:r,stroke:o,"stroke-width":ba.canvas.strokeWidth,fill:"none"});w(a.target,{c_shapetype:"line"});Ji.appendChild(a.target)}}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target)if(r.length<4)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(polygon)"]={draw:function(e,t,n){var r,i,a=Co,o=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",s=a.dots;if(s.length>=2){r=s.join(" ")+" "+e+" "+t;if(a.target)w(a.target,{points:r});else{i="polygon";a.target=Wt(i,{points:r,stroke:o,"stroke-width":ba.canvas.strokeWidth,fill:"none"});w(a.target,{c_shapetype:"line"});Ji.appendChild(a.target)}}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target)if(r.length<6)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(ellipse)"]={draw:function(e,t,n){var r,i,a,o,s,c=Co,l=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",d=n?c.dots.length-2>0?c.dots.slice(0,c.dots.length-2):[]:c.dots;r=d.length;if(d.length>=2){e==d[r-2]||t==d[r-1]?(i=(e+d[r-2])/2,a=(t+d[r-1])/2,o=Math.abs(e-d[r-2])/2,s=Math.abs(t-d[r-1])/2,Math.max(o,s)):(i=(e+d[r-2])/2,a=(t+d[r-1])/2,o=Math.abs(e-d[r-2])/2,s=Math.abs(t-d[r-1])/2);if(c.target)w(c.target,{cx:i,cy:a,rx:o,ry:s});else{c.target=Wt("ellipse",{cx:i,cy:a,rx:o,ry:s,stroke:l,"stroke-width":"1",fill:"none"});w(c.target,{c_shapetype:"line"});Ji.appendChild(c.target)}n&&c.next()}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target)if(r.length<4)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(rect)"]={draw:function(e,t,n){var r,i,a,o=Co,s=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",c=n?o.dots.length-2>0?o.dots.slice(0,o.dots.length-2):[]:o.dots;r=c.length;if(c.length>=2){var l=Math.min(e,c[r-2]),d=Math.min(t,c[r-1]);i=Math.max(e,c[r-2])-l;a=Math.max(t,c[r-1])-d;0!==i&&0!==a||(i=a=Math.max(i,a));if(o.target)w(o.target,{x:l,y:d,width:i,height:a});else{o.target=Wt("rect",{x:l,y:d,width:i,height:a,stroke:s,"stroke-width":"1",fill:"none"});w(o.target,{c_shapetype:"line"});Ji.appendChild(o.target)}n&&o.next()}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target)if(r.length<4)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(roundrect)"]={draw:function(e,t,n){var r,i,a,o,s=Co,c=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",l=n?s.dots.length-2>0?s.dots.slice(0,s.dots.length-2):[]:s.dots;r=l.length;if(l.length>=2){var d=Math.min(e,l[r-2]),u=Math.min(t,l[r-1]);a=Math.max(e,l[r-2])-d;o=Math.max(t,l[r-1])-u;0!==a&&0!==o||(a=o=Math.max(a,o));if(s.target)w(s.target,{x:d,y:u,width:a,height:o});else{s.target=Wt("rect",{x:d,y:u,width:a,height:o,stroke:c,"stroke-width":"1",fill:"none"});w(s.target,{c_shapetype:"line"});Ji.appendChild(s.target)}i=Math.min(10,Math.min(a,o)/2);w(s.target,{rx:i,ry:i});n&&s.next()}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);if(n.started&&n.target)if(r.length<4)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(freedraw)"]={ready:null,mousedownLeft:function(e){var t=Co,n=ln(e,!1);t.startX=Wa.toFixed(n.x,2);t.startY=Wa.toFixed(n.y,2);t.started=!0;t.draw(t.startX,t.startY,!0)},mouseupLeft:function(e){Co.next();return Co.STATUSEXIT},mousemove:function(e){var t=Co;if(e.button==qi){var n=ln(e,!1),r=Wa.toFixed(n.x,2),i=Wa.toFixed(n.y,2);t.draw(r,i,!0);return Co.STATUSEXIT}},draw:function(e,t,n){var r=Co,i=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000";if(r.dots.length>=2)if(r.target)w(r.target,{d:w(r.target,"d")+" "+e+" "+t});else{r.target=Wt("path",{d:"M"+r.startX+" "+r.startY+"L"+e+" "+t,stroke:i,"stroke-width":ba.canvas.strokeWidth,fill:"none",c_shapetype:"line",c_etype:"freedraw"});r.target.style.shapeRendering="auto";r.target.style.strokeLinejoin="round";Ji.appendChild(r.target)}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);if(n.started&&n.target)if(r.length<4)M(n.target);else{lt(n.target,n.dots);ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1}};Co["draw(bezier)"]={draw:function(e,t,n){var r,i,a,o=Co,s=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",c=o.dots;i=n?o.dots.length-2>0?o.dots.length-2:0:o.dots.length;if(i>=2){var l=c.slice(0);n||l.push(e,t);var d=l.length;if(d%6==0){l.push(l[d-2],l[d-1]);l[d-2]=l[d-4];l[d-1]=l[d-3]}else d%6==4&&l.push(l[d-2],l[d-1],l[d-2],l[d-1]);r="M"+l[0]+" "+l[1]+" C"+l.slice(2).join(" ");if(o.target)w(o.target,{d:r});else{a="path";o.target=Wt(a,{d:r,stroke:s,"stroke-width":ba.canvas.strokeWidth,fill:"none",c_shapetype:"line"});Ji.appendChild(o.target)}vn(o.target)}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);yn();if(n.started&&n.target)if(r.length<6)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}yn()}};Co["draw(arc)"]={draw:function(e,t,n){var r,i,a,o,s,c,l,d=Co,u=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",h=n?d.dots.length-2>0?d.dots.slice(0,d.dots.length-2):[]:d.dots;i=h.length;if(h.length>=2){a=h[0],o=h[1];var f;if(i>=2){if(e==a&&t==o)return;if(2==i)s=Math.abs(e-a),c=Math.abs(t-o);else{s=Math.abs(h[0]-h[2]);c=Math.abs(h[1]-h[3])}}switch(i){case 2:f=h.concat(e,t);f.c_helper_lines=[{from:0,to:1}];Ar(f);if(d.target)w(d.target,{rx:s,ry:c});else{d.target=Wt("ellipse",{cx:a,cy:o,rx:s,ry:c,"stroke-dasharray":"3,3",stroke:u,"stroke-width":"1",fill:"none"});Ji.appendChild(d.target)}break;case 4:l=Wa.arc.getArcParams(a,o,s,c,e,t,e,t);if(!l)return;f=h.concat(l.x1,l.y1);f.c_helper_lines=[{from:0,to:1},{from:0,to:2,ray:1}];Ar(f);break;case 6:if(Wa.arc.getAngle(h[4]-a,h[5]-o)==Wa.arc.getAngle(e-a,t-o))return;l=Wa.arc.getArcParams(a,o,s,c,h[4],h[5],e,t);if(!l)return;r="M"+l.x1+","+l.y1+" A"+s+","+c+" 0 "+l.fa+" "+l.fs+" "+l.x2+","+l.y2;if("ellipse"==d.target.tagName){var p=Wt("path",{d:r,c_shapetype:"line",stroke:u,"stroke-width":"1",fill:"none"});Ji.replaceChild(p,d.target);d.target=p}else w(d.target,{d:r});if(n){w(d.target,{c_helper_type:"arc1"});d.next();return}f=Wa.arc.calculateArcHelperDots(d.target);f.c_helper_lines=Wa.arc.c_helper_lines;Ar(f)}}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);yn();if(n.started&&n.target)if(r.length<8)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(){var e=Co;if(e.target){ha.removeOne(e.target);M(e.target)}yn()}};Co["draw(pie)"]={draw:function(e,t,n){var r,i,a,o,s,c,l,d=Co,u=ba.colors&&ba.colors.draw||ba.canvas.fgcolor||"#000000",h=n?d.dots.length-2>0?d.dots.slice(0,d.dots.length-2):[]:d.dots;i=h.length;if(h.length>=2){a=h[0],o=h[1];var f;if(i>=2){if(e==a&&t==o)return;if(2==i)s=Math.abs(e-a),c=Math.abs(t-o);else{s=Math.abs(h[0]-h[2]);c=Math.abs(h[1]-h[3])}}switch(i){case 2:f=h.concat(e,t);f.c_helper_lines=[{from:0,to:1}];Ar(f);if(d.target)w(d.target,{rx:s,ry:c});else{d.target=Wt("ellipse",{cx:a,cy:o,rx:s,ry:c,"stroke-dasharray":"3,3",stroke:u,"stroke-width":"1",fill:"none"});Ji.appendChild(d.target)}break;case 4:l=Wa.arc.getArcParams(a,o,s,c,e,t,e,t);if(!l)return;f=h.concat(l.x1,l.y1);f.c_helper_lines=[{from:0,to:1},{from:0,to:2,ray:1}];Ar(f);break;case 6:if(Wa.arc.getAngle(h[4]-a,h[5]-o)==Wa.arc.getAngle(e-a,t-o))return;l=Wa.arc.getArcParams(a,o,s,c,h[4],h[5],e,t);if(!l)return;r="M"+a+","+o+" L"+l.x1+","+l.y1+" A"+s+","+c+" 0 "+l.fa+" "+l.fs+" "+l.x2+","+l.y2+"Z";if("ellipse"==d.target.tagName){var p=Wt("path",{d:r,c_shapetype:"line",stroke:u,"stroke-width":"1",fill:"none"});Ji.replaceChild(p,d.target);d.target=p}else w(d.target,{d:r});if(n){w(d.target,{c_helper_type:"pie1"});d.next();return}f=Wa.arc.calculateArcHelperDots(d.target);f.c_helper_lines=Wa.arc.c_helper_lines_pie1;Ar(f)}}},next:function(e,t){var n=Co,r=n.dots,i=void 0!==e&&void 0!==t;i&&r.length>1&&e==r[r.length-2]&&t==r[r.length-1]&&(i=!1);i&&n.draw(e,t,!0);yn();if(n.started&&n.target)if(r.length<8)M(n.target);else{ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!1},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}yn()}};Co["draw(image)"]={ready:function(){Co.started=!0},draw:function(e,t,n){var r,i,a,o=Co;if(n&&o.target){a=o.target.cloneNode(!0);a.id=Wa.newId();o.next();Ji.appendChild(a);o.target=a}else if(!n){r=da.width;i=da.height;if(o.target){w(o.target,{x:e,y:t});ft(Co.target,0)}else{o.target=Wt("image",{x:e,y:t,width:r,height:i,preserveAspectRatio:"none","xlink:href":da.src,c_shapetype:"line",id:Wa.newId(),c_rotation:0});Ji.appendChild(o.target);o.target&&!o.target.id&&w(o.target,{id:Wa.newId()})}}},next:function(e,t){var n=Co;if(n.started&&n.target){ha.updateOne(n.target);La.save(["add",n.target.id])}n.started=!0},end:function(e){var t=Co;if(t.target){ha.removeOne(t.target);M(t.target)}}};Co["draw(origin)"]={ready:function(){Co.forcedPixelSnap=!0;Co.started=!0;Co.preOrigin={offsetX:0,offsetY:0}},draw:function(e,t,r){var i=Co;if(r){i.preOrigin.offsetX=e-ba.canvas.originX;i.preOrigin.offsetY=t-ba.canvas.originY;n("setOriginXY",[{x:e,y:t}]);i.end();lr();pn("setTabUnsaved");La.save(["originXY","set.origin",i.preOrigin])}}};Co.place_part={cloneTemplate:function(e){if(!va)return lr();var t=va.substr(6);this.template=v(t);var n=this.template,r=w(n,"subparts");if(r&&!e){r=r.split(",");var i=r.indexOf(w(n,"uuid"));if(i>=0){var a=(i+1)%r.length,o=r[a],s=o&&L('#gCurParts > [uuid="'+o+'"]');if(s){n.id="";s.id=t;this.template=s}}}if("place_part(pin)"==va||"place_part(netLabel_text)"==va||"place_part(netLabel_netPort)"==va||"place_part(netLabel_volProbe)"==va){var c;if("place_part(pin)"==va){c=Co.getNextName(0);this.template.childNodes[0].textContent=c;w(this.template.childNodes[0],"c_pinname",c);c=Co.getNextName(1);this.template.childNodes[1].textContent=c;w(this.template.childNodes[1],"c_pinnumber",c);w(this.template,{c_spicepin:c.match(/\d+$/)?c.match(/\d+$/)[0]:0})}else{c=Co.getNextName();"place_part(netLabel_volProbe)"==va||"place_part(netLabel_netPort)"==va?this.template.childNodes[1].childNodes[0].textContent=c:this.template.childNodes[1].textContent=c}}Co.target=this.template.cloneNode(!0);if("place_part(annotation)"==va){var l=Co.target.childNodes[0].textContent;c=Co.getNextName();if(c&&c.match(/\d+$/)&&"1"===c.match(/\d+$/)[0]){Co.nameObj["place_part(annotation)"]=l;c=l}if(c){c.indexOf("\n")>-1&&c.replace(/\n/g,"\\n");Oi(Co.target,{"attr-text-text":c},{notHistory:!0,notUpdateJsonCache:!0})}}var d=w(Co.target,"c_module");d&&N(Co.target,"c_partid");if(!d&&"place_part(lib)"===va){var u=ue();w(Co.target,"id","gge"+u)}"place_part(lib)"==va&&"part_lib_sheet"==w(Co.target,"c_partid")&&(Co.target.id="frame_sheet_1");var h=!0===Ua.getCacheObj("PackageDis"),f=Wa.c_paraToJson(w(Co.target,"c_para"));h&&!No&&j(f,"package")&&Ai(Co.target,"Package Display","Yes");if(No){var p=Wa.c_paraToJson(w(Co.target,"c_para")),g="U"===p.spicePre?pn("getInitValue",[p,An("name",Co.target).textContent]):pn("getInitValue",[p]);"0"===p.NameDisplay&&w(An("name",Co.target),"display","none");"0"===p.PreDisplay&&w(An("pre",Co.target),"display","none");g&&Ei(An("name",Co.target),g)}N(Co.target,"subparts");Ji.appendChild(Co.target);Rt(Co.target);var y=Co.target;if("part(lib)"!=t&&"none"==w(y,"display")&&wa.canvasMoveEvent){w(y,"display","");var x=ln(wa.canvasMoveEvent);Nn(y,x.x,x.y)}},ready:function(){this.cloneTemplate(!0);Co.started=!0;Co.forcedPixelSnap=!0;"place_part(lib_sheet)"==va&&xo.updateSheetText(Co.target,{date:"?",product:"?"})},draw:function(e,t,n){var r,i,a,o,s,c=Co.target,l=[];if(c){var d=Ua.getCacheObj("AutoAnnotatePre");void 0===d&&(d=!0);if(n){var u=!!w(c,"c_module");if(u){Pn(c);var h=[].slice.call(c.children||c.childNodes,0).filter(function(e){return 1===e.nodeType});for(r=0;r<h.length;r++){Ji.appendChild(h[r]);"place_part(netLabel_volProbe)"==va&&(h[r].childNodes[1].firstChild.nodeValue=Jr(h[r].childNodes[1].firstChild.nodeValue));"place_part(lib)"==va&&"g"==h[r].tagName&&Vt(h[r])}M(c);if(l.length){s=ua.getNewPre(l.map(function(e){return e.pre}));for(r=0;r<s.length;r++)l[r].preNode.textContent=s[r]}ir(h,!0);ha.updateMore(h);Sa.solveItems(h);Sa.solveTodoList();var f=h.map(function(e){return e.id}).join(",");La.save(Sa.batHistoryCmd(["add",f]))}else{Pn(c);if(m('.shapeBox >g[c_partid="'+w(c,"c_partid")+'"][c_origin="'+w(c,"c_origin")+'"]').filter(function(e){return e!=Co.target}).length)return;w(c,{c_shapetype:"group"});N(c,"pointer-events");Vt(c);!function(e){var t=w(e,"eelibtitle"),n=w(e,"c_para"),r=ae("easyeda.preferences");if(t&&n&&r){n=Wa.c_paraToJson(n);r=B(r);var i=r&&r["eelib-package"]||{},a=n.package,o=i[t];a&&w(e,"package-default",a);if(a&&i&&o&&o!=a){n.package=o;n=Wa.jsonToC_para(n);w(e,"c_para",n)}}}(c);w(c,{c_etype:"pinpart"});a=L('g text[c_note="note_pre"]',c);if(a&&d){i=a.textContent;o=L('g text[c_note="note_name"]',a.parentNode.parentNode);o=o&&o.textContent;if(i.indexOf("?")>=0)/\.\d+$/.test(i)&&o&&(i={pre:i,name:o});else if(/\.\d+$/.test(i)){i=i.replace(/\d+(\D*\.\d+)$/,"?$1");o&&(i={pre:i,name:o})}else i=i.replace(/\d+(\D*)$/,"?$1");(i.pre||i).indexOf("?")>=0&&(a.textContent=ua.getNewPre(i))}if(a){i=a.textContent;var p,g,y,x,v,_,b=!1,S=Wa.c_paraToJson(w(c,"c_para"));if(/\.\d+$/.test(a.textContent)){var C,P=pn("getAllJson"),T=pn("getAllSchInProject");for(r=0;r<P.length;r++)if(!(T.length&&T.indexOf(P[r].tabid)<0)){C=P[r].json.schlib;var O,k,A,E=pn("getTabById",[P[r].fid]).contentWindow.document;for(var I in C)if(!(I.indexOf("frame_lib")>=0)){y=[],O={},k={},A={};for(_ in C[I].annotation)y.push(C[I].annotation[_]);y.forEach(function(e){"N"===e.mark&&(k=e);"P"===e.mark&&(O=e);"PK"===e.mark&&(A=e)});x=O.string.indexOf(".");v=i&&i.indexOf(".");if(x>=1&&v>=1&&O.string.substr(0,x)===i.substr(0,v)){0===k.visible&&w(An("name",c),"display","none");0===O.visible&&w(An("pre",c),"display","none");if(A.visible&&(!j(S,"Package Display")||"No"===S["Package Display"])){Ai(c,"Package Display","Yes");vi(c)}w(c,"puuid")!==C[I].head.puuid&&w(c,"puuid",C[I].head.puuid);w(c,"convert_to_pcb",C[I].head.convert_to_pcb);w(c,"add_into_bom",C[I].head.add_into_bom);p=E.getElementById(C[I].head.gId);S=JSON.parse(JSON.stringify(w(p,"c_para")));g=Wa.jsonToC_para(S);w(c,"c_para",g);b=!0;break}}if(!0===b)break}}}var D=!!L('[c_etype^="frame_"]',c);if(D){c.id="frame_lib_?";w(An("pre",c),"display","none");w(An("name",c),"display","none");xo.updateSheetText(c,{date:"?",product:"?"})}Rt(c);ha.updateOne(c);Sa.solveItem(c);Sa.solveTodoList();La.save(Sa.batHistoryCmd(["add",c.id]));if(D){this.end(!0)}"place_part(lib)"==va&&Un("mounted",c);this.checkNoConnectFlagPositon(e,t);this.checkSomeWiringPosition(e,t)}"place_part(lib)"==va&&"part_lib_sheet"==w(Co.target,"c_partid")&&(va="");if("place_part(lib)"==va&&u){va="";pn("openPalceModuleDlg")}this.cloneTemplate()}else{"none"==w(c,"display")&&w(c,"display","");Nn(c,e,t)}}},end:function(e){Tn(this.template.id);Co.target&&Co.target.parentNode&&!e&&Co.target.parentNode.removeChild(Co.target);m('[c_from="importDxf"]').forEach(function(e){M(e)});m("#gCurParts > g[subparts]").forEach(function(e){M(e)});Co.cancelNextName();this.template=null;lr()},checkNoConnectFlagPositon:function(e,t){if("place_part(no_connect_flag)"!==va)return!1;if(go.getPinByXY(e,t))return!0;if(go.checkNCFlagInBridgeWire(e,t))return!0;pn("messagerError",["No connect flag only can be placed on Pin dot or the wire which is connected one Pin."]);return!1},checkSomeWiringPosition:function(t,n){var r,i,a,o,s=go.getWireByXY(t,n),c=e.parent.Locale;if(!s)return!1;switch(va){case"place_part(busentry)":a="BusEntry";break;case"place_part(netLabel_volProbe)":a="Voltage Probe";break;case"place_part(netLabel_netPort)":a="Net Port";break;case"place_part(pin)":a="Pin";break;case"place_part(netLabel_text)":case"place_part(netLabel_gnD)":case"place_part(netLabel_GNd)":case"place_part(netLabel_+5V)":case"place_part(netLabel_VCC)":a="Net Label";break;default:return!1}a=c.i18n(a);a="zh-hans"===c._curr?a+"":a+" ";a+=c.i18n("can not be placed on the wire which is placing No Connect Flag.");r=s.points;i=r.length-1;go.getPinByXY(r[0].x,r[0].y)&&go.getNoConnectFlagByXY(r[i].x,r[i].y)&&(o=!0);go.getPinByXY(r[i].x,r[i].y)&&go.getNoConnectFlagByXY(r[0].x,r[0].y)&&(o=!0);o&&e.parent.$.messager.error(a);return!1}};La.records=[];La.timestamps=[];La._queueBatchRecords=[];La.maxLength=120;La.index=-1;La.savedIndex=-1;La.fileWaitingforSaving=!1;La.extraAttr="recover-uuid";La.enableLog=!0;La.logs=[];La.logsMaxLength=1e3;La.log=function(e,t){if(La.enableLog){var n={time:Date.now()};if("string"==typeof e){n.title=e;t&&(n.data=t)}else{if(!Array.isArray(e)||"string"!=typeof e[0])return;n.title=e[0];n.data=e[1]}var r=La.logs;r.push(n);r.length>La.logsMaxLength&&r.splice(0,2,{op:"...",time:Date.now()})}};La.log("begin");La.getLogs=function(){return{index:La.index,records:JSON.parse(JSON.stringify(La.records.map(La.recordToPlainObject))),logs:La.logsToPlainObject(La.logs)}};La.logsToPlainObject=function(e){function t(e){var t=de(e),n=e.id
;return(t||"<"+e.tagName+">")+(n?"#"+n:"")}return JSON.parse(JSON.stringify(e,function(e,n){return n instanceof Element?t(n):n}))};La.XMLSerializer=e.XMLSerializer?new XMLSerializer:{serializeToString:function(){}};La.DOMParser=e.DOMParser?new DOMParser:{parseFromString:function(){}};La.save=function(t,n){if(Array.isArray(t)){var r={};if(n&&"object"==typeof n){r=n;n=r.mergeSource}if("string"!=typeof n||!n){n="";La.lastMergeSource=""}r.mergeSource=n;r.title&&(r.time=Date.now());if(La.batchState)if(Array.isArray(t)&&Array.isArray(t[0])){[].push.apply(La._queueBatchRecords,t);La.joinLogInfoToRecord(t[0],r)}else{La._queueBatchRecords.push(t);La.joinLogInfoToRecord(t,r)}else{if(n&&n===La.lastMergeSource){var i=La.records[La.index],a=i[0],o=i[1],s=i[2];if(a===t[0]&&o===t[1]){La.records.pop();La.index--;t[2]=s}}else La.lastMergeSource=n||"";var c=La.records.length;if(La.index>=La.maxLength-1){La.records.shift();La.savedIndex>-1&&(La.savedIndex-=1)}else La.index++;La.joinLogInfoToRecord(t,r);La.timestamps[La.index]=Date.now();La.records[La.index]=t;La.records.length=La.index+1;var l=La.needSetUnSaved();(c>La.records.length||c==La.records.length&&c!=La.maxLength)&&(La.fileWaitingforSaving=!0);pn("triggerEvent",["history_change",La.records.length,La.index,l,La.fileWaitingforSaving]);var d=function(e,t){return e?e.split(",").map(function(e){var n;if("del"==t){var r=m("#"+e,qa);n=r.length?r[r.length-1]:L("#"+e,Ji)}else n=L("#"+e,Ji);return(n&&(de(n)||n.tagName)||"")+"#"+e}).join(","):""};La.walkRecord(t,function(e){var t=La.ids2elems(e[1]),n=e[0];t&&t[0]&&("del"!=n&&"add"!=n||1===t.length&&!e[2]&&Ji.contains(t[0])&&(e[2]=Wa.node.getRefId(t[0])));if("node"==n){e[11]=(de(e[2])||e[2].tagName||"")+"#"+e[2].id;e[12]=(de(e[3])||e[3].tagName||"")+"#"+e[3].id}else["add","del","attr","attrpanel","text","move","rotate"].includes(n)&&(e[11]=d(e[1],n))});if(Pa||e.checkJsonCache)try{ha.checkJsonCache()}catch(e){}var u=function(e){return"string"==typeof e[0]?e[0]:Array.isArray(e[0])?e.map(u).join(","):""},h=u(t);La.log([h||"History.save",t])}}else Wa.reportError(new Error("History.save :: first argument is not an array"))};La.walkRecord=function(e,t){Array.isArray(e[0])?e.forEach(t):t(e)};La.needSetUnSaved=function(){if(La.index!=La.savedIndex){for(var e=Math.min(La.index,La.savedIndex),t=Math.max(La.index,La.savedIndex),n=e+1;n<=t;n++){var r=La.records[n];if(!r||r&&void 0!==r[r.length-1]&&!r[r.length-1].notChangeSaveState)return!0}return!1}return!1};La.startBatch=function(e){La.batchState=La.batchState+1||1;La.log(e?["History.startBatch",e]:"History.startBatch")};La.endBatch=function(){La.batchState=La.batchState-1||0;La._queueBatchRecords.length=0};La.saveBatch=function(){La.batchState>0&&(La.batchState-=1);if(!La.batchState&&La._queueBatchRecords.length){La.save(La._queueBatchRecords.slice(0));La._queueBatchRecords.length=0}La.log("History.saveBatch")};La.clear=function(e){var t=e&&!1===e.saved;La.log("History.clear");La.timestamps.length=0;La.records.length=0;La.index=-1;La.savedIndex=t?-2:La.index;La.fileWaitingforSaving=t;La.batchState=void 0;pn("triggerEvent",["history_change",La.records.length,La.index,t,La.fileWaitingforSaving]);for(;qa.lastChild;)qa.removeChild(qa.lastChild)};La.goTo=function(e){var t;if(e>=-1&&e!==La.index&&e<La.records.length){if(e>La.index)for(t=La.index+1;t<=e;t++)La.doCmdBatch("redo",La.records[t]);else for(t=La.index;t>e;t--)La.doCmdBatch("undo",La.records[t]);La.index=e;var n=La.needSetUnSaved();pn("triggerEvent",["history_change",La.records.length,La.index,n,La.fileWaitingforSaving]);pn("triggerEvent",["select_change"])}};La.go=function(e){try{La.log(1===e?"redo":-1===e?"undo":"go("+e+")");La.goTo(La.index+e)}catch(e){Wa.reportError(e);var t=pn("isTabUnSaved");La.clear({saved:!t})}};La.doCmdBatch=function(e,t){function n(e){if(e){var t=w(e,"net");t&&i.nets.indexOf(t)<0&&i.nets.push(t);for(var n=m("[net]",e),r=0;r<n.length;r++){t=w(n[r],"net");t&&i.nets.indexOf(t)<0&&i.nets.push(t)}}}function r(t){var o,s,c;if(t&&W(t)&&t.length)if(W(t[0]))for(o=0,s=t.length;o<s;o++)r(t[o]);else{var l=t[1].split(","),d=La.getFilterAttr(t[3]);for(o=0,s=l.length;o<s;o++){"add"==t[0]&&"undo"==e||"del"==t[0]&&"redo"==e?i.removeIds.indexOf(l[o])<0&&i.removeIds.push(l[o]):i.updateIds.push(l[o]);if(a)if("add"==t[0]&&"redo"==e||"del"==t[0]&&"undo"==e){c=m("#"+l[o]+d,qa);c=c&&c.length&&c[c.length-1];n(c)}else if("node"==t[0]){c=L("#"+l[o],Ji);n(c);c="undo"==e?t[2]:t[3];n(c)}else if("attr"==t[0]&&("undo"==e&&t[2].net||"redo"==e&&t[3].net)){var u=[t[2].net,t[3].net];u.forEach(function(e){e&&i.nets.indexOf(e)<0&&i.nets.push(e)})}else{c=L("#"+l[o],Ji);n(c)}}}}var i={updateIds:[],removeIds:[],nets:[],copper:[]},a=wo==ia.PCB;r(t);!function(){var e,t,n,r=wo==ia.PCB;for(e=0,t=i.removeIds.length;e<t;e++){n=v(i.removeIds[e]);ha.gJsonCache.panelize&&"panelizedOutline"===w(n,"c_outlinetype")&&delete ha.gJsonCache.panelize;ha.removeOne(n)}if(r){var a=ratLineMgr.ignoreNextBuildRatline;ratLineMgr.ignoreNextBuildRatline=!1;i.nets.length&&ratLineMgr.buildGroupNets(i.nets,{async:!0});ratLineMgr.ignoreNextBuildRatline=a}}();"redo"==e?La.redoOne(t):La.undoOne(t);en();!function(){var e,t,n,r,a,o=[],s=[];for(e=0,t=i.updateIds.length;e<t;e++){n=v(i.updateIds[e]);r=de(n);a=wo==ia.PCB||wo==ia.PCBLIB?"TEXT":"text";"COPPERAREA"===r&&o.push(i.updateIds[e]);"PLANEZONE"===r&&s.push(i.updateIds[e]);r!=a||b(n.parentNode,$a)||(n=n.parentNode);if(n){n.tagName&&"circle"===n.tagName&&isNetCircleLayer(parseInt(w(n,"layerid")))&&circleToArcForJsonCatch(n);ha.updateOne(n,{notCopper:!0,notUpdateElement:!0,notRealtimeDRC:!0})}}var c,l=[];if(s.length){for(e=0;e<s.length;e++){c=ha.gJsonCache.PLANEZONE[s[e]];c&&c.layerid&&-1===l.indexOf(c.layerid)&&l.push(c.layerid)}copperAreaMgr.rebuildPlane(l)}}();a&&function(){wo==ia.PCB&&i.nets.length&&ratLineMgr.buildGroupNets(i.nets)}();a&&ratLineMgr.historyHandler()};La._undoRedos={};La.defineUndoRedo=function(e,t){La._undoRedos[e]=t};La.undoOne=function(e){if(W(e))if(W(e[0]))for(var t=e.length-1;t>=0;t--)e[t]&&La.undoOne(e[t]);else{var n=La._undoRedos[e[0]];n&&n.undo&&n.undo(e)}};La.redoOne=function(e){if(W(e))if(W(e[0]))e.forEach(La.redoOne);else{var t=La._undoRedos[e[0]];t&&t.redo&&t.redo(e)}};La.ids2elems=function(e){return e&&e!=Ji.id&&"config.colors"!=e&&"set.origin"!=e&&"set.target"!=e?m("#"+e.replace(/\,/g,",#"),Ji):[]};La.defineUndoRedo("add",{undo:function(e){var t,n,r;r=e[1].split(",");for(n=r.length;--n>=0;){t=v(r[n]);if(t){La.beforeAppend2Recover(t,e);qa.appendChild(t)}}},redo:function(e){var t,n,r,i,a,o,s;if("string"==typeof e[1]){var c=e[2];c&&"string"!=typeof c&&(c="");s=c&&/^</.test(c);o=(c||"").replace(/^</,"");a=o?v(o):null;i=e[1].split(",");var l=La.getFilterAttr(e[3]);for(n=0,r=i.length;n<r;n++){t=m("#"+i[n]+l,qa);t=t&&t.length&&t[t.length-1];if(t){la.unselect(t);a&&s?a.appendChild(t):a&&a.parentNode?a.parentNode.insertBefore(t,a):wo==ia.PCB||wo==ia.PCBLIB||wo==ia.WAVEFORM?Layer.appendElement(t):Ji.appendChild(t);La.updateCache(t,w(t,"net")||"")}}}}});La.defineUndoRedo("del",{undo:function(e){var t,n,r,i,a,o;o=e[2]&&/^</.test(e[2]);a=(e[2]||"").replace(/^</,"");i=a?L("#"+a,Ji):null;r=e[1].split(",");var s=La.getFilterAttr(e[3]);for(n=r.length;--n>=0;){t=m("#"+r[n]+s,qa);t=t&&t.length&&t[t.length-1];if(t){la.unselect(t);i&&o?i.appendChild(t):i&&i.parentNode?i.parentNode.insertBefore(t,i):wo==ia.PCB||wo==ia.PCBLIB||wo==ia.WAVEFORM?Layer.appendElement(t):Ji.appendChild(t);La.updateCache(t,w(t,"net")||"")}}},redo:function(e){var t,n,r;r=e[1].split(",");for(n=r.length;--n>=0;){t=m("#"+r[n]);t=t.length<=1?t[0]:L("#g1 > #"+r[n])||L('#g1 > *[id^="layer_"] > #'+r[n]);if(t){La.beforeAppend2Recover(t,e);qa.appendChild(t)}}}});La.defineUndoRedo("attr",{undo:function(e){var t,n,r,i,a,o="\0";if(e[1]!=Ji.id)if("panelize"!==e[1]){n=m("#"+e[1].replace(/\,/g,",#"),Ji);for(r=0;r<n.length;r++){t=n[r];if(t){if(wo==ia.PCB){i="net";a=w(t,i);a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");j(e[2],i)&&o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");j(e[3],i)&&o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}w(t,e[2]);La.updateCache(t,o)}}}else applyPanelize(e[2],!1);else w(Ji,e[2])},redo:function(e){var t,n,r,i,a,o="\0";if(e[1]!=Ji.id)if("panelize"!==e[1]){n=m("#"+e[1].replace(/\,/g,",#"),Ji);for(r=0;r<n.length;r++){t=n[r];if(t){if(wo==ia.PCB){i="net";a=w(t,i);a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");j(e[2],i)&&o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");j(e[3],i)&&o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}w(t,e[3]);La.updateCache(t,o)}}}else applyPanelize(e[3],!1);else w(Ji,e[3])}});La.defineUndoRedo("attrpanel",{undo:function(e){var t,n,r,i,a,o="\0";if(e[1]==Ji.id){Oi("canvas",e[2],{notHistory:!0});pn("updateAttrPanel")}else{n=m("#"+e[1].replace(/\,/g,",#"),Ji);for(r=0;r<n.length;r++){t=n[r];if(t){if(wo==ia.PCB){a=w(t,"net");a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");for(i in e[2])if(j(e[2],i)&&"-net"==i.substr(i.length-4)){o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}}Oi(t||e[1],e[2],{notHistory:!0});t&&La.updateCache(t,o)}}}},redo:function(e){var t,n,r,i,a,o="\0";if(e[1]==Ji.id){Oi("canvas",e[3],{notHistory:!0});pn("updateAttrPanel")}else{n=m("#"+e[1].replace(/\,/g,",#"),Ji);for(r=0;r<n.length;r++){t=n[r];if(t){if(wo==ia.PCB){a=w(t,"net");a&&o.indexOf("\0"+a+"\0")<0&&(o+=a+"\0");for(i in e[2])if(j(e[2],i)&&"-net"==i.substr(i.length-4)){o.indexOf("\0"+e[2][i]+"\0")<0&&(o+=e[2][i]+"\0");o.indexOf("\0"+e[3][i]+"\0")<0&&(o+=e[3][i]+"\0")}}Oi(t,e[3],{notHistory:!0});La.updateCache(t,o)}}}}});La.defineUndoRedo("node",{undo:function(e){var t,n,r,i="\0";t=v(e[1]);if(t){var a=Ji.id,o=e[2].cloneNode(!0);if(wo==ia.PCB&&t.id!==a){var s=w(o,"net"),c=w(t,"net");s&&i.indexOf("\0"+s+"\0")<0&&(i+=s+"\0");c&&i.indexOf("\0"+c+"\0")<0&&(i+=c+"\0")}la.unselect(t);t.parentNode.replaceChild(o,t);la.unselect(o);if(t.id===a){Ji=v(a);n=o.childNodes.filter(function(e){return la.isSelected(e)});r=n[0]&&n[0].id;pa=v(r)}else La.updateCache(o,i)}},redo:function(e){var t,n="\0";t=v(e[1]);if(t){var r=Ji.id,i=e[3].cloneNode(!0);if(wo==ia.PCB&&t.id!==r){var a=w(i,"net"),o=w(t,"net");a&&n.indexOf("\0"+a+"\0")<0&&(n+=a+"\0");o&&n.indexOf("\0"+o+"\0")<0&&(n+=o+"\0")}la.unselect(t);la.unselect(i);t.parentNode.replaceChild(i,t);if(t.id===r){Ji=v(r);var s=i.childNodes.filter(function(e){return la.isSelected(e)}),c=s[0]&&s[0].id;pa=v(c)}else La.updateCache(i,n)}}});La.defineUndoRedo("text",{undo:function(e){var t=v(e[1]);if(t&&e[2]){Nt(t,e[2]);La.updateCache(t)}},redo:function(e){var t=v(e[1]);if(t&&e[3]){Nt(t,e[3]);La.updateCache(t)}}});La.defineUndoRedo("move",{undo:function(e){var t=m("#"+e[1].replace(/\,/g,",#"),Ji);Ct(t,-e[2],-e[3],{hideBox:!0});La.updateCache(t)},redo:function(e){var t=m("#"+e[1].replace(/\,/g,",#"),Ji);Ct(t,e[2],e[3],{hideBox:!0});La.updateCache(t)}});La.defineUndoRedo("rotate",{undo:function(e){var t=m("#"+e[1].replace(/\,/g,",#"),Ji);Tr(t,Ue(-e[2]));La.updateCache(t)},redo:function(e){var t=m("#"+e[1].replace(/\,/g,",#"),Ji);Pr(t,e[2]);La.updateCache(t)}});La.defineUndoRedo("copperArea",{undo:function(e){},redo:function(e){}});La.defineUndoRedo("originXY",{undo:function(e){var t=e[2];if((t.offsetX||0===t.offsetX)&&(t.offsetY||0===t.offsetY)){var r={};r.x=ba.canvas.originX-t.offsetX;r.y=ba.canvas.originY-t.offsetY;n("setOriginXY",[{x:r.x,y:r.y}])}},redo:function(e){var t=e[2];if((t.offsetX||0===t.offsetX)&&(t.offsetY||0===t.offsetY)){var r={};r.x=ba.canvas.originX+t.offsetX;r.y=ba.canvas.originY+t.offsetY;n("setOriginXY",[{x:r.x,y:r.y}])}}});La.defineUndoRedo("elePosition",{undo:function(e){var t,n,r,i;e[0];i=e[1].split(",");n=e[2].split(",");for(r=i.length;--r>=0;){t=v(i[r]);t&&xe(t.parentNode,t,n[r])}},redo:function(e){var t,n,r,i;e[0];i=e[1].split(",");n=e[3].split(",");for(r=i.length;--r>=0;){t=v(i[r]);t&&xe(t.parentNode,t,n[r])}}});La.removeCache=function(e){};La.beforeAppend2Recover=function(e,t){var n=e&&e.id;if(n&&!w(e,La.extraAttr)&&W(t)){var r=m("#"+n,qa),i=m("* #"+n,qa);if(r.length!==i.length){var a=t[3]||ue();w(e,La.extraAttr,a);t[3]=a;return!0}}};La.getFilterAttr=function(e){var t=":not(["+La.extraAttr+"])";e&&(t="["+La.extraAttr+'="'+e+'"]');return t};La.updateCache=function(e,t){};La.canRedo=function(){return La.index<La.records.length-1};La.canUndo=function(e){return La.index>=0};La.allRecordsToString=function(){for(var e=[],t=0,n=La.records,r=n.length;t<r;t++)e[t]=La.recordToString(n[t]);return e};La.recordToString=function(e){if(!e||!e[0])return"";if(Array.isArray(e[0]))return La.recordToString(e[0])+(e.length>1?"...["+e.length+"]":"");if("string"!=typeof e[1])return e[0];var t=e[0],n="#"+e[1].replace(/\,/g,",#"),r=t+" : "+n;switch(t){case"add":case"del":e[2]&&(r+=" ; next_sibling : #"+e[2]);break;case"attr":case"attrpanel":r+=" ; old:"+JSON.stringify(e[2])+"; new:"+JSON.stringify(e[3]);break;case"node":break;case"text":r+=" ; old: "+ne(e[2])+"; new: "+ne(e[3]);break;case"move":r+=" ; dx:"+e[2]+"; dy:"+e[3];break;case"rotate":r+=" ; degree : "+e[2]}return r};La.recordToPlainObject=function(e,t){function n(e){if(!e)return"<null/>";var t;if(e.children[0]){t=La.XMLSerializer.serializeToString(e.cloneNode(!1));t=t.replace(/\/?>.*/,">...</"+e.tagName+">")}else t=La.XMLSerializer.serializeToString(e);t=t.replace(/ xmlns="[^"]*"/g,"");return t}function r(e){return e.split(",").map(function(e){if(!e)return"<null/>";try{var t=e==Ji.id?Ji:Ji.querySelector("#"+e);return t?n(t):"<null/>"}catch(e){return"<ERROR/>"}})}function i(e){for(var t,r=e.split(","),i=[],a=0,o=r.length;a<o;a++)if(r[a]){t=m("#"+r[a],qa);t=t&&t.length&&t[t.length-1];if(t)try{i.push(n(t))}catch(e){i.push("<null/>")}else i.push("<null/>")}else i.push("<null/>");return i}function a(e){if(Array.isArray(e[0]))return e.map(a);var t=e.slice(),o=t[0];if("node"==o){t[2]=n(t[2]);t[3]=n(t[3])}else"add"==o?t.push(r(t[1])):"del"==o&&t.push(i(t[1]));return t}return e&&e[0]&&Array.isArray(e)?a(e):""};La.joinLogInfoToRecord=function(e,t){e&&t&&t.title&&Array.isArray(e)&&(Array.isArray(e[0])?"log"!==e[0][0]&&(e[0][10]=t):"log"!==e[0]&&(e[10]=t))};Pi.prototype.deleteItemAt=function(e){this.hist.splice(e,1);this.nodes.splice(e,1)};Pi.prototype.update=function(){for(var e=this.hist,t=this.nodes,n=0,r=t.length;n<r;n++)e[n][3]=t[n].cloneNode(!0)};Pi.prototype.updateAndSave=function(){this.update();this.hist.length>0&&La.save(this.hist)};Pi.prototype.findIndexWithId=function(e,t){if(["hist","nodes"].indexOf(t)<=-1)return-1;var n=-1;if("hist"===t){for(var r=0;r<this.hist.length;r++)if(this.hist[r].length&&this.hist[r][1]===e){n=r;break}return n}for(var r=0;r<this.nodes.length;r++)if(this.nodes[r]&&this.nodes[r].id===e){n=r;break}return n};ha.eleCacheUpdate=function(e){Le(wo)&&("schlib"==e||"busentry"==e||"netflag"==e?ha._rebuildDotsCache():"junction"==e?ha._rebuildJunctionsCache():"wire"==e&&ha._rebuildWiresCache())};ha.ifFind=function(e,t){var n,r={type:"",X:0,Y:0},i=[],a=new x(e,t),o=fo.getSanpSize("X")/2;for(n in ha.dots){if(e==ha.dots[n].x&&t==ha.dots[n].y){r.type=1;r.X=e;r.Y=t;return r}if(Math.abs(e-ha.dots[n].x)<=o&&Math.abs(t-ha.dots[n].y)<=o){r.type=2;r.X=ha.dots[n].x;r.Y=ha.dots[n].y;return r}}for(n in ha.wires)if(j(ha.wires,n)){i=ha.wires[n];var s=Ee(a,i,4);if(s){r.type=3;r.X=parseInt(s.point.x,10);r.Y=parseInt(s.point.y,10);r.wireId=n;return r}}return r};ha.checkShow=function(e,t){var n=v("pdot0"),r=ha.ifFind(e,t),i="none"!=w(n,"display");r.type?3==r.type?i&&w(n,"display","none"):w(n,{display:"",cx:r.X,cy:r.Y}):i&&w(n,"display","none")};ha.getPinDots=function(e){if(e){for(var t,n=m("circle.pindot",e),r=[],i=0;i<n.length;i++){t=n[i];r.push(t.cx.baseVal.value,t.cy.baseVal.value)}return r}return ha.dots};ha.getWires=function(e){return e?ha.wires[e]:ha.wires};ha.getNoConnectFlags=function(e){if(ha.gJsonCache&&ha.gJsonCache.noconnectflag){return e?ha.gJsonCache.noconnectflag[e]:ha.gJsonCache.noconnectflag}};ha.hasJunctionAtXY=function(e,t){var n=ha.junctions,r=!1;for(var i in n)if(j(n,i)&&e==n[i].x&&t==n[i].y){r=!0;break}return r};ha.removeOne=function(e){if(e){"image"===e.tagName&&e.parentNode&&"part_image"===w(e.parentNode,"c_partid")&&(e=e.parentNode);var t=w(e,"id"),n=de(e),r=ha.gJsonCache[n];e.parentNode&&e.parentNode.id.indexOf("frame_lib_")>-1&&(r=ha.gJsonCache.schlib[e.parentNode.id][n]);if(r){delete r[t];ha.eleCacheUpdate(n)}}};ha.removeAll=function(){ha.wires={};ha.dots={};ha.junctions={};var e={head:1,canvas:1,BBox:1,zoom:1,itemOrder:1,importFlag:1,title:1};ha.gJsonCache.itemOrder=[];for(var t in ha.gJsonCache)!j(ha.gJsonCache,t)||t in e||(ha.gJsonCache[t]={})};ha.updateOne=function(e,t){if(e&&(!e.parentNode||"gCurParts"!=e.parentNode.id)&&e.tagName&&Ji.contains(e)){e=Mn(e);if(e&&1===e.nodeType){var n=w(e,"id"),r=de(e);if(Mo[r]){var i=Mo.toObj(e);ha.gJsonCache[r]||(ha.gJsonCache[r]={});ha.gJsonCache[r][n]=i;(!t||!t.batch)&&ha.eleCacheUpdate(r)}}}};ha.updateMore=function(e){if(e&&e.length){for(var t=0,n=e.length;t<n;t++)ha.updateOne(e[t],{batch:!0});Le(wo)&&ha.rebuildAllCache()}};ha.calAll=function(){for(var e=Ji.children,t={},n=[],r=0,i=e.length;r<i;r++){var a=e[r].id;if(a){t[a]=(t[a]||0)+1;n.push(a);try{ha.updateOne(e[r],{batch:!0})}catch(e){}}}for(var o=["annotation","pin","junction","busentry","netlabel","netflag","schlib","arrowhead","noconnectflag","svgnode","pimage","wire","bus","arc","path","polyline","rect","image","circle","ellipse","line","polygon"],r=0;r<o.length;r++){var s=o[r],c=ha.gJsonCache[s];if(c)for(var l=Object.keys(c),d=0;d<l.length;d++){var a=l[d];t[a]||delete c[a]}}ha.gJsonCache.itemOrder=n;Le(wo)&&ha.rebuildAllCache()};ha.fixedJsonCache=function(){Me(ha.gJsonCache,ha.update_cmdKeys);var e=m(ha.update_selector);e=nr(e);ha.updateMore(e)};ha.rebuildAllCache=function(){if(Le(wo)){ha._rebuildDotsCache();ha._rebuildJunctionsCache();ha._rebuildWiresCache()}};ha._rebuildWiresCache=function(){ha.wires={};if(ha.gJsonCache.wire)for(var e in ha.gJsonCache.wire)if(j(ha.gJsonCache.wire,e)){ha.wires[e]=ha.gJsonCache.wire[e].pointArr;ha.wires[e]||delete ha.wires[e]}};ha._rebuildDotsCache=function(){ha.dots={};var e,t,n;if(ha.gJsonCache.schlib)for(e in ha.gJsonCache.schlib)if(j(ha.gJsonCache.schlib,e)){t=ha.gJsonCache.schlib[e];if(!t||!t.pin)continue;for(n in t.pin)j(t.pin,n)&&"show"==t.pin[n].configure.display&&(ha.dots[e+"_"+n]=t.pin[n].pinDot)}if(ha.gJsonCache.busentry)for(e in ha.gJsonCache.busentry)if(j(ha.gJsonCache.busentry,e)){t=ha.gJsonCache.busentry[e];ha.dots[e+"_0"]={x:+t.x1,y:+t.y1};ha.dots[e+"_1"]={x:+t.x2,y:+t.y2}}if(ha.gJsonCache.netflag)for(e in ha.gJsonCache.netflag)if(j(ha.gJsonCache.netflag,e)){t=ha.gJsonCache.netflag[e];ha.dots[e+"_0"]=t.pinDot}};ha._rebuildJunctionsCache=function(){ha.junctions={};var e,t;if(ha.gJsonCache.junction)for(e in ha.gJsonCache.junction)if(j(ha.gJsonCache.junction,e)){t=ha.gJsonCache.junction[e];ha.junctions[e]=t.pinDot}};!function(){var e,t={schlib:'#g1 > g[c_partid^="part_lib"]',wire:'#g1 > polyline[c_etype="wire"]'},n="",r=[];for(e in t){r.push(e);t[e]&&(n+=t[e]+",")}n=n.slice(0,n.length-1);ha.check_selector=n;ha.check_cmdKeys=r}();!function(){var e,t={schlib:'#g1 > g[c_partid^="part_lib"]',wire:'#g1 > polyline[c_etype="wire"]'},n=[],r="";for(e in t){n.push(e);t[e]&&(r+=t[e]+",")}r=r.slice(0,r.length-1);ha.update_selector=r;ha.update_cmdKeys=n}();var Mo={toObj:function(e){if(!e)return!1;var t=de(e);return!!Mo[t]&&Mo[t](e)},_lineCommonObj:function(e){var t=1===e.nodeType?Tt(e):e;return{gId:t.id,strokeColor:t.stroke,strokeWidth:t["stroke-width"],strokeStyle:Ri(t["stroke-dasharray"]),fillColor:t.fill||"",locked:t.locked||0}},polyline:function(e){var t=Tt(e),n=Mo._lineCommonObj(t);n.pointArr=z(t.points);return n.pointArr.length>=2&&n},wire:function(e){return Mo.polyline(e)},bus:function(e){return Mo.polyline(e)},rect:function(e){if("hitbox"!=e.className.baseVal){var t=Tt(e),n=Mo._lineCommonObj(t);n.x=t.x;n.y=t.y;n.rx=t.rx||"";n.ry=t.ry||"";n.width=t.width;n.height=t.height;n.c_etype=t.c_etype||"";return n}},image:function(e){var t=Tt(e),n=Ve(e);n&&(n=360-n);return{gId:t.id,x:t.x,y:t.y,width:t.width,height:t.height,rotation:n,href:q((t["xlink:href"]||t.href).replace(/~/g,"%7E")),locked:t.locked||0,transform:t.transform}},circle:function(e){var t=Tt(e),n=Mo._lineCommonObj(t);n.cx=t.cx;n.cy=t.cy;n.r=t.r||1;return n},ellipse:function(e){var t=Tt(e),n=Mo._lineCommonObj(t);n.cx=t.cx;n.cy=t.cy;n.rx=t.rx||1;n.ry=t.ry||1;return n},line:function(e){var t=Tt(e),n=Mo._lineCommonObj(t);n.x1=t.x1||1;n.y1=t.y1||1;n.x2=t.x2||1;n.y2=t.y2||1;return n},polygon:function(e){return Mo.polyline(e)},path:function(e){var t=Tt(e),n=Mo._lineCommonObj(t);n.pathString=t.d;n.c_etype=t.c_etype||"";return n},arc:function(e){var t=Mo.path(e);t.helperDots="";return t},annotation:function(e){var t=Tt(e.childNodes[0]),n="L";if(!t)return!1;"note_name"==t.c_note?n="N":"note_pre"==t.c_note?n="P":"note_package"==t.c_note&&(n="PK");var r=Ve(e.childNodes[0]),i=w(e,"display"),a=Pt(e.childNodes[0],"\\n")||"";a=ee(a);"P"==n&&(a=a.toUpperCase());if(!a){if("N"!=n&&"P"!=n)return!1;a=" "}return{gId:e.id,mark:n,x:t.x,y:t.y,rotation:r,fillColor:t.fill||"",fontFamily:Vi(t["font-family"]),fontSize:Gi(t["font-size"]),fontWeight:t["font-weight"]||"",fontStyle:t["font-style"]||"",dominantBaseline:t["dominant-baseline"]||"",type:t.type||"comment",string:a,visible:"none"==i?0:1,textAnchor:t["text-anchor"],locked:w(e,"locked")||0,c_etype:w(e,"c_etype")||""}},pimage:function(e){var t=Tt(e.childNodes[0]),n="L";if(!t)return!1;"note_name"==t.c_note?n="N":"note_pre"==t.c_note&&(n="P");var r=(Ve(e.childNodes[0]),w(e,"display")),i=Mo.image(e.childNodes[0]);return{gId:e.id,mark:n,visible:"none"==r?0:1,locked:i.locked||0,imgid:i.gId,imgx:i.x,imgy:i.y,imgwidth:i.width,imgheight:i.height,imghref:q((i["xlink:href"]||i.href).replace(/~/g,"%7E"))}},pin:function(e){return{configure:function(e){var t=Tt(e),n=t.c_origin.split(",");return{display:t.c_show,electric:t.c_elec,spicePin:ee(t.c_spicepin),x:n[0]||0,y:n[1]||0,rotation:t.c_rotation,gId:t.id,locked:t.locked||0}},pinDot:function(e){var t=Tt(e);return new x(t.cx,t.cy)},path:function(e){var t=Tt(e);return{pathString:X(t.d),pinColor:t.stroke}},name:function(e){var t=Tt(e);return{visible:"none"==t.display?0:1,x:t.x,y:t.y,rotation:Ve(e),text:re(e.textContent),textAnchor:t["text-anchor"],fontFamily:Vi(t["font-family"]),fontSize:Gi(t["font-size"]),fillColor:t.fill}},num:function(e){e.textContent=re(e.textContent);return this.name(e)},dot:function(e){if(!e)return{};var t=Tt(e);return{visible:"none"==t.display?0:1,x:t.cx||0,y:t.cy||0}},clock:function(e){if(!e)return{};var t=Tt(e);return{visible:"none"==t.display?0:1,pathString:t.d||""}},all:function(e){return{configure:this.configure(e),pinDot:this.pinDot(e.childNodes[2]),path:this.path(e.childNodes[3]),name:this.name(e.childNodes[0]),num:this.num(e.childNodes[1]),dot:this.dot(e.childNodes[4]),clock:this.clock(e.childNodes[5])}}}.all(e)},junction:function(e){var t=Tt(e.childNodes[1]);return{pinDot:new x(t.cx,t.cy),r:t.r||1,fillColor:t.fill,gId:e.id,locked:t.locked||0}},netlabel:function(e){var t=L("text",e),n=Ve(t),r=Tt(t),i=Tt(L("circle",e)),a=t.textContent,o=e.children;if(!a||!a.replace(/(^\s*)|(\s*$)/g,""))for(var s=0;s<o.length;s++)if(o[s]&&"TEXT"===o[s].nodeName.toUpperCase()){a=o[s].textContent;r=Tt(o[s]);break}return{gId:e.id,pinDot:new x(i.cx,i.cy),rotation:n,fillColor:r.fill||"#000080",name:ee(q(a)),textAnchor:r["text-anchor"],x:r.x,y:r.y,fontFamily:r["font-family"],fontSize:r["font-size"],locked:w(e,"locked")||0}},netflag:function(e){return{configure:function(e){var t=Tt(e),n=t.c_origin.split(",");return{gId:t.id,partId:t.c_partid,x:n[0]||0,y:n[1]||0,rotation:t.c_rotation||"0",locked:t.locked||0}},pinDot:function(e){var t=Tt(e);return new x(t.cx,t.cy)},mark:function(e){var t="part_annotation"===w(e,"c_partid")?L("text",e):e,n={};t&&(n=Tt(t));var r=(n.transform||"").match(/^rotate.\-?\d+/)||"0";r="0"==r?"0":(r+"").replace("rotate(","");return{netFlagString:(ee(q(e.textContent))||"").trim(),fillColor:n.fill||"",x:n.x||0,y:n.y||0,rotation:r,textAnchor:n["text-anchor"]||"",visible:"none"==w(e,"display")?0:1,fontFamily:Vi(n["font-family"]||""),fontSize:Gi(n["font-size"]||""),gId:e.id}},all:function(e){for(var t=e.childNodes.length,n=L("circle",e),r=L("g",e),i={configure:this.configure(e),pinDot:this.pinDot(n),mark:this.mark(r),shapes:{}},a=2;a<t;a++){var o=e.childNodes[a];if(3!=o.nodeType){var s=Mo.toObj(o),c=de(o);if(s){i.shapes[c]||(i.shapes[c]={});i.shapes[c][s.gId]=s}}}return i}}.all(e)},busentry:function(e){var t=w(e,"c_rotation")||"0",n=Tt(e.childNodes[2]);return{gId:e.id,x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,rotation:t,locked:w(e,"locked")||0}},schlib:function(e){for(var t=e.childNodes,n=Tt(e),r=n.c_origin.split(","),i={head:{gId:e.id,x:r[0]||0,y:r[1]||1,c_para:n.c_para,rotation:n.c_rotation,importFlag:0,puuid:n.puuid,uuid:n.uuid,locked:n.locked||0,bind_pcb_id:n.bind_pcb_id||"",convert_to_pcb:n.convert_to_pcb||"yes",add_into_bom:n.add_into_bom||"yes"},itemOrder:[]},a=0,o=t.length;a<o;a++){var s=t[a];if(3!=s.nodeType){var c=Mo.toObj(s),l=de(s);if(c){i[l]||(i[l]={});var d="pin"==l?c.configure.gId:c.gId;i[l][d]=c;i.itemOrder.push(d)}}}return i},arrowhead:function(e){var t=Tt(e),n=t.c_origin.split(",");return{partType:t.c_partid,x:n[0]||0,y:n[1]||1,gId:t.id,rotation:t.c_rotation,pathString:w(e.childNodes[0],"d"),fillColor:w(e.childNodes[0],"fill")||"",locked:t.locked||0,arrowtype:t.arrowtype||"3",arrowsize:t.arrowsize||15}},noconnectflag:function(e){var t=Tt(e),n=t.c_origin.split(",");return{x:n[0]||0,y:n[1]||1,gId:t.id,pathString:w(e.childNodes[0],"d"),strokeColor:w(e.childNodes[0],"stroke")||"",locked:t.locked||0}},svgnode:function(e){if(1===e.nodeType){var t=Tt(e),n={gId:t.id,nodeName:e.nodeName,nodeType:e.nodeType};delete t.class;delete t.xmlns;n.attrs=t;var r=0,i=e.childNodes,a=i.length;if(a){n.childNodes=[];for(;r<a;r++)n.childNodes[r]=Mo.svgnode(i[r])}return n}return{nodeName:e.nodeName,nodeType:e.nodeType,nodeValue:e.nodeValue}}},wo=e.frameElement?e.frameElement.getAttribute("c_doctype"):ia.SCH,No=pn("isSpiceMode");if(me(wo)||wo==ia.SCHMODULE){ba.canvas.originX=0;ba.canvas.originY=0;ba.adsorbGrid.gridSize=5;ba.adsorbGrid.distanceX=5;ba.adsorbGrid.distanceY=5}!function(){e.doctype=wo;n.registerHook(ai());e.addEventListener("error",Wa.reportError,!1);pn("triggerEvent",["history_change",0,-1,!0]);ei()}();n.registerHook(function(){return{setColors:ji,getSpiceImage:function(){var t,n=fa.cloneNode(),r=Ji.cloneNode(!0);n.appendChild(r);t=unescape(encodeURIComponent((new XMLSerializer).serializeToString(n)));return"data:image/svg+xml;base64,"+e.btoa(t)},getWaveFormObj:function(){Ma.removePlotData();return Ja},setWaveFormObj:function(e){Ja=e;Ma.ini();Ma.rebuild()},getWaveFormCSV:function(){return Yi()},getSVG:function(e){var t=ba.canvas.bgcolor,r=n("getBBox"),i=e||50,a=r.x-i|0,o=r.y-i|0,s=0|Math.max(r.width+2*i,100),c=0|Math.max(r.height+2*i,100);return'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+s+'" height="'+c+'" viewBox="'+a+" "+o+" "+s+" "+c+'"><title>'+ne(pn("getTitle"))+'</title><style type="text/css">\npath, polyline, polygon {stroke-linejoin:round;}\npath, polyline, polygon, line {stroke-linecap:round;}\n</style>\n<rect x="'+a+'" y="'+o+'" width="'+s+'" height="'+c+'" fill="'+t+'" stroke="none"/>'+function(){if("undefined"!=typeof XMLSerializer){var e=(new XMLSerializer).serializeToString(Ji);e.search(/[^\x00-\x7f]/)>=0&&(e=e.replace(/[^\x00-\x7f]/g,function(e){return"&#"+e.charCodeAt(0)+";"}));e=e.replace(/<circle [^>]*c_pindot="true"[^>]*(?:\/>|><\/circle>)/g,"").replace(/<rect [^>]*class="hitbox"[^>]*(?:\/>|><\/rect>)/g,"").replace(/<g(\s[^>]*)?\/>/g,"").replace(/ xmlns="http:\/\/www\.w3\.org\/2000\/svg"/g,"").replace(/ xmlns:xlink="http:\/\/www\.w3\.org\/1999\/xlink"/g,"");for(var t=["id","class","title","net","number","c_\\w+"],n=0;n<t.length;n++)for(var r=new RegExp("(<\\w+[^>]*)\\s"+t[n]+'=\\"[^\\"]*\\"',"g");r.test(e);)e=e.replace(r,"$1");e=e.replace(/<g\s*>\s*<\/g>/g,"");e=e.replace(/( xlink:href=")(\/\/)/g,"$1"+location.protocol+"$2");e=e.replace(/( xlink:href=")(\/[^\/"][^"]*)/g,"$1"+location.protocol+"//"+location.host+"$2");return e}return"gCanvasToXML error! "}()+"</svg>"},crossProbe:function(e){function t(){w(v("gMarkError"),"visibility","hidden");Sn(!1);wa.markPinTimer=0}function n(e,n){var r=wo==ia.PCB||wo==ia.PCBMODULE;w(v("gMarkError"),{cx:e,cy:n,visibility:"yes","stroke-width":1.5/Za});if(r){Bt({x:e,y:n},20);"#FFFFFF"==ha.gJsonCache.backGround?Sn(e,n,{strokeWidth:"2",strokeLinecap:"square"}):Sn(e,n,{stroke:"#FFFFFF",strokeWidth:"2",strokeLinecap:"square"})}else{Et(e,n);Sn(e,n,{strokeWidth:"2",strokeLinecap:"square"})}wa.markPinTimer&&clearTimeout(wa.markPinTimer);wa.markPinTimer=setTimeout(t,1e3)}var r=e.selectObjPrefixs||[],i=e.selectedObjWireNetNodes||{},a=e.selectObjPadNets||{},o=r&&r.length>0;en();if(o||i&&0!==Object.keys(i).length||a&&0!==Object.keys(a).length){for(var s,c=[],l=[],d=0;d<r.length;d++){var u=r[d].pre;u=u.toUpperCase();s=null;for(var h,f=m('#g1 text[c_note="note_pre"]',Ji),p=0;p<f.length;p++){h=f[p].textContent;h=X(h||"").toUpperCase();if(h==u){s=f[p].parentNode.parentNode;l.push(s);break}if(h.split(".")[0]==u&&c.indexOf(h)<0){r.push({pre:h});c.push(h)}}s&&la.select(s)}var g=l.length;for(var y in i){var x=i[y];for(p=0;p<x.length;p++){var L=x[p].gId;if(L){s=v(L,Ji);if(s){la.select(s);l.push(s);"wire"==de(s)&&S(s,"designManager_selected")}}}}for(u in a){var _=ha.gJsonCache.schlib;u=u.toUpperCase();for(var b in _)if(!b.match(/frame_lib_/)){var C=_[b],M=C?C.annotation:"";if(M)for(var N in M)if(j(M,N)){var P=M[N];if("P"==P.mark&&(P.string==u||P.string.split(".")[0]==u)){var T=C.pin;for(var O in T)if(j(T,O)&&T[O].num&&T[O].num.text==a[u]){Ln({pin:{gId:O}});l.push(v(O))}}}}}if(1===l.length){kt(s);1===g&&function(e){var t=Lt(e);t&&n(t.x,t.y)}(l[0])}else if(l.length>1){var k=l.map(function(e){return Wa.svg.getBBox(e)}),A=Wa.combineMultiBox(k);A&&At(A)}pn("triggerEvent",["select_change"])}else pn("triggerEvent",["select_change"])},rotate:function(){var e=Ea&&Ea.start||Qa.pasting,t=e;if(!ii()||e){var n,r,i,a,o,s=arguments[0];if("number"==typeof s)r=s;else if("string"==typeof s)isNaN(+s)||(r=+s);else if("object"==typeof s&&s.ids){a=s.ids;r=s.degree;if(!Array.isArray(a))return}void 0===r&&(r=270);if(a){n=a.map(function(e){return v(e)});n=n.filter(function(e){return e&&b(e.parentNode,$a)});if(n.length){o=new Pi(n);Tr(n,r);o.update();!t&&La.save(Sa.batHistoryCmd(o.hist));pn("updateAttrPanel")}}else if("draw(image)"==va&&Co.target)ft(Co.target,r);else if(ma&&va&&0===va.indexOf("place_part(")){var c=va.substr(6),l=v(c);Co.target&&Pr([Co.target],r);l&&Pr([l],r)}else{if(!Qa.pasting){if(pa){var d=pa,u=de(d),h=gr(d);if("annotation"==u&&!b(h,$a)){if(po.isLocked(h))return;la.unselect(d);Tr([d],r);!t&&La.save(["rotate",d.id,r]);la.select(d);if(!e){var f=ki(d);pn("noneselected");pn("show_attrpanel",[f])}return}}n=Zt().filter(function(e){return!po.isLocked(e)});if(n.length){if(t)Tr(n,r);else{o=new Pi(n);Tr(n,r);o.update();La.save(Sa.batHistoryCmd(o.hist))}pn("updateAttrPanel");return!0}return!1}n=Qa.targets;if(n.length>1){i=Wa.svg.getElementsCenter(n,!0);lo.rotate(n,r,i.x,i.y)}else lo.rotate(n,r)}}},delete:function(){if(Co.started&&Co.canBackStep())Co.backStep();else if(!ii()){var e,t,n,r=arguments[0],i=arguments[1];if(!i){pn("delete",[r,!0]);return}if("object"==typeof r){if(r.ids){e=r.ids;if(!Array.isArray(e))return;t=e.map(function(e){return v(e)})}else r.target&&(t=r.target);r.force&&(n=r.force);t=t.filter(function(e){var t=w(e.firstChild,"c_note"),n="schlib"===de(e.parentNode)&&("note_name"===t||"note_pre"===t||"note_package"===t),r="netflag"===de(e.parentNode)&&"note_netflag"===t;return e&&(b(e.parentNode,$a)||n||r)});t.length&&Lr(pa?t:null,n)}else Lr()}},globalDelete:function(e){var t,n=[];e.deleteComponents&&(t=ha.gJsonCache.schlib)&&(n=n.concat(Object.keys(t).map(function(e){return v(e)}).filter(function(e){return!T(e)})));e.deleteTexts&&(t=ha.gJsonCache.annotation)&&(n=n.concat(Object.keys(t).map(function(e){return v(e)})));if(e.deleteWires){t=ha.gJsonCache.wire;t&&(n=n.concat(Object.keys(t).map(function(e){return v(e)})))
;t=ha.gJsonCache.bus;t&&(n=n.concat(Object.keys(t).map(function(e){return v(e)})));t=ha.gJsonCache.busentry;t&&(n=n.concat(Object.keys(t).map(function(e){return v(e)})));t=ha.gJsonCache.noconnectflag;t&&(n=n.concat(Object.keys(t).map(function(e){return v(e)})))}if(e.deleteNetlabelAndnetFlag){var r=ha.gJsonCache.netflag,i=ha.gJsonCache.netlabel;r&&(n=n.concat(Object.keys(r).map(function(e){return v(e)})));i&&(n=n.concat(Object.keys(i).map(function(e){return v(e)})))}if(e.deleteDrawings){var a=ha.gJsonCache.arc,o=ha.gJsonCache.arrowhead,s=ha.gJsonCache.ellipse,c=ha.gJsonCache.image,l=ha.gJsonCache.path,d=ha.gJsonCache.polygon,u=ha.gJsonCache.polyline,h=ha.gJsonCache.rect,f=ha.gJsonCache.pin,p=ha.gJsonCache.schlib;a&&(n=n.concat(Object.keys(a).map(function(e){return v(e)})));p&&(n=n.concat(Object.keys(p).filter(function(e){return e.match(/frame_lib_/)}).map(function(e){return v(e)})));o&&(n=n.concat(Object.keys(o).map(function(e){return v(e)})));s&&(n=n.concat(Object.keys(s).map(function(e){return v(e)})));c&&(n=n.concat(Object.keys(c).map(function(e){return v(e)})));l&&(n=n.concat(Object.keys(l).map(function(e){return v(e)})));d&&(n=n.concat(Object.keys(d).map(function(e){return v(e)})));u&&(n=n.concat(Object.keys(u).map(function(e){return v(e)})));h&&(n=n.concat(Object.keys(h).map(function(e){return v(e)})));f&&(n=n.concat(Object.keys(f).map(function(e){return v(e)})))}n.length&&Lr(n)},getPinNextText:function(){if(Co.target)return{name:L("text[c_pinname]",Co.target).textContent,number:L("text[c_pinnumber]",Co.target).textContent}},removeEmptyNetLabel:function(e){var t=v(e);M(t);ha.removeOne(t)},getAllPrefixNames:function(){var e=ha.gJsonCache.schlib||{},t=[];for(var n in e)if(j(e,n)&&!/^frame_lib_/.test(n)){var r=e[n],i=r.annotation,a="",o="";for(var s in i)if(j(i,s)){var c=i[s];"P"==c.mark?a=c.string.toUpperCase():"N"==c.mark&&(o=c.string);if(a&&o)break}a&&t.push({name:o,pre:a})}return t},getSelectPrefixNamesAndNetNames:function(e){e=e||{};var t=Zt(),n=ha.gJsonCache.schlib||{},r=ha.gJsonCache.wire||{},i={prefixNames:[],wireNetNames:[]};if(n||r){for(var a=[],o=0;o<t.length;o++){var s=t[o].id;if(n[s]){var c=n[s],l=c.annotation;for(var d in l)if(j(l,d)){var u=l[d];"P"==u.mark&&i.prefixNames.push({pre:u.string.split(".")[0],rotation:c.head.rotation,x:c.head.x,y:c.head.y})}}else if(r[s]&&!e.onlyPrefix){c=r[s];c.pointArr&&c.pointArr[0]&&a.push(c.pointArr[0])}}if(a.length)for(var h=pn("getWireNetName",[a])||[],f=i.wireNetNames,o=0;o<h.length;o++)h[o]&&f.indexOf(h[o])<0&&f.push(h[o])}return i},HasSimualtionAnalyse:function(){for(var e=["AC","dc","DISTO","NOISE","op","pz","SENS","TF","TRAN","PSS"],t=0,n=0;n<e.length;n++)Yr(e[n])&&t++;return t},getPinMapInfo:function(){return Gr.apply(null,arguments)},getSheetInfo:function(){return xo.getSheetInfo()},getSymbolInfo:function(){return Fr()},hasGround:function(){for(var e=m("g[c_partid^=part_netLabel_]",Ji),t=e.length,n=!1,r=0;r<t;r++){var i=w(e[r],"c_partid")||"";if(/part_netLabel_gnd/i.test(i)){n=!0;break}if("part_netLabel_text"==i&&2==e[r].childNodes.length&&/gnd/i.test(e[r].childNodes[1].textContent))return!0}return n},hasProbe:function(){return!!(Hr().length||Ur()||Yr("probe"))},spiceLimit:function(){return i()},modifyTextById:function(e,t){var n=v(e);if(n){var r=n.cloneNode(!0);Ei(n,t,function(){var e=n.cloneNode(!0);ha.updateOne(n);La.save(["node",n.id,r,e])})}},modifyName:function(e){var t=w(Ji,"c_para")||"`name``";t=t.replace("`name``","`name`"+e+"`");w(Ji,"c_para",t)},getNetLabelOfPlacingElement:function(){return Co.target.children[1].textContent||""},annotion:function(e){return ua.annotion(e)},getSchThemeConfig:function(){return e.schTheme?Wa.extend({},schTheme):null},storeImageData:function(e){da=e},isSubPart:function(e){return Kr(e)},createSpiceCmdOntoCanvas:function(e){a(e)},getSpicePrefixByName:o,showResultInPartObj:function(e){oo.showResult(e)},showMovingResult:function(e){oo.showMovingResult(e)},getSpiceCycle:function(){return s()},initSpiceObj:function(e,t,n){return g(e,t,n)},findShape:function(e){if(e)return gr(v(e))},getViewBox:function(){return So.getViewBox()},updatePackageAndPin:function(e){La.startBatch();var t,n,r,i,a,o,s;if(e.pin)for(t in e.pin)if(j(e.pin,t)){n=v(t);i=y(n);if(j(e.pin[t],"name")){r=L("text[c_pinname]",n);r.textContent=e.pin[t].name;w(r,"c_pinname",e.pin[t].name);ha.updateOne(n)}if(j(e.pin[t],"num")){r=L("text[c_pinnumber]",n);r.textContent=e.pin[t].num;w(r,"c_pinnumber",e.pin[t].num);w(n,"c_spicepin",e.pin[t].num);ha.updateOne(n)}La.save(["node",t,i,n])}if(e.packageObj)for(t in e.packageObj)if(j(e.packageObj,t)&&e.packageObj[t].package){a=v(t);i=y(a);o=w(a,"c_para");s=Wa.c_paraToJson(o);s.package=e.packageObj[t].package;"Yes"===s["Package Display"]&&(L('[c_note="note_package"]',a).textContent=e.packageObj[t].package);w(a,"c_para",Wa.jsonToC_para(s));w(a,"puuid",e.packageObj[t].puuid);if(wo==ia.SCHLIB||wo==ia.SPICESYMBOL||wo==ia.SUBPART){ha.gJsonCache.head.puuid=e.packageObj[t].puuid;ha.calAll()}else ha.updateOne(a);La.save(["node",t,i,a])}La.saveBatch()},findAllChildLibsInProject:function(e){return Zr(e)}}}());e.addEventListener("load",function(){var r=se();_(fa,"bw-"+r,!0);wa.decimalPlaces=wa.schDecimalPlaces;wa.decimalPlacesShow=wa.schDecimalPlacesShow;wa.fixedDecimal=!1;wo==ia.WAVEFORM?e.addEventListener("resize",Ma.resizeToFitWindow,!1):e.addEventListener("resize",function(){var e=t.documentElement.clientWidth||9,n=t.documentElement.clientHeight||9,r=So.getViewBox(),i=[r[0]+.5*r[2]-.5*e/Za,r[1]+.5*r[3]-.5*n/Za,e/Za,n/Za];w(fa,{width:e,height:n});So.setViewBox(i)},!1);!function(){var e=t.documentElement.clientWidth||9,n=t.documentElement.clientHeight||9,r=ba.canvas.originX,i=ba.canvas.originY;if(Wa.fileType.isLib(wo)){r-=e/Za/2;i-=n/Za/2}w(fa,{width:e,height:n,viewBox:[r,i,e/Za,n/Za].join(" ")})}();t.addEventListener("mouseover",ur,!1);t.addEventListener("mouseout",ur,!1);t.addEventListener("mousedown",ur,!1);t.addEventListener("mouseup",ur,!1);t.addEventListener("click",function(e){var t=e.altKey;-function(e){e&&n("highlight_net")}(t)},!1);t.addEventListener("contextmenu",dn,!1);if(wo==ia.WAVEFORM)t.addEventListener("dblclick",Ma.restoreCanvas,!1);else{t.addEventListener(!za||"onwheel"in t?"wheel":"MozMousePixelScroll",un,{passive:!1});t.addEventListener("mousemove",sn,!1);t.addEventListener("scroll",on,!1)}t.addEventListener("mousemove",Dn,!1);t.addEventListener("mouseup",Dn,!1);t.addEventListener("mouseout",function(){Dn.data.uplock=!0},!1);t.addEventListener("drop",function(e){pn("editor_drop",[e]);e.preventDefault()},!1);_n();an(fa);si();xi();wo!=ia.WAVEFORM&&ka();Ti();rn();kt(Ji);on();pn("showDocTip");Yn();pn("buildVersionCheck",[wa.version+","+wa.buildDate]);e.loaded=!0;pn("triggerEvent",["select_change"]);pn("triggerEvent",["editor_load"]);Di();g(ha.gJsonCache.schlib)},!1);!function(){function e(e){if(""!==va)return!1;var n,i=e.target,a=i.tagName,o=v("textInputBox");if(No&&!$r(i.parentNode)&&i.parentNode.parentNode&&"g1"!==i.parentNode.parentNode.id){n=w(i.parentNode.parentNode,"c_partid");var s=["part_lib_sheet"];if("schlib"===de(i.parentNode.parentNode)&&s.indexOf(n)<0)return!1}if(!o){o=t.createElement("textarea");t.body.appendChild(o);o.id="textInputBox";o.className="textInputBox";o.style.width="200px";o.style.height="100px";w(o,"min-ofw",o.offsetWidth);w(o,"min-ofh",o.offsetHeight);o.addEventListener("change",function(){var e=r,t=this.value,n="tspan"==a?e.parentNode:e,i=b(n.parentNode,$a)?n:n.parentNode,o=i.cloneNode(!0);Ei("part_pin"===w(i,"c_partid")?e:i,t,function(){var e=i.cloneNode(!0);ha.updateOne(i);La.save(["node",i.id,o,e])});pn("addUserBehaviorRecord",["text-edit-submit",{text:t}])},!1);o.addEventListener("blur",function(e){this.style.display="none"},!1);o.addEventListener("keydown",function(e){32==e.keyCode&&e.stopPropagation();if(27==e.keyCode){e.stopPropagation();this.value=this.oldValue;this.style.display="none"}if(!e.ctrlKey&&13==e.keyCode){e.preventDefault();e.stopPropagation();var n=t.createEvent("HTMLEvents");n.initEvent("change",!1,!0);o.dispatchEvent(n);this.style.display="none"}if(e.ctrlKey&&13==e.keyCode){var r=v(w(o,"data-targetid"));if("annotation"!=de(r)||r.parentNode!=Ji){e.preventDefault();e.stopPropagation()}else{var i=e.currentTarget.selectionStart,a=e.currentTarget.selectionEnd;o.value=o.value.substring(0,i)+"\r\n"+o.value.substring(a);e.currentTarget.selectionStart=i+1;e.currentTarget.selectionEnd=i+1}}},!1);void 0!==o.style.resize||function(e){function n(n){if(n.button===qi){l&&i();if(n.offsetX>e.offsetWidth-16&&n.offsetY>e.offsetHeight-16){n.preventDefault();e.style.cursor="nwse-resize";t.addEventListener("mousemove",r,!1);t.addEventListener("mouseup",i,!1);l=!0;a=n.pageX;o=n.pageY;s=parseInt(e.style.width,10);c=parseInt(e.style.height,10)}}}function r(t){var n=s+t.pageX-a,r=c+t.pageY-o;e.style.width=Math.min(Math.max(n,100),1200)+"px";e.style.height=Math.min(Math.max(r,100),1e3)+"px"}function i(n){if(l){e.style.cursor="";t.removeEventListener("mousemove",r,!1);t.removeEventListener("mouseup",i,!1);l=!1}}var a=0,o=0,s=0,c=0,l=!1;e.addEventListener("mousedown",n,!1);e.addEventListener("blur",i,!1)}(o)}var c=e.pageX,l=e.pageY;o.style.display="";o.style.top=Math.max(l-5,5)+"px";o.style.left=Math.max(c-5,5)+"px";"tspan"==a&&(i=i.parentNode);var d=Pt(i);o.value=X(d);o.oldValue=d;o.select();o.focus();r=i;w(o,"data-targetid",i.parentNode.id);pn("addUserBehaviorRecord",["text-edit-dbclick",{text:d}]);!function(e){for(var t=e.value.replace(/[^\x00-\xff]/g,"**").split(/\r\n|\r|\n/),n=t.length,r=0,i=0;i<t.length;i++)r=Math.max(t[i].length,r);w(o,"rows",n);w(o,"cols",r);o.style.width="";o.style.height="";o.style.width=200+Math.max(0,o.offsetWidth-w(o,"min-ofw"))+"px";o.style.height=100+Math.max(0,o.offsetHeight-w(o,"min-ofh"))+"px"}(o)}function n(e){if(""===va){var t=e.target;e.ctrlKey||e.altKey||e.shiftKey||jr(t)}}var r;t.addEventListener("dblclick",function(t){var r=t.target,i=r.tagName;r.parentNode==mo?n(t):"text"!==i&&"tspan"!==i||"note_mounted"!==w(r,"c_note")&&"note_package"!==w(r,"c_note")&&r.parentNode&&"frame_tick"!=w(r.parentNode,"c_etype")&&e(t)},!1)}();Ca.bestFormatString=function(e){var t;e=Math.abs(e);if(e>=10)t="%d";else if(e>1)t=e===parseInt(e,10)?"%d":"%.1f";else{var n=-Math.floor(Math.log(e)/Math.LN10);t="%."+n+"f"}return t};Ca.bestInterval=function(e,t){t=t||7;var n,r=e/(t-1),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;n=i<1?a>5?10*i:a>2?5*i:a>1?2*i:i:a>5?10*i:a>4?5*i:a>3?4*i:a>2?3*i:a>1?2*i:i;return n};Ca.bestLinearInterval=function(e,t){t=t||1;var n,r=Math.floor(Math.log(e)/Math.LN10),i=Math.pow(10,r),a=e/i;a/=t;n=a<=.38?.1:a<=1.6?.2:a<=4?.5:a<=8?1:a<=16?2:5;return n*i};Ca.LinearTickGenerator=function(e,t,n,r){e===t&&(t=t?0:1);n=n||1;if(t<e){var i=t;t=e;e=i}var a=[],o=Ca.bestLinearInterval(t-e,n);Ca.getSignificantFigures;if(null===r){a[0]=Math.floor(e/o)*o;a[1]=Math.ceil(t/o)*o;a[2]=Math.round((a[1]-a[0])/o+1);a[3]=Ca.bestFormatString(o);a[4]=o}else{var s=[];s[0]=Math.floor(e/o)*o;s[1]=Math.ceil(t/o)*o;s[2]=Math.round((s[1]-s[0])/o+1);s[3]=Ca.bestFormatString(o);s[4]=o;if(s[2]===r)a=s;else{var c=Ca.bestInterval(s[1]-s[0],r);a[0]=s[0];a[2]=r;a[4]=c;a[3]=Ca.bestFormatString(c);a[1]=a[0]+(a[2]-1)*a[4]}}return a};Ca.createTicks=function(e,t,n,r,i,a){var o="x"==i?e:t;this._scalefact=(Math.max(o,31)-30)/600;var s=a;"y2"==i&&(s=a);var c=r-n,l=Ca.LinearTickGenerator(n,r,this._scalefact,s,!1,!1);l[2];this.padMin=1.01;this.padMax=1.01;var d=null!==this.min&&void 0!==this.min?n:n+c*(this.padMin-1),u=null!==this.max&&void 0!==this.max?r:r-c*(this.padMax-1);if(n<d||r>u){d=null!==this.min&&void 0!==this.min?n:n-c*(this.padMin-1);u=null!==this.max&&void 0!==this.max?r:r+c*(this.padMax-1);l=Ca.LinearTickGenerator(d,u,this._scalefact,s,!1,!1)}return{min:l[0],max:l[1],numberTicks:l[2],autoFormatString:l[3],tickInterval:l[4]}};Ma.ini=function(){Ma._gWaveForm=v("g1");var e=t.documentElement.clientWidth,n=t.documentElement.clientHeight;Ja._width=Math.max(e,600);Ja._height=Math.max(n,400);Ma._width=Ja._width;Ma._height=Ja._height;Ja._xaxis.plotData=Ja._xaxis.data.slice(0);for(var r in Ja.series)j(Ja.series,r)&&(Ja.series[r].plotData=Ja.series[r].data.slice(0))};Ma.rebuild=function(){ha.removeAll();Ma._clean();Ma._resetCanvas();Ma._createBackground();Ma._iniMessageBar();Ma._createPanes()};Ma.resizeToFitWindow=function(){Ma.ini();Ma.rebuild()};Ma._iniMessageBar=function(){var e=v("gMessageBar");e.style.backgroundColor=Ja._paneBackground;e.style.color=Ja._gridSetting.gridColor};Ma._clean=function(){for(var e=Ma._gWaveForm.childNodes,t=e.length-1;t>=0;t--)e[t]&&Ma._gWaveForm.removeChild(e[t])};Ma._resetCanvas=function(){w(fa,{width:Ma._width,height:Ma._height,viewBox:"0 0 "+Ma._width+" "+Ma._height})};Ma._createBackground=function(){var e=Wt("rect",{x:0,y:0,width:Ma._width,height:Ma._height,stroke:Ja._paneBackground,"stroke-width":"1",id:Wa.newId(),fill:Ja._paneBackground});Ma._addGrapItem(e)};Ma._addGrapItem=function(e){Ma._gWaveForm.appendChild(e);ha.updateOne(e)};Ma._createPanes=function(){Ma._setXAxis();var e=Ja.panes.length;if(e){Ma._paneHeight=(Ma._height-Ma._messageBarHeight)/e;for(var t,n=0;n<e;n++){Ma.isZoomViaSelectBox||Ma._setYAxes(n);t=Ma._messageBarHeight+n*Ma._paneHeight;Ja.panes[n].topLeftY=t;Ma._createLegend(t,n);Ma._createGrid(t,n);Ma._createWave(t,n)}}};Ma._getGridWidth=function(){return Ma._width-Ma._paneLeftPadding-Ma._paneRightPadding};Ma._getGridHeight=function(){return Ma._paneHeight-Ma._paneTopPadding-Ma._paneBottonPadding};Ma._createLegend=function(e,t){var n=e+Ma._paneTopPadding-10,r=Ja.panes[t].serieNames,i=Ma._width/r.length,a=20-i;r.forEach(function(e){a+=i;var t=Ja.series[e],r=Ma.createAnnotationNode({x:a,y:n-10,stroke:"none","text-anchor":"start",fill:t.color,"font-size":"12pt"},e);Ma._addGrapItem(r)})};Ma._createGrid=function(e,t){var n=Ja.panes[t],r=Ma._paneLeftPadding,i=e+Ma._paneTopPadding,a=Ma._width-Ma._paneRightPadding,o=Ma._getGridWidth(),s=Ma._getGridHeight(),c=Ma._getGridBBox(t),l=Wt("rect",{x:c.x,y:c.y,width:c.width,height:c.height,id:Wa.newId(),stroke:Ja._gridSetting.gridColor,"stroke-width":"1",fill:Ja._gridSetting.gridBackground});Ma._addGrapItem(l);var d=0,u={},h={},f=null;if(Ja._xaxis.isDecade){var p=Math.floor(Ja._xaxis.dataMin),g=Math.ceil(Ja._xaxis.dataMax);g=Math.min(10,g);g=Math.max(1,g);f={min:p,max:g,numberTicks:g-p+1,tickInterval:1}}else f=Ca.createTicks(o,s,Ja._xaxis.dataMin,Ja._xaxis.dataMax,"x",null);Ja._xaxis.max=f.max;Ja._xaxis.min=f.min;Ja._xaxis.numberTicks=f.numberTicks;var y=o/(f.numberTicks-1),x="";for(d=0;d<Ja._xaxis.numberTicks;d++){x=Ma._friendSuffix(f.min+d*f.tickInterval,Ja._xaxis.isDecade,Ja._xaxis.unit);u.x=r+d*y;h.x=r+d*y;u.y=i;h.y=i+s;if(0!==d){var v=Wt("polyline",{points:[u.x,u.y,h.x,h.y].join(" "),stroke:Ja._gridSetting.gridColor,"stroke-width":1,"stroke-dasharray":"2,8",fill:"none",id:Wa.newId(),class:"px1"});Ma._addGrapItem(v)}var m=Ma.createAnnotationNode({x:h.x,y:h.y+17,stroke:"none","text-anchor":"middle",fill:Ja._gridSetting.gridColor,"font-size":"12pt"},x);Ma._addGrapItem(m)}f=Ca.createTicks(o,s,n.y1.dataMin,n.y1.dataMax,"y1",null);n.y1.max=f.max;n.y1.min=f.min;n.y1.numberTicks=f.numberTicks;var L=s/(f.numberTicks-1);for(d=0;d<n.y1.numberTicks;d++){x=Ma._friendSuffix(f.max-d*f.tickInterval,!1,n.y1.unit);u.x=r;h.x=r+o;u.y=i+d*L;h.y=i+d*L;if(0!==d){var _=Wt("polyline",{points:[u.x,u.y,h.x,h.y].join(" "),stroke:Ja._gridSetting.gridColor,"stroke-width":1,"stroke-dasharray":"2,8",fill:"none",id:Wa.newId(),class:"px1"});Ma._addGrapItem(_)}var b=Ma.createAnnotationNode({x:u.x-5,y:u.y,stroke:"none","text-anchor":"end",fill:Ja._gridSetting.gridColor,"font-size":"12pt"},x);Ma._addGrapItem(b)}if(n.isDoubleYaxes){f=Ca.createTicks(o,s,n.y2.dataMin,n.y2.dataMax,"y2",f.numberTicks);n.y2.max=f.max;n.y2.min=f.min;n.y2.numberTicks=f.numberTicks;L=s/(f.numberTicks-1);for(d=0;d<n.y2.numberTicks;d++){x=Ma._friendSuffix(f.max-d*f.tickInterval,!1,n.y2.unit);u.x=a+10;u.y=i+d*L;b=Ma.createAnnotationNode({x:u.x,y:u.y,stroke:"none","text-anchor":"start",fill:Ja._gridSetting.gridColor,"font-size":"12pt"},x);Ma._addGrapItem(b)}}};Ma._getGridBBox=function(e){var t=Ma._messageBarHeight+e*Ma._paneHeight;return{x:Ma._paneLeftPadding,y:t+Ma._paneTopPadding,width:Ma._getGridWidth(),height:Ma._getGridHeight()}};Ma._createWave=function(e,t){var n=Ja.panes[t].serieNames,r=Ja._xaxis.plotData,i=Ma._paneLeftPadding,a=e+Ma._paneTopPadding,o=Ma._getGridWidth(),s=Ma._getGridHeight(),c=o/(Ja._xaxis.max-Ja._xaxis.min),l=Wa.toFixed((Ja._xaxis.dataMax-Ja._xaxis.min)*c+i,8);n.forEach(function(e){var n,o=[],d=Ja.series[e],u=d.plotData,h=Ja.panes[t][d.yaxisIndex].max-Ja.panes[t][d.yaxisIndex].min,f=s/h;if(0!==h)for(var p=0,g=u.length;p<g;p++){var y=i+(r[p]-Ja._xaxis.min)*c,x=a+s-(u[p]-Ja.panes[t][d.yaxisIndex].min)*f;y=Wa.toFixed(y,8);x=Wa.toFixed(x,8);o.push(y);o.push(x);if(y===l){n={points:o.join(" "),stroke:d.color,"stroke-width":1,fill:"none",id:Wa.newId(),class:"px1"};"dash"===d.style&&(n["stroke-dasharray"]="1,3");Ma._addGrapItem(Wt("polyline",n));o=[]}}})};Ma._getRang=function(e,t){var n=-1/0,r=1/0;if("x"==e){n=parent.d3.max(Ja._xaxis.plotData,function(e){return+e});r=parent.d3.min(Ja._xaxis.plotData,function(e){return+e})}else{Ja.panes[t].serieNames.forEach(function(t){if(Ja.series[t].yaxisIndex==e){var i=parent.d3.max(Ja.series[t].plotData,function(e){return+e});n=Math.max(i,n);var a=parent.d3.min(Ja.series[t].plotData,function(e){return+e});r=Math.min(a,r)}})}return{min:r,max:n}};Ma._setYAxes=function(e){var t=Ja.panes[e].serieNames,n=Ma.initYAxis(t),r=Ma._getRang("y1",e),i={unit:n[0],dataMin:r.min,dataMax:r.max};Ja.panes[e].y1=i;if(n[1]){r=Ma._getRang("y2",e);i={unit:n[1],dataMin:r.min,dataMax:r.max};Ja.panes[e].y2=i;Ja.panes[e].isDoubleYaxes=!0}};Ma.initYAxis=function(e){var t,n,r,i,a,o=e[0]&&Ja.series[e[0]]&&Ja.series[e[0]].unit;for(n=0;n<e.length;n+=1){Ja.series[e[n]].yaxisIndex="y1";o!==Ja.series[e[n]].unit&&(t=t||Ja.series[e[n]].unit)}if(t)for(n=0;n<e.length;n+=1){r=Ja.series[e[n]].type;i=Ja.series[e[n]].unit;if(["current","phase","notype","device_current","subckt_current"].indexOf(r)>-1){Ja.series[e[n]].yaxisIndex="y2";if(i===o){a=o;o=t;t=a}}}return[o,t]};Ma._setXAxis=function(){var e=Ma._getRang("x");Ja._xaxis.dataMin=e.min;Ja._xaxis.dataMax=e.max};Ma._friendSuffix=function(e,t,n){var r=0,i="",a=e<0;e=Math.abs(e);if(t){e=Math.pow(10,e);if(a){e=1/e;a=!1}}for(var o=[[1e12,"T"],[1e9,"G"],[1e6,"M"],[1e3,"K"],[1,""],[.001,"m"],[1e-6,"u"],[1e-9,"n"],[1e-12,"p"]],s=0,c=o.length;s<c&&0!==e;s++)if(e>=o[s][0]){r=e/o[s][0];i=o[s][1];break}return(a?"-":"")+Wa.toFixed(r,3)+i+n};Ma.zoomViaSelectBox=function(e,t){Ma.isDrawingSelectBox=!1;!0===Ma.computePlotDataViaSelectBox(e,t)&&Ma.rebuild()};Ma.lastFrom=1;Ma.zoomHistory=[];Ma.computePlotDataViaSelectBox=function(e,t){var n,r,i,a,o=Ja.panes.length||1,s=Ja._xaxis.data.slice(0),c=Ma._paneLeftPadding,l=Ma._getGridWidth(),d=Ja._xaxis.min,u=Ja._xaxis.max,h=0,f=Ma._getPaneIndexViaSelectBox(e),p=l/(u-d),g=0,y=s.length,x=this.lastFrom;if(null===f)return!1;if("zoomin"===t){for(h=x;h<s.length;h+=1){n=c+(s[h]-d)*p;if(!g&&n>=e.x){g=h;this.lastFrom=g}if(g&&n>=e.x+e.width){y=h;break}}if(y-g<3)return!1;this.zoomHistory.push({from:g,to:y})}else{if(!this.zoomHistory.length)return!1;this.zoomHistory.pop();a=this.zoomHistory.length?this.zoomHistory[this.zoomHistory.length-1]:void 0;if(a){g=a.from;y=a.to}else{g=0;y=s.length}this.lastFrom=g}Ja._xaxis.plotData=s.slice(g,y);for(r=0;r<o;r+=1){i=Ja.panes[r].serieNames;i.forEach(function(e){var t=Ja.series[e];t.plotData=t.data.slice(g,y)})}return!0};Ma._getPaneIndexViaSelectBox=function(e){var t,n=0,r=0,i=null;for(r=Ja.panes.length;n<r;n+=1){t=Ma._getGridBBox(n);if(Wa.isRectTouchRect(t,e)){i=n;break}}return i};Ma._getPaneIndexViaPoint=function(e){var t=(Ma._paneLeftPadding,Ma._getGridWidth(),Ma._getGridHeight(),0),n=0,r=null;if(!Ja.panes)return null;for(t=0,n=Ja.panes.length;t<n;t++){var i=Ma._getGridBBox(t);if(Wa.isDotInRect(e.x,e.y,i)){r=t;break}}return r};Ma.updateMessageBarInfo=function(e){function t(t){var n,r,i=v("gMessageBar"),a=e.x+20,o=e.y+20;if(L){a=e.x+e.width+20;o=e.y+e.height+20}i.innerHTML=t;n=i.offsetWidth;r=i.offsetHeight;a+n>=x&&(a=a-n-40);o+r>=m&&(o=o-r-40);i.style.left=a+"px";i.style.top=o+"px";i.style.width="250px";i.style.display=L?"none":"block"}var n,r,i,a,o,s,c,l,d,u,h,f,p,g,y=Ma._paneLeftPadding,x=Ma._getGridWidth(),m=Ma._getGridHeight(),L=Ma.isDrawingSelectBox,_=null,b="",S=Ja._xaxis.max,C=Ja._xaxis.min,M=Ma._friendSuffix,w=0,N="",P=Ja._xaxis.isDecade,T=Ja._xaxis.unit;L&&e.width?_=Ma._getPaneIndexViaSelectBox(e):L||e.width||(_=Ma._getPaneIndexViaPoint(e));var O=Ma._messageBarHeight+_*Ma._paneHeight+Ma._paneTopPadding;if(Ja.panes[_]&&Ja.panes[_].serieNames.length)if(null!==_){if(L){a=y+x;o=O+m;s=Math.max(e.x,y);c=Math.min(e.x+e.width,a);l=Math.max(e.y,O);d=Math.min(e.y+e.height,o);u=c-s;h=d-l;w=P?Math.pow(10,(S-C)/x*(c-y)+C)-Math.pow(10,(S-C)/x*(l-y)+C):(S-C)/x*u;N=M(w,!1,T);p=(Ja.panes[_].y1.max-Ja.panes[_].y1.min)/m*h;g=Ja.panes[_].isDoubleYaxes?(Ja.panes[_].y2.max-Ja.panes[_].y2.min)/m*h:"";f="S"===T?"("+M(1/w,!1,"Hz")+") ":"";b="<p>dx = "+N+f+"</p><p>dy = "+M(p,!1,Ja.panes[_].y1.unit);b+=Ja.panes[_].isDoubleYaxes?", "+M(g,!1,Ja.panes[_].y2.unit):""}else{n=(S-C)/x*(e.x-y)+C;r=Ja.panes[_].y1.max-(Ja.panes[_].y1.max-Ja.panes[_].y1.min)/m*(e.y-O);i=Ja.panes[_].isDoubleYaxes?Ja.panes[_].y2.max-(Ja.panes[_].y2.max-Ja.panes[_].y2.min)/m*(e.y-O):"";b="<p>x = "+M(n,P,T)+"</p><p>y = "+M(r,!1,Ja.panes[_].y1.unit);b+=Ja.panes[_].isDoubleYaxes?", "+M(i,!1,Ja.panes[_].y2.unit):""}t(b+"</p>")}else t("")};Ma.restoreCanvas=function(){Ma.lastFrom=1;Ma.isDrawingSelectBox=!1;Ma.ini();Ma.rebuild()};Ma.removePlotData=function(){Ja._xaxis.plotData=null;for(var e in Ja.series)j(Ja.series,e)&&(Ja.series[e].plotData=null)};Ma.createAnnotationNode=function(e,n){var r=Wt("g",{c_partid:"part_annotation",id:Wa.newId(),c_origin:e.x+","+e.y}),i=Wt("text",e),a=t.createTextNode(n);i.appendChild(a);r.appendChild(i);return r}}(window,document);
//# sourceMappingURL=editorSCH.min.map