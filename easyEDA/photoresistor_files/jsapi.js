!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="./",r(r.s=122)}([function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return s}));var n,i=r(1),o=r(8);!function(t){t[t.MULTI=0]="MULTI",t[t.TOP_SILK=1]="TOP_SILK",t[t.TOP_SOLDER_MASK=2]="TOP_SOLDER_MASK",t[t.TOP_PASTE=3]="TOP_PASTE",t[t.TOP_COPPER=4]="TOP_COPPER",t[t.INNER=5]="INNER",t[t.PLANE=6]="PLANE",t[t.BOT_COPPER=7]="BOT_COPPER",t[t.BOT_PASTE=8]="BOT_PASTE",t[t.BOT_SOLDER_MASK=9]="BOT_SOLDER_MASK",t[t.BOT_SILK=10]="BOT_SILK",t[t.OUTLINE=11]="OUTLINE",t[t.DOCUMENT=12]="DOCUMENT",t[t.MECHANICAL=13]="MECHANICAL",t[t.RATELINE=14]="RATELINE",t[t.MODEL=15]="MODEL",t[t.OTHER=16]="OTHER"}(n||(n={}));var a=function(t){switch(t){case n.MULTI:return"MULTI";case n.TOP_SILK:return"TOP_SILK";case n.TOP_SOLDER_MASK:return"TOP_SOLDER_MASK";case n.TOP_PASTE:return"TOP_PASTE";case n.TOP_COPPER:return"TOP_COPPER";case n.INNER:return"INNER";case n.PLANE:return"PLANE";case n.BOT_COPPER:return"BOT_COPPER";case n.BOT_PASTE:return"BOT_PASTE";case n.BOT_SOLDER_MASK:return"BOT_SOLDER_MASK";case n.BOT_SILK:return"BOT_SILK";case n.OUTLINE:return"OUTLINE";case n.DOCUMENT:return"DOCUMENT";case n.MECHANICAL:return"MECHANICAL";case n.RATELINE:return"RATELINE";case n.MODEL:return"MODEL";case n.OTHER:return"OTHER"}},s=function(){function t(t,e){switch(this.type=t,t){case n.INNER:case n.MECHANICAL:case n.PLANE:this.order=i.a.positive(e);break;default:if(0!==e)throw new Error(o.a.format("layer type %s order must eq 0, not %d",t,e));this.order=e}this.hashed=31*(31+t)+e}return t.isTop=function(t){switch(t){case n.TOP_COPPER:case n.TOP_PASTE:case n.TOP_SOLDER_MASK:case n.TOP_SILK:return!0;default:return!1}},t.isBot=function(t){switch(t){case n.BOT_COPPER:case n.BOT_PASTE:case n.BOT_SOLDER_MASK:case n.BOT_SILK:return!0;default:return!1}},t.prototype.hashCode=function(){return this.hashed},t.prototype.toString=function(){return"PcbLayer [type="+this.type+", order="+this.order+"]"},t.prototype.equals=function(e){return e instanceof t&&(this.type===e.type&&this.order===e.order)},t.MULTI=new t(n.MULTI,0),t.TOP_SILK=new t(n.TOP_SILK,0),t.TOP_SOLDER_MASK=new t(n.TOP_SOLDER_MASK,0),t.TOP_PASTE=new t(n.TOP_PASTE,0),t.TOP_COPPER=new t(n.TOP_COPPER,0),t.BOT_COPPER=new t(n.BOT_COPPER,0),t.BOT_PASTE=new t(n.BOT_PASTE,0),t.BOT_SOLDER_MASK=new t(n.BOT_SOLDER_MASK,0),t.BOT_SILK=new t(n.BOT_SILK,0),t.OUTLINE=new t(n.OUTLINE,0),t.DOCUMENT=new t(n.DOCUMENT,0),t.RATELINE=new t(n.RATELINE,0),t.OTHER=new t(n.OTHER,0),t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(8),i=function(){function t(){}return t.rgb=function(t){if(0<=t&&t<=255)return t;throw new Error(n.a.format("RGB should not nagative and not over 255(0xFF): %X",t))},t.normal=function(t){if(isFinite(t))return t;throw new Error(n.a.format("%f is not permitted",t))},t.positiveOr0=function(t){if(t>=0)return t;throw new Error(n.a.format("%f must >= 0",t))},t.positive=function(t){if(t>0)return t;throw new Error(n.a.format("%f must > 0",t))},t.notnull=function(t){if(null!=t)return t;throw new Error("invalid null value")},t.mustnull=function(t){if(null===t)return null;throw new Error("value must be null")},t.notEmpty=function(t){if(null==t||0===t.length)throw new Error("invalid empty string");return t},t.nullOrEmpty=function(t){return null==t||0===t.length},t.notNullOrUndef=function(t){if(null!=t)return t;throw new Error("null or undefined is not permitted")},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return p}));var n,i=r(94),o=r(7),a=r(10),s=r(17),u=r(26),l=r(14),h=r(9),c=r(5),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),p=function(t){function e(e,r){var n=t.call(this)||this;return e.equals(r)?(n.a=NaN,n.b=NaN,n.c=NaN,n._start=e,n._end=r):(n.a=r.y-e.y,n.b=e.x-r.x,n.c=r.x*e.y-e.x*r.y,n._start=e,n._end=r),n.__bbox=(new o.b).ext2(e).ext2(r).build(),n.hashed=n._hashCode(),n}return f(e,t),e.prototype._hashCode=function(){var t=1;return t=31*(t=31*t+this._start.hashCode())+this._end.hashCode()},e.prototype.start=function(){return this._start},e.prototype.end=function(){return this._end},e.prototype.panDistance=function(t){var r=this._end.x-this._start.x,n=this._end.y-this._start.y,i=Math.sqrt(r*r+n*n);return r=r*t/i,n=-n*t/i,new e(new c.a(this._start.x+n,this._start.y+r),new c.a(this._end.x+n,this._end.y+r))},e.prototype.isPoint=function(){return this._start.equals(this._end)},e.prototype.isPoint1=function(){return this._start.equals1(this._end)},e.prototype.length=function(){return this._start.distance1(this._end)},e.prototype.toString=function(){return"Line [start="+this._start+", end="+this._end+"]"},e.prototype.bbox=function(){return this.__bbox},e.prototype.multiply3=function(t){return new e(this._start.multiply3(t),this._end.multiply3(t))},e.prototype.hashCode=function(){return this.hashed},e.prototype.equals=function(t){var e=t;return this.hashed===e.hashed&&this._start.equals(e.start)&&this._end.equals(e.end)},e.prototype.stroke=function(t,e,r){var n,i,o;this._end.x<this._start.x?(i=this._start.x-this._end.x,o=this._start.y-this._end.y,n=this._end):(i=this._end.x-this._start.x,o=this._end.y-this._start.y,n=this._start);var f,p,d,y=Math.sqrt(i*i+o*o),b=t/2;e===u.a.SQUARE?(p=-b,d=y+b):(p=0,d=y),f=e===u.a.BUTT||e===u.a.SQUARE?r===s.a.CW?l.a.build5([p,-b,p,b,d,b,d,-b]):l.a.build5([p,b,p,-b,d,-b,d,b]):r===s.a.CW?l.a.build2([h.a.build3(new c.a(p,0),-90,-180,b,b),h.a.build3(new c.a(d,0),90,-180,b,b)]):l.a.build2([h.a.build3(new c.a(p,0),90,180,b,b),h.a.build3(new c.a(d,0),-90,180,b,b)]);var v=Math.atan2(o,i),m=a.a.rotate(v).translate1(n);return f.multiply3(m)},e.prototype.points=function(t){return[this._start,this._end]},e}(i.a)},function(t,e,r){"use strict";var n,i;r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return o})),function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(n||(n={})),function(t){t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM"}(i||(i={}));var o=function(){function t(t,e){this.horizontal=t,this.vertical=e}return t.LT=new t(n.LEFT,i.TOP),t.LC=new t(n.LEFT,i.CENTER),t.LB=new t(n.LEFT,i.BOTTOM),t.CT=new t(n.CENTER,i.TOP),t.CC=new t(n.CENTER,i.CENTER),t.CB=new t(n.CENTER,i.BOTTOM),t.RT=new t(n.RIGHT,i.TOP),t.RC=new t(n.RIGHT,i.CENTER),t.RB=new t(n.RIGHT,i.BOTTOM),t}()},function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t[t.BS=8]="BS",t[t.TAB=9]="TAB",t[t.LF=10]="LF",t[t.FF=12]="FF",t[t.CR=13]="CR",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.QUOTE=34]="QUOTE",t[t.PERCENT=37]="PERCENT",t[t.MINUS=45]="MINUS",t[t.PLUS=43]="PLUS",t[t.COMMA=44]="COMMA",t[t.STRIKE=45]="STRIKE",t[t.DOT=46]="DOT",t[t.SLASH=47]="SLASH",t[t.NUM0=48]="NUM0",t[t.NUM1=49]="NUM1",t[t.NUM2=50]="NUM2",t[t.NUM3=51]="NUM3",t[t.NUM4=52]="NUM4",t[t.NUM5=53]="NUM5",t[t.NUM6=54]="NUM6",t[t.NUM7=55]="NUM7",t[t.NUM8=56]="NUM8",t[t.NUM9=57]="NUM9",t[t.COLON=58]="COLON",t[t.SEMICOLON=59]="SEMICOLON",t[t.EQUAL=61]="EQUAL",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.LBRACKET=91]="LBRACKET",t[t.BSLASH=92]="BSLASH",t[t.RBRACKET=93]="RBRACKET",t[t.UNDERLINE=95]="UNDERLINE",t[t.a=97]="a",t[t.b=98]="b",t[t.c=99]="c",t[t.d=100]="d",t[t.e=101]="e",t[t.f=102]="f",t[t.g=103]="g",t[t.h=104]="h",t[t.i=105]="i",t[t.j=106]="j",t[t.k=107]="k",t[t.l=108]="l",t[t.m=109]="m",t[t.n=110]="n",t[t.o=111]="o",t[t.p=112]="p",t[t.q=113]="q",t[t.r=114]="r",t[t.s=115]="s",t[t.t=116]="t",t[t.u=117]="u",t[t.v=118]="v",t[t.w=119]="w",t[t.x=120]="x",t[t.y=121]="y",t[t.z=122]="z",t[t.LBRACE=123]="LBRACE",t[t.VECLINE=124]="VECLINE",t[t.RBRACE=125]="RBRACE"}(n||(n={}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(1),i=r(12),o=r(45),a=r(19),s=r(7),u=new ArrayBuffer(16),l=new Float64Array(u),h=new Int32Array(u),c=function(){function t(t,e){this.x=n.a.normal(t),this.y=n.a.normal(e),l[0]=t,l[1]=e,this.hashed=h[0]^h[1]^h[2]^h[3]}return t.sortByXAsc=function(t,e){return t.x-e.x},t.sortByYAsc=function(t,e){return t.y-e.y},t.sortByXYAsc=function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y-e.y},t.normal=function(t,e,r){var n=e.sub(t),i=r.sub(e);return n.cross(i)},t.getVector2=function(e){return new t(Math.cos(e),Math.sin(e))},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.length=function(){return Math.sqrt(this.dot(this))},t.prototype.getCos=function(){return this.x/this.length()},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.add1=function(e,r){return new t(this.x+e,this.y+r)},t.prototype.mul=function(e){return new t(this.x*e,this.y*e)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.getSin=function(){return this.y/this.length()},t.prototype.angle=function(t){return Math.atan2(this.y-t.y,this.x-t.x)},t.prototype.angleD=function(t){return i.a.toDegrees(this.angle(t))},t.prototype.distance1=function(t){var e=t.x-this.x,r=t.y-this.y;return o.a.hypot(e,r)},t.prototype.distance2=function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},t.prototype.rotateD=function(t,e){return this.rotate(t,i.a.toRadians(e))},t.prototype.rotate=function(t,e){var r=Math.cos(e),n=Math.sin(e),i=this.x-t.x,o=this.y-t.y,a=i*r+o*-n,s=i*n+o*r;return t.add1(a,s)},t.prototype.multiply3=function(e){return new t(this.x*e.data[0]+this.y*e.data[3]+e.data[6],this.x*e.data[1]+this.y*e.data[4]+e.data[7])},t.prototype.multiply4=function(e){return new t(this.x*e.data[0]+this.y*e.data[4]+e.data[12],this.x*e.data[1]+this.y*e.data[5]+e.data[13])},t.prototype.hashCode=function(){return this.hashed},t.prototype.equals=function(e){return e instanceof t&&(e.x===this.x&&e.y===this.y)},t.prototype.equals1=function(t){return a.a.eq(this.x,t.x)&&a.a.eq(this.y,t.y)},t.prototype.toString=function(){return"Vector [X="+this.x+", Y="+this.y+"]"},t.prototype.bbox=function(){var t=this.x,e=this.y;return new s.a(t,t,e,e)},t.ORIGIN=new t(0,0),t}()},function(t,e,r){"use strict";r.d(e,"c",(function(){return h})),r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return f}));var n=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=null,o=function(){try{return eval("require")}catch(t){}}(),a=new ArrayBuffer(8),s=new Float64Array(a),u=new Uint32Array(a),l=new Uint16Array(a);function h(t,e,r,n){function i(t,e,r,n,o){var a,s,u,l;if(n<o-1)if(o-n>50)null===e&&(e=new Array(o-n+1)),function(t,e,r,n,o,a){i(t,e,r,n,o),i(t,e,r,o,a);var s=n,u=o,l=0,h=t[s],c=t[u];for(;s<o&&u<a;){var f=r(h,c);isNaN(f)?(e[l++]=c,c=t[++u]):(f<=0&&(e[l++]=h,h=t[++s]),f>=0&&(e[l++]=c,c=t[++u]))}for(;s<o;s++)e[l++]=t[s];for(;u<a;u++)e[l++]=t[u];for(s=n,u=0;u<l;s++,u++)t[s]=e[u]}(t,e,r,n,(n+o)/2|0,o);else{for(a=t[n],s=n,u=n,l=o;s+1<l;)if(u==l){var h=s+1;r(a,t[h])>=0?s=h:(t[u]=t[h],s=h,u=h)}else{if(r(a,t[l+=-1])<=0)continue;t[u]=t[l],u=l}t[u]=a,i(t,e,r,n,u),i(t,e,r,u+1,o)}}i(t,null,e,r,n)}var c=function(){function t(){}return t.repeat=function(t,e){for(var r=new Array(e);e-- >0;)r[e]=t;return r.join("")},t.lpad=function(t,e,r){var n=r-t.length;return n>0?this.repeat(e,n)+t:t},t.rpad=function(t,e,r){var n=r-t.length;return n>0?t+this.repeat(e,n):t},t.strHashcode=function(t){if(t.length>0){for(var e=0,r=0;r<t.length;r++)e=31*e+t.charCodeAt(r)|0;return e}return 0},t.arraycopy=function(t,e,r,n,i){if(!(t.length>=e+i&&r.length>=n+i))throw new Error("arraycopy out of range");for(;i-- >0;)r[n++]=t[e++]},t.undefAsNull=function(t){return null},t.reverse=function(t,e){for(var r=0,n=t.length-1;n>=0;r++,n--)e[r]=t[n];return e},t.sortAsc=function(t,e){return t-e},t.xmlDecode=function(t){for(var e=t.length,r=new Array,n=-1,i=0;i<e;i++){var o=t.charAt(i);if(n>=0){if(";"===o){var a=t.substring(n+1,i);switch(a){case"lt":r.push("<");break;case"gt":r.push(">");break;case"quot":r.push('"');break;case"apos":r.push("'");break;case"amp":r.push("&");break;default:if("#"===a.charAt(0)){var s=parseInt(a.substring(1));r.push(String.fromCharCode(s))}else r.push("&"+a+";")}n=-1}}else"&"===o?n=i:r.push(o)}return n>=0&&r.push(t.substring(n)),r.join("")},t.addAll=function(t,e){var r,i;try{for(var o=n(e),a=o.next();!a.done;a=o.next()){var s=a.value;t.push(s)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},t.contains=function(t,e){var r,i;try{for(var o=n(t),a=o.next();!a.done;a=o.next()){if(a.value.equals(e))return!0}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return!1},t.equals=function(t,e){if(t.length==e.length){for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}return!1},t.remove=function(t,e){for(var r=0,n=t.length,i=0;i<n;i++)t[i]===e&&(t.splice(i,1),i--,n--,r++);return r},t.getUrlVars=function(){for(var t={},e=location.href.slice(location.href.indexOf("?")+1).split("&"),r=0;r<e.length;r++){var n=e[r].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t},t.prefix=function(){if(!i){var t=this.getUrlVars().version;i=t?"/analyzer/v"+t:"/analyzer"}return i},t.add2objS=function(t,e,r){if(e in t)return t[e];var n=r(e);return t[e]=n,n},t.downloadFile=function(t,e){var r=document.createElement("a"),n=URL.createObjectURL(e);r.download=t,r.href=n,r.click(),URL.revokeObjectURL(n)},t.uuid=function(){var t=new Array;s[0]=(new Date).getTime(),t.push(u[1].toString(16)),s[0]=Math.random(),t.push(l[3].toString(16));var e=l[2].toString(16);t.push("4"+e.substr(0,3)),s[0]=performance.now();var r=u[0].toString(16)+u[1].toString(16);return t.push("0"+r.substr(0,3)),t.push(r.substr(3)),t.join("-")},t.funcCopy=function(t){return eval("("+t.toString()+")")},t.NVL=function(){for(var t,e,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{for(var o=n(r),a=o.next();!a.done;a=o.next()){var s=a.value;if(null!==s)return s}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return null},t}();function f(t,e,r){return new Promise((function(n,i){var o=!1;function a(t){o||(i(t||"Ajax Timed Out"),o=!0)}fetch(t,e).then((function(t){o||(n(t),o=!0)}),a),setTimeout(a,r)}))}},function(t,e,r){"use strict";r.d(e,"b",(function(){return u})),r.d(e,"a",(function(){return l}));var n,i=r(1),o=r(19),a=r(22),s=r(5);!function(t){t[t.INNER=0]="INNER",t[t.OUTER=1]="OUTER",t[t.SEPARATED=2]="SEPARATED",t[t.INTERSECTED=3]="INTERSECTED",t[t.EQ=4]="EQ",t[t.INSIDE_TOUCHED=5]="INSIDE_TOUCHED",t[t.OUTSIDE_TOUCHED=6]="OUTSIDE_TOUCHED"}(n||(n={}));var u=function(){function t(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY}return t.prototype.ext1=function(t){return this.minX=Math.min(this.minX,t.minX),this.maxX=Math.max(this.maxX,t.maxX),this.minY=Math.min(this.minY,t.minY),this.maxY=Math.max(this.maxY,t.maxY),this},t.prototype.ext2=function(t){return this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y),this},t.prototype.ext3=function(t){for(var e=0;e<t.length;e++){var r=t[e];this.ext2(r)}return this},t.prototype.ext4=function(t){var e=this;return Object(a.b)(t,(function(t,r){return e.ext2(r),!0})),this},t.prototype.ext5=function(t,e,r,n){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,e),this.minY=Math.min(this.minY,r),this.maxY=Math.max(this.maxY,n),this},t.prototype.ext6=function(t,e){return this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t),this.minY=Math.min(this.minY,e),this.maxY=Math.max(this.maxY,e),this},t.prototype.ext7=function(t){if(t<0){var e=2*t;if(e<this.minX-this.maxX||e<this.minY-this.maxY)throw new Error("")}return this.minX-=t,this.maxX+=t,this.minY-=t,this.maxY+=t,this},t.prototype.valid=function(){return isFinite(this.minX)&&isFinite(this.maxX)&&isFinite(this.minY)&&isFinite(this.maxY)},t.prototype.clear=function(){this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY},t.prototype.build=function(){return new l(this.minX,this.maxX,this.minY,this.maxY)},t}(),l=function(){function t(t,e,r,n){this.minX=i.a.normal(t),this.maxX=i.a.normal(e),this.minY=i.a.normal(r),this.maxY=i.a.normal(n)}return t.extend1=function(e,r){return null===e?new t(r.x,r.x,r.y,r.y):new t(Math.min(e.minX,r.x),Math.max(e.maxX,r.x),Math.min(e.minY,r.y),Math.max(e.maxY,r.y))},t.extend2=function(e,r){return null===e?r:new t(Math.min(e.minX,r.minX),Math.max(e.maxX,r.maxX),Math.min(e.minY,r.minY),Math.max(e.maxY,r.maxY))},t.prototype.isContains=function(t){return this.isContains1(t.x,t.y)},t.prototype.isContains1=function(t,e){return this.isContainsX(t)&&this.isContainsY(e)},t.prototype.isContains2=function(t,e){return this.isContainsX1(t)&&this.isContainsY1(e)},t.prototype.isContainsX=function(t){return t>=this.minX&&t<=this.maxX},t.prototype.isContainsX1=function(t){return o.a.greatereq(t,this.minX)&&o.a.lesseq(t,this.maxX)},t.prototype.isContainsY=function(t){return t>=this.minY&&t<=this.maxY},t.prototype.isContainsY1=function(t){return o.a.greatereq(t,this.minY)&&o.a.lesseq(t,this.maxY)},t.prototype.isIntersect=function(t){return!(Math.max(this.minX,t.minX)>Math.min(this.maxX,t.maxX))&&!(Math.max(this.minY,t.minY)>Math.min(this.maxY,t.maxY))},t.prototype.extendOfSize=function(e){return i.a.positiveOr0(e),new t(this.minX-e,this.maxX+e,this.minY-e,this.maxY+e)},t.prototype.isInside=function(t){return this.minX>=t.minX&&this.maxX<=t.maxX&&this.minY>=t.minY&&this.maxY<=t.maxY},t.prototype.intersection1=function(e){var r=Math.max(this.minX,e.minX),n=Math.min(this.maxX,e.maxX);if(o.a.greater(r,n))return null;r>n&&(n=r);var i=Math.max(this.minY,e.minY),a=Math.min(this.maxY,e.maxY);return o.a.greater(i,a)?null:(i>a&&(a=i),new t(r,n,i,a))},t.prototype.width=function(){return this.maxX-this.minX},t.prototype.height=function(){return this.maxY-this.minY},t.prototype.UL=function(){return new s.a(this.minX,this.maxY)},t.prototype.UR=function(){return new s.a(this.maxX,this.maxY)},t.prototype.LL=function(){return new s.a(this.minX,this.minY)},t.prototype.LR=function(){return new s.a(this.maxX,this.minY)},t.prototype.center=function(){return new s.a(this.maxX-(this.maxX-this.minX)/2,this.maxY-(this.maxY-this.minY)/2)},t.prototype.area=function(){return this.width()*this.height()},t.prototype.transform=function(t){var e=new u;return e.ext2(this.LL().multiply3(t)),e.ext2(this.LR().multiply3(t)),e.ext2(this.UR().multiply3(t)),e.ext2(this.UL().multiply3(t)),e.build()},t.prototype.isSeparated=function(t){if((this.minX>=t.minX?this.minX:t.minX)>(this.maxX<=t.maxX?this.maxX:t.maxX))return!0;return(this.minY>=t.minY?this.minY:t.minY)>(this.maxY<=t.maxY?this.maxY:t.maxY)},t.prototype.relation=function(t){var e,r,i=0,o=0;if(this.minX>t.minX?(i++,e=this.minX):this.minX===t.minX?e=this.minX:(o++,e=t.minX),this.maxX<t.maxX?(i++,r=this.maxX):this.maxX===t.maxX?r=this.maxX:(o++,r=t.maxX),e>r)return n.SEPARATED;var a=void 0;this.minY>t.minY?(i++,a=this.minY):this.minY===t.minY?a=this.minY:(o++,a=t.minY);var s=void 0;return this.maxY<t.maxY?(i++,s=this.maxY):this.maxY===t.maxY?s=this.maxY:(o++,s=t.maxY),a>s?n.SEPARATED:4===i?n.INNER:4===o?n.OUTER:0===i&&0===o?n.EQ:e===r||a===s?n.OUTSIDE_TOUCHED:i!==o?n.INSIDE_TOUCHED:n.INTERSECTED},t.prototype.toString=function(){return"BBox [minX="+this.minX+", maxX="+this.maxX+", minY="+this.minY+", maxY="+this.maxY+"]"},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(4),o=r(6),a=r(1);!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.PERCENT=1]="PERCENT",t[t.LEFT_PAD0=2]="LEFT_PAD0"}(n||(n={}));var s=/(\.?0+)$/,u=function(){function t(){}return t.format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.format1(t,e)},t.format1=function(t,e){var r=this._format(t,e);if("string"==typeof r)return r;throw new Error(this.format("Invalid state on (%d) %s",r,t))},t._format=function(t,e){for(var r,a=[],s=n.UNKNOWN,u=0,l=0,h=0,c=0;c<t.length;c++){var f=t.charAt(c),p=f.charCodeAt(0);switch(s){case n.UNKNOWN:p===i.a.PERCENT?s=n.PERCENT:a.push(f);break;case n.PERCENT:switch(p){case i.a.d:if("number"!=typeof(r=e[u++]))return c;a.push(r.toFixed(0)),s=n.UNKNOWN;break;case i.a.f:if("number"!=typeof(r=e[u++]))return c;a.push(r.toString()),s=n.UNKNOWN;break;case i.a.x:if("number"!=typeof(r=e[u++]))return c;a.push((0|r).toString(16)),s=n.UNKNOWN;break;case i.a.X:if("number"!=typeof(r=e[u++]))return c;a.push((0|r).toString(16).toUpperCase()),s=n.UNKNOWN;break;case i.a.s:case i.a.c:r=e[u++],a.push(null===r?"null":r.toString()),s=n.UNKNOWN;break;case i.a.NUM0:l=c+1,h=-1,s=n.LEFT_PAD0;break;case i.a.PERCENT:a.push("%"),s=n.UNKNOWN;break;default:return c}break;case n.LEFT_PAD0:switch(p){case i.a.NUM0:case i.a.NUM1:case i.a.NUM2:case i.a.NUM3:case i.a.NUM4:case i.a.NUM5:case i.a.NUM6:case i.a.NUM7:case i.a.NUM8:case i.a.NUM9:h=c;break;case i.a.x:if(!(h>=l))return c;var d=parseInt(t.substring(l,h+1));if("number"!=typeof(r=e[u++]))return c;a.push(o.a.lpad((0|r).toString(16),"0",d)),s=n.UNKNOWN;break;case i.a.X:if(!(h>=l))return c;d=parseInt(t.substring(l,h+1));if("number"!=typeof(r=e[u++]))return c;a.push(o.a.lpad((0|r).toString(16).toUpperCase(),"0",d)),s=n.UNKNOWN;break;default:return c}break;default:return c}}return a.join("")},t.startsWith=function(t,e){return t.length>=e.length&&t.substring(0,e.length)===e},t.endsWith=function(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e},t.split=function(t,e){for(var r=new Array,n=0;;){var i=t.exec(e);if(null===i){var o=e.substring(n);a.a.nullOrEmpty(o)||r.push(o);break}var s=t.lastIndex-i[0].length;r.push(e.substring(n,s)),n=t.lastIndex}return r},t.fmtNumber=function(t){return t.toFixed(5).replace(s,"")},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return b}));var n,i=r(7),o=r(1),a=r(12),s=r(10),u=r(8),l=r(26),h=r(17),c=r(14),f=r(50),p=r(94),d=r(5),y=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),b=function(t){function e(e,r,n,i,o){var a=t.call(this)||this;return a.rx=e,a.ry=r,a.rx2=e*e,a.ry2=r*r,a.center=n,a.startAngle=i,a.sweepAngle=o,a._start=d.a.ORIGIN,a._end=d.a.ORIGIN,a._start=a.pointOn(i),a._end=a.pointOn(i+o),a.svgEnd=a.getSvgEnd(i,o,a._start,a._end),a.__bbox=a.buildBBox(),a}return y(e,t),e.prototype.getSvgEnd=function(t,e,r,n){for(var i=e>=0?-.01:.01,o=t+e;(e>=0&&o>t||e<0&&o<t)&&r.distance2(n)<2e-4;)o+=i*=2,n=this.pointOn(o);return n},e.build1=function(t,r,n,i,s,u){if(o.a.positive(n),o.a.positive(i),t.equals(r))return new e(.001,.001,t,0,s?360:0);var l=t.x,c=-t.y,f=r.x,p=-r.y,y=u===h.a.CW,b=(l-f)/2,v=(c-p)/2,m=Math.cos(0),w=Math.sin(0),g=m*b+w*v,x=-w*b+m*v,O=(n=Math.abs(n))*n,E=(i=Math.abs(i))*i,_=g*g,N=x*x,A=s===y?-1:1,T=(O*E-O*N-E*_)/(O*N+E*_);T=T<0?0:T;var S=A*Math.sqrt(T),R=S*(n*x/i),I=S*(-i*g/n),P=(l+f)/2+(m*R-w*I),C=(c+p)/2+(w*R+m*I),L=(g-R)/n,D=(x-I)/i,M=(-g-R)/n,k=(-x-I)/i,U=void 0,B=void 0;B=Math.sqrt(L*L+D*D),U=L,A=D<0?-1:1;var F=a.a.toDegrees(A*Math.acos(U/B));A=L*k-D*M<0?-1:1;var Y=(U=L*M+D*k)/(B=Math.sqrt((L*L+D*D)*(M*M+k*k))),G=void 0;G=Y<-1?Math.acos(-1):Y>1?Math.acos(1):Math.acos(Y);var z=a.a.toDegrees(A*G);!y&&z>0?z-=360:y&&z<0&&(z+=360),o.a.normal(F),o.a.normal(z);var W=t.distance1(r)/2;return n<W&&i<W&&(n=W,i=W),new e(n,i,new d.a(P,-C),a.a.regularD(-F),-z)},e.build2=function(t,r,n,i,s,u){var l;return o.a.positive(i),o.a.positive(s),o.a.normal(r),o.a.normal(n),r===n?(r=a.a.regularD(r),n=a.a.regularD(n),l=0):(r=a.a.regularD(r),n=a.a.regularD(n),u===h.a.CCW?n<=r&&(n+=360):n>=r&&(r+=360),l=n-r),new e(i,s,t,a.a.regularD(r),l)},e.build3=function(t,r,n,i,s){return o.a.positive(i),o.a.positive(s),o.a.normal(n),new e(i,s,t,a.a.regularD(r),n)},e.prototype.start=function(){return this._start},e.prototype.end=function(){return this._end},e.prototype.isLarge=function(){return Math.abs(this.sweepAngle)>180},e.prototype.sweep=function(){return this.sweepAngle>=0?h.a.CCW:h.a.CW},e.prototype.endAngle=function(){return this.startAngle+this.sweepAngle},e.prototype.pointOn=function(t){t=a.a.regularD(t);var e=this.rx,r=this.ry;if(0===t)return this.center.add1(e,0);if(90===t)return this.center.add1(0,r);if(180===t)return this.center.add1(-e,0);if(270===t)return this.center.add1(0,-r);var n=this.rx2,i=this.ry2,o=Math.tan(a.a.toRadians(t)),s=o*o,u=Math.sqrt(n*i/(n+i/s)),l=Math.sqrt(n*i/(i+n*s));return t>90&&t<270&&(l=-l),t>180&&t<360&&(u=-u),isNaN(l)&&(l=0),isNaN(u)&&(u=0),this.center.add1(l,u)},e.prototype.exchangeSweep=function(){return e.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,this.rx,this.ry)},e.prototype.sectorArea=function(){return Math.abs(this.sweepAngle)/360*Math.PI*this.rx*this.ry},e.prototype.area=function(){var t=f.a.area(this.center,this._start,this.pointOn(this.endAngle()));return this.sectorArea()-t},e.prototype.multiply3=function(t){var r,n;return r=t.isMirrored()?-this.sweepAngle:this.sweepAngle,n=t.equals(s.a.ROT_90)?a.a.regularD(this.startAngle+90):t.equals(s.a.ROT_N90)?a.a.regularD(this.startAngle-90):a.a.transformD(this.startAngle,t),e.build3(this.center.multiply3(t),n,r,t.iScale*this.rx,t.iScale*this.ry)},e.prototype.buildBBox=function(){var t=this.startAngle+this.sweepAngle,e=(new i.b).ext2(this._start).ext2(this.pointOn(t));if(this.sweepAngle>0)for(var r=0;r<t;)r>this.startAngle&&e.ext2(this.pointOn(r)),r+=90;else if(this.sweepAngle<0)for(r=360;r>t;)r<this.startAngle&&e.ext2(this.pointOn(r)),r-=90;return e.build()},e.prototype.bbox=function(){return this.__bbox},e.prototype.toString=function(){return u.a.format("Arc [start=%s, end=%s, rx=%s, ry=%s, center=%s, startAngle=%s, sweepAngle=%s]",this._start,this._end,this.rx,this.ry,this.center,this.startAngle,this.sweepAngle)},e.prototype.stroke=function(t,r,n){var i,o,a=t/2,u=this.rx+a,f=this.ry+a,p=this.rx-a,d=this.ry-a,y=new s.a;switch(p<0&&(p=-p,y=y.multiply3(s.a.MIRROR_Y)),d<0&&(d=-d,y=y.multiply3(s.a.MIRROR_X)),0===p&&(p=.001),0===d&&(d=.001),y=y.setOrigin1(this.center),n===this.sweep()?(i=e.build3(this.center,this.startAngle,this.sweepAngle,u,f),o=e.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,p,d)):(i=e.build3(this.center,this.startAngle+this.sweepAngle,-this.sweepAngle,u,f),o=e.build3(this.center,this.startAngle,this.sweepAngle,p,d)),o=o.multiply3(y),r){case l.a.ROUND:var b=n===h.a.CCW?180:-180,v=n===this.sweep()?this.pointOn(this.endAngle()):this.pointOn(this.startAngle),m=n===this.sweep()?this.pointOn(this.startAngle):this.pointOn(this.endAngle()),w=i.pointOn(i.endAngle()).angleD(v),g=o.pointOn(o.endAngle()).angleD(m);return c.a.build2([i,e.build3(v,w,b,a,a),o,e.build3(m,g,b,a,a)]);default:return c.a.build2([i,o])}},e.prototype.points=function(t){if(this.rx<=t)return[this.start(),this.svgEnd];for(var e=(this.rx-t)/this.rx,r=Math.ceil(Math.abs(this.sweepAngle/a.a.toDegrees(Math.acos(e))/2)),n=new Array(r+1),i=this.sweepAngle/r,o=this.startAngle,s=0;s<=r;s++,o+=i)n[s]=this.pointOn(o);return n},e.prototype.panDistance=function(t){return this.sweepAngle>0?new e(this.rx-t,this.ry-t,this.center,this.startAngle,this.sweepAngle):new e(this.rx+t,this.ry+t,this.center,this.startAngle,this.sweepAngle)},e}(p.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(58),o=r(12),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=[1,0,0,0,1,0,0,0,1],u=function(t){function e(e){void 0===e&&(e=s);var r=t.call(this,3,3,e)||this,n=e[0],i=e[3],o=e[1],a=e[4];return r.iScale=Math.sqrt(n*n+o*o),r.jScale=Math.sqrt(i*i+a*a),r}return a(e,t),e.translate=function(t,r){return new e([1,0,0,0,1,0,t,r,1])},e.translate1=function(t){return this.translate(t.x,t.y)},e.rotate=function(t){var r=Math.cos(t),n=Math.sin(t);return new e([r,n,0,-n,r,0,0,0,1])},e.rotateD=function(t){return this.rotate(o.a.toRadians(t))},e.scale=function(t){return new e([t,0,0,0,t,0,0,0,1])},e.prototype.isMirrored=function(){return this.det()<0},e.prototype.multiply3=function(t){var r=new Array(9);return i.a.mul(3,3,3,this.data,t.data,r),new e(r)},e.prototype.translate=function(t,r){return this.multiply3(e.translate(t,r))},e.prototype.translate1=function(t){return this.multiply3(e.translate1(t))},e.prototype.scale=function(t){return this.multiply3(e.scale(t))},e.prototype.det=function(){return this.data[0]*this.data[4]-this.data[3]*this.data[1]},e.prototype.invert=function(){return new e(this.invert().data)},e.prototype.rotateD=function(t){return this.multiply3(e.rotateD(t))},e.prototype.rotate=function(t){return this.multiply3(e.rotate(t))},e.prototype.resetOffset=function(){var t=this.data;return new e([t[0],t[1],0,t[3],t[4],0,0,0,1])},e.prototype.setOrigin=function(t,r){return e.translate(-t,-r).multiply3(this).translate(t,r)},e.prototype.setOrigin1=function(t){return this.setOrigin(t.x,t.y)},e.MIRROR_Y=new e([1,0,0,0,-1,0,0,0,1]),e.MIRROR_X=new e([-1,0,0,0,1,0,0,0,1]),e.ROT_90=new e([0,1,0,-1,0,0,0,0,1]),e.ROT_N90=new e([0,-1,0,1,0,0,0,0,1]),e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(1),i=new ArrayBuffer(24),o=new Float64Array(i),a=new Int32Array(i),s=function(){function t(t,e,r){this.x=n.a.normal(t),this.y=n.a.normal(e),this.z=n.a.normal(r),o[0]=t,o[1]=e,o[2]=r,this.hashed=a[0]^a[1]^a[2]^a[3]^a[4]^a[5]}return t.normal=function(t,e,r){var n=e.sub(t),i=r.sub(e);return n.cross(i)},t.prototype.hashCode=function(){return this.hashed},t.prototype.equals=function(e){return e instanceof t&&(e.x===this.x&&e.y===this.y&&e.z===this.z)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.normalize=function(){var e=this.length();return new t(this.x/e,this.y/e,this.z/e)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.neg=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.multiply4=function(e){var r=this.x*e.data[0]+this.y*e.data[4]+this.z*e.data[8]+e.data[12],n=this.x*e.data[1]+this.y*e.data[5]+this.z*e.data[9]+e.data[13],i=this.x*e.data[2]+this.y*e.data[6]+this.z*e.data[10]+e.data[14],o=this.x*e.data[3]+this.y*e.data[7]+this.z*e.data[11]+e.data[15];return 0!=o?new t(r/o,n/o,i/o):new t(r,n,i)},t.ORIGIN=new t(0,0,0),t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(5),i=function(){function t(){}return t.toDegrees=function(t){return 180*t/Math.PI},t.toRadians=function(t){return t/180*Math.PI},t.regularD=function(t){return(t%=360)<0?360+t:t},t.regular=function(e){return(e%=t.PIx2)<0?t.PIx2+e:e},t.toQuarterBase=function(e){return t.regular((e+t.PI_4)/t.PI_2*t.PI_2)},t.toQuarterBaseD=function(e){return t.regularD(90*((e+45)/90|0))},t.transformD=function(e,r){return t.toDegrees(t.transform(t.toRadians(e),r))},t.transform=function(e,r){var i=Math.cos(e),o=Math.sin(e),a=new n.a(r.data[6],r.data[7]),s=new n.a(i,o).multiply3(r);return t.regular(s.angle(a))},t.PIx2=2*Math.PI,t.PI_2=Math.PI/2,t.PI_4=Math.PI/4,t}()},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"d",(function(){return c})),r.d(e,"c",(function(){return o})),r.d(e,"a",(function(){return f}));var n,i,o,a=r(25),s=r(10),u=r(7),l=r(12),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function c(t){switch(t){case i.INPUT:return"INPUT";case i.IO:return"IO";case i.OUTPUT:return"OUTPUT";case i.OPEN_COLLECTOR:return"OPEN_COLLECTOR";case i.PASSIVE:return"PASSIVE";case i.HIZ:return"HIZ";case i.EMITTER:return"EMITTER";case i.POWER:return"POWER"}}!function(t){t[t.INPUT=0]="INPUT",t[t.IO=1]="IO",t[t.OUTPUT=2]="OUTPUT",t[t.OPEN_COLLECTOR=3]="OPEN_COLLECTOR",t[t.PASSIVE=4]="PASSIVE",t[t.HIZ=5]="HIZ",t[t.EMITTER=6]="EMITTER",t[t.POWER=7]="POWER"}(i||(i={})),function(t){t[t.POSTPONED_OUTPUT=0]="POSTPONED_OUTPUT",t[t.OPEN_COLLECTOR=1]="OPEN_COLLECTOR",t[t.HIZ=2]="HIZ",t[t.HIGH_CURRENT=3]="HIGH_CURRENT",t[t.PULSE=4]="PULSE",t[t.SCHMITT=5]="SCHMITT",t[t.OPEN_COLLECTOR_PULL_UP=6]="OPEN_COLLECTOR_PULL_UP",t[t.OPEN_EMITTER=7]="OPEN_EMITTER",t[t.OPEN_EMITTER_PULL_UP=8]="OPEN_EMITTER_PULL_UP",t[t.SHIFT_LEFT=9]="SHIFT_LEFT",t[t.OPEN_OUTPUT=10]="OPEN_OUTPUT",t[t.CLOCK=11]="CLOCK",t[t.DOT=12]="DOT",t[t.ACTIVE_LOW_INPUT=13]="ACTIVE_LOW_INPUT",t[t.ACTIVE_LOW_OUTPUT=14]="ACTIVE_LOW_OUTPUT",t[t.RIGHT_LEFT_SIGNAL_FLOW=15]="RIGHT_LEFT_SIGNAL_FLOW",t[t.ANALOG_SIGNAL_IN=16]="ANALOG_SIGNAL_IN",t[t.NOT_LOGIC_CONNECTION=17]="NOT_LOGIC_CONNECTION",t[t.DIGITAL_SIGNAL_IN=18]="DIGITAL_SIGNAL_IN",t[t.LEFT_RIGHT_SIGNAL_FLOW=19]="LEFT_RIGHT_SIGNAL_FLOW",t[t.BIDIRECTIONAL_SIGNAL_FLOW=20]="BIDIRECTIONAL_SIGNAL_FLOW"}(o||(o={}));var f=function(t){function e(e,r,n,i,o,a,s,u,h,c,f){var p=t.call(this,"")||this;return p.location=e,p.orientation=l.a.regularD(r),p.color=n,p.length=i,p.visible=o,p.name=a,p.nameVisible=s,p.number=u,p.numVisible=h,p.electrical=c,p.pinShapes=f,p}return h(e,t),e.prototype.multiply3=function(t){return new e(this.location.multiply3(t),l.a.transformD(this.orientation,t),this.color,t.iScale*this.length,this.visible,this.name.multiply3(t),this.nameVisible,this.number.multiply3(t),this.numVisible,this.electrical,this.pinShapes)},e.prototype.bbox=function(){var t=this.location,e=s.a.rotateD(this.orientation).setOrigin1(t);return(new u.b).ext2(t).ext2(t.add1(this.length,0).multiply3(e)).build()},e}(a.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r(7),i=r(22),o=r(2),a=r(6),s=r(9),u=r(62),l=r(5),h=r(50),c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(){function t(t,e){this.primitives=t,this.__bbox=e}return t.calcBBox=function(t){for(var e=new n.b,r=0;r<t.length;r++){var i=t[r];e.ext1(i.bbox())}return e.build()},t.build1=function(e){var r=[],n=null;return Object(i.c)(e,(function(t,e){var i=e.start(),a=e.end();return null===n||i.equals(n)||r.push(new o.a(n,i)),r.push(e),n=a,!0})),0===r.length&&null!=n&&r.push(new o.a(n,n)),new t(r,t.calcBBox(r))},t.build2=function(e){return t.build1(Object(i.a)(e))},t.build3=function(e){var r=new n.b,a=[],s=null;return Object(i.c)(e,(function(t,e){return null!==s&&a.push(new o.a(s,e)),r.ext2(e),s=e,!0})),new t(a,r.build())},t.build4=function(t){return this.build3(Object(i.a)(t))},t.build5=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(new l.a(t[r],t[r+1]));return this.build4(e)},t.prototype.area=function(t){var e=null,r=null,n=0;return this.points(t,(function(t){r?n+=(t.x+r.x)*(t.y-r.y):e=t,r=t})),(n+=(e.x+r.x)*(e.y-r.y))/2},t.prototype.closed=function(){if(this.primitives.length<=1)return!1;var t=this.primitives[0],e=this.primitives[this.primitives.length-1];return t.start().equals(e.end())},t.prototype.asClosed=function(){var e=this.primitives[0],r=this.primitives[this.primitives.length-1],n=e.start(),i=r.end();if(n.equals(i))return this;var s=new Array;return a.a.addAll(s,this.primitives),s.push(new o.a(i,n)),t.build2(s)},t.prototype.reverse=function(){for(var e=new Array(this.primitives.length),r=0,n=this.primitives.length-1;n>=0;r++,n--){var i=this.primitives[n];if(i instanceof o.a)i=new o.a(i.end(),i.start());else if(i instanceof s.a)i=i.exchangeSweep();else{if(!(i instanceof u.a))throw new Error("bug");var a=i._points.reverse();i=new u.a(a)}e[r]=i}return new t(e,this.__bbox)},t.prototype.simplify=function(e){var r,n,i=new Array,a=new Array;try{for(var s=c(this.primitives),u=s.next();!u.done;u=s.next()){var l=u.value,f=l.start(),p=l.end();if(l instanceof o.a)if(a.length>0){var d=a[a.length-1];h.a.area(d,f,p)>e&&a.push(f)}else a.push(f);else{a.push(f);for(var y=1;y<a.length;y++)i.push(new o.a(a[y-1],a[y]));a.length=0,i.push(l)}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}if(a.length>0){f=this.primitives[0].start();a[a.length-1].equals(f)||a.push(f);for(y=1;y<a.length;y++)i.push(new o.a(a[y-1],a[y]))}try{return new t(i,t.calcBBox(i))}catch(t){return null}},t.prototype.points=function(t,e){var r,n,i,o;try{for(var a=c(this.primitives),s=a.next();!s.done;s=a.next()){var u=s.value;try{for(var l=(i=void 0,c(u.points(t))),h=l.next();!h.done;h=l.next()){e(h.value)}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.multiply3=function(e){for(var r=new n.b,i=new Array(this.primitives.length),o=0;o<this.primitives.length;o++){var a=this.primitives[o].multiply3(e);i[o]=a,r.ext1(a.bbox())}return new t(i,r.build())},t.prototype.bbox=function(){return this.__bbox},t}()},function(t,e,r){"use strict";r.d(e,"d",(function(){return i})),r.d(e,"g",(function(){return g})),r.d(e,"c",(function(){return O})),r.d(e,"e",(function(){return E})),r.d(e,"b",(function(){return x})),r.d(e,"a",(function(){return _})),r.d(e,"f",(function(){return N}));var n,i,o=r(10),a=r(35),s=r(7),u=r(14),l=r(0),h=r(1),c=r(8),f=r(2),p=r(26),d=r(17),y=r(9),b=r(12),v=r(109),m=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),w=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function g(t){switch(t){case i.ROUND:return"ROUND";case i.RECTANGLE:return"RECTANGLE";case i.ROUND_RECTANGLE:return"ROUND_RECTANGLE";case i.OCTAGONAL:return"OCTAGONAL";case i.POLYGON:return"POLYGON"}}!function(t){t[t.ROUND=0]="ROUND",t[t.RECTANGLE=1]="RECTANGLE",t[t.ROUND_RECTANGLE=2]="ROUND_RECTANGLE",t[t.OCTAGONAL=3]="OCTAGONAL",t[t.POLYGON=4]="POLYGON"}(i||(i={}));var x,O=function(){function t(t,e,r,n,o){if(t===i.POLYGON?this.outline=h.a.notnull(o):this.outline=h.a.mustnull(o),this.type=t,this.xSize=e,this.ySize=r,!(0<=n&&n<=100))throw new Error("cornerRadius is only allowed 0-100");this.cornerRadius=n}return t.prototype.transform=function(e){var r=null!==this.outline?this.outline.multiply3(e):null;return new t(this.type,e.iScale*this.xSize,e.iScale*this.ySize,this.cornerRadius,r)},t.prototype.equals=function(e){return null!==e&&e instanceof t&&(e.type===this.type&&(e.xSize===this.xSize&&(e.ySize===this.ySize&&e.cornerRadius===this.cornerRadius)))},t}(),E=function(){function t(t,e,r,n,i,o){t.type===l.a.MULTI?(h.a.notnull(n),h.a.notnull(i),h.a.notnull(o)):t.type===l.a.TOP_COPPER?(h.a.notnull(n),h.a.mustnull(i),h.a.mustnull(o)):t.type===l.a.BOT_COPPER?(h.a.mustnull(n),h.a.mustnull(i),h.a.notnull(o)):(h.a.mustnull(n),h.a.notnull(i),h.a.mustnull(o)),this.offsetX=h.a.normal(e),this.offsetY=h.a.normal(r),this.top=n,this.inner=i,this.bot=o,this.layer=t}return t.prototype.transform=function(e){var r=null!==this.top?this.top.transform(e):null,n=null!==this.inner?this.inner.transform(e):null,i=null!==this.bot?this.bot.transform(e):null;return new t(this.layer,e.iScale*this.offsetX,e.iScale*this.offsetY,r,n,i)},t}();!function(t){t[t.ROUND=0]="ROUND",t[t.SQUARE=1]="SQUARE",t[t.SLOT=2]="SLOT"}(x||(x={}));var _=function(){function t(t,e,r,n){if(r<e)throw new Error(c.a.format("hole size %f must less or eq than hole length %f",e,r));this.type=t,this.size=h.a.positiveOr0(e),this.length=h.a.positiveOr0(r),this.rotation=n}return t.prototype.transform=function(e){return new t(this.type,e.iScale*this.size,e.iScale*this.length,this.rotation)},t}(),N=function(t){function e(e,r,n,i,o,a,s,u,l,c,f){var p=t.call(this,e,r,n)||this;return p.location=i,p.rotation=o,p.shapes=a,p.hole=s,p.pasteMaskEx=h.a.normal(u),p.solderMaskEx=h.a.normal(l),p.designator=c,p.plated=f,p.__bbox=p._bbox(),p}return m(e,t),e.prototype.multiply3=function(t){return new e(this.id,this.net,this.layer,this.location.multiply3(t),b.a.transformD(this.rotation,t),this.shapes.transform(t),this.hole.transform(t),this.pasteMaskEx*t.iScale,this.solderMaskEx*t.iScale,this.designator,this.plated)},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t,e,r=new s.b,n=0,i=0;try{for(var a=w([this.shapes.top,this.shapes.inner,this.shapes.bot]),u=a.next();!u.done;u=a.next()){var h=u.value;null!==h&&(n<h.xSize&&(n=h.xSize),i<h.ySize&&(i=h.ySize),null!==h.outline&&r.ext1(h.outline.bbox()))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}n/=2,i/=2;var c=this.location.add1(-n,i),f=this.location.add1(n,-i),p=o.a.rotateD(this.rotation).setOrigin1(this.location).translate(this.shapes.offsetX,this.shapes.offsetY);return r.ext2(c.multiply3(p)).ext2(f.multiply3(p)),this.layer.type===l.a.MULTI&&(n=this.hole.size/2,i=this.hole.length/2,c=this.location.add1(-n,i),f=this.location.add1(n,-i),p=o.a.rotateD(this.rotation+this.hole.rotation).setOrigin1(this.location),r.ext2(c.multiply3(p)).ext2(f.multiply3(p))),r.build()},e.prototype.shape=function(t,e){var r=o.a.translate(this.shapes.offsetX,this.shapes.offsetY).multiply3(o.a.rotateD(this.rotation).setOrigin1(this.location));if(t.type!==l.a.MULTI)return null!==this.shapes.top&&t.type===l.a.TOP_COPPER?this.generate1(this,this.shapes.top,e,r):null!==this.shapes.bot&&t.type===l.a.BOT_COPPER?this.generate1(this,this.shapes.bot,e,r):null!==this.shapes.inner&&t.type===l.a.INNER?this.generate1(this,this.shapes.inner,e,r):null;if(this.hole.size>0&&this.hole.length>0){var n=this.hole.size/2,i=this.hole.length/2,a=void 0;switch(this.hole.type){case x.SLOT:a=new f.a(this.location.add1(-i+n,0),this.location.add1(i-n,0)).stroke(this.hole.size,p.a.ROUND,d.a.CW);break;case x.SQUARE:a=new f.a(this.location.add1(-n,0),this.location.add1(n,0)).stroke(this.hole.size,p.a.BUTT,d.a.CW);break;default:a=u.a.build2([y.a.build3(this.location,0,-360,n,n)])}return a.multiply3(o.a.rotateD(this.rotation+this.hole.rotation).setOrigin1(this.location))}return null},e.prototype.generate1=function(t,e,r,n){var o=2*r;switch(e.type){case i.OCTAGONAL:var a=void 0,s=void 0;if(e.xSize>=e.ySize){var l=e.xSize-e.ySize;s=e.ySize,a=new f.a(t.location.add1(-l,0),t.location.add1(l,0))}else{l=e.ySize-e.xSize;s=e.xSize,a=new f.a(t.location.add1(0,-l),t.location.add1(0,l))}return(s+=o)>0?a.stroke(s+o,p.a.ROUND,d.a.CW).multiply3(n):null;case i.RECTANGLE:if(r>0)return this.roundRectangle(t,e,r).multiply3(n);var h=e.xSize/2+r,c=e.ySize+o;return h>0&&c>0?new f.a(t.location.add1(-h,0),t.location.add1(h,0)).stroke(c,p.a.BUTT,d.a.CW).multiply3(n):null;case i.ROUND_RECTANGLE:h=e.xSize/2+r,c=e.ySize+o;return h>0&&c>0?new f.a(t.location.add1(-h,0),t.location.add1(h,0)).stroke(c,p.a.BUTT,d.a.CW).multiply3(n):null;case i.POLYGON:if(0!==r&&null!==e.outline){var b=e.outline.bbox();if(b.width()+o>0&&b.height()+o>0){var m=e.outline;return m=m.area(.01)>0?m.reverse():m,v.a.zoomCorner(m,r)}return null}return e.outline;default:if(e.xSize+o>0&&e.ySize+o>0){if(e.xSize===e.ySize)return u.a.build2([y.a.build3(t.location,0,-360,e.xSize/2+r,e.ySize/2+r)]).multiply3(n);if(e.xSize<e.ySize){h=e.xSize+o,c=(e.ySize-e.xSize)/2;return new f.a(t.location.add1(0,-c),t.location.add1(0,c)).stroke(h,p.a.ROUND,d.a.CW).multiply3(n)}h=(e.xSize-e.ySize)/2,c=e.ySize+o;return new f.a(t.location.add1(-h,0),t.location.add1(h,0)).stroke(c,p.a.ROUND,d.a.CW).multiply3(n)}return null}},e.prototype.roundRectangle=function(t,e,r){return u.a.build2([new f.a(t.location.add1(-e.xSize/2,e.ySize/2+r),t.location.add1(e.xSize/2,e.ySize/2+r)),y.a.build3(t.location.add1(e.xSize/2,e.ySize/2),90,-90,r,r),new f.a(t.location.add1(e.xSize/2+r,e.ySize/2),t.location.add1(e.xSize/2+r,-e.ySize/2)),y.a.build3(t.location.add1(e.xSize/2,-e.ySize/2),0,-90,r,r),new f.a(t.location.add1(e.xSize/2,-e.ySize/2-r),t.location.add1(-e.xSize/2,-e.ySize/2-r)),y.a.build3(t.location.add1(-e.xSize/2,-e.ySize/2),-90,-90,r,r),new f.a(t.location.add1(-e.xSize/2-r,-e.ySize/2),t.location.add1(-e.xSize/2-r,e.ySize/2)),y.a.build3(t.location.add1(-e.xSize/2,e.ySize/2),-180,-90,r,r)])},e}(a.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"g",(function(){return i})),r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return a})),r.d(e,"f",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return l}));var n=6,i=2,o=12,a=o-i,s=6,u=22,l=u-i},function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t[t.CW=0]="CW",t[t.CCW=1]="CCW"}(n||(n={}))},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return u}));var n,i,o=r(35),a=r(0),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t[t.SOLID=0]="SOLID",t[t.POLYGON_CUTOUT=1]="POLYGON_CUTOUT",t[t.BOARD_CUTOUT=2]="BOARD_CUTOUT"}(i||(i={}));var u=function(t){function e(e,r,n,i){var o=t.call(this,"",e,r)||this;return o.kind=n,o.outlines=i,o.__bbox=o._bbox(),o}return s(e,t),e.prototype.multiply3=function(t){return new e(this.net,this.layer,this.kind,this.outlines.multiply3(t))},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){return this.outlines.bbox()},e.prototype.shape=function(t,e){return this.layer.equals(t)||this.layer.equals(a.c.MULTI)?this.outlines:null},e}(o.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){}return t.regular=function(t){return Math.round(t*this.precision)/this.precision},t.eq=function(t,e){return Math.abs(t-e)<=this.eps},t.neq=function(t,e){return Math.abs(t-e)>this.eps},t.less=function(t,e){return t-e<-this.eps},t.lesseq=function(t,e){return t-e<this.eps},t.greater=function(t,e){return t-e>this.eps},t.greatereq=function(t,e){return t-e>-this.eps},t.sqrt=function(t){return Math.abs(t)<=1e-10?0:Math.sqrt(t)},t.sortAsc=function(t,e){return t-e},t.sortDesc=function(t,e){return e-t},t.eps=1e-8,t.precision=1e8,t}()},function(t,e,r){"use strict";r.d(e,"c",(function(){return d})),r.d(e,"a",(function(){return y})),r.d(e,"b",(function(){return b}));var n,i=r(1),o=r(35),a=r(7),s=r(0),u=r(2),l=r(9),h=r(14),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},p=function(){},d=function(t){function e(e){var r=t.call(this)||this;return r.neckThickness=i.a.positiveOr0(e),r}return c(e,t),e.prototype.transform=function(t){return new e(this.neckThickness*t.iScale)},e}(p),y=function(t){function e(e,r){var n=t.call(this)||this;return n.gridWidth=i.a.positive(e),n.gridClearance=i.a.positive(r),n}return c(e,t),e.prototype.transform=function(t){var r=t.iScale;return new e(this.gridWidth*r,this.gridClearance*r)},e}(p),b=function(t){function e(e,r,n,o,a,s,h,c,p,d,y){var b,v,m=t.call(this,e,r,n)||this;try{for(var w=f(d),g=w.next();!g.done;g=w.next()){var x=g.value;if(!(x instanceof u.a||x instanceof l.a))throw new Error("invalid outlines, must be Line or Arc")}}catch(t){b={error:t}}finally{try{g&&!g.done&&(v=w.return)&&v.call(w)}finally{if(b)throw b.error}}return m.method=o,m.outlineClearance=i.a.normal(a),m.clearance=i.a.positive(s),m.thermal=h,m.keepIsland=c,m.pourIndex=p,m.outlines=d,m.coppered=y,m.__bbox=m._bbox(),m}return c(e,t),e.prototype.multiply3=function(t){for(var r,n,i=new Array(this.outlines.length),o=0;o<this.outlines.length;o++)i[o]=this.outlines[o].multiply3(t);if(null!==this.coppered){r=new Array(this.coppered.length);for(o=0;o<this.coppered.length;o++)r[o]=this.coppered[o].multiply3(t)}else r=null;return n=null==this.method?null:this.method.transform(t),new e(this.id,this.net,this.layer,n,this.outlineClearance*t.iScale,this.clearance*t.iScale,this.thermal,this.keepIsland,this.pourIndex,i,r)},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t,e,r=new a.b;try{for(var n=f(this.outlines),i=n.next();!i.done;i=n.next()){var o=i.value;r.ext1(o.bbox())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r.build()},e.prototype.shape=function(t,e){return this.layer.equals(t)||this.layer.equals(s.c.MULTI)?h.a.build2(this.outlines):null},e}(o.a)},function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return a}));var n=r(29),i=r(1);function o(t,e,r,i,o,s,u,l,h,c,f){void 0===f&&(f=1);var p=new n.a(t,e,r),d=new n.a(i,o,s),y=new n.a(u,l,h);return new a(p,d,y,5*c,f)}var a=function(t,e,r,n,o){if(o<0||o>1)throw new Error("opacity must between 0 and 1");this.ambient=t,this.diffuse=e,this.specular=r,this.shininess=i.a.positiveOr0(n),this.opacity=o}},function(t,e,r){"use strict";function n(t,e){i(t.iterator(),e)}function i(t,e){for(var r=0;t.hasNext();){e(r++,t.next())}}r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return a}));!function(){function t(t){this.lst=t}t.prototype.iterator=function(){return new o(this.lst)}}();var o=function(){function t(t){this.idx=-1,this.lst=t}return t.prototype.hasNext=function(){return this.idx<this.lst.length-1},t.prototype.next=function(){if(this.idx<this.lst.length-1)return this.idx++,this.lst[this.idx];throw new Error("bug")},t}();function a(t){return new o(t)}},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return u})),r.d(e,"a",(function(){return l}));var n,i,o=r(25),a=r(12),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function u(t){switch(t){case i.CIRCLE:return"CIRCLE";case i.ARROW:return"ARROW";case i.BAR:return"BAR";case i.WAVE:return"WAVE";case i.POWER_GROUND:return"POWER_GROUND";case i.SIGNAL_GROUND:return"SIGNAL_GROUND";case i.EARTH:return"EARTH"}}!function(t){t[t.CIRCLE=0]="CIRCLE",t[t.ARROW=1]="ARROW",t[t.BAR=2]="BAR",t[t.WAVE=3]="WAVE",t[t.POWER_GROUND=4]="POWER_GROUND",t[t.SIGNAL_GROUND=5]="SIGNAL_GROUND",t[t.EARTH=6]="EARTH"}(i||(i={}));var l=function(t){function e(e,r,n,i,o,a){var s=t.call(this,"")||this;return s.net=e,s.type=r,s.showNetName=n,s.location=i,s.color=o,s.orientation=a,s}return s(e,t),e.prototype.multiply3=function(t){return new e(this.net.multiply3(t),this.type,this.showNetName,this.location.multiply3(t),this.color,a.a.transformD(this.orientation,t))},e.prototype.bbox=function(){return this.net.bbox()},e}(o.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"d",(function(){return p})),r.d(e,"c",(function(){return d})),r.d(e,"b",(function(){return y})),r.d(e,"e",(function(){return _}));var n=r(2),i=r(9),o=r(19),a=r(50),s=r(106),u=r(45),l=r(12),h=r(5),c=new Float64Array(100);function f(t,e,r,n,i){if(!(t.length>=e+i&&r.length>=n+i))throw new Error("arraycopy out of range");for(;i-- >0;)r[n++]=t[e++]}function p(t,e){if(t instanceof n.a&&e instanceof n.a)return v(t,e);if(t instanceof i.a&&e instanceof n.a)return x(t,e);if(t instanceof n.a&&e instanceof i.a)return x(e,t);if(t instanceof i.a&&e instanceof i.a)return function(t,e){if(null!=t.bbox().intersection1(e.bbox())){if(t.rx===t.ry&&e.rx===e.ry)return function(t,e){var r=t.center.x,i=t.center.y,a=e.center.x,s=e.center.y,u=t.rx,l=e.rx,f=t.rx2,p=e.rx2,d=t.center.distance2(e.center),y=(u-l)*(u-l),b=(u+l)*(u+l);if(o.a.greater(d,b)||o.a.less(d,y))return 0;if(o.a.eq(d,b)){var v=0,m=0,g=new n.a(t.center,e.center);return m+=w(e,g),E(t,e,v,m)}if(o.a.greater(y,0)&&o.a.greater(d,0)&&o.a.eq(d,y)){v=0;if(u>l){var x=(u-l)/u;return c[0]=r+(a-r)/x,c[1]=i+(s-i)/x,E(t,e,v,2)}x=(l-u)/l;return c[0]=a+(r-a)/x,c[1]=s+(i-s)/x,E(t,e,v,2)}if(o.a.eq(y,0)&&o.a.eq(d,0)&&o.a.eq(d,y)){m=0;return _(t,e.start())&&(c[m]=e.start().x,c[m+1]=e.start().y,m+=2),_(t,e.end())&&(c[m]=e.end().x,c[m+1]=e.end().y,m+=2),_(e,t.start())&&(c[m]=t.start().x,c[m+1]=t.start().y,m+=2),_(e,t.end())&&(c[m]=t.end().x,c[m+1]=t.end().y,m+=2),m}v=0,m=0;var O=Math.sqrt(d),N=(a-r)*(x=(d-p+f)/(2*O)/O)+r,A=(s-i)*x+i,T=o.a.regular(a-r),S=o.a.regular(s-i),R=Math.max(u,l);if(0!==S){var I=T/-S,P=A-I*N;g=new n.a(new h.a(N-R,I*(N-R)+P),new h.a(N+R,I*(N+R)+P));m+=w(e,g)}else{g=new n.a(new h.a(N,A-R),new h.a(N,A+R));m+=w(e,g)}return E(t,e,v,m)}(t,e);throw new Error("not supported operation")}return 0}(t,e);throw new Error("not supported operation")}function d(t,e){var r=t.bbox();return r.isContainsY1(e)&&v(new n.a(new h.a(r.minX-1,e),new h.a(r.maxX+1,e)),t)>0?1:0}function y(t,e){if(t.rx===t.ry){var r=t.bbox();return r.isContainsY1(e)&&w(t,new n.a(new h.a(r.minX-1,e),new h.a(r.maxX+1,e)))>0?1:0}throw new Error("not supported operation")}function b(t,e,r){return!(!isFinite(e)||!isFinite(r))&&t.isContains2(e,r)}function v(t,e){if(t.isPoint1())return m(e,t.start());if(e.isPoint1())return m(t,e.start());var r=function(t,e){var r=t.bbox().intersection1(e.bbox());if(null!=r){var n=u.a.crossProd3(e.start(),e.end(),t.start()),i=u.a.crossProd3(e.start(),e.end(),t.end());return Math.abs(n)<1e-10||Math.abs(i)<1e-10||n*i<0?r:null}return null}(t,e);if(null!=r){var n=0,i=t.start().x,o=t.start().y,s=t.end().x,l=t.end().y,h=e.start().x,f=e.start().y,p=e.end().x,d=e.end().y,y=NaN,v=NaN,w=i,g=o,x=s,O=l,E=a.a.area2(w,g,h,f,p,d),_=a.a.area2(x,O,h,f,p,d);if(E<1e-10&&_<1e-10){var N=r.UL(),A=r.UR(),T=r.LL(),S=r.LR();if(0==r.height()&&0==r.width())c[n++]=N.x,c[n++]=N.y;else if(0==r.width())c[n++]=N.x,c[n++]=N.y,c[n++]=T.x,c[n++]=T.y;else if(0==r.height())c[n++]=N.x,c[n++]=N.y,c[n++]=A.x,c[n++]=A.y;else{a.a.area2(N.x,N.y,h,f,p,d)<a.a.area2(A.x,A.y,h,f,p,d)?(c[n++]=N.x,c[n++]=N.y,c[n++]=S.x,c[n++]=S.y):(c[n++]=A.x,c[n++]=A.y,c[n++]=T.x,c[n++]=T.y)}}else if(E<1e-10)y=w,v=g;else if(_<1e-10)y=x,v=O;else for(var R=Number.POSITIVE_INFINITY;R>0;){0;var I=E/(E+_);y=w+(x-w)*I,v=g+(O-g)*I;var P=a.a.area2(y,v,h,f,p,d);if(E===_||w===y&&g===v||x===y&&O===v){P>2e-8&&(y=NaN,v=NaN);break}R=P,E<_?(x=y,O=v,_=R):(w=y,g=v,E=R)}return b(r,y,v)&&(c[n++]=y,c[n++]=v),n}return 0}function m(t,e){return t.isPoint()?e.equals1(t.start())?(c[0]=e.x,c[1]=e.y,2):0:o.a.eq(a.a.area2(t.start().x,t.start().y,t.end().x,t.end().y,e.x,e.y),0)?(c[0]=e.x,c[1]=e.y,2):0}function w(t,e){var r=t.bbox().intersection1(e.bbox());if(null!=r){var n=t.center.x,i=t.center.y,l=t.rx2,h=e.start().x,p=e.start().y,d=e.end().x,y=e.end().y,b=t.center.distance2(e.start()),v=t.center.distance2(e.end()),m=0;if(o.a.less(b,l)&&o.a.less(v,l))return 0;if(o.a.eq(b,l)&&o.a.eq(v,l))c[m++]=h,c[m++]=p,c[m++]=d,c[m++]=y;else if(o.a.greater(b,l)&&o.a.greater(v,l)){var w=s.a.foot(e,t.center),x=w.distance2(t.center);if(o.a.greater(x,l))return 0;if(o.a.eq(x,l)){var E=w.distance2(t.start()),_=w.distance2(t.end());o.a.eq(E,0)?(c[m++]=t.start().x,c[m++]=t.start().y):o.a.eq(_,0)?(c[m++]=t.end().x,c[m++]=t.end().y):(c[m++]=w.x,c[m++]=w.y)}else{var N=t.start().x,A=t.start().y,T=t.end().x,S=t.end().y;if(a.a.area2(N,A,h,p,d,y)<2e-8&&(c[m++]=N,c[m++]=A),a.a.area2(T,S,h,p,d,y)<2e-8&&(c[m++]=T,c[m++]=S),m<4){m=function(t,e,r,n,i,o,a){if(0==u.a.crossProd2(r,n,i,o,t,e)){var s=u.a.dotProd2(r,n,i,o,t,e),l=u.a.dotProd2(i,o,r,n,t,e);return s<0&&l<0?(c[a++]=t,c[a++]=e,a):s>=0?(c[a++]=i,c[a++]=o,a):(c[a++]=r,c[a++]=n,a)}for(var h=NaN,f=NaN,p=r,d=n,y=i,b=o,v=u.a.distance2(r,n,t,e),m=u.a.distance2(i,o,t,e),w=Number.POSITIVE_INFINITY;w>0&&(h=p+.5*(y-p),f=d+.5*(b-d),!(v==m||p==h&&d==f||y==h&&b==f));){w=u.a.distance2(h,f,t,e);var g=u.a.dotProd2(p,d,h,f,t,e);if(0==g)break;g<0?(y=h,b=f,m=w):(p=h,d=f,v=w)}return c[a++]=h,c[a++]=f,a}(n,i,h,p,d,y,m);var R=c[m-2],I=c[m-1],P=u.a.distance2(n,i,R,I);if(m-=2,o.a.eq(P,l))c[m++]=R,c[m++]=I;else{if(!(P<l))return 0;m=g(l,n,i,h,p,R,I,m),m=g(l,n,i,R,I,d,y,m)}}}}else o.a.eq(b,l)?(c[m++]=h,c[m++]=p):o.a.eq(v,l)?(c[m++]=d,c[m++]=y):m=g(l,n,i,h,p,d,y,m);if(m>0){f(c,0,c,m,m);for(var C=0,L=0;L<m;L+=2){var D=c[m+L];C=O(t,r,C,c[m+L+1],D)}return C}return 0}return 0}function g(t,e,r,n,i,a,s,l){var h=u.a.distance2(n,i,e,r)-t;if(o.a.eq(0,h))return c[l++]=n,c[l++]=i,l;var f=u.a.distance2(a,s,e,r)-t;if(o.a.eq(0,f))return c[l++]=a,c[l++]=s,l;for(var p=n,d=i,y=a,b=s,v=NaN,m=NaN,w=Number.POSITIVE_INFINITY;0!==w;){0;var g=Math.max(Math.min(Math.abs(h)/(Math.abs(h)+Math.abs(f)),.9),.1);if(m=d+(b-d)*g,p===(v=p+(y-p)*g)&&d===m||y===v&&b===m)break;(w=u.a.distance2(v,m,e,r)-t)<0&&h>f||w>0&&h<f?(y=v,b=m,f=w):(p=v,d=m,h=w)}return o.a.eq(0,w)?(c[l++]=v,c[l++]=m,l):l}function x(t,e){if(t.rx===t.ry)return w(t,e);throw new Error("not supported")}function O(t,e,r,n,i){return isFinite(i)&&isFinite(n)&&b(e,i,n)&&_(t,new h.a(i,n))&&(c[r++]=i,c[r++]=n),r}function E(t,e,r,n){if(n>0){var i=2*n;f(c,0,c,i,n);for(var o=0;o<n;o+=2){var a=c[i+o],s=c[i+o+1],u=new h.a(a,s);_(t,u)&&_(e,u)&&(c[r++]=a,c[r++]=s)}}return r}function _(t,e){var r=t.bbox();if(e.x-r.minX>-1e-4&&e.x-r.maxX<1e-4&&e.y-r.minY>-1e-4&&e.y-r.maxY<1e-4){if(Math.abs(t.sweepAngle)>180){var n=l.a.regularD(e.angleD(t.center));return t.sweepAngle>0?(o.a.less(n,t.startAngle)&&(n+=360),o.a.greatereq(t.endAngle(),n)):(o.a.greater(n,t.startAngle)&&(n-=360),o.a.lesseq(t.endAngle(),n))}return!0}return!1}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t){this.id=t}},function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE"}(n||(n={}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){this.obj={}}return t.prototype.contains=function(t){return t in this.obj},t.prototype.isEmpty=function(){for(var t in this.obj)return!1;return!0},t.prototype.getOrDefault=function(t,e){var r=this.obj[t];return void 0===r?e:r},t.prototype.get=function(t){return this.obj[t]},t.prototype.put=function(t,e){var r=this.obj[t];return this.obj[t]=e,r},t.prototype.del=function(t){var e=this.obj[t];return delete this.obj[t],e},t.prototype.computeIfAbsent=function(t,e){var r=this.obj;if(t in r)return r[t];var n=e(t.toString());return r[t]=n,n},t.prototype.iterator=function(t){var e=this.obj;for(var r in e){if(!t(r,e[r]))break}},t.prototype.origin=function(){return this.obj},t.prototype.clear=function(){this.obj={}},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var n,i=r(8),o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},s=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(a(arguments[e]));return t};function u(t){switch(t){case n.DEBUG:return"DEBUG";case n.INFO:return"INFO";case n.WARNING:return"WARNING";case n.ERROR:return"ERROR";case n.DUMMY:return"DUMMY"}}!function(t){t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.WARNING=2]="WARNING",t[t.ERROR=3]="ERROR",t[t.DUMMY=4]="DUMMY"}(n||(n={}));var l=function(t,e){n.ERROR},h=function(t,e){return i.a.format("%s %s: %s",new Date,u(t),e)},c=function(){function t(t,e,r){void 0===e&&(e=l),void 0===r&&(r=h),this.level=t,this.writer=e,this.fmt=r}return t.mix=function(){for(var e,r,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var s=n.DUMMY;try{for(var u=o(i),l=u.next();!l.done;l=u.next()){var h=l.value;h.level<s&&(s=h.level)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return new t(s,(function(t,e){var r,n;try{for(var a=o(i),s=a.next();!s.done;s=a.next()){s.value.write1(t,e)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}),(function(t,e){return e}))},t.prototype.wrap=function(e,r){var n=this;void 0===e&&(e=null),void 0===r&&(r=null);var i=null===e?this.fmt:function(t,r){return r=e(t,r),n.fmt(t,r)},o=null===r?this.writer:function(t,e){r(t,e),n.writer(t,e)};return new t(this.level,o,i)},t.prototype.chain=function(t){return t.wrap(this.fmt.bind(this),this.writer.bind(this))},t.prototype.include=function(t){return this.level<=t},t.prototype.write3=function(t,e,r){this.include(t)&&this.writer(t,this.fmt(t,i.a.format.apply(i.a,s([e],r))))},t.prototype.write2=function(t,e){this.include(t)&&(e instanceof Error?this.writer(t,this.fmt(t,e.stack)):this.writer(t,this.fmt(t,e.toString())))},t.prototype.write1=function(t,e){this.include(t)&&this.writer(t,this.fmt(t,e))},t.prototype.debug3=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.write3(n.DEBUG,t,e)},t.prototype.debug2=function(t){this.write2(n.DEBUG,t)},t.prototype.debug1=function(t){this.write1(n.DEBUG,t)},t.prototype.info3=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.write3(n.INFO,t,e)},t.prototype.info2=function(t){this.write2(n.INFO,t)},t.prototype.info1=function(t){this.write1(n.INFO,t)},t.prototype.warning3=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.write3(n.WARNING,t,e)},t.prototype.warning2=function(t){this.write2(n.WARNING,t)},t.prototype.warning1=function(t){this.write1(n.WARNING,t)},t.prototype.error3=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.write3(n.ERROR,t,e)},t.prototype.error2=function(t){this.write2(n.ERROR,t)},t.prototype.error1=function(t){this.write1(n.ERROR,t)},t.DUMMY=new t(n.DUMMY),t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(1),i=function(){function t(t,e,r,i){void 0===i&&(i=1),this.x=n.a.positiveOr0(t),this.y=n.a.positiveOr0(e),this.z=n.a.positiveOr0(r),this.alpha=i}return t.of1=function(t){return this.of2(t>>16&255,t>>8&255,255&t)},t.of2=function(e,r,n,i){return void 0===i&&(i=255),new t(e/255,r/255,n/255,i/255)},t.of3=function(e){if(e.startsWith("#")&&(e=e.substr(1)),3==e.length)return new t(parseInt(e[0],16)/15,parseInt(e[1],16)/15,parseInt(e[2],16)/15);if(6==e.length)return new t(parseInt(e.substr(0,2),16)/255,parseInt(e.substr(2,2),16)/255,parseInt(e.substr(4,2),16)/255);throw new Error("invalid color string")},t.prototype.add=function(e,r,n,i){return new t(Math.max(0,Math.min(1,this.x+e)),Math.max(0,Math.min(1,this.y+r)),Math.max(0,Math.min(1,this.z+n)),Math.max(0,Math.min(1,this.alpha+i)))},t.prototype.getData=function(){return[this.x,this.y,this.z,this.alpha]},t.WHITE=new t(1,1,1,1),t.BLACK=new t(0,0,0,1),t.RED=new t(1,0,0,1),t.GREEN=new t(0,1,0,1),t.BLUE=new t(0,0,1,1),t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n,i=r(35),o=r(7),a=r(1),s=r(2),u=r(26),l=r(17),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(t){function e(e,r,n,i,o,s){var u=t.call(this,"",e,r)||this;return u.start=n,u.end=i,u.width=a.a.normal(o),u.keepout=s,u.__bbox=u._bbox(),u}return h(e,t),e.prototype.multiply3=function(t){return new e(this.net,this.layer,this.start.multiply3(t),this.end.multiply3(t),t.iScale*this.width,this.keepout)},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t=this.width/2;return(new o.b).ext2(this.start.add1(t,t)).ext2(this.start.add1(-t,-t)).ext2(this.end.add1(t,t)).ext2(this.end.add1(-t,-t)).build()},e.prototype.shape=function(t,e){return this.layer.equals(t)?new s.a(this.start,this.end).stroke(this.width+2*e,u.a.ROUND,l.a.CW):null},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,i=r(25),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(e,r){var n=t.call(this,"")||this;return n.pl=e,n.style=r,n}return o(e,t),e.prototype.multiply3=function(t){return new e(this.pl.multiply3(t),this.style.transform(t))},e.prototype.bbox=function(){return this.pl.bbox().extendOfSize(this.style.stroke.width/2)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n=r(98),i=r(71),o=r(22),a=function(t,e){this.node1=null,this.node2=null,this.key=t,this.value=e},s=function(){function t(t){this.itors=t}return t.prototype.hasNext=function(){return this.itors.hasNext()},t.prototype.next=function(){return this.itors.next().key},t}(),u=function(){function t(t){this.itors=t}return t.prototype.hasNext=function(){return this.itors.hasNext()},t.prototype.next=function(){return this.itors.next().value},t}(),l=function(){function t(){this.innerList=new i.a,this.innerMap={}}return t.prototype.replace=function(t,e){null!==t.node1&&(t.node1.set(e),e.node1=t.node1),null!==t.node2&&(t.node2.set(e),e.node2=t.node2)},t.prototype.put=function(t,e){var r=this,s=t.hashCode(),u=new a(t,e),l=this.innerMap[s];if(void 0===l)return u.node1=this.innerList.add(u),this.innerMap[s]=u,null;if(l instanceof a){if(l.key.equals(t))return this.innerMap[s]=u,this.replace(l,u),l.value;u.node1=this.innerList.add(u);var h=new i.a;return l.node2=h.add(l),u.node2=h.add(u),this.innerMap[s]=h,null}if(l instanceof i.a){var c=null;return Object(o.b)(l,(function(e,n){return!n.key.equals(t)||(r.replace(n,u),c=n.value,!1)})),null===c?(u.node1=this.innerList.add(u),u.node2=l.push(u),null):c}return Object(n.a)(l)},t.prototype.get=function(t){var e=t.hashCode(),r=this.innerMap[e];if(void 0===r)return null;if(r instanceof a)return r.key.equals(t)?r.value:null;if(r instanceof i.a){var s=null;return Object(o.b)(r,(function(e,r){return!r.key.equals(t)||(s=r.value,!1)})),s}return Object(n.a)(r)},t.prototype.containsKey=function(t){return null!==this.get(t)},t.prototype.delete=function(t){null!==t.node1&&t.node1.parent.remove(t.node1),null===t.node2?delete this.innerMap[t.key.hashCode()]:t.node2.parent.remove(t.node2)},t.prototype.remove=function(t){var e=this,r=t.hashCode(),s=this.innerMap[r];if(void 0===s)return null;if(s instanceof a)return s.key.equals(t)?(this.delete(s),s.value):null;if(s instanceof i.a){var u=null;return Object(o.b)(s,(function(r,n){return!n.key.equals(t)||(u=n.value,e.delete(n),!1)})),u}return Object(n.a)(s)},t.prototype.computeIfAbsent=function(t,e){var r=this.get(t);if(null===r){var n=e(t);return this.put(t,n),n}return r},t.prototype.size=function(){return this.innerList.size()},t.prototype.isEmpty=function(){return 0===this.innerList.size()},t.prototype.keys=function(){return new s(this.innerList.iterator())},t.prototype.values=function(){return new u(this.innerList.iterator())},t.prototype.entries=function(){return this.innerList.iterator()},t}()},function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i})),function(t){t[t.MIL=1]="MIL",t[t.INCH=1e3]="INCH",t[t.MM=39.37]="MM",t[t.CM=393.7]="CM",t[t.M=3937]="M",t[t.PT=13.88888888888889]="PT",t[t.PX72=13.88888888888889]="PX72",t[t.PX96=10.416666666666666]="PX96",t[t.PX100=10]="PX100"}(n||(n={}));var i=function(){function t(t,e){this.ratio=t/e}return t.prototype.wrap=function(t){return t*this.ratio},t.ASIS=new t(n.MIL,n.MIL),t}()},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return h}));var n,i,o=r(25),a=r(10),s=r(7),u=r(12),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.OUTPUT=1]="OUTPUT",t[t.INPUT=2]="INPUT",t[t.BIDIRECTIONAL=3]="BIDIRECTIONAL"}(i||(i={}));var h=function(t){function e(e,r,n,i,o,a,s,u,l){var h=t.call(this,"")||this;return h.name=e,h.fillColor=r,h.strokeColor=n,h.width=i,h.startSharp=o,h.endSharp=a,h.location=s,h.orientation=u,h.ioType=l,h}return l(e,t),e.prototype.multiply3=function(t){return new e(this.name.multiply3(t),this.fillColor,this.strokeColor,t.iScale*this.width,this.startSharp,this.endSharp,this.location.multiply3(t),u.a.transformD(this.orientation,t),this.ioType)},e.prototype.bbox=function(){var t=this.location,e=a.a.rotateD(this.orientation).setOrigin1(t);return(new s.b).ext2(t).ext2(t.add1(this.width,0).multiply3(e)).build()},e}(o.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t,e,r){this.id=t,this.net=e,this.layer=r}},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(35),o=r(17),a=r(26),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r,n,i,o){var a=t.call(this,"",e,r)||this;return a.arc=n,a.width=i,a.keepout=o,a}return s(e,t),e.prototype.multiply3=function(t){return new e(this.net,this.layer,this.arc.multiply3(t),t.iScale*this.width,this.keepout)},e.prototype.bbox=function(){return this.arc.bbox()},e.prototype.shape=function(t,e){return this.layer.equals(t)?this.arc.stroke(this.width+2*e,a.a.ROUND,o.a.CW):null},e}(i.a)},function(t,e,r){"use strict";var n;r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),function(t){t[t.SOLID=0]="SOLID",t[t.DASHED=1]="DASHED",t[t.DOTTED=2]="DOTTED"}(n||(n={}));var i=function(){function t(t,e,r){void 0===r&&(r=n.SOLID),this.color=t,this.width=Math.abs(e),this.style=r}return t.prototype.transform=function(e){return new t(this.color,e.iScale*this.width,this.style)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(10),o=r(58),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u=function(t){function e(e){return void 0===e&&(e=s),t.call(this,4,4,e)||this}return a(e,t),e.translate=function(t,r,n){return new e([1,0,0,0,0,1,0,0,0,0,1,0,t,r,n,1])},e.translate1=function(t){return new e([1,0,0,0,0,1,0,0,0,0,1,0,t.x,t.y,t.z,1])},e.rotateX=function(t){var r=Math.cos(t),n=Math.sin(t);return new e([1,0,0,0,0,r,n,0,0,-n,r,0,0,0,0,1])},e.rotateY=function(t){var r=Math.cos(t),n=Math.sin(t);return new e([r,0,-n,0,0,1,0,0,n,0,r,0,0,0,0,1])},e.rotateZ=function(t){var r=Math.cos(t),n=Math.sin(t);return new e([r,n,0,0,-n,r,0,0,0,0,1,0,0,0,0,1])},e.scale=function(t,r,n){return void 0===r&&(r=t),void 0===n&&(n=t),new e([t,0,0,0,0,r,0,0,0,0,n,0,0,0,0,1])},e.prototype.translate=function(t){return this.multiply4(e.translate1(t))},e.prototype.translate1=function(t,r,n){return this.multiply4(e.translate(t,r,n))},e.prototype.rotateX=function(t){return this.multiply4(e.rotateX(t))},e.prototype.rotateY=function(t){return this.multiply4(e.rotateY(t))},e.prototype.rotateZ=function(t){return this.multiply4(e.rotateZ(t))},e.prototype.scale=function(t,r,n){return void 0===r&&(r=t),void 0===n&&(n=t),this.multiply4(e.scale(t,r,n))},e.prototype.scale1=function(t){return this.multiply4(e.scale(t.x,t.y,t.z))},e.prototype.setOrigin=function(t,r,n){return e.translate(-t,-r,-n).multiply4(this).translate1(t,r,n)},e.prototype.setOrigin1=function(t){return this.setOrigin(t.x,t.y,t.z)},e.prototype.multiply4=function(t){var r=new Array(16);return o.a.mul(4,4,4,this.data,t.data,r),new e(r)},e.prototype.inverse=function(){return new e(this.getInverseMatrix())},e.prototype.toMatrix3=function(){var t=this.data;return new i.a([t[0],t[1],0,t[4],t[5],0,t[12],t[13],1])},e.ORIGIN=new e,e}(o.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(6),i=function(){function t(t,e,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1),this.familly=t,this.size=e,this.weight=r,this.italic=n,this.bold=i}return t.prototype.transform=function(e){return new t(this.familly,e.iScale*this.size,e.iScale*this.weight,this.italic,this.bold)},t.prototype.hashCode=function(){return n.a.strHashcode(this.familly)^this.size^this.weight},t.prototype.equals=function(e){return this===e||null!=e&&(e instanceof t&&(this.familly===e.familly&&(this.size===e.size&&(this.weight===e.weight&&(this.italic===e.italic&&this.bold===e.bold)))))},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(8),i=function(){function t(t,e,r){this.R=t,this.G=e,this.B=r,this.hashed=31*(31*t+e)+r}return t.of=function(e){return new t(e>>16&255,e>>8&255,255&e)},t.prototype.toString=function(){return n.a.format("#%02X%02X%02X",this.R,this.G,this.B)},t.prototype.hashCode=function(){return this.hashed},t.prototype.equals=function(e){return e instanceof t&&(e.R===this.R&&e.G===this.G&&e.B===this.B)},t.BLACK=t.of(0),t.WHITE=t.of(16777215),t.RED=t.of(16711680),t.GREEN=t.of(65280),t.BLUE=t.of(255),t.YELLOW=t.of(16776960),t}()},function(t,e,r){"use strict";var n=r(118),i=function(t,e){if(e.material.opacity>=1)throw new Error("only opacity < 1 is permitted at blend pass");this.mMatrix=t,this.mesh=e};r.d(e,"a",(function(){return s}));var o,a=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r){var n=t.call(this)||this;return n.geometry=e,n.material=r,n}return a(e,t),e.prototype.draw=function(t,e){this.draw1(t,e,!1)},e.prototype.draw1=function(t,e,r){this.material.opacity<1&&!r?t.blendTasks.push(new i(e,this)):(e=this.getMatrix().multiply4(e),t.program.render(t,e,this.geometry,this.material,r))},e.prototype.bbox=function(){return this.geometry.bbox()},e}(n.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n,i=r(25),o=r(3),a=r(10),s=r(7),u=r(12),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){function e(e,r,n,i,o,a,s,u){var l=t.call(this,"")||this;return l.location=e,l.font=r,l.aligment=n,l.mAligment=i,l.text=o,l.orientation=a,l.color=s,l.mirror=u,l}return l(e,t),e.prototype.multiply3=function(t){var r,n;if(t.isMirrored()){switch(this.aligment.vertical){case o.c.TOP:n=o.c.BOTTOM;break;case o.c.BOTTOM:n=o.c.TOP;break;default:n=this.aligment.vertical}r=this.aligment.horizontal}else r=this.aligment.horizontal,n=this.aligment.vertical;var i=new o.a(r,n),a=this.location.multiply3(t),s=this.font.transform(t),l=u.a.transformD(this.orientation,t);return new e(a,s,i,this.mAligment,this.text,l,this.color,this.mirror)},e.prototype.bbox=function(){var t=this.font.size,e=t*this.text.length/2,r=this.orientation;this.mirror&&(r+=180);var n=this.location,i=n.add1(e,t);if(r%360==0)return(new s.b).ext2(n).ext2(i).build();var o=n.add1(e,0),u=n.add1(0,t),l=a.a.rotateD(r).setOrigin1(n);return(new s.b).ext2(n).ext2(i).ext2(o).ext2(u).build().transform(l)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"b",(function(){return y})),r.d(e,"a",(function(){return b}));var n,i=r(35),o=r(7),a=r(0),s=r(44),u=r(1),l=r(12),h=r(5),c=r(39),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),p=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d=new s.a("",a.c.DOCUMENT,h.a.ORIGIN,0,"",new c.a("",0,0),!1),y=function(){function t(){this.layer=null,this.location=null,this.orientation=Number.NaN,this.pattern=null,this.showDesignator=!1,this.showComment=!1,this.designator=null,this.comment=null,this.shapes=[]}return t.prototype.clone=function(e){var r,n,i=new t;i.layer=e.layer,i.location=e.location,i.orientation=e.orientation,i.pattern=e.pattern,i.showDesignator=e.showDesignator,i.showComment=e.showComment,i.designator=e.designator,i.comment=e.comment;try{for(var o=p(e.shapes),a=o.next();!a.done;a=o.next()){var s=a.value;i.shapes.push(s)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},t.prototype.asContainer=function(){return this.orientation=0,this.pattern="",this.showDesignator=!1,this.showComment=!1,this.designator=d,this.comment=d,this},t.prototype.build=function(){return new b(this)},t}(),b=function(t){function e(e){var r=t.call(this,"","",u.a.notnull(e.layer))||this;if(r.location=u.a.notnull(e.location),r.orientation=u.a.normal(e.orientation),r.pattern=u.a.notnull(e.pattern),r.showDesignator=e.showDesignator,r.showComment=e.showComment,r.designator=u.a.notnull(e.designator),r.comment=u.a.notnull(e.comment),0==e.shapes.length)throw new Error("no shape in component ");return r.shapes=e.shapes.slice(0),r.__bbox=r._bbox(),r}return f(e,t),e.prototype.multiply3=function(t){var e,r,n=new y;n.layer=this.layer,n.location=this.location.multiply3(t),n.orientation=l.a.transformD(this.orientation,t),n.pattern=this.pattern,n.showDesignator=this.showDesignator,n.showComment=this.showComment,n.designator=this.designator.multiply3(t),n.comment=this.comment.multiply3(t);try{for(var i=p(this.shapes),o=i.next();!o.done;o=i.next()){var a=o.value;n.shapes.push(a.multiply3(t))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n.build()},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t,e,r=new o.b;try{for(var n=p(this.shapes),i=n.next();!i.done;i=n.next()){var a=i.value;r.ext1(a.bbox())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return this.showDesignator&&r.ext1(this.designator.bbox()),this.showComment&&r.ext1(this.comment.bbox()),r.build()},e.prototype.shape=function(t,e){throw new Error("unsupported operation")},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n,i=r(35),o=r(7),a=r(10),s=r(12),u=r(1),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){function e(e,r,n,i,o,a,s){var l=t.call(this,"",e,r)||this;return l.location=n,l.rotation=u.a.normal(i),l.text=o,l.font=a,l.mirror=s,l.__bbox=l._bbox(),l}return l(e,t),e.prototype.multiply3=function(t){return new e(this.net,this.layer,this.location.multiply3(t),s.a.transformD(this.rotation,t),this.text,this.font.transform(t),this.mirror)},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t=this.font.size*this.text.length/2,e=this.rotation;this.mirror&&(e+=180);var r=this.location,n=this.location.add1(t,this.font.size);if(e%360==0)return(new o.b).ext2(r).ext2(n).build();var i=this.location.add1(t,0),s=this.location.add1(0,this.font.size),u=a.a.rotateD(e).setOrigin1(this.location);return(new o.b).ext2(r.multiply3(u)).ext2(n.multiply3(u)).ext2(i.multiply3(u)).ext2(s.multiply3(u)).build()},e.prototype.shape=function(t,e){return null},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){}return t.dotProd1=function(t,e,r,n){return t*r+e*n},t.dotProd2=function(t,e,r,n,i,o){return this.dotProd1(r-t,n-e,i-r,o-n)},t.dotProd3=function(t,e,r){return this.dotProd2(t.x,t.y,e.x,e.y,r.x,r.y)},t.crossProd1=function(t,e,r,n){return t*n-e*r},t.crossProd2=function(t,e,r,n,i,o){return this.crossProd1(r-t,n-e,i-r,o-n)},t.crossProd3=function(t,e,r){return this.crossProd2(t.x,t.y,e.x,e.y,r.x,r.y)},t.distance2=function(t,e,r,n){var i=r-t,o=n-e;return i*i+o*o},t.distance1=function(t,e,r,n){return this.hypot(r-t,n-e)},t.distance1p=function(t,e){return this.distance1(t.x,t.y,e.x,e.y)},t.hypot=function(t,e){if(t=Math.abs(t),(e=Math.abs(e))>t){var r=e;e=t,t=r}if(0===t)return e;var n=e/t;return t*Math.sqrt(1+n*n)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t,e,r){void 0===r&&(r=1),this.stroke=t,this.fill=e,this.transparency=r}return t.prototype.transform=function(e){return new t(this.stroke.transform(e),this.fill,this.transparency)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n,i=r(35),o=r(7),a=r(0),s=r(1),u=r(14),l=r(9),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(t){function e(e,r,n,i,o,u,l,h){var c=t.call(this,e,r,a.c.MULTI)||this;return c.center=n,c.holeDiameter=s.a.normal(i),c.topPad=o,c.innerPad=s.a.normal(u),c.botPad=l,c.mask=h,c.__bbox=c._bbox(),c}return h(e,t),e.prototype.multiply3=function(t){return new e(this.id,this.net,this.center.multiply3(t),t.iScale*this.holeDiameter,t.iScale*this.topPad,t.iScale*this.innerPad,t.iScale*this.botPad,this.mask)},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t,e,r=0;try{for(var n=c([this.holeDiameter,this.topPad,this.innerPad,this.botPad]),i=n.next();!i.done;i=n.next()){var a=i.value;r<a&&(r=a)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r/=2,new o.a(this.center.x-r,this.center.x+r,this.center.y-r,this.center.y+r)},e.prototype.shape=function(t,e){return this.generate(this,t,e)},e.prototype.generate=function(t,e,r){if(e.type!==a.a.MULTI){if(!isNaN(t.topPad)&&e.equals(a.c.TOP_COPPER)){var n=t.topPad/2;return u.a.build2([l.a.build3(t.center,0,-360,n+r,n+r)])}if(!isNaN(t.botPad)&&e.equals(a.c.BOT_COPPER)){n=t.botPad/2;return u.a.build2([l.a.build3(t.center,0,-360,n+r,n+r)])}if(!isNaN(t.innerPad)&&e.type===a.a.INNER){n=t.innerPad/2;return u.a.build2([l.a.build3(t.center,0,-360,n+r,n+r)])}}else if(t.holeDiameter>0){n=t.holeDiameter/2;return u.a.build2([l.a.build3(t.center,0,-360,n,n)])}return null},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n,i=r(118),o=r(6),a=r(72),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.childrens=[],e._bbox=null,e}return s(e,t),e.prototype.add=function(t){this.childrens.push(t),this._bbox=null},e.prototype.remove=function(t){o.a.remove(this.childrens,t),this._bbox=null},e.prototype.clear=function(){this.childrens.length=0,this._bbox=null},e.prototype.draw=function(t,e){var r,n;e=this.getMatrix().multiply4(e);try{for(var i=u(this.childrens),o=i.next();!o.done;o=i.next()){o.value.draw(t,e)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.bbox=function(){var t,e;if(null===this._bbox){var r=new a.a;try{for(var n=u(this.childrens),i=n.next();!i.done;i=n.next()){var o=i.value.bbox();null!==o&&r.ext4(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}try{this._bbox=r.build()}catch(t){}}return this._bbox},e}(i.a)},function(t,e,r){"use strict";r.d(e,"e",(function(){return s})),r.d(e,"d",(function(){return u})),r.d(e,"c",(function(){return l})),r.d(e,"a",(function(){return h})),r.d(e,"b",(function(){return f})),r.d(e,"f",(function(){return p}));var n,i=r(1),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(){},s=function(t){function e(e){var r=t.call(this)||this;return r.selectors=e,r}return o(e,t),e}(a),u=function(t){function e(e){var r=t.call(this)||this;return r.net=e,r}return o(e,t),e}(a),l=function(t){function e(e){var r=t.call(this)||this;return r.id=e,r}return o(e,t),e}(a),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(a),c=function(t){this.selector=t},f=function(t){function e(e,r){var n=t.call(this,e)||this;return n.clearance=i.a.normal(r),n}return o(e,t),e}(c),p=function(t){function e(e,r){var n=t.call(this,e)||this;return n.width=i.a.positiveOr0(r),n}return o(e,t),e}(c)},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(45),i=r(5),o=function(){function t(t,e,r){this.p1=t,this.p2=e,this.p3=r}return t.prototype.barycentre=function(){return t.barycentre(this.p1,this.p2,this.p3)},t.barycentre=function(t,e,r){var n=t.x+e.x+r.x,o=t.y+e.y+r.y;return new i.a(n/3,o/3)},t.prototype.area=function(){return t.area(this.p1,this.p2,this.p3)},t.area=function(t,e,r){return this.area2(t.x,t.y,e.x,e.y,r.x,r.y)/2},t.area2=function(t,e,r,i,o,a){return Math.abs(n.a.crossProd2(t,e,r,i,o,a))},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"e",(function(){return i})),r.d(e,"d",(function(){return o})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return s}));var n=function(t,e){this.type=t,this.value=e},i=function(t,e){this.distance=t,this.scale=e},o=function(t,e){this.layer=t,this.visible=e},a=function(t,e,r,n,i,o,a,s,u,l,h){this.id=t,this.width=e,this.height=r,this.originX=n,this.originY=i,this.rx=o,this.ry=a,this.rz=s,this.x=u,this.y=l,this.z=h},s=function(){}},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(32),i=function(){function t(){this.innerMap=new n.a}return t.prototype.add=function(t){return!0!==this.innerMap.put(t,!0)},t.prototype.remove=function(t){this.innerMap.remove(t)},t.prototype.contains=function(t){return!0===this.innerMap.get(t)},t.prototype.iterator=function(){return this.innerMap.keys()},t.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},t.prototype.size=function(){return this.innerMap.size()},t}()},function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return o}));var n=function(t){return 0!==t},i=function(t){return t>0},o=function(t){return t%2!=0}},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(35),o=r(7),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=function(t){function e(e,r,n,i){var o=t.call(this,e,r,n)||this;return o.plg=i,o}return a(e,t),e.prototype.multiply3=function(t){var r,n,i=new Array;try{for(var o=s(this.plg),a=o.next();!a.done;a=o.next()){var u=a.value;i.push(u.multiply3(t))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return new e(this.id,this.net,this.layer,i)},e.prototype.bbox=function(){var t,e,r=new o.b;try{for(var n=s(this.plg),i=n.next();!i.done;i=n.next()){var a=i.value;r.ext1(a.bbox())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r.build()},e.prototype.shape=function(t,e){throw new Error("unsupported operation")},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n,i=r(35),o=r(7),a=r(0),s=r(1),u=r(10),l=r(12),h=r(14),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f=function(t){function e(e,r,n,i,o,a){var u=t.call(this,"",e,r)||this;return u.location1=n,u.location2=i,u.rotation=s.a.normal(o),u.keepout=a,u.__bbox=u._bbox(),u}return c(e,t),e.prototype.multiply3=function(t){var r=(new o.b).ext2(this.location1).ext2(this.location2).build(),n=r.center().multiply3(t),i=t.iScale*r.width()/2,a=t.jScale*r.height()/2,s=n.add1(-i,-a),u=n.add1(i,a);return new e(this.net,this.layer,s,u,l.a.transformD(this.rotation,t),this.keepout)},e.prototype.bbox=function(){return this.__bbox},e.prototype._bbox=function(){var t=u.a.rotateD(this.rotation).setOrigin1(this.location1);return(new o.b).ext2(this.location1).ext2(this.location2.multiply3(t)).build()},e.prototype.shape=function(t,e){var r=this.__bbox.extendOfSize(e);return this.layer.equals(t)||this.layer.equals(a.c.MULTI)?h.a.build4([r.LL(),r.UL(),r.UR(),r.LR(),r.LL()]):null},e}(i.a)},function(t,e,r){"use strict";r.d(e,"c",(function(){return p})),r.d(e,"d",(function(){return d})),r.d(e,"b",(function(){return y})),r.d(e,"e",(function(){return b})),r.d(e,"f",(function(){return w})),r.d(e,"a",(function(){return g}));var n,i=r(32),o=r(112),a=r(22),s=r(4),u=r(8),l=r(6),h=r(70),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},p=function(){function t(){}return t.auto=function(e){var r,n;if(e instanceof t)return e;if(null===e)return b;switch(typeof e){case"number":return new y(e);case"string":return new d(e);case"boolean":return e?w:g;case"object":if(Array.isArray(e)){var i=new x;try{for(var o=f(e),a=o.next();!a.done;a=o.next()){var s=a.value;i.add(s)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i}var u=new v;for(var l in e)if(e.hasOwnProperty(l)){var h=e[l];u.put(l,h)}return u;default:return new d(e.toString())}},t.prototype.toJson=function(t){void 0===t&&(t=0);var e=new o.a;return this.toJson1(e,t),e.toString()},t.prototype.toJson1=function(t,e){void 0===e&&(e=0),this._toJson(t,0,e)},t.prototype.asString=function(){throw new Error("unsupported operation")},t.prototype.asNumber=function(){throw new Error("unsupported operation")},t.prototype.asBoolean=function(){throw new Error("unsupported operation")},t.prototype.asJMap=function(){throw new Error("unsupported operation")},t.prototype.asJArray=function(){throw new Error("unsupported operation")},t.prototype.put=function(t,e){throw new Error("unsupported operation")},t.prototype.remove=function(t){throw new Error("unsupported operation")},t.prototype.add=function(t){throw new Error("unsupported operation")},t}(),d=function(t){function e(e){var r=t.call(this)||this;return r.str=e,r}return c(e,t),e.prototype.asString=function(){return this.str},e.prototype._toJson=function(t,e,r){var n=this.str,i=n.length,o=new h.a;o.write(s.a.QUOTE);for(var a=0;a<i;a++){var l=n.charCodeAt(a);switch(l){case s.a.CR:o.writeStr("\\r");break;case s.a.LF:o.writeStr("\\n");break;case s.a.TAB:o.writeStr("\\t");break;case s.a.BS:o.writeStr("\\b");break;case s.a.FF:o.writeStr("\\f");break;case s.a.BSLASH:o.writeStr("\\\\");break;case s.a.QUOTE:o.writeStr('\\"');break;default:32<=l&&l<=126?o.write(l):o.writeStr(u.a.format("\\u%04x",l))}}o.write(s.a.QUOTE),t.write(o.toString())},e.prototype.hashCode=function(){return l.a.strHashcode(this.str)},e.prototype.equals=function(t){return t instanceof e&&this.str===t.str},e.prototype.toString=function(){return this.str},e}(p),y=function(t){function e(e){var r=t.call(this)||this;return r.value=e,r}return c(e,t),e.prototype.asNumber=function(){return this.value},e.prototype._toJson=function(t,e,r){t.write(this.value.toString())},e.prototype.hashCode=function(){return this.value},e.prototype.equals=function(t){return t instanceof e&&this.value===t.value},e.prototype.toString=function(){return this.value.toString()},e}(p),b=function(t){function e(){return t.call(this)||this}return c(e,t),e.prototype._toJson=function(t,e,r){t.write("null")},e.prototype.hashCode=function(){return 0},e.prototype.equals=function(t){return this===t},e.prototype.toString=function(){return"null"},e.JNull=new e,e}(p).JNull,v=function(t){function e(){var e=t.call(this)||this;return e.inner=new i.a,e}return c(e,t),e.build=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t.length;if(n%2==0){for(var i=new e,o=0;o<n;o+=2)i.put(t[o],t[o+1]);return i}throw new Error("unsupported operation")},e.prototype.put=function(t,e){return this.inner.put(p.auto(t),p.auto(e))},e.prototype.get=function(t){return this.inner.get(t)},e.prototype.remove=function(t){return this.inner.remove(t)},e.prototype.asJMap=function(){return this},e.prototype.isEmpty=function(){return this.inner.isEmpty()},e.prototype.size=function(){return this.inner.size()},e.prototype._toJson=function(t,e,r){var n=this.size();if(r>0){var i="\r\n"+l.a.repeat(" ",(e+1)*r);t.write("{"),n>0?(Object(a.b)(this,(function(o,a){return n--,t.write(i),a.key._toJson(t,e+1,r),t.write(": "),a.value._toJson(t,e+1,r),n>0&&t.write(","),!0})),t.write("\r\n"+l.a.repeat(" ",e*r)),t.write("}")):t.write("}")}else t.write("{"),n>0?(Object(a.b)(this,(function(i,o){return n--,o.key._toJson(t,e+1,r),t.write(": "),o.value._toJson(t,e+1,r),n>0&&t.write(", "),!0})),t.write("}")):t.write("}")},e.prototype.iterator=function(){return this.inner.entries()},e.prototype.hashCode=function(){var t=1;return Object(a.c)(this.inner.entries(),(function(e,r){return t=31*(t=31*t+r.key.hashCode())+r.value.hashCode(),!0})),t},e.prototype.equals=function(t){if(t instanceof e&&t.size()===this.size()){for(var r=this.inner.entries(),n=t.inner.entries();r.hasNext();){var i=r.next(),o=n.next();if(!i.key.equals(o.key))return!1;if(!i.value.equals(o.value))return!1}return!0}return!1},e.prototype.toString=function(){return this.toJson()},e}(p),m=function(t){function e(e){var r=t.call(this)||this;return r.value=e,r.display=e?"true":"false",r.hashed=e?1231:1237,r}return c(e,t),e.prototype.asBoolean=function(){return this.value},e.prototype._toJson=function(t,e,r){t.write(this.display)},e.prototype.hashCode=function(){return this.hashed},e.prototype.equals=function(t){return this===t},e.prototype.toString=function(){return this.display},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(p),w=m.TRUE,g=m.FALSE,x=function(t){function e(){var e=t.call(this)||this;return e.inner=new Array,e}return c(e,t),e.build=function(){for(var t,r,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var o=new e;try{for(var a=f(n),s=a.next();!s.done;s=a.next()){var u=s.value;o.add(u)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return o},e.prototype.add=function(t){this.inner.push(p.auto(t))},e.prototype.get=function(t){var e=this.inner[t];if(void 0===e)throw new Error("not found");return e},e.prototype.asJArray=function(){return this},e.prototype.isEmpty=function(){return this.inner.length=0},e.prototype.size=function(){return this.inner.length},e.prototype._toJson=function(t,e,r){var n,i,o,a,s=this.inner.length;if(r>0){t.write("[");var u="\r\n"+l.a.repeat(" ",(e+1)*r);if(s>0){try{for(var h=f(this.inner),c=h.next();!c.done;c=h.next()){var p=c.value;s--,t.write(u),p._toJson(t,e+1,r),s>0&&t.write(",")}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}t.write("\r\n"),t.write(l.a.repeat(" ",e*r)),t.write("]")}else t.write("]")}else if(t.write("["),s>0){try{for(var d=f(this.inner),y=d.next();!y.done;y=d.next()){p=y.value;s--,p._toJson(t,e+1,r),s>0&&t.write(", ")}}catch(t){o={error:t}}finally{try{y&&!y.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}t.write("]")}else t.write("]")},e.prototype.iterator=function(){return Object(a.a)(this.inner)},e.prototype.hashCode=function(){var t,e,r=1;try{for(var n=f(this.inner),i=n.next();!i.done;i=n.next()){r=31*r+i.value.hashCode()}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},e.prototype.equals=function(t){if(t instanceof e&&t.size()===this.size()){for(var r=this.size(),n=0;n<r;n++)if(!this.get(n).equals(t.get(n)))return!1;return!0}return!1},e.prototype.toString=function(){return this.toJson()},e}(p)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(11),i=r(72),o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=(new n.a(0,0,1),function(){function t(t,e){if(void 0===e&&(e=[]),this.vertexs=[],this.normals=[],this.positionBuffer=null,this.normalBuffer=null,this._bbox=null,t.length%3!=0)throw new Error;if(t.length===e.length)this.vertexs=t,this.normals=e;else{for(var r=new Array(t.length),i=t.length-2,o=0;o<i;o+=3){var a=t[o],s=t[o+1],u=t[o+2],l=n.a.normal(a,s,u);r[o]=l,r[o+1]=l,r[o+2]=l}this.vertexs=t,this.normals=r}}return t.prototype.createArray=function(t){var e,r,n=new Float32Array(3*t.length),i=0;try{for(var a=o(t),s=a.next();!s.done;s=a.next()){var u=s.value;n[i++]=u.x,n[i++]=u.y,n[i++]=u.z}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return n},t.prototype.bindVertexesBuffer=function(t,e){if(null===this.positionBuffer){if(this.positionBuffer=t.createBuffer(),null===this.positionBuffer)throw new Error("faild to create buffer");t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,this.createArray(this.vertexs),t.STATIC_DRAW)}else t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);t.vertexAttribPointer(e,3,t.FLOAT,!1,0,0)},t.prototype.bindNormalsBuffer=function(t,e){if(null===this.normalBuffer){if(this.normalBuffer=t.createBuffer(),null===this.normalBuffer)throw new Error("faild to create buffer");t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,this.createArray(this.normals),t.STATIC_DRAW)}else t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer);t.vertexAttribPointer(e,3,t.FLOAT,!1,0,0)},t.prototype.bbox=function(){var t,e;if(null===this._bbox){var r=new i.a;try{for(var n=o(this.vertexs),a=n.next();!a.done;a=n.next()){var s=a.value;r.ext3(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this._bbox=r.build()}return this._bbox},t}())},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1),i=r(6),o=function(){function t(t,e,r){this.m=n.a.normal(t),this.n=n.a.normal(e);var i=t*e;if(r.length!==i)throw new Error("invalid matrix size");for(var o=0;o<r.length;o++)n.a.normal(r[o]);this.data=r}return t.mul=function(t,e,r,n,i,o){for(var a=0,s=0,u=0;u<t;u++){for(var l=0;l<r;l++){for(var h=l,c=0,f=0;f<e;f++)c+=n[s+f]*i[h],h+=r;o[a++]=c}s+=e}},t.prototype.mul=function(e){if(this.n===e.m){var r=new Array(this.m*e.n);return t.mul(this.m,this.n,e.n,this.data,e.data,r),new t(this.m,e.n,r)}throw new Error("m !== p")},t.prototype.toString=function(){var t=[];t.push("Matrix ("),t.push(this.m.toString()),t.push(" x "),t.push(this.n.toString()),t.push(")");for(var e=0,r=0;r<this.m;r++)for(var n=0;n<this.n;n++){var i=this.data[e++].toString();0===n?(t.push("\n"),t.push("\t"),t.push(i)):(t.push(", "),t.push(i))}return t.join("")},t.on=function(t,e,r){return t*e+r},t.prototype.initExpandMatrix=function(e){for(var r=this.m,n=this.n,i=2*n,o=new Array(r*i),a=0;a<r;a++)for(var s=0;s<i;s++)o[t.on(i,a,s)]=s<n?e[t.on(n,a,s)]:s===r+a?1:0;return o},t.prototype.inverseMatrix=function(e,r,n){for(var i=0;i<r;i++)for(var o=e[t.on(n,i,i)],a=0;a<n;a++)e[t.on(n,i,a)]/=o;return e},t.prototype.getMatrixRank=function(e,r,n){for(var o=Math.min(r,n),a=0;a<r;a++){if(0===e[t.on(n,a,a)]){var s=new Array(n),u=void 0;for(u=a;u<r;u++)if(0!==e[t.on(n,u,a)]){i.a.arraycopy(e,t.on(n,u,0),s,0,n),i.a.arraycopy(e,t.on(n,a,0),e,t.on(n,u,0),n),i.a.arraycopy(s,0,e,t.on(n,a,0),n);break}u>=r&&(o-=1)}if(!(o<r))for(var l=0;l<r;l++)if(l!==a)for(var h=e[t.on(n,l,a)]/e[t.on(n,a,a)],c=0;c<n;c++)e[t.on(n,l,c)]-=e[t.on(n,a,c)]*h}return o},t.prototype.getInverseMatrix=function(){var e=this.data.slice(0);if(this.m!==this.n)throw new Error("The matrix is an "+this.m+"x"+this.n+" order matrix, non-square matrix, please check!");var r=2*this.n,n=this.initExpandMatrix(e),i=new Array(this.m*this.n),o=this.getMatrixRank(n,this.m,r);if(o!==this.m)throw new Error("The ranks of the matrix is "+o+", a non-full rank matrix, please check!");n=this.inverseMatrix(n,this.m,r);for(var a=0;a<this.m;a++)for(var s=this.n;s<r;s++)i[t.on(this.n,a,s-this.n)]=n[t.on(r,a,s)];return i},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.m==e.m&&(this.n==e.n&&i.a.equals(this.data,e.data)))},t}()},function(t,e,r){"use strict";r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return a}));var n=r(1),i="\r",o="\r\n",a=function(){function t(t){this.ob=new Array,this.logger=t}return t.prototype.obGetClean=function(){var t=this.ob.join("");return this.ob.length=0,t},t.prototype.autoD=function(t){return n.a.normal(t),(0|t)===t?t.toString():t.toFixed(4)},t.prototype.obWrite=function(t){this.ob.push(t)},t.prototype.item=function(t,e){var r=e.toString();/^[\x20-\x7e]*$/m.test(r)||(t="%UTF8%"+t),this.obWrite("|"),this.obWrite(t),this.obWrite("="),this.obWrite(r.replace(/\|/g,""))},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,i=r(97),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(e){var r=t.call(this,e)||this;return r.plGrps=new Array,r}return o(e,t),e.prototype.onPolylineGroup=function(e,r){t.prototype.onPolylineGroup.call(this,e,r),this.plGrps.push(e)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(7),i=r(6),o=r(22),a=function(){function t(t){this.items=new Array(t.length),i.a.arraycopy(t,0,this.items,0,t.length),this.__bbox=this.calcBBox()}return t.build1=function(e){var r=[];return Object(o.c)(e,(function(t,e){return r.push(e),!0})),new t(r)},t.prototype.calcBBox=function(){for(var t=new n.b,e=0;e<this.items.length;e++)t.ext1(this.items[e].bbox());return t.build()},t.prototype.multiply3=function(e){for(var r=new Array(this.items.length),n=0;n<r.length;n++)r[n]=this.items[n].multiply3(e);return new t(r)},t.prototype.bbox=function(){return this.__bbox},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n,i=r(94),o=r(7),a=r(6),s=r(22),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),l=function(t){function e(e){var r=t.call(this)||this;if(r._points=[],e.length<2)throw new Error("Bezier needs at least 2 endpoints");return a.a.addAll(r._points,e),r._bbox=(new o.b).ext3(r.points(20)).build(),r}return u(e,t),e.prototype.build1=function(t){var r=[];return Object(s.b)(t,(function(t,e){return r.push(e),!0})),new e(r)},e.prototype.start=function(){return this._points[0]},e.prototype.end=function(){return this._points[this._points.length-1]},e.pointOn=function(t,r){if(r.length<1)throw new Error("bezier must have at least 1 point");if(1===r.length)return r[0];for(var n=new Array(r.length-1),i=1;i<r.length;i++){var o=r[i-1],a=r[i],s=(a.x-o.x)*t,u=(a.y-o.y)*t;n[i-1]=o.add1(s,u)}return e.pointOn(t,n)},e.prototype.toString=function(){return"Bezier ["+this._points.join(" ")+"]"},e.prototype.bbox=function(){return this._bbox},e.prototype.multiply3=function(t){for(var r=new Array(this._points.length),n=0;n<this._points.length;n++){var i=this._points[n];r[n]=i.multiply3(t)}return new e(r)},e.prototype.stroke=function(t,e,r){throw new Error("not supported")},e.prototype.points=function(t){for(var r=t*t,n=this._points[0],i=.5;i>1e-5&&!(n.distance2(e.pointOn(i,this._points))<=r);i*=.5);var o=Math.ceil(1/i),a=new Array(o+1),s=0;a[0]=this.start();for(var u=1;u<o;u++)s+=i,a[u]=e.pointOn(s,this._points);return a[o]=this.end(),a},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n,i=r(35),o=r(0),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(r,n,i){var o=t.call(this,"",r,e.checkPlane(n))||this;return o.outline=i,o}return a(e,t),e.checkPlane=function(t){if(t.type===o.a.PLANE)return t;throw new Error("plane zone must in plane layer")},e.prototype.multiply3=function(t){return new e(this.net,this.layer,this.outline.multiply3(t))},e.prototype.bbox=function(){return this.outline.bbox()},e.prototype.shape=function(t,e){return this.layer.equals(t)||this.layer.equals(o.c.MULTI)?this.outline:null},e}(i.a)},function(t,e,r){"use strict";var n=r(67),i=r(52),o=r(14),a=r(22),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=function(){function t(t){this.sides=new i.a,this.others=new i.a,this.id=t}return t.prototype.add=function(t){var e,r;this.sides.add(t),t.finalGrp=this.id;try{for(var n=s(t.connect),i=n.next();!i.done;i=n.next()){var o=i.value;this.others.add(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.polyline=function(){var t=new Array;return Object(a.b)(this.sides,(function(e,r){return t.push(r.shape),!0})),o.a.build2(t)},t.prototype.hashCode=function(){return this.id},t.prototype.equals=function(e){return null!=e&&e instanceof t&&this.id===e.id},t}(),l=r(69),h=r(28),c=r(53),f=r(83),p=r(71),d=r(6),y=r(19),b=r(84),v=r(10),m=r(32),w=r(73),g=r(61),x=r(60),O=r(26),E=r(17);r.d(e,"b",(function(){return C})),r.d(e,"a",(function(){return L}));var _,N=(_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}_(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),A=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},T=d.a.funcCopy(d.c),S=d.a.funcCopy(d.c),R=d.a.funcCopy(d.c);function I(t){return new Array}function P(t,e){var r,n,i=new x.a(!1),o=new L(t,h.c.DUMMY,i);try{for(var a=A(e),s=a.next();!s.done;s=a.next()){var u=s.value;o.addPolyline(u)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o.simplify(),i.plGrps}function C(t,e){var r,n,i,o,a,s;t=t.asClosed();var u=P(c.b,[t]),l=[];try{for(var h=A(u),f=h.next();!f.done;f=h.next()){var p=f.value;d.a.addAll(l,p.items)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}if(e>0){try{for(var y=A(t.primitives),b=y.next();!b.done;b=y.next()){var v=b.value;l.push(v.stroke(2*e,O.a.ROUND,E.a.CW))}}catch(t){i={error:t}}finally{try{b&&!b.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}return P(c.b,l)}if(e<0){e=-e;try{for(var m=A(t.primitives),w=m.next();!w.done;w=m.next()){v=w.value;l.push(v.stroke(2*e,O.a.ROUND,E.a.CCW))}}catch(t){a={error:t}}finally{try{w&&!w.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}return P(c.c,l)}return u}var L=function(t){function e(e,r,n){var i=t.call(this,new f.a(!1),e,r,n)||this;return i.finalSides=new Array,i.sideGroups={},i.vecSides=new Array,i.curNetIndex=0,i.curIndex=-1,i.scanLines=0,i}return N(e,t),e.prototype.sweep=function(t,e,r){var i,o;this.scanLines=0,T(e,n.a.sortByBBoxMinY,0,e.length);var a=new p.a;this.curNetIndex=0;var s=Number.POSITIVE_INFINITY;try{for(var u=A(t),l=u.next();!l.done;l=u.next()){var h=l.value;h>s&&this.scan(a,(s+h)/2,e),s=h}}catch(t){i={error:t}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}this.getAllMarkPrimitive(r,e),this.logger.debug3("scan %s %d",r,this.scanLines)},e.prototype.simplify=function(){this.seekIntersection(),this.splitSidesByInters(),this.sweep(this.getSortedEndpointsLineAsc(this.sides),this.sides,!1),this.flipSides(),this.sweep(this.getSortedEndpointsLineAsc(this.vecSides),this.vecSides,!0),this.connectSides(),this.fillResult()},e.prototype.addPolyline=function(e,r,n){void 0===r&&(r=1),void 0===n&&(n=.01),t.prototype.addPolyline.call(this,e,r,n)},e.prototype.scan=function(t,e,r){for(var n=!1,i=t.listIterator();i.hasNext();){var o=i.next(),a=o.item;y.a.less(a.bbox().maxY,e)?t.remove(o):!n&&a.isNeedScan(e)&&(n=!0)}for(;this.curNetIndex<r.length;){a=r[this.curNetIndex];if(!y.a.less(a.bbox().minY,e))break;y.a.greatereq(a.bbox().maxY,e)&&(this.add2AET(t,a),!n&&a.isNeedScan(e)&&(n=!0)),this.curNetIndex++}if(n){this.scanLines++;for(var s=new b.a(this.rule,this,e),u=t.iterator();u.hasNext();){var l=u.next();s.onEp(l)}}},e.prototype.add2AET=function(t,e){for(var r=e.bbox().minX,n=e.bbox().maxX,i=e.bbox().minY,o=e.bbox().maxY,a=t.listIterator();a.hasNext();){var s=void 0,u=a.next(),l=u.item,h=l.bbox().minX,c=l.bbox().maxX;if(n<=h)s=-1;else if(c<=r)s=1;else{var f=l.bbox().minY,p=l.bbox().maxY,d=Math.max(i,f),y=Math.min(o,p);s=this.compareBySweep(e,l,(d+y)/2)}if(s<0)return void t.insertBefore(u,e)}t.add(e)},e.prototype.compareBySweep=function(t,e,r){var n=t.getX(r),i=e.getX(r);return isFinite(n)&&isFinite(i)?n-i:0},e.prototype.getAllMarkPrimitive=function(t,e){var r,n;try{for(var i=A(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(a.status===l.b.UNMARKED&&0!=a.bbox().height()){var s=a.voteStatus();if(s===l.b.OUTSIDE||s===l.b.INSIDE){a.status=s;var u=a.reverse(s);if(t){this.event.onResultSide(u);var h=u.shape.multiply3(v.a.ROT_N90),c=u.start.multiply3(v.a.ROT_N90),f=u.end.multiply3(v.a.ROT_N90);u=new l.a(this,h,u.baseWeight,c,f,u.polyGrp,u.polyIndex)}this.finalSides.push(u),this.event.onResultSide(u)}}}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.flipSides=function(){var t,e;try{for(var r=A(this.sides),n=r.next();!n.done;n=r.next()){var i=n.value;if(0==i.polyIndex){var o=null,a=null;do{var s=i.shape.multiply3(v.a.ROT_90),u=i.start.multiply3(v.a.ROT_90),h=i.end.multiply3(v.a.ROT_90),c=new l.a(this,s,i.baseWeight,u,h,i.polyGrp,i.polyIndex);if(c.outsideWeight=i.outsideWeight,c.insideWeight=i.insideWeight,c.invalidWeight=i.invalidWeight,c.status=i.status,null!=o?(o.next=c,c.previous=o):a=c,this.vecSides.push(c),this.event.onSplitedSide(c),o=c,null===i.next)break;i=i.next}while(0!=i.polyIndex);null!=a&&(a.previous=o,o.next=a)}}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.connectSides=function(){var t,e,r,n,o=new m.a,a=new w.a(10);try{for(var s=A(this.finalSides),u=s.next();!u.done;u=s.next()){var l=u.value;o.computeIfAbsent(l.start,I).push(l),a.add(l.start)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}var h=0,c=new i.a,f=new Array;try{for(var d=A(this.finalSides),y=d.next();!y.done;y=d.next()){var b=y.value;if(!c.contains(b)){var v=new i.a,g=b.start,x=new p.a;x.add(b),c.add(b);for(var O=b.end;x.size()>0;){if(this.isStart(g,O)){x.size()>1&&this.fillSideGroups(x,h++);break}var E=o.get(O),_=this.findNext(c,E);if(null==_&&null!==(O=this.findNeigber(O,v,a,.01))&&(E=o.get(O),_=this.findNext(c,E)),null!=_)x.add(_),c.add(_),O=_.end;else{if(null!=O?v.add(O):(0==f.length&&x.size()>1&&this.logger.warning3("unable to connect at %s",x.getLast()),f.push(x.removeLast())),!(x.size()>0))break;O=x.getLast().end}}}}}catch(t){r={error:t}}finally{try{y&&!y.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}},e.prototype.fillSideGroups=function(t,e){var r=new u(e);Object(a.b)(t,(function(t,e){return r.add(e),!0})),this.sideGroups[r.id]=r},e.prototype.isStart=function(t,e){return t.distance2(e)<=1e-4},e.prototype.findNext=function(t,e){var r,n;if(null!=e)try{for(var i=A(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(!t.contains(a))return a}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return null},e.prototype.fillResult=function(){var t,e,r=0,o=new m.a;for(var s in this.sideGroups){var u=this.sideGroups[s];Object(a.b)(u.sides,(function(t,e){return-2!=e.polyGrp&&o.put(e,e),!0}))}var l=new i.a;for(var s in this.sideGroups){u=this.sideGroups[s];if(l.add(u)){var h=0,c=new Array;c.push(u);for(var f=function(){var t,e,r=c[h],n=new Array;Object(a.b)(r.others,(function(t,e){var r=o.get(e);return null!=r&&n.push(r.finalGrp),!0})),S(n,d.a.sortAsc,0,n.length);var i=r.id;try{for(var s=(t=void 0,A(n)),u=s.next();!u.done;u=s.next()){var f=u.value;if(f!=i&&f!=r.id){var y=p.sideGroups[f];l.add(y)&&c.push(y),i=f}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}h++},p=this;h<c.length;)f();var y=new Array;try{for(var b=(t=void 0,A(c)),v=b.next();!v.done;v=b.next()){var w=v.value.polyline().simplify(.001);w&&y.push(w)}}catch(e){t={error:e}}finally{try{v&&!v.done&&(e=b.return)&&e.call(b)}finally{if(t)throw t.error}}y.length>0&&(R(y,n.a.sortByBBoxAreaDesc,0,y.length),this.event.onPolylineGroup(new g.a(y),r++))}}},e.prototype.findNeigber=function(t,e,r,n){var i,o,a=n*n,s=Number.MAX_VALUE,u=null;try{for(var l=A(r.search(t.bbox().extendOfSize(n))),h=l.next();!h.done;h=l.next()){var c=h.value;if(!e.contains(c)){var f=t.distance2(c);f<s&&(s=f,u=c)}}}catch(t){i={error:t}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return s<a?u:null},e}(n.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(10),i=r(7),o=r(1),a=r(12),s=function(){function t(t,e,r,n,i,a,s,u,l){this.name=t,this.value=e,this.location=r,this.orientation=o.a.normal(n),this.showName=i,this.display=a,this.font=s,this.color=u,this.aligment=l}return t.prototype.multiply3=function(e){return new t(this.name,this.value,this.location.multiply3(e),a.a.transformD(this.orientation,e),this.showName,this.display,this.font.transform(e),this.color,this.aligment)},t.prototype.bbox=function(){var t=this.font.size*this.name.length/2,e=this.orientation,r=this.location,o=this.location.add1(t,this.font.size);if(e%360==0)return(new i.b).ext2(r).ext2(o).build();var a=this.location.add1(t,0),s=this.location.add1(0,this.font.size),u=n.a.rotateD(e).setOrigin1(this.location);return(new i.b).ext2(r.multiply3(u)).ext2(o.multiply3(u)).ext2(a.multiply3(u)).ext2(s.multiply3(u)).build()},t}()},function(t,e,r){"use strict";r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return f}));var n,i=r(43),o=r(1),a=r(107),s=r(95),u=r(8),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(){function t(){this.sourceName=null,this.contributor=null,this.scale=Number.NaN,this.rules=[],this.shapes=[],this.layerStack=new s.a}return t.prototype.build=function(){return new f(this)},t.prototype.addLayerOrder=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(null!==t)for(var r=0;r<t.length;r++){var n=o.a.notnull(t[r]);if(this.layerStack.contains(n))throw new Error(u.a.format("duplicate layer %s",n));this.layerStack.add(n)}},t}(),f=function(t){function e(e){var r=t.call(this,o.a.notnull(e.sourceName),o.a.notnull(e.contributor),e.scale)||this;return r.rules=e.rules.slice(0),r.shapes=e.shapes.slice(0),r.layerStack=e.layerStack.array().slice(0),r}return l(e,t),e.prototype.components=function(){var t,e,r={},n=[];try{for(var o=h(this.shapes),a=o.next();!a.done;a=o.next()){var s=a.value;s instanceof i.a&&(s.pattern in r||(r[s.pattern]=!0,n.push(s)))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n},e}(a.a)},function(t,e,r){"use strict";r.d(e,"b",(function(){return p})),r.d(e,"a",(function(){return d}));var n=r(69),i=r(73),o=r(6),a=r(9),s=r(2),u=r(52),l=r(24),h=r(5),c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=o.a.funcCopy(o.c);function p(t,e){var r=0;if(Math.abs(t.start.y-e)<=1e-4)l.a[r++]=t.start.x;else if(Math.abs(t.end.y-e)<=1e-4)l.a[r++]=t.end.x;else if(t.shape instanceof s.a)r=Object(l.c)(t.shape,e);else{if(!(t.shape instanceof a.a))throw new Error("not supported operation");r=Object(l.b)(t.shape,e)}return r}var d=function(){function t(t,e,r,n){this.sides=new Array,this.loader=t,this.loader.bo=this,this.logger=r,this.rule=e,this.event=n}return t.sortByBBoxMinY=function(t,e){return t.bbox().minY-e.bbox().minY},t.sortByBBoxAreaDesc=function(t,e){return e.bbox().area()-t.bbox().area()},t.prototype.addPolyline=function(t,e,r){var n,i;void 0===e&&(e=1),void 0===r&&(r=.01);try{for(var o=c(this.loader.buildGroup(t,e,r)),a=o.next();!a.done;a=o.next()){var s=a.value;this.sides.push(s),this.event.onOriginSide(s)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},t.prototype.buildRTree=function(){var t,e,r=new i.a(10);try{for(var n=c(this.sides),o=n.next();!o.done;o=n.next()){var a=o.value;r.add(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return r},t.prototype.fillValidSides=function(t,e,r){var n,i;try{for(var o=c(e),a=o.next();!a.done;a=o.next()){var s=a.value;isFinite(s.getX(r))&&t.push(s)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},t.prototype.getSortedEndpointsLineAsc=function(t){var e,r,n,i,o=new Array;try{for(var a=c(t),s=a.next();!s.done;s=a.next()){var u=s.value;u.needCountWeight()&&(o.push(u.start),o.push(u.end))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}f(o,h.a.sortByYAsc,0,o.length);var l=new Array,p=Number.NEGATIVE_INFINITY;try{for(var d=c(o),y=d.next();!y.done;y=d.next()){var b=y.value.y;b>p&&(l.push(b),p=b)}}catch(t){n={error:t}}finally{try{y&&!y.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return l},t.prototype.splitSides=function(t,e,r){var i,o,u=t.start,l=t.end,p=new h.a(l.x+2*(u.x-l.x),l.y+2*(u.y-l.y));f(t.inters,(function(t,e){return t.distance2(p)-e.distance2(p)}),0,t.inters.length);var d=null;try{for(var y=c(t.inters),b=y.next();!b.done;b=y.next()){var v=b.value;if(null==d)v.equals(u)&&(d=v);else if(!v.equals(d)){var m=n.a.rebuild(t.shape,d,v);if(m instanceof a.a&&Math.abs(m.sweepAngle)>190&&(m=new s.a(d,v)),e.push(new n.a(this,m,t.baseWeight,d,v,t.polyGrp,r++)),v.equals(l))break;d=v}}}catch(t){i={error:t}}finally{try{b&&!b.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}return r},t.prototype.splitSidesByInters=function(){var t,e,r,n,i,o,a=new Array;try{for(var s=c(this.sides),u=s.next();!u.done;u=s.next()){var l=u.value;if(0==l.polyIndex){var h=0,f=null,p=null;do{var d=new Array;h=this.splitSides(l,d,h);try{for(var y=(r=void 0,c(d)),b=y.next();!b.done;b=y.next()){var v=b.value;null!=f?(f.next=v,v.previous=f):p=v,f=v,this.event.onSplitedSide(v),a.push(v)}}catch(t){r={error:t}}finally{try{b&&!b.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}if(null===l.next)throw new Error("not supported operation");l=l.next}while(0!==l.polyIndex);null!=p&&null!=f&&(p.previous=f,f.next=p)}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}this.sides.length=0;try{for(var m=c(a),w=m.next();!w.done;w=m.next()){var g=w.value;this.sides.push(g)}}catch(t){i={error:t}}finally{try{w&&!w.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}},t.prototype.seekIntersection=function(){var t,e,r,n;if(this.sides.length>0){var i=this.buildRTree(),o=new u.a;try{for(var a=c(this.sides),f=a.next();!f.done;f=a.next()){var p=f.value;o.add(p);var d=p.bbox().extendOfSize(1e-5),y=p.shape instanceof s.a;try{for(var b=(r=void 0,c(i.search(d))),v=b.next();!v.done;v=b.next()){var m=v.value;if(!o.contains(m)){var w=m.shape instanceof s.a;if(y&&w&&null!==p.next&&null!==p.previous&&(p.next.equals(m)||p.previous.equals(m)));else for(var g=Object(l.d)(p.shape,m.shape),x=0;x<g;x+=2){var O=new h.a(l.a[x],l.a[x+1]);p.inters.push(O),m.inters.push(O),this.event.onIntersect(O,p,m)}}}}catch(t){r={error:t}}finally{try{v&&!v.done&&(n=b.return)&&n.call(b)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{f&&!f.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}}},t}()},function(t,e,r){"use strict";r.d(e,"b",(function(){return f})),r.d(e,"a",(function(){return p}));var n,i=r(25),o=r(7),a=r(1),s=r(27),u=r(12),l=r(5),h=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(){function t(){this.name="",this.abbreviation="",this.location=l.a.ORIGIN,this.orientation=0,this.mirrored=!1,this.prefix=null,this.value=null,this.footprint="",this.partId="",this.props=new Array,this.shapes=new s.a}return t.prototype.addShape=function(t,e,r){this.shapes.computeIfAbsent(t,(function(){return new s.a})).computeIfAbsent(e,(function(){return[]})).push(r)},t.prototype.check=function(){if(this.shapes.isEmpty()&&0===this.props.length)throw new Error("sch component should not be empty");a.a.notNullOrUndef(a.a.notNullOrUndef(this.shapes.get(this.footprint)).get(this.partId))},t.prototype.build=function(){return new p(this)},t}(),p=function(t){function e(e){var r=t.call(this,"")||this;e.check(),r.name=e.name,r.abbreviation=e.abbreviation,r.location=e.location,r.orientation=a.a.normal(e.orientation),r.mirrored=e.mirrored,r.prefix=a.a.notnull(e.prefix),r.value=a.a.notnull(e.value),r.footprint=e.footprint,r.partId=e.partId,r.props=e.props;var n={};return e.shapes.iterator((function(t,e){return n[t]=e.origin(),!0})),r.shapes=n,r}return h(e,t),e.prototype.hasMultiParts=function(){var t=this.shapes;for(var e in t){var r=0;for(var n in t[e])if(++r>1)return!0}return!1},e.prototype.getProps=function(t){var e,r,n=new Array;try{for(var i=c(this.props),o=i.next();!o.done;o=i.next()){var a=o.value;a.name===t&&n.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},e.prototype.multiply3=function(t){var e,r,n=new f;n.name=this.name,n.abbreviation=this.abbreviation,n.location=this.location.multiply3(t),n.orientation=u.a.transformD(this.orientation,t),n.mirrored=this.mirrored,n.prefix=this.prefix.multiply3(t),n.value=this.value.multiply3(t),n.footprint=this.footprint,n.partId=this.partId,this.shapeItor((function(e,r,i){return n.addShape(e,r,i.multiply3(t)),!0}));try{for(var i=c(this.props),o=i.next();!o.done;o=i.next()){var a=o.value;n.props.push(a.multiply3(t))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n.build()},e.prototype.bbox=function(){var t,e,r=new o.b;r.ext1(this.prefix.bbox()),r.ext1(this.value.bbox());try{for(var n=c(this.props),i=n.next();!i.done;i=n.next()){var a=i.value;r.ext1(a.bbox())}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return this.shapeItor((function(t,e,n){return r.ext1(n.bbox()),!0})),r.build()},e.prototype.shapeItor=function(t){var e,r;for(var n in this.shapes){var i=this.shapes[n];for(var o in i)try{for(var a=(e=void 0,c(i[o])),s=a.next();!s.done;s=a.next()){if(!t(n,o,s.value))return}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}}},e}(i.a)},function(t,e,r){"use strict";r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return f}));var n,i=r(8),o=r(7),a=r(6),s=r(2),u=r(9),l=r(17),h=r(67),c=r(24);!function(t){t[t.UNMARKED=0]="UNMARKED",t[t.INSIDE=1]="INSIDE",t[t.OUTSIDE=2]="OUTSIDE",t[t.INVALID=3]="INVALID"}(n||(n={}));var f=function(){function t(t,e,r,i,a,s,u){this.inters=[],this.connect=new Array,this.previous=null,this.next=null,this.finalGrp=-1,this.trans=NaN,this.outsideWeight=0,this.insideWeight=0,this.invalidWeight=0,this._confidence=0,this._confidence_y=NaN,this._x=NaN,this._x_y=NaN,this.status=n.UNMARKED,this.bo=t,this.shape=e,this.baseWeight=r,i.y>a.y?this.weight=-r:i.y==a.y?this.weight=0:this.weight=r,this.start=i,this.end=a,this.polyGrp=s,this.polyIndex=u,this._bbox=(new o.b).ext1(e.bbox()).ext2(i).ext2(a).build(),this.inters.push(i),this.inters.push(a);var l=1;l=31*(l=31*l+this.polyGrp)+this.polyIndex,this._hashcode=l}return t.rebuild=function(t,e,r){if(t instanceof s.a||e.distance2(r)<1e-6)return new s.a(e,r);if(t instanceof u.a){var n=t,i=t.bbox().center().x,o=void 0;o=e.y>r.y?i>n.center.x?l.a.CW:l.a.CCW:i>n.center.x?l.a.CCW:l.a.CW;var a=e.angleD(n.center),h=r.angleD(n.center);return u.a.build2(n.center,a,h,n.rx,n.ry,o)}throw new Error("not supported operation")},t.prototype.is=function(t,e){return t===this.polyGrp&&e===this.polyIndex},t.prototype.confidence=function(t){if(this._confidence_y!=t){var e=this._bbox.height();if(0!==e)if(Math.abs(t-this._bbox.maxY)>5e-4&&Math.abs(t-this._bbox.minY)>5e-4){var r=1-Math.abs(2*t-this._bbox.maxY-this._bbox.minY)/e;this._confidence=1e4*r|0}else this._confidence=0;else this._confidence=1;this._confidence_y=t}return this._confidence},t.prototype.needCountWeight=function(){return this.outsideWeight+this.insideWeight+this.invalidWeight<5e3},t.prototype.revokeOutside=function(t){var e=this.confidence(t);return this.outsideWeight-=e,this.invalidWeight+=e,e},t.prototype.revokeInside=function(t){var e=this.confidence(t);return this.insideWeight-=e,this.invalidWeight+=e,e},t.prototype.setOutside=function(t){var e=this.confidence(t);return this.outsideWeight+=e,e},t.prototype.setInside=function(t){var e=this.confidence(t);return this.insideWeight+=e,e},t.prototype.setInvalid=function(t){var e=this.confidence(t);return this.invalidWeight+=e,e},t.prototype.prevNot0=function(){for(var t=this.previous;null!=t&&t!=this;){if(0!=t.weight)return t;t=t.previous}return null},t.prototype.nextNot0=function(){for(var t=this.next;null!=t&&t!=this;){if(0!=t.weight)return t;t=t.next}return null},t.prototype.getX=function(t){if(null!==this.bo)return this._x_y!=t&&(Object(h.b)(this,t)>0?this._x=c.a[0]:this._x=NaN,this._x_y=t),this._x;throw new Error("not supported operation")},t.prototype.voteStatus=function(){return this.outsideWeight>this.insideWeight&&this.outsideWeight>this.invalidWeight?n.OUTSIDE:this.insideWeight>this.outsideWeight&&this.insideWeight>this.invalidWeight?n.INSIDE:this.invalidWeight>this.outsideWeight&&this.invalidWeight>this.insideWeight?n.INVALID:n.UNMARKED},t.prototype.reverse=function(e){if(e===n.OUTSIDE){if(this.start.y>this.end.y){var r=t.rebuild(this.shape,this.end,this.start),i=new t(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return a.a.addAll(i.connect,this.connect),i}return this}if(e===n.INSIDE){if(this.start.y<this.end.y){r=t.rebuild(this.shape,this.end,this.start),i=new t(this.bo,r,this.baseWeight,this.end,this.start,this.polyGrp,this.polyIndex);return a.a.addAll(i.connect,this.connect),i}return this}return this},t.prototype.isNeedScan=function(t){return this.needCountWeight()&&this.confidence(t)>0},t.prototype.hashCode=function(){return this._hashcode},t.prototype.equals=function(e){return e instanceof t&&(this.polyGrp===e.polyGrp&&this.polyIndex===e.polyIndex)},t.prototype.bbox=function(){return this._bbox},t.prototype.toString=function(){return i.a.format("(%d,%d,%d) (%d,%d,%d) %s %s",this.polyGrp,this.polyIndex,this.weight,this.outsideWeight,this.invalidWeight,this.insideWeight,this.start,this.end)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=String.fromCharCode,i=function(){function t(){this.buffer=new Array}return t.prototype.size=function(){return this.buffer.length},t.prototype.isEOF=function(){return!1},t.prototype.write=function(t){return this.buffer.push(t),1},t.prototype.writen1=function(t){return this.writen2(t,0,t.length)},t.prototype.writen2=function(t,e,r){for(var n=this.buffer,i=0,o=e;i<r;i++,o++)n.push(t[o]);return r},t.prototype.writeAsync=function(t,e){e(this.write(t))},t.prototype.writenAsync1=function(t,e){e(this.writen1(t))},t.prototype.writenAsync2=function(t,e,r,n){n(this.writen2(t,e,r))},t.prototype.writeStr=function(t){for(var e=t.length,r=new Array(e),n=0;n<e;n++)r[n]=t.charCodeAt(n);return this.writen1(r)},t.prototype.clear=function(){this.buffer.length=0},t.prototype.toString=function(){var t=this.buffer,e=t.length;if(e<=500)return n.apply(null,t);for(var r=new Array,i=0;i<t.length;i+=500){var o=Math.min(e-i,500),a=n.apply(null,t.slice(i,i+o));r.push(a)}return r.join("")},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=new Error("list is empty"),i=function(){function t(t,e){this.prev=null,this.next=null,this.parent=t,this.item=e}return t.prototype.insertAfter=function(t){t.next=this.next,this.next=t,t.prev=this,null!==t.next&&(t.next.prev=t)},t.prototype.insertBefore=function(t){t.prev=this.prev,this.prev=t,t.next=this,null!==t.prev&&(t.prev.next=t)},t.prototype.remove=function(){null!==this.prev&&(this.prev.next=this.next),null!==this.next&&(this.next.prev=this.prev)},t.prototype.set=function(t){this.item=t},t}(),o=function(){function t(t){this._next=t}return t.prototype.hasNext=function(){return null!==this._next},t.prototype.next=function(){var t=this._next;if(null!==t)return this._next=t.next,t.item;throw new Error("iterator is null")},t}(),a=function(){function t(t){this._next=t}return t.prototype.hasNext=function(){return null!==this._next},t.prototype.next=function(){var t=this._next;if(null!==t)return this._next=t.next,t;throw new Error("iterator is null")},t}(),s=function(){function t(){this.first=null,this.last=null,this.cnt=0}return t.prototype.add=function(t){return this.addLast(t)},t.prototype.push=function(t){return this.addLast(t)},t.prototype.pop=function(){return this.removeLast()},t.prototype.shift=function(){return this.removeFirst()},t.prototype.removeFirst=function(){var t=this.first;if(null===t)throw n;return this.remove(t),t.item},t.prototype.removeLast=function(){var t=this.last;if(null===t)throw n;return this.remove(t),t.item},t.prototype.addLast=function(t){if(null===this.first||null===this.last){var e=new i(this,t);return this.first=e,this.last=e,this.cnt++,e}return this.insertAfter(this.last,t)},t.prototype.addFirst=function(t){if(null===this.first||null===this.last){var e=new i(this,t);return this.first=e,this.last=e,this.cnt++,e}return this.insertBefore(this.first,t)},t.prototype.getFirst=function(){if(null===this.first)throw n;return this.first.item},t.prototype.getLast=function(){if(null===this.last)throw n;return this.last.item},t.prototype.insertAfter=function(t,e){var r=new i(this,e);return t.insertAfter(r),t===this.last&&(this.last=r),this.cnt++,r},t.prototype.insertBefore=function(t,e){var r=new i(this,e);return t.insertBefore(r),t===this.first&&(this.first=r),this.cnt++,r},t.prototype.remove=function(t){t.remove(),t===this.first&&(this.first=t.next),t===this.last&&(this.last=t.prev),this.cnt--},t.prototype.size=function(){return this.cnt},t.prototype.clear=function(){this.first=null,this.last=null,this.cnt=0},t.prototype.iterator=function(){return new o(this.first)},t.prototype.listIterator=function(){return new a(this.first)},t.prototype.toArray=function(){for(var t=new Array,e=this.first;null!=e;)t.push(e.item),e=e.next;return t},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1),i=r(11),o=function(){function t(){this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.minZ=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.maxZ=Number.NEGATIVE_INFINITY}return t.prototype.ext1=function(t,e,r,n,i,o){if(!(t<=n&&e<=i&&r<=o))throw new Error("min > max is not permitted");return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.minZ=Math.min(this.minZ,r),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,i),this.maxZ=Math.max(this.maxZ,o),this},t.prototype.ext2=function(t,e,r){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.minZ=Math.min(this.minZ,r),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,e),this.maxZ=Math.max(this.maxZ,r),this},t.prototype.ext3=function(t){return this.ext2(t.x,t.y,t.z)},t.prototype.ext4=function(t){return this.ext1(t.minX,t.minY,t.minZ,t.maxX,t.maxY,t.maxZ)},t.prototype.ext5=function(t,e){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,e),this},t.prototype.ext6=function(t){return this.minZ=Math.min(this.minZ,t),this.maxZ=Math.max(this.maxZ,t),this},t.prototype.isValid=function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.minZ)&&isFinite(this.maxX)&&isFinite(this.maxY)&&isFinite(this.maxZ)},t.prototype.build=function(){return new a(this.minX,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},t}(),a=function(){function t(t,e,r,i,o,a){if(!(t<=i&&e<=o&&r<=a))throw new Error("min > max is not permitted");this.minX=n.a.normal(t),this.minY=n.a.normal(e),this.minZ=n.a.normal(r),this.maxX=n.a.normal(i),this.maxY=n.a.normal(o),this.maxZ=n.a.normal(a)}return t.prototype.center=function(){return new i.a((this.minX+this.maxX)/2,(this.minY+this.maxY)/2,(this.minZ+this.maxZ)/2)},t.prototype.transform=function(t){var e=new o,r=new i.a(this.minX,this.minY,this.minZ).multiply4(t),n=new i.a(this.maxX,this.maxY,this.maxZ).multiply4(t);return e.ext3(r).ext3(n).build()},t.prototype.isContains=function(t){return!(t.x<this.minX||t.y<this.minY||t.z<this.minZ||t.x>this.maxX||t.y>this.maxY||t.z>this.maxZ)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n=r(7),i=r(6),o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function a(t,e){var r=t.bbox(),n=e.bbox();return(r.minY+r.maxY)/2-(n.minY+n.maxY)/2}function s(t,e){var r=t.bbox(),n=e.bbox();return(r.minX+r.maxX)/2-(n.minX+n.maxX)/2}var u=function(){function t(t){var e,r;if(this.__bbox=null,void 0!==t)if(t instanceof Array){this.__items=[];try{for(var n=o(t),i=n.next();!i.done;i=n.next()){var a=i.value;this.add(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}else this.__items=t,this.__bbox=t.bbox();else this.__items=[]}return t.prototype.add=function(t){if(!(this.__items instanceof Array))throw new Error("can't insert multiple item into leaf node");this.__items.push(t),this.__bbox=n.a.extend2(this.__bbox,t.bbox())},t.prototype.items=function(){return this.__items},t.prototype.bbox=function(){if(null!==this.__bbox)return this.__bbox;throw new Error("bug")},t}(),l=function(){function t(t){this.changed=!1,this.root=new u,this.capacity=t,this.capacity2=t*t,this.itemList=[]}return t.prototype.size=function(){return this.itemList.length},t.prototype.items=function(){return this.flushWhenNeed(),this.itemList},t.prototype.add=function(t){this.itemList.push(t),this.changed=!0},t.prototype.remove=function(t){i.a.remove(this.itemList,t),this.changed=!0},t.prototype.clear=function(){this.changed=!1,this.root=new u,this.itemList.length=0},t.prototype.flushWhenNeed=function(){var t,e;if(this.changed){var r=new Array;try{for(var n=o(this.itemList),i=n.next();!i.done;i=n.next()){var a=i.value;r.push(new u(a))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}for(;;){var s=this.organize(r);if(!(s.length>1))break;r=s}this.root=new u(r),this.changed=!1}},t.prototype.organize=function(t){Object(i.c)(t,s,0,t.length);for(var e=t.length,r=[],n=0;n<e;)if(n+this.capacity2<=e){var o=n+this.capacity2;Object(i.c)(t,a,n,o);for(var l=n;l<o;l+=this.capacity){var h=new u(t.slice(l,l+this.capacity));r.push(h)}n+=this.capacity*this.capacity}else{h=new u(t.slice(n,n+this.capacity));r.push(h),n+=this.capacity}return r},t.prototype.search=function(t){var e,r;this.flushWhenNeed();var n=[],i=[];for(i.push(this.root);;){var a=i.shift();if(void 0===a)break;var s=a.items();if(s instanceof Array)try{for(var u=(e=void 0,o(s)),l=u.next();!l.done;l=u.next()){var h=l.value;if(!t.isSeparated(h.bbox())){var c=h.items();c instanceof Array?i.push(h):n.push(c)}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}else t.isSeparated(a.bbox())||n.push(s)}return n},t.prototype.walker=function(t){this.flushWhenNeed(),this._walker(this.root,0,t)},t.prototype._walker=function(t,e,r){var n,i;this.flushWhenNeed();var a=t.items();if(a instanceof Array)try{for(var s=o(a),u=s.next();!u.done;u=s.next()){var l=u.value;this._walker(l,e+1,r)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}else r(a,e)},t.prototype.bbox=function(){return this.flushWhenNeed(),this.root.bbox()},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t){this.cache={},this.levels=t,this.result=new Array(t),this.weights=new Array(t),this.maxIdx=t-1,this.rule=this.decide.bind(this);for(var e=1,r=0;r<t;r++)this.weights[r]=e,e*=50}return t.prototype.weight=function(t){return this.weights[t]},t.prototype.decide=function(t){t=Math.abs(t);var e=this.cache[t];if(void 0===e){for(var r=t,n=this.maxIdx;n>=0;n--){var i=this.weights[n],o=t/i|0,a=t%i;a>(i/2|0)?(t=i-a,o++):t=a,this.result[n]=o>0}e=this.decide1(this.result),this.cache[r]=e}return e},t}()},function(t,e,r){"use strict";var n=r(105),i=r(91),o=r(28),a=r(8),s=r(66),u=r(101),l=r(76),h=r(4),c=r(27),f=r(70),p=r(56),d=r(40);function y(t){var e=parseInt(t),r=255&e,n=e>>8&255,i=e>>16&255;return new d.a(r,n,i)}var b,v=function(){function t(t){this._line=0,this._index=0,this.decoder=t,this.logger=t.logger,this.isLib=t.isLib}return t.prototype.on=function(t){this.decoder.on(t)},t.prototype.feed=function(t,e,r){this._line=e,this._index=r,this.watcher(t)},t.prototype.line=function(){return this._line},t.prototype.index=function(){return this._index},t}(),m=r(111),w=r(33),g=r(1),x=r(0),O=r(44),E=r(2),_=r(9),N=r(17),A=r(39),T=r(36),S=r(15),R=r(47),I=r(18),P=r(14),C=r(20),L=r(63),D=r(55),M=r(30),k=r(43),U=r(5),B=r(54),F=(b=function(t,e){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}b(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Y=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function G(t){return(t=g.a.notEmpty(t)).endsWith("mil")&&(t=t.substring(0,t.length-3)),parseInt(t)}function z(t){return(t=g.a.notEmpty(t)).endsWith("mil")&&(t=t.substring(0,t.length-3)),parseFloat(t)}function W(t,e){return new U.a(z(t),z(e))}var X=function(t){function e(e){var r=t.call(this,e)||this;r.compIndex=new c.a,r.nets=new c.a,r.boardOutline=new Array,r.layerInfos=new m.a,r.hasOutline=!1,r.data=new c.a;var n=new s.b;return n.sourceName=e.sourceName,n.contributor="Altium",n.scale=w.a.MIL,r.doc=n,r}return F(e,t),e.prototype.watcher=function(t){this.data=t;var e=t.get("RECORD");if(!g.a.nullOrEmpty(e)&&!t.contains("POLYGON"))try{switch(e){case"Board":this.parseBoard();break;case"Component":this.parseComponent();break;case"Arc":this.parseEllipseArc();break;case"Pad":this.parsePad();break;case"Via":this.parseVia();break;case"Track":this.parseTrack();break;case"Text":this.parseText();break;case"Region":this.parseRegion();break;case"Fill":this.parseFill();break;case"Polygon":this.parsePolygon();break;case"Net":this.parseNet();break;default:this.logger.warning3("unrecognized RECORD name %s",e)}}catch(t){this.logger.error2(t)}return!0},e.prototype.finish=function(){var t,e,r=this.doc,n=this.layerInfos.layers();r.addLayerOrder(n[0].layer);for(var i=n[0].next;null!=i;)this.logger.debug2(i),r.addLayerOrder(i.layer),i=i.next;if(!this.isLib&&!this.hasOutline)try{for(var o=Y(this.boardOutline),a=o.next();!a.done;a=o.next()){var s=a.value;s instanceof _.a?r.shapes.push(new T.a("",x.c.OUTLINE,s,10,!1)):r.shapes.push(new M.a("",x.c.OUTLINE,s.start(),s.end(),10,!1))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}this.compIndex.iterator((function(t,e){return e.shapes.length>0&&r.shapes.push(e.build()),!0})),this.on(r.build())},e.prototype.net=function(t){if(void 0===t)return"";var e=this.nets.get(t);return g.a.nullOrEmpty(e)?"":e},e.prototype.layer=function(t){var e,r=0;switch(t=g.a.notEmpty(t)){case"BOTTOM":e=x.a.BOT_COPPER;break;case"TOP":e=x.a.TOP_COPPER;break;case"TOPPASTE":e=x.a.TOP_PASTE;break;case"BOTTOMPASTE":e=x.a.BOT_PASTE;break;case"BOTTOMOVERLAY":e=x.a.BOT_SILK;break;case"TOPOVERLAY":e=x.a.TOP_SILK;break;case"TOPSOLDER":e=x.a.TOP_SOLDER_MASK;break;case"BOTTOMSOLDER":e=x.a.BOT_SOLDER_MASK;break;case"KEEPOUT":e=x.a.OUTLINE;break;case"MULTILAYER":e=x.a.MULTI;break;default:t.startsWith("MID")?(e=x.a.INNER,r=G(t.substring("MID".length))):t.startsWith("MECHANICAL")?(e=x.a.MECHANICAL,r=G(t.substring("MECHANICAL".length))):t.startsWith("PLANE")?(e=x.a.PLANE,r=G(t.substring("PLANE".length))):(this.logger.warning3("unknow layer type %s",t),e=x.a.OTHER)}return new x.c(e,r)},e.prototype.put2doc=function(t){var e=this.data;if(e.contains("COMPONENT")){var r=g.a.notEmpty(e.get("COMPONENT")),n=this.compIndex.get(r);void 0===n?(this.logger.warning3("component %s not found",r),this.doc.shapes.push(t)):t instanceof O.a?"True"===e.getOrDefault("DESIGNATOR","False")?this.isLib?n.designator=new O.a(t.net,t.layer,t.location,t.rotation,t.text.replace(/^(\D*)\d+/,"$1?"),t.font,t.mirror):n.designator=t:"True"===e.getOrDefault("COMMENT","False")?n.comment=t:n.shapes.push(t):n.shapes.push(t)}else this.doc.shapes.push(t)},e.prototype.parseBoard=function(){var t=this.data;if(1===this.line())for(var e=0,r=null;;){var n=t.get("KIND"+e);if(g.a.nullOrEmpty(n))break;var i=G(n);if(0==i||1==i){var o=W(t.get("VX"+e),t.get("VY"+e));if(null==r||this.boardOutline.push(new E.a(r,o)),r=o,1==i){var s=W(t.get("CX"+e),t.get("CY"+e)),u=z(t.get("SA"+e)),l=z(t.get("EA"+e)),h=z(t.get("R"+e)),c=_.a.build2(s,u,l,h,h,N.a.CCW);c.start().distance2(o)>c.svgEnd.distance2(o)&&(c=c.exchangeSweep()),this.boardOutline.push(c),r=null}}else this.logger.warning3("unkonwn kind %d",i);e++}else{var f=this.layerInfos.layers();for(e=1;e<=f.length;e++){var p=a.a.format("LAYER%dNEXT",e),d=G(t.getOrDefault(p,"0"));if(d>0){var y=f[e-1],b=f[d-1];y.next=b}}}},e.prototype.parseComponent=function(){var t=this.data,e=new k.b;e.layer=this.layer(t.get("LAYER")),e.location=W(t.getOrDefault("X","0"),t.getOrDefault("Y","0")),e.orientation=z(t.getOrDefault("ROTATION","0")),e.pattern=t.getOrDefault("PATTERN",""),e.showDesignator="TRUE"===t.get("NAMEON"),e.showComment="TRUE"===t.get("COMMENTON"),e.designator=new O.a("U?",x.c.DOCUMENT,e.location,e.orientation,e.pattern,new A.a("",1,.1),!1),e.comment=e.designator,this.compIndex.put(g.a.notEmpty(t.get("ID")),e),this.logger.info3("detected PCB component %s",e.pattern)},e.prototype.parseEllipseArc=function(){var t=this.data,e=this.net(t.get("NET")),r=Math.max(z(t.get("WIDTH")),.5),n=W(t.get("LOCATION.X"),t.get("LOCATION.Y")),i=z(t.getOrDefault("STARTANGLE","0")),o=z(t.getOrDefault("ENDANGLE","0")),a=Math.max(z(t.get("RADIUS")),.01),s=Math.max(z(t.getOrDefault("SECONDARYRADIUS",g.a.notEmpty(t.get("RADIUS")))),.01),u="TRUE"===t.getOrDefault("KEEPOUT","FALSE"),l=this.layer(t.get("LAYER"));(u||l.type===x.a.OUTLINE)&&(l=x.c.DOCUMENT);var h=_.a.build2(n,i,o,a,s,N.a.CCW);this.put2doc(new T.a(e,l,h,r,u))},e.prototype.parseOutShape=function(t){switch(t=g.a.notEmpty(t)){case"ROUND":return S.d.ROUND;case"RECTANGLE":return S.d.RECTANGLE;case"OCTAGONAL":return S.d.OCTAGONAL;case"ROUNDEDRECTANGLE":return S.d.ROUND_RECTANGLE;default:return this.logger.warning3("unknow shape %s",t),S.d.ROUND}},e.prototype.parsePadOut=function(t,e,r,n,i){var o=this.data,a=this.parseOutShape(o.getOrDefault(t+"SHAPE",r)),s=Math.max(z(o.getOrDefault(t+"XSIZE",n)),.5),u=Math.max(z(o.getOrDefault(t+"YSIZE",i)),.5),l=z(o.getOrDefault(e+"CRPCT","50"));return new S.c(a,s,u,l,null)},e.prototype.parsePad=function(){var t,e,r=this.data,n=this.net(r.get("NET")),i=this.layer(r.get("LAYER")),o=z(r.get("ROTATION")),a=r.getOrDefault("NAME",""),s=Math.max(z(r.get("HOLESIZE")),0),u="TRUE"===r.getOrDefault("PLATED","FALSE"),l=G(r.getOrDefault("HOLETYPE","0"));switch(l){case 0:t=S.b.ROUND;break;case 1:t=S.b.SQUARE;break;case 2:t=S.b.SLOT;break;default:this.logger.warning3("unknow hole type %d",l),t=S.b.ROUND}e=t!==S.b.SLOT?s:z(r.getOrDefault("HOLEWIDTH","0")),e=Math.max(e,0);var h=z(r.getOrDefault("HOLEROTATION","0")),c=z(r.getOrDefault("PADXOFFSET0","0")),f=z(r.getOrDefault("PADYOFFSET0","0")),p=W(r.get("X"),r.get("Y")),d=r.getOrDefault("SHAPE",""),y=r.getOrDefault("XSIZE",""),b=r.getOrDefault("YSIZE",""),v=this.parsePadOut("TOP","TOPLAYER",d,y,b),m=this.parsePadOut("MID","MIDLAYER1",d,y,b),w=this.parsePadOut("BOT","BOTTOMLAYER",d,y,b);i.type===x.a.MULTI||(i.type===x.a.TOP_COPPER?(w=null,m=null):i.type===x.a.BOT_COPPER?(v=null,m=null):(v=null,w=null));var g=new S.e(i,c,f,v,m,w),O=new S.a(t,s,e,h),E=new S.f("",n,i,p,o,g,O,4,4,a,u);this.put2doc(E)},e.prototype.parseVia=function(){var t=this.data,e=this.net(t.get("NET")),r=z(t.get("HOLESIZE")),n=W(t.get("X"),t.get("Y")),i=t.get("STARTLAYER"),o=t.get("ENDLAYER"),a=g.a.notEmpty(t.get("DIAMETER")),s=z(t.getOrDefault("TOPLAYERSIZE",a)),u=z(t.getOrDefault("MIDLAYER1SIZE",a)),l=z(t.getOrDefault("BOTTOMLAYERSIZE",a));"TOP"!==i&&(s=Number.NaN),"BOTTOM"!==o&&(l=Number.NaN);var h=new R.a("",e,n,r,s,u,l,!1);this.put2doc(h)},e.prototype.parseTrack=function(){var t=this.data,e=this.net(t.get("NET")),r=Math.max(z(t.get("WIDTH")),.5),n=W(t.get("X1"),t.get("Y1")),i=W(t.get("X2"),t.get("Y2")),o="TRUE"===t.getOrDefault("KEEPOUT","FALSE"),a=this.layer(t.get("LAYER"));(o||a.type===x.a.OUTLINE)&&(a=x.c.DOCUMENT),this.put2doc(new M.a(e,a,n,i,r,o))},e.prototype.parseText=function(){var t,e,r=this.data,n=this.net(r.get("NET")),i=this.layer(r.get("LAYER")),o=r.getOrDefault("FONTNAME",""),a=r.get("WIDESTRING");if(g.a.nullOrEmpty(a))a=r.getOrDefault("TEXT","");else{var s=new f.a;try{for(var u=Y(a.split(",")),l=u.next();!l.done;l=u.next()){var h=l.value;s.write(parseInt(h))}}catch(e){t={error:e}}finally{try{l&&!l.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}a=s.toString()}var c=Math.max(z(r.getOrDefault("WIDTH","0")),.5),p=Math.max(z(r.getOrDefault("HEIGHT","0")),.5),d=z(r.getOrDefault("ROTATION","0")),y="TRUE"===r.getOrDefault("MIRROR","FALSE"),b=W(r.getOrDefault("X","0"),r.getOrDefault("Y","0")),v="TRUE"===r.getOrDefault("USETTFONTS","FALSE");this.put2doc(new O.a(n,i,b,d,a,new A.a(v?o:"",p,c),y))},e.prototype.polygonVal=function(){for(var t=this.data,e=new Array,r=null,n=0;n<1e4;n++){var i=n.toString(),o=G(t.getOrDefault("KIND"+i,"-1"));if(0===o||1===o){var a=W(t.get("VX"+i),t.get("VY"+i));if(null==r||e.push(new E.a(r,a)),r=a,1==o){var s=W(t.get("CX"+i),t.get("CY"+i)),u=z(t.get("SA"+i)),l=z(t.get("EA"+i)),h=z(t.get("R"+i)),c=_.a.build2(s,u,l,h,h,N.a.CCW);c.start().distance2(a)>c.svgEnd.distance2(a)&&(c=c.exchangeSweep()),e.push(c),r=null}}else{if(3!==o)break;a=new U.a(z(t.get("MVX"+i))/1e4,z(t.get("MVY"+i))/1e4);null==r||e.push(new E.a(r,a)),r=a}}if(e.length>0){var f=e[0],p=e[e.length-1],d=f.start(),y=void 0;y=p instanceof _.a?p.svgEnd:p.end(),e.push(new E.a(y,d))}return e},e.prototype.polygonHoleVal=function(t){for(var e=this.data,r=G(e.getOrDefault("HOLE"+t+"VERTEXCOUNT","0")),n="H"+t,i=new Array,o=null,a=0;a<r;a++){var s=e.getOrDefault(n+"VX"+a,"0"),u=e.getOrDefault(n+"VY"+a,"0"),l=new U.a(1e-4*z(s),1e-4*z(u));null==o||i.push(new E.a(o,l)),o=l}return i},e.prototype.parseRegion=function(){var t=this.data,e=this.net(t.get("NET")),r=this.layer(t.get("LAYER")),n=this.polygonVal();if(0===n.length)this.logger.warning1("ignore Region without outline");else{var i=void 0,o=G(t.get("KIND"));switch(o){case 0:"TRUE"===t.getOrDefault("ISBOARDCUTOUT","FALSE")?(i=I.b.BOARD_CUTOUT,r=new x.c(x.a.MULTI,0)):i=I.b.SOLID;break;case 1:i=I.b.POLYGON_CUTOUT;break;default:i=I.b.SOLID,this.logger.warning3("unknown region kind %d",o)}var a=new Array;a.push(P.a.build2(n));for(var s=0;s<1e3;s++){var u=this.polygonHoleVal(s);if(!(u.length>0))break;a.push(P.a.build2(u))}1===a.length?this.put2doc(new I.a(e,r,i,a[0])):this.put2doc(new B.a("",e,r,a))}},e.prototype.parsePolygon=function(){var t=this.data,e=this.net(t.get("NET")),r=this.layer(t.get("LAYER")),n=this.polygonVal(),i=P.a.build2(n),o=G(t.getOrDefault("POURINDEX","0"));switch(t.getOrDefault("POLYGONTYPE","").trim().toUpperCase()){case"POLYGON":this.put2doc(new C.b("",e,r,new C.c(10),10,10,!1,!0,o,i.primitives,null));break;case"Split Plane":this.put2doc(new L.a(e,r,i));break;default:r.type==x.a.PLANE?this.put2doc(new L.a(e,r,i)):this.put2doc(new C.b("",e,r,new C.c(10),10,10,!1,!0,o,i.primitives,null))}},e.prototype.parseFill=function(){var t=this.data,e=this.net(t.get("NET")),r=this.layer(t.get("LAYER")),n=z(t.get("ROTATION")),i=W(t.get("X1"),t.get("Y1")),o=W(t.get("X2"),t.get("Y2")),a="TRUE"===t.getOrDefault("KEEPOUT","FALSE");this.put2doc(new D.a(e,r,i,o,n,a))},e.prototype.parseNet=function(){var t=this.data;this.nets.put(g.a.notEmpty(t.get("ID")),g.a.notEmpty(t.get("NAME")))},e}(v),j=r(68),H=r(65),V=r(3),K=r(10),Z=r(37),q=r(13),Q=r(42),J=r(81),$=r(62),tt=r(46),et=r(31),rt=r(82),nt=r(85),it=r(79),ot=r(80),at=r(77),st=r(87),ut=r(88),lt=r(23),ht=r(34),ct=r(86),ft=r(78),pt=r(89),dt=r(92),yt=r(52),bt=r(98),vt=r(7),mt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gt=/^(.*?)(\d+)(.*)$/,xt=new A.a("Arial",1,.1);function Ot(t){return parseInt(t)}var Et,_t=function(t){function e(e){var r=t.call(this,e)||this;return r.shapes=new Array,r.props=new Array,r.compIndex=new c.a,r.compList=new c.a,r.modelIndex=new c.a,r.fonts=new c.a,r.defaultFont=null,r.data=new c.a,r.sourceName=e.sourceName,r}return mt(e,t),e.prototype.watcher=function(t){this.data=t;var e=Ot(t.getOrDefault("RECORD","-1"));try{switch(e){case 1:this.parseComponent();break;case 2:this.parsePin();break;case 3:this.logger.warning1("IEEE Symbol is not supported");break;case 4:this.parseAnnotation();break;case 5:this.parseBezier();break;case 6:this.parsePolyline();break;case 7:this.parsePolygon();break;case 8:this.parseEllipse();break;case 9:this.parsePie();break;case 10:this.parseRect();break;case 11:case 12:this.parseEllipticArc();break;case 13:this.parseLine();break;case 14:this.parseRect();break;case 17:this.parsePowerPort();break;case 18:this.parsePort();break;case 22:this.parseNoERC();break;case 25:this.parseNetLabel();break;case 26:this.parseBus();break;case 27:this.parseWire();break;case 28:this.parseTextFrame();break;case 29:this.parseJunction();break;case 31:this.parseConfig();break;case 34:this.parseProperty();break;case 37:this.parseBusEntry();break;case 41:this.parseProperty();break;case 44:this.parseLibraryEnd();break;case 45:this.parseLibraryModel();break;default:-1==e||this.logger.warning3("unrecognized RECORD code %d",e)}}catch(t){this.logger.error2(t)}return!0},e.prototype.finish=function(){var t=this,e=1;this.compList.iterator((function(r,n){try{if(null==n.prefix){var i="U"+e++;n.prefix=new H.a("",i,n.location,n.orientation,!1,!1,xt,d.a.BLACK,V.a.LB),n.abbreviation="U?"}null==n.value&&(n.value=new H.a("",n.name,n.location,n.orientation,!1,!1,xt,d.a.BLACK,V.a.LB));var o=t.modelIndex.get(r);if(void 0!==o){var a={};for(var s in n.shapes.iterator((function(t,e){var r=parseInt(t),i=o[r];return void 0!==i&&(n.footprint===t&&(n.footprint=i),a[i]=e),!0})),n.shapes.clear(),a)n.shapes.put(s,a[s])}if(t.isLib){var u=K.a.translate(n.location.x,n.location.y).rotateD(-n.orientation);t.shapes.push(n.build().multiply3(u))}else t.shapes.push(n.build())}catch(e){t.logger.error2(e)}return!0}));var r=this.tunningSchPortByWireOrPin();this.on(new dt.a(this.sourceName,"Altium",w.a.PX100,r,this.props))},e.prototype.fillWireOrPinEps=function(t,e){e instanceof at.a?(t.add(e.points[0]),t.add(e.points[e.points.length-1])):e instanceof q.a&&t.add(e.location)},e.prototype.tunningSchPortByWireOrPin=function(){var t,e,r,n,i=this,o=new yt.a;try{for(var a=wt(this.shapes),s=a.next();!s.done;s=a.next()){(c=s.value)instanceof j.a?c.shapeItor((function(t,e,r){return i.fillWireOrPinEps(o,r),!0})):this.fillWireOrPinEps(o,c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}var u=new Array;try{for(var l=wt(this.shapes),h=l.next();!h.done;h=l.next()){var c;if((c=h.value)instanceof ht.a){var f=c.location,p=f.add1(c.width,0).multiply3(K.a.rotateD(c.orientation).setOrigin1(f));p=new U.a(Math.round(1e4*p.x)/1e4,Math.round(1e4*p.y)/1e4);var d=o.contains(f),y=o.contains(p),b=!(d||y),v=!0,m=!0;switch(c.ioType){case ht.b.UNSPECIFIED:v=c.startSharp&&!b,m=c.endSharp||b;break;case ht.b.OUTPUT:v=!d&&!b,m=!y||b;break;case ht.b.INPUT:v=d,m=y||b;break;case ht.b.BIDIRECTIONAL:v=!0,m=!0;break;default:Object(bt.a)(c.ioType)}var w=new ht.a(c.name,c.fillColor,c.strokeColor,c.width,v,m,c.location,c.orientation,c.ioType);u.push(w)}else u.push(c)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return u},e.prototype.pointVal=function(t,e){return new U.a(this.doubleVal(t),this.doubleVal(e))},e.prototype.pointsVal=function(t){var e,r,n=new Array,i=null;try{for(var o=wt(t),a=o.next();!a.done;a=o.next()){var s=a.value;null===i?i=s:(n.push(this.pointVal(i,s)),i=null)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n},e.prototype.doubleVal=function(t,e){void 0===e&&(e=0);var r=this.data,n=r.get(t),i=r.get(t+"_FRAC");return g.a.nullOrEmpty(n)&&g.a.nullOrEmpty(i)?e:(g.a.nullOrEmpty(n)&&(n="0"),n.indexOf(".")>=0?parseFloat(n):(g.a.nullOrEmpty(i)&&(i="0"),i.startsWith("-")&&(i=i.substring(1)),parseFloat(n+"."+i)))},e.prototype.fontVal=function(t){return this.fonts.get(t)||g.a.notnull(this.defaultFont)},e.prototype.strokeStyleVal=function(){switch(Ot(this.data.getOrDefault("LINESTYLE","0"))){case 0:return Z.b.SOLID;case 1:return Z.b.DASHED;case 2:return Z.b.DOTTED;default:return this.logger.warning3("unknow linestyle"),Z.b.SOLID}},e.prototype.strokeVal=function(){var t=y(this.data.getOrDefault("COLOR","0")),e=Math.max(.5,this.doubleVal("LINEWIDTH",0)),r=this.strokeStyleVal();return new Z.a(t,e,r)},e.prototype.put2doc=function(t){var e=this.data,r=e.getOrDefault("OWNERINDEX","0"),n=this.compIndex.get(r),i=e.getOrDefault("OWNERPARTID","1"),o=e.getOrDefault("OWNERPARTDISPLAYMODE","0");void 0===n||Ot(i)<0?this.isLib||this.shapes.push(t):n.addShape(o,i,t)},e.prototype.parseLocations=function(){for(var t=Ot(this.data.getOrDefault("LOCATIONCOUNT","0")),e=new Array(t+t),r=1,n=0;r<=t;r++)e[n++]=a.a.format("X%d",r),e[n++]=a.a.format("Y%d",r);return this.pointsVal(e)},e.prototype.parseComponent=function(){var t=this.data,e=new j.b;e.location=this.pointVal("LOCATION.X","LOCATION.Y"),e.orientation=90*Ot(t.getOrDefault("ORIENTATION","0")),e.name=t.getOrDefault("LIBREFERENCE",""),e.name=this.fixedGarbledStr(e.name);t.getOrDefault("COMPONENTDESCRIPTION",""),y(t.getOrDefault("AREACOLOR","0")),y(t.getOrDefault("COLOR","0")),y(t.getOrDefault("PINCOLOR","0")),t.getOrDefault("SHOWHIDDENPINS","F");e.mirrored="T"===t.getOrDefault("ISMIRRORED","F"),e.partId=t.getOrDefault("CURRENTPARTID","0"),e.footprint=t.getOrDefault("DISPLAYMODE","0"),this.logger.info3("detected SCH component %s",e.name),this.compIndex.put(this.index()-2,e)},e.prototype.parseLibraryEnd=function(){var t=this.data.getOrDefault("OWNERINDEX","0"),e=this.compIndex.get(t);void 0!==e?(this.compIndex.put(this.index()-2,e),this.compList.put(this.index()-2,e)):this.logger.warning2("can not find start library")},e.prototype.parseLibraryModel=function(){var t=this.data,e=t.getOrDefault("MODELNAME","");e=this.fixedGarbledStr(e);var r=t.getOrDefault("MODELTYPE","").toUpperCase(),n=t.getOrDefault("ISCURRENT","").toUpperCase();if("PCBLIB"===r){var i=t.getOrDefault("OWNERINDEX","0");this.logger.debug3("pid %s model %s",i,e);var o=this.modelIndex.computeIfAbsent(i,(function(){return[]}));"T"==n?o.unshift(e):o.push(e)}},e.prototype.parsePin=function(){var t,e=this.data,r=Ot(e.getOrDefault("ELECTRICAL","0"));switch(r){case 0:t=q.b.INPUT;break;case 1:t=q.b.IO;break;case 2:t=q.b.OUTPUT;break;case 3:t=q.b.OPEN_COLLECTOR;break;case 4:t=q.b.PASSIVE;break;case 5:t=q.b.HIZ;break;case 6:t=q.b.EMITTER;break;case 7:t=q.b.POWER;break;default:this.logger.warning3("unknow electrical type %d",r),t=q.b.IO}var n=new Array,i=Ot(e.getOrDefault("SYMBOL_INNER","0"));switch(i){case 0:case 3:break;case 8:n.push(q.c.POSTPONED_OUTPUT);break;case 9:n.push(q.c.OPEN_COLLECTOR);break;case 10:n.push(q.c.HIZ);break;case 11:n.push(q.c.HIGH_CURRENT);break;case 12:n.push(q.c.PULSE);break;case 13:n.push(q.c.SCHMITT);break;case 22:n.push(q.c.OPEN_COLLECTOR_PULL_UP);break;case 23:n.push(q.c.OPEN_EMITTER);break;case 24:n.push(q.c.OPEN_EMITTER_PULL_UP);break;case 30:n.push(q.c.SHIFT_LEFT);break;case 32:n.push(q.c.OPEN_OUTPUT);break;default:this.logger.warning3("unknow inside %d",i)}switch(Ot(e.getOrDefault("SYMBOL_INNEREDGE","0"))){case 0:break;case 3:n.push(q.c.CLOCK);break;default:this.logger.warning3("unknow insideEdge %d",i)}var o=Ot(e.getOrDefault("SYMBOL_OUTER","0"));switch(o){case 0:break;case 2:n.push(q.c.RIGHT_LEFT_SIGNAL_FLOW);break;case 5:n.push(q.c.ANALOG_SIGNAL_IN);break;case 6:n.push(q.c.NOT_LOGIC_CONNECTION);break;case 25:n.push(q.c.DIGITAL_SIGNAL_IN);break;case 33:n.push(q.c.LEFT_RIGHT_SIGNAL_FLOW);break;case 34:n.push(q.c.BIDIRECTIONAL_SIGNAL_FLOW);break;default:this.logger.warning3("unknow outside %d",o)}var a=Ot(e.getOrDefault("SYMBOL_OUTEREDGE","0"));switch(a){case 0:break;case 1:n.push(q.c.DOT);break;case 4:n.push(q.c.ACTIVE_LOW_INPUT);break;case 17:n.push(q.c.ACTIVE_LOW_OUTPUT);break;default:this.logger.warning3("unknow outsideEdge %d",a)}var s=y(e.getOrDefault("COLOR","0")),u=g.a.notnull(this.defaultFont),l=e.getOrDefault("DESIGNATOR",""),h=e.getOrDefault("NAME",""),c=Ot(e.getOrDefault("PINCONGLOMERATE","0")),f=90*(3&c),p=(8&c)>0,d=(16&c)>0,b=0==(4&c),v=this.pointVal("LOCATION.X","LOCATION.Y"),m=this.doubleVal("PINLENGTH",0),w=K.a.rotateD(f).setOrigin1(v),x=v.add1(5,0).multiply3(w),O=f%180,E=0==O?x.add1(0,2):x.add1(-2,0),_=v.add1(-8,0).multiply3(w),N=new V.a(f>=180?V.b.LEFT:V.b.RIGHT,V.c.CENTER),A=new V.a(f>=180?V.b.RIGHT:V.b.LEFT,V.c.BOTTOM),T=new Q.a(_,u,N,V.c.TOP,h,O,s,!1),S=new Q.a(E,u,A,V.c.TOP,l,O,s,!1),R=new q.a(v,f,s,m,b,T,p,S,d,t,n);this.put2doc(R)},e.prototype.parseAnnotation=function(){var t,e,r=this.data,n=y(r.getOrDefault("COLOR","0")),i=this.fontVal(Ot(r.getOrDefault("FONTID","0"))),o=this.pointVal("LOCATION.X","LOCATION.Y"),a="T"===r.getOrDefault("ISMIRRORED","F"),s=90*Ot(r.getOrDefault("ORIENTATION","0")),u=r.getOrDefault("TEXT",""),l=Ot(r.getOrDefault("JUSTIFICATION","0"));switch(l%3){case 0:t=V.b.LEFT;break;case 1:t=V.b.CENTER;break;case 2:t=V.b.RIGHT;break;default:this.logger.warning3("unknow justification value %d",l),t=V.b.LEFT}switch(l/3){case 0:e=V.c.BOTTOM;break;case 1:e=V.c.CENTER;break;case 2:e=V.c.TOP;break;default:this.logger.warning3("unknow justification value %d",l),e=V.c.BOTTOM}var h=new Q.a(o,i,new V.a(t,e),V.c.TOP,u,s,n,a);this.put2doc(h)},e.prototype.parseBezier=function(){var t=this.parseLocations(),e=this.strokeVal();4==t.length?this.put2doc(new J.a(new $.a(t),new tt.a(e,null))):this.logger.warning3("locations not enough of bezier")},e.prototype.parseLine=function(){var t=this.pointsVal(["LOCATION.X","LOCATION.Y","CORNER.X","CORNER.Y"]);if(!(t.length<2)){var e=this.strokeVal();this.put2doc(new et.a(P.a.build4(t),new tt.a(e,null)))}},e.prototype.parsePolyline=function(){var t=this.parseLocations();if(!(t.length<2)){var e=this.strokeVal();this.put2doc(new et.a(P.a.build4(t),new tt.a(e,null)))}},e.prototype.parsePolygon=function(){var t=this.data,e=this.parseLocations();if(!(e.length<2)){var r=this.strokeVal(),n="T"===t.getOrDefault("ISSOLID","F")?y(t.getOrDefault("AREACOLOR","0")):null;this.put2doc(new et.a(P.a.build4(e),new tt.a(r,n)))}},e.prototype.parseEllipse=function(){var t=this.data,e=this.pointVal("LOCATION.X","LOCATION.Y"),r=Math.abs(this.doubleVal("RADIUS",0)),n=Math.abs(this.doubleVal("SECONDARYRADIUS",0)),i="T"===t.getOrDefault("ISSOLID","F")?y(t.getOrDefault("AREACOLOR","0")):null,o="T"===t.getOrDefault("TRANSPARENT","F")?.5:1;this.put2doc(new rt.a(e,r,n,new tt.a(this.strokeVal(),i,o)))},e.prototype.parsePie=function(){var t=this.data,e=this.pointVal("LOCATION.X","LOCATION.Y"),r=this.doubleVal("RADIUS",0),n=this.doubleVal("STARTANGLE",0),i=this.doubleVal("ENDANGLE",0);r<0&&(r=-r,n+=180,i+=180);var o="T"===t.getOrDefault("ISSOLID","F")?y(t.getOrDefault("AREACOLOR","0")):null,a=_.a.build2(e,n,i,r,r,N.a.CCW);this.put2doc(new nt.a(a,new tt.a(this.strokeVal(),o)))},e.prototype.parseRect=function(){var t=this.data,e="T"===t.getOrDefault("ISSOLID","F")?y(t.getOrDefault("AREACOLOR","0")):null,r=this.pointVal("LOCATION.X","LOCATION.Y"),n=this.pointVal("CORNER.X","CORNER.Y"),i=this.doubleVal("CORNERXRADIUS",0),o=this.doubleVal("CORNERYRADIUS",0),a="T"===t.getOrDefault("TRANSPARENT","F")?.5:1;this.put2doc(new it.a(r,n,i,o,new tt.a(this.strokeVal(),e,a)))},e.prototype.parseEllipticArc=function(){var t=this.pointVal("LOCATION.X","LOCATION.Y"),e=this.doubleVal("STARTANGLE",0),r=this.doubleVal("ENDANGLE",0),n=Math.abs(this.doubleVal("RADIUS",0)),i=Math.abs(this.doubleVal("SECONDARYRADIUS",n));if(n>0&&i>0){var o=_.a.build2(t,e,r,n,i,N.a.CCW);this.put2doc(new ot.a(o,new tt.a(this.strokeVal(),null)))}},e.prototype.parseWire=function(){this.put2doc(new at.a(this.parseLocations(),this.strokeVal()))},e.prototype.parseTextFrame=function(){var t=this,e=this.data,r=y(e.getOrDefault("TEXTCOLOR","0")),n=this.fontVal(Ot(e.getOrDefault("FONTID","0"))),i=this.pointVal("LOCATION.X","LOCATION.Y"),o=this.pointVal("CORNER.X","CORNER.Y"),a=(new vt.b).ext2(i).ext2(o).build(),s=e.getOrDefault("TEXT","").replace(/~~|~\d/g,(function(e){return"~~"===e?"~":"~1"===e?"\n":(t.logger.warning3("unknown Text Frame mode %s",e),e)})),u=new V.a(V.b.LEFT,V.c.TOP),l=new Q.a(a.UL(),n,u,V.c.TOP,s,0,r,!0);this.put2doc(l)},e.prototype.parseBus=function(){this.put2doc(new st.a(this.parseLocations(),this.strokeVal()))},e.prototype.parseBusEntry=function(){var t=this.pointVal("LOCATION.X","LOCATION.Y"),e=this.pointVal("CORNER.X","CORNER.Y");this.put2doc(new ut.a(t,e,this.strokeVal()))},e.prototype.parsePowerPort=function(){var t,e,r,n,i=this.data,o=i.getOrDefault("TEXT",""),a="T"===i.getOrDefault("SHOWNETNAME","F"),s=this.pointVal("LOCATION.X","LOCATION.Y"),u=90*Ot(i.getOrDefault("ORIENTATION","0")),l=y(i.getOrDefault("COLOR","0")),h=g.a.notnull(this.defaultFont),c=Ot(i.getOrDefault("STYLE","0"));switch(c){case 0:t=lt.b.CIRCLE,e=10;break;case 1:t=lt.b.ARROW,e=10;break;case 2:t=lt.b.BAR,e=10;break;case 3:t=lt.b.WAVE,e=10;break;case 4:t=lt.b.POWER_GROUND,e=20;break;case 5:t=lt.b.SIGNAL_GROUND,e=20;break;case 6:t=lt.b.EARTH,e=20;break;default:this.logger.warning3("unknow Power Port style %d",c),t=lt.b.BAR,e=10}switch(u){case 0:r=s.add1(e,-h.size/2),n=V.b.LEFT;break;case 90:r=s.add1(0,e),n=V.b.CENTER;break;case 180:r=s.add1(-e,-h.size/2),n=V.b.RIGHT;break;case 270:r=s.add1(0,-e-h.size),n=V.b.CENTER;break;default:this.logger.warning3("unsupported PowerPort orientation %f",u),r=s.add1(0,-e-h.size),n=V.b.CENTER}var f=new V.a(n,V.c.BOTTOM),p=new Q.a(r,h,f,V.c.TOP,o,0,l,!1),d=new lt.a(p,t,a,s,l,u);this.put2doc(d)},e.prototype.parsePort=function(){var t,e=this.data,r=e.getOrDefault("NAME",""),n=y(e.getOrDefault("COLOR","0")),i=y(e.getOrDefault("AREACOLOR","0")),o=y(e.getOrDefault("TEXTCOLOR","0")),a=this.doubleVal("WIDTH",0),s=Ot(e.getOrDefault("IOTYPE","0"));switch(s){case 0:t=ht.b.UNSPECIFIED;break;case 1:t=ht.b.OUTPUT;break;case 2:t=ht.b.INPUT;break;case 3:t=ht.b.BIDIRECTIONAL;break;default:t=ht.b.UNSPECIFIED,this.logger.warning3("unknow IOType %d of Port",s)}var u,l,h,c=this.pointVal("LOCATION.X","LOCATION.Y"),f=Ot(e.getOrDefault("STYLE","0"));switch(f){case 0:h=0,u=!1,l=!1;break;case 1:h=0,u=!0,l=!1;break;case 2:h=0,u=!1,l=!0;break;case 3:h=0,u=!0,l=!0;break;case 4:c=c.add1(0,a),h=270,u=!1,l=!1;break;case 5:c=c.add1(0,a),h=270,u=!0,l=!1;break;case 6:c=c.add1(0,a),h=270,u=!1,l=!0;break;case 7:c=c.add1(0,a),h=270,u=!0,l=!0;break;default:h=0,u=!1,l=!1,this.logger.warning3("unknow style %d of Port",f)}var p,d,b=g.a.notnull(this.defaultFont),v=-b.size/2,m=Ot(e.getOrDefault("ALIGNMENT","0")),w=K.a.rotateD(h).setOrigin1(c);switch(m){case 0:d=V.b.CENTER,p=c.add1(a/2,v).multiply3(w);break;case 1:d=V.b.LEFT,p=c.add1(5,v).multiply3(w);break;case 2:d=V.b.RIGHT,p=c.add1(a-5,v).multiply3(w);break;default:d=V.b.LEFT,p=c.add1(5,v).multiply3(w),this.logger.warning3("unknow aligment %d of Port",m)}var x=new V.a(d,V.c.BOTTOM),O=new Q.a(p,b,x,V.c.TOP,r,h,o,!1),E=new ht.a(O,i,n,a,u,l,c,h,t);this.put2doc(E)},e.prototype.parseNetLabel=function(){var t=this.data,e=this.pointVal("LOCATION.X","LOCATION.Y"),r=y(t.getOrDefault("COLOR","0")),n=90*Ot(t.getOrDefault("ORIENTATION","0")),i=this.fontVal(Ot(t.getOrDefault("FONTID","0"))),o=t.getOrDefault("TEXT","");this.put2doc(new ct.a(e,n,o,i,r))},e.prototype.parseJunction=function(){var t,e=this.data,r=this.pointVal("LOCATION.X","LOCATION.Y"),n=y(e.getOrDefault("COLOR","0")),i=Ot(e.getOrDefault("SIZE","0"));switch(i){case 0:t=2;break;case 1:t=3;break;case 2:t=5;break;case 3:t=10;break;default:this.logger.warning3("unsupported junction size %d",i),t=2}this.put2doc(new ft.a(r,t,n))},e.prototype.parseNoERC=function(){var t=this.pointVal("LOCATION.X","LOCATION.Y"),e=y(this.data.getOrDefault("COLOR","0"));this.put2doc(new pt.a(t,e))},e.prototype.parseProperty=function(){var t,e,r=this.data,n=this.pointVal("LOCATION.X","LOCATION.Y"),i=y(r.getOrDefault("COLOR","0")),o=this.fontVal(Ot(r.getOrDefault("FONTID","0"))),a=r.getOrDefault("NAME",""),s=r.getOrDefault("TEXT",""),u="T"===r.getOrDefault("SHOWNAME","F"),l="F"===r.getOrDefault("ISHIDDEN","F"),h=90*Ot(r.getOrDefault("ORIENTATION","0")),c=Ot(r.getOrDefault("JUSTIFICATION","0"));switch(c%3){case 0:t=V.b.LEFT;break;case 1:t=V.b.CENTER;break;case 2:t=V.b.RIGHT;break;default:this.logger.warning3("unknow justification value %d",c),t=V.b.LEFT}switch(c/3){case 0:e=V.c.BOTTOM;break;case 1:e=V.c.CENTER;break;case 2:e=V.c.TOP;break;default:this.logger.warning3("unknow justification value %d",c),e=V.c.BOTTOM}var f=new V.a(t,e),p=new H.a(a,s,n,h,u,l,o,i,f),d=Ot(r.getOrDefault("OWNERINDEX","0")),b=this.compIndex.get(d);if(void 0!==b)if("Designator"===a){b.prefix=p;var v=gt.exec(s);b.abbreviation=null!==v?v[1]+"?"+v[3]:s.indexOf("?")>=0?s:s+"?"}else"Value"===a||"Comment"===a&&null==b.value?b.value=p:b.props.push(p);else this.logger.warning1("parent component not found")},e.prototype.parseConfig=function(){for(var t=this.data,e=Ot(t.getOrDefault("FONTIDCOUNT","0")),r=1;r<=e;r++){var n=t.getOrDefault(a.a.format("FONTNAME%d",r),""),i=Ot(t.getOrDefault(a.a.format("SIZE%d",r),"0"));i-=1,this.defaultFont=new A.a(n,i,5,!1,!1),this.fonts.put(r,this.defaultFont)}this.defaultFont=this.fonts.get(Ot(t.getOrDefault("SYSTEMFONT","1")))||this.defaultFont},e.prototype.fixedGarbledStr=function(t){return t?t.replace(/[^\x00-\x7F]/g,"_"):t},e}(v),Nt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(t){t[t.NORMAL=0]="NORMAL",t[t.PRE_NEWLINE=1]="PRE_NEWLINE",t[t.MAYBE_NEWLINE=2]="MAYBE_NEWLINE"}(Et||(Et={}));var At,Tt=function(t){function e(e,r,n){var i=t.call(this)||this;return i.docs=new Array,i.keyBuf=new f.a,i.valueBuf=new f.a,i.state=Et.NORMAL,i.isKey=!1,i.index=0,i.data=new c.a,i.decoder=null,i.currentComponent="",i.sourceName=e,i.logger=r.wrap(i.format.bind(i)),i.isLib=n,i}return Nt(e,t),e.prototype.finish=function(){null!==this.decoder&&this.decoder.finish()},e.prototype.feed=function(t){switch(this.state){case Et.NORMAL:switch(t){case h.a.EQUAL:this.isKey?this.isKey=!1:this.applyKVBuf(t);break;case h.a.CR:this.state=Et.MAYBE_NEWLINE;break;case h.a.LF:this.state=Et.PRE_NEWLINE;break;case h.a.VECLINE:this.setRecord();break;case 142:this.applyKVBuf(h.a.VECLINE);break;case 0:this.setRecord(),this.parseRecord();break;default:this.applyKVBuf(t)}break;case Et.MAYBE_NEWLINE:t===h.a.LF?this.state=Et.PRE_NEWLINE:0===t?(this.setRecord(),this.parseRecord()):(this.state=Et.PRE_NEWLINE,this.feed(t));break;case Et.PRE_NEWLINE:t==h.a.VECLINE||"TEXT"!==this.keyBuf.toString()||0===t?(this.setRecord(),this.parseRecord(),t!==h.a.VECLINE&&this.applyKVBuf(t)):this.applyKVBuf(t),this.state=Et.NORMAL;break;default:throw new Error("bug")}return!0},e.prototype.on=function(t){return this.docs.push(t),!0},e.prototype.getDocs=function(){return this.docs},e.prototype.setRecord=function(){if(this.isKey=!0,this.keyBuf.size()>0){var t=this.keyBuf.toString().toUpperCase();this.keyBuf.clear();var e=this.valueBuf.toString();this.valueBuf.clear(),t.startsWith("%UTF8%")?(this.data.put(t,e),this.data.put(t.substring(6),e)):this.data.contains("%UTF8%"+t)||this.data.put(t,e)}else this.valueBuf.clear()},e.prototype.applyKVBuf=function(t){this.isKey?this.keyBuf.write(t):this.valueBuf.write(t)},e.prototype.parseRecord=function(){if(this.logger.include(o.a.DEBUG)&&this.logger.debug1(p.c.auto(this.data).toJson(4)),this.index++,!this.data.isEmpty()){if(null===this.decoder){if(this.data.contains("HEADER"))this.decoder=new _t(this);else{if(!this.data.contains("RECORD"))throw new Error("unsupported file format");this.decoder=new X(this)}g.a.notnull(this.decoder).feed(this.data,this.line(),this.index)}else{var t=this.decoder;this.data.contains("RECORD")?(this.currentComponent=t instanceof X?this.data.getOrDefault("COMPONENT",""):this.data.getOrDefault("OWNERINDEX",""),t.feed(this.data,this.line(),this.index),this.currentComponent=""):this.logger.warning1("RECORD not found")}this.data=new c.a}},e.prototype.format=function(t,e){return g.a.nullOrEmpty(this.currentComponent)?a.a.format("(line %d)(index %d) %s",this.line(),this.index,e):a.a.format("(line %d)(index %d)(lib %s) %s",this.line(),this.index,this.currentComponent,e)},e}(l.a),St=r(112),Rt=r(6),It=/\r\n|\r|\n/g,Pt=new w.b(w.a.MIL,w.a.PX100),Ct=new w.b(w.a.PX100,w.a.PT),Lt=a.a.fmtNumber,Dt=function(){function t(){this.sb=new St.a,this.separator="",this.isFirst=!1}return t.prototype.setSep=function(t,e){this.separator=t,this.isFirst=e},t.prototype.sep=function(){return this.isFirst?(this.isFirst=!1,""):this.separator},t}(),Mt=function(){function t(t){this.outputBuffer=new Array,this.isLib=!1,this.logger=t}return t.prototype.obStart=function(){this.outputBuffer.push(new Dt)},t.prototype.obGetClean=function(){var t=g.a.notnull(this.outputBuffer.pop()).sb.toString();return this.logger.debug1(t),t},t.prototype.obWrite=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];0===e.length?this.curBuffer().sb.write(t):this.curBuffer().sb.write(a.a.format1(t,e))},t.prototype.setSeparator=function(t,e){this.curBuffer().setSep(t,e)},t.prototype.obSeparator=function(){this.obWrite(this.curBuffer().sep())},t.prototype.obPoint2D=function(t){this.obSeparator(),this.obWrite(Lt(t.x)),this.obSeparator(),this.obWrite(Lt(-t.y))},t.prototype.obNumber=function(t){this.obSeparator(),this.obWrite(Lt(t))},t.prototype.obColor=function(t){this.obSeparator(),null!==t&&this.obWrite(t.toString())},t.prototype.obBoolean=function(t){this.obSeparator(),this.obWrite(t?"1":"0")},t.prototype.obAny=function(t,e,r){if(void 0===e&&(e=!0),void 0===r&&(r=!0),this.obSeparator(),null!=t){var n=t.toString();r&&(n=n.replace(/~/g,"")),e&&(n=Rt.a.xmlDecode(n)),n=this.fixedGarbledText(n),this.obWrite(n)}},t.prototype.regularPrefix=function(t){return t.indexOf("?")>=0?t:t+"?"},t.prototype.curBuffer=function(){var t=this.outputBuffer;return g.a.notnull(t[t.length-1])},t.prototype.fixedGarbledText=function(t,e){return t?t.replace(/\ufffd/g,e||"_"):""},t}(),kt=r(96),Ut=r(99),Bt=r(12),Ft=r(22);!function(t){t[t.SCH=1]="SCH",t[t.SCH_LIB=2]="SCH_LIB",t[t.SCH_GRP=5]="SCH_GRP",t[t.SCH_LIB_SUBPART=6]="SCH_LIB_SUBPART",t[t.PCB=3]="PCB",t[t.PCB_LIB=4]="PCB_LIB"}(At||(At={}));var Yt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zt=new U.a(400,-300),Wt=function(t){function e(e,r){var n=t.call(this,r)||this;return n.isInComponent=!1,n.doc=e,n.lh=new kt.a(r,e.layerStack),n}return Yt(e,t),e.prototype.export=function(t){var e,r;void 0===t&&(t=Rt.a.uuid());var n=this.doc;this.isLib=!1;var i=K.a.scale(n.scale*Pt.ratio),o=new Array,a=new vt.b;try{for(var s=Gt(n.shapes),u=s.next();!u.done;u=s.next()){var l=u.value;l=l.multiply3(i),a.ext1(l.bbox()),Rt.a.addAll(o,this.dispatcher(l))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}var h={};this.obStart();var c={docType:At.PCB};if(g.a.nullOrEmpty(n.contributor)||(c.importedFrom=n.contributor),h.head=c,this.setSeparator("~",!0),this.obAny("CA"),this.obNumber(1e3),this.obNumber(1e3),this.obAny("#000000"),this.obAny("yes"),this.obAny("#FFFFFF"),this.obNumber(10),this.obNumber(1e3),this.obNumber(1e3),this.obAny("line"),this.obNumber(1),this.obAny("mil"),this.obNumber(1),this.obNumber(45),this.obAny("visible"),this.obNumber(.5),this.obNumber(0),this.obNumber(0),h.canvas=this.obGetClean(),h.systemColor="#000000~#FFFFFF~#FFFFFF~#222222~#FFFFFF",h.shape=o,h.layers=this.gnrLayers(),a.valid())h.BBox={x:300,y:400,width:1e3,height:1e3};else{var f=a.build();h.BBox={x:f.minX,y:-f.maxY,width:f.width(),height:f.height()}}return h.DRCRULE={trackWidth:.6,track2Track:.6,pad2Pad:.6,track2Pad:.6,hole2Hole:1,holeSize:1.2,isRealtime:!0},{uuid:t,docType:At.PCB,title:n.sourceName,dataStr:h}},e.prototype.exportLib=function(t,e){var r,n;void 0===e&&(e=Rt.a.uuid()),this.isLib=!0;var i=new Array,o=t.layer.type==x.a.BOT_COPPER,a=new K.a;a=(a=(a=a.translate(-t.location.x,-t.location.y)).rotateD(-t.orientation)).scale(this.doc.scale*Pt.ratio),o&&(a=a.multiply3(K.a.MIRROR_Y)),a=a.translate(zt.x,zt.y);var s=new vt.b;try{for(var u=Gt(t.shapes),l=u.next();!l.done;l=u.next()){var h=l.value;o&&(h=g.a.notnull(this.mirrorShape(h))),h=h.multiply3(a),s.ext1(h.bbox()),Rt.a.addAll(i,this.dispatcher(h))}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}var c=s.build(),f={};this.obStart();var p={package:this.fixedGarbledText(t.pattern.toUpperCase()),pre:this.fixedGarbledText(this.regularPrefix(t.designator.text))},d={docType:At.PCB_LIB,x:zt.x,y:-zt.y,c_para:p};return g.a.nullOrEmpty(this.doc.contributor)||(d.importedFrom=this.doc.contributor),f.head=d,this.setSeparator("~",!0),this.obAny("CA"),this.obNumber(1e3),this.obNumber(1e3),this.obAny("#000000"),this.obAny("yes"),this.obAny("#FFFFFF"),this.obNumber(1),this.obNumber(c.width()),this.obNumber(c.height()),this.obAny("line"),this.obNumber(1),this.obAny("mil"),this.obNumber(1),this.obNumber(45),this.obAny("visible"),this.obNumber(.1),this.obPoint2D(zt),f.canvas=this.obGetClean(),f.systemColor="#000000~#FFFFFF~#FFFFFF~#222222~#FFFFFF",f.shape=i,f.layers=this.gnrLayers(),f.BBox={x:c.minX,y:-c.maxY,width:c.width(),height:c.height()},{uuid:e,title:this.fixedGarbledText(t.pattern),docType:At.PCB_LIB,dataStr:f}},e.prototype.gnrLayers=function(){var t=this,e=new Array;return Object(Ft.b)(this.lh,(function(r,n){return t.obStart(),t.setSeparator("~",!0),t.obAny(n.id),t.obAny(n.name),t.obColor(n.color),t.obAny(n.visible?"true":"false"),t.obAny(n.active?"true":"false"),t.obAny(n.config?"true":"false"),t.obAny(""),n.layer.type!=x.a.INNER&&n.layer.type!=x.a.PLANE||t.obAny(n.isSignal?"Signal":"Plane"),e.push(t.obGetClean()),!0})),e},e.prototype.net=function(t){return this.isLib?"":t.toUpperCase()},e.prototype.obLayer=function(t){this.obSeparator(),this.obWrite("%d",this.lh.info2(t).id)},e.prototype.obPourMethod=function(t){t instanceof C.c?this.obAny("solid"):t instanceof C.a?this.obAny("grid"):this.obAny("none")},e.prototype.ensureLayerVisible=function(t){var e=this.lh.info2(t);e.visible=!0,e.config=!0},e.prototype.checkMultiLayer=function(t,e){return t.type===x.a.MULTI?(this.logger.warning3("Multi layer of %s is not supported, Document instead",e),x.c.DOCUMENT):t},e.prototype.mirrorLayer=function(t){switch(t.type){case x.a.TOP_COPPER:return x.c.BOT_COPPER;case x.a.TOP_PASTE:return x.c.BOT_PASTE;case x.a.TOP_SILK:return x.c.BOT_SILK;case x.a.TOP_SOLDER_MASK:return x.c.BOT_SOLDER_MASK;case x.a.BOT_COPPER:return x.c.TOP_COPPER;case x.a.BOT_PASTE:return x.c.TOP_PASTE;case x.a.BOT_SILK:return x.c.TOP_SILK;case x.a.BOT_SOLDER_MASK:return x.c.TOP_SOLDER_MASK;default:return t}},e.prototype.mirrorShape=function(t){var e=this.mirrorLayer(t.layer);if(t instanceof T.a)return new T.a(t.net,e,t.arc,t.width,t.keepout);if(t instanceof O.a)return new O.a(t.net,e,t.location,t.rotation,t.text,t.font,t.mirror);if(t instanceof S.f){var r=new S.e(e,t.shapes.offsetX,t.shapes.offsetY,t.shapes.bot,t.shapes.inner,t.shapes.top);return new S.f(t.id,t.net,e,t.location,t.rotation,r,t.hole,t.pasteMaskEx,t.solderMaskEx,t.designator,t.plated)}return t instanceof D.a?new D.a(t.net,e,t.location1,t.location2,t.rotation,t.keepout):t instanceof I.a?new I.a(t.net,e,t.kind,t.outlines):t instanceof M.a?new M.a(t.net,e,t.start,t.end,t.width,t.keepout):t instanceof R.a?new R.a(t.id,t.net,t.center,t.holeDiameter,t.botPad,t.innerPad,t.topPad,t.mask):t instanceof C.b?new C.b(t.id,t.net,e,t.method,t.outlineClearance,t.clearance,t.thermal,t.keepIsland,t.pourIndex,t.outlines,t.coppered):t instanceof L.a?new L.a(t.net,e,t.outline):(this.logger.warning3("unsupported shape %s",t),null)},e.prototype.dispatcher=function(t){return t instanceof T.a?this.gnrArc(t):t instanceof O.a?this.gnrString(t,"L",!0):t instanceof S.f?this.gnrPad(t):t instanceof D.a?this.gnrFill(t):t instanceof I.a?this.gnrRegion(t):t instanceof M.a?this.gnrTrack(t):t instanceof R.a?this.gnrVia(t):t instanceof k.a?this.gnrComponent(t):t instanceof C.b?this.gnrPolygonPour(t):t instanceof L.a?this.gnrPlaneZone(t):t instanceof B.a?this.gnrPcbImage(t):(this.logger.warning3("unsupported shape %s",t),[])},e.prototype.gnrPcbImage=function(t){var e,r,n,i,o=new Ut.a;try{try{for(var a=Gt(t.plg),s=a.next();!s.done;s=a.next()){var u=s.value;try{for(var l=(n=void 0,Gt(u.primitives)),h=l.next();!h.done;h=l.next()){var c=h.value;c instanceof E.a?o.encLine1(c):c instanceof _.a&&o.encArc(c)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}o.close(!0)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}}catch(t){this.logger.warning2(t)}var f={nodeName:"path",nodeType:1,layerid:this.lh.info2(t.layer).id,attrs:{d:o.toString(),stroke:"none",layerid:this.lh.info2(t.layer).id.toString()}};return this.obStart(),this.setSeparator("~",!0),this.obAny("SVGNODE"),this.obAny(JSON.stringify(f)),[this.obGetClean()]},e.prototype.gnrPlaneZone=function(t){var e,r,n,i;this.obStart(),this.setSeparator("~",!0),this.obAny("PLANEZONE"),this.obLayer(t.layer),this.obAny(t.net),this.obAny("solid"),this.obAny(""),this.obWrite("#@$"),this.setSeparator("~",!0),this.obAny("");var o=new Ut.a;try{var a=null;try{for(var s=Gt(t.outline.primitives),u=s.next();!u.done;u=s.next()){var l=u.value;try{for(var h=(n=void 0,Gt(l.points(.1))),c=h.next();!c.done;c=h.next()){var f=c.value;f=new U.a(f.x,-f.y),null!==a&&o.encLine2(a,f),a=f}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}o.close(!0)}catch(t){this.logger.warning2(t)}return[this.obGetClean()]},e.prototype.gnrArc=function(t){var e=this.checkMultiLayer(t.layer,"Arc");t.keepout&&this.logger.warning1("Arc is not support keepout"),this.obStart();var r,n=t.arc,i=n.isLarge()?1:0;switch(n.sweep()){case N.a.CCW:r=0;break;case N.a.CW:r=1;break;default:throw new Error("unsupported operation")}return this.setSeparator("~",!0),this.obAny("ARC"),e.type===x.a.OUTLINE?this.obNumber(1):this.obNumber(t.width),this.obLayer(e),this.obAny(this.net(t.net)),this.obWrite("~"),this.setSeparator(" ",!0),this.obAny("M"),this.obPoint2D(n.start()),this.obAny("A"),this.obNumber(n.rx),this.obNumber(n.ry),this.obNumber(0),this.obNumber(i),this.obNumber(r),this.obPoint2D(n.svgEnd),this.setSeparator("~",!1),this.obAny(""),this.obAny(""),this.ensureLayerVisible(e),[this.obGetClean()]},e.prototype.gnrString=function(t,e,r){var n,i,o=this.checkMultiLayer(t.layer,"String");x.c.isBot(t.layer.type)?t.mirror?(i=t.rotation,n=t.location.add1(0,-t.font.size/2).multiply3(K.a.rotateD(t.rotation+180).setOrigin1(t.location))):(this.logger.warning1("Text witout mirror in bottom layer will invert"),i=t.rotation+180,n=t.location.add1(0,t.font.size/2).multiply3(K.a.rotateD(t.rotation).setOrigin1(t.location))):t.mirror?(this.logger.warning1("Text with mirror not in bottom layer will not invert"),i=t.rotation+180,n=t.location.add1(0,-t.font.size/2).multiply3(K.a.rotateD(i).setOrigin1(t.location))):(i=t.rotation,n=t.location.add1(0,t.font.size/2).multiply3(K.a.rotateD(i).setOrigin1(t.location))),this.obStart(),this.setSeparator("~",!0),this.obAny("TEXT");var a=t.text.replace(It,"\\\\n");return this.obAny(e),this.obPoint2D(n),this.obNumber(t.font.weight),this.obNumber(i),this.obBoolean(!1),r||"L"!==e?this.obLayer(o):this.obLayer(x.c.DOCUMENT),this.obAny(t.net),this.obNumber(t.font.size),this.obAny(a,!1,!0),this.obAny(""),r||"L"===e?this.obAny(""):this.obAny("none"),this.obAny(""),this.obAny(""),this.ensureLayerVisible(o),[this.obGetClean()]},e.prototype.mustTransform2Polygon=function(t,e){if(0!==t.shapes.offsetX||0!==t.shapes.offsetY)return!0;if(t.layer.type===x.a.MULTI){var r=Bt.a.regularD(t.hole.rotation)%180;return e.xSize<e.ySize?90!==r:0!==r}return!1},e.prototype.gnrPad=function(t){var e,r,n,i,o,a,s,u,l;switch(t.layer.type===x.a.MULTI&&t.hole.type===S.b.SQUARE&&this.logger.warning1("Square Hole is not supported, use Round instead"),t.layer.type){case x.a.MULTI:s=x.c.MULTI,u=g.a.notnull(t.shapes.top);try{for(var h=Gt([t.shapes.top,t.shapes.bot]),c=h.next();!c.done;c=h.next()){var f=c.value;null!==f&&u.xSize*u.ySize<f.xSize*f.ySize&&(u=f)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}break;case x.a.TOP_COPPER:s=x.c.TOP_COPPER,u=t.shapes.top;break;case x.a.BOT_COPPER:s=x.c.BOT_COPPER,u=t.shapes.bot;break;default:if(x.c.isTop(t.layer.type))this.logger.warning3("PAD layer %s is not supported, use %s instead",Object(x.b)(t.layer.type),Object(x.b)(x.a.TOP_COPPER)),s=x.c.TOP_COPPER,u=t.shapes.inner;else{if(!x.c.isBot(t.layer.type))return this.logger.warning3("PAD layer %s is not supported",Object(x.b)(t.layer.type)),[];this.logger.warning3("PAD layer %s is not supported, use %s instead",Object(x.b)(t.layer.type),Object(x.b)(x.a.BOT_COPPER)),s=x.c.BOT_COPPER,u=t.shapes.inner}}if(u=g.a.notnull(u),this.mustTransform2Polygon(t,u))l="POLYGON";else switch(u.type){case S.d.ROUND:l=u.xSize===u.ySize?"ELLIPSE":"OVAL";break;case S.d.OCTAGONAL:l="POLYGON";break;case S.d.RECTANGLE:l="RECT";break;case S.d.ROUND_RECTANGLE:l="POLYGON";break;default:this.logger.warning3("Pad out shape %s not supported, use Ellipse instead",Object(S.g)(u.type)),l="ELLIPSE"}if(this.obStart(),this.setSeparator("~",!0),g.a.nullOrEmpty(t.net)&&!t.plated&&t.layer===x.c.MULTI&&u.type===S.d.ROUND&&t.hole.type===S.b.ROUND&&u.xSize<=t.hole.size)this.obAny("HOLE"),this.obPoint2D(t.location),this.obNumber(t.hole.size/2),this.obAny("");else{if(this.obAny("PAD"),this.obAny(l),this.obPoint2D(t.location),"POLYGON"===l?(this.obNumber(0),this.obNumber(0)):(this.obNumber(u.xSize),this.obNumber(u.ySize)),this.obLayer(s),this.obAny(this.net(t.net)),this.obAny(t.designator),this.obNumber(t.hole.size/2),this.obSeparator(),this.setSeparator(" ",!0),"POLYGON"===l&&u.xSize>0&&u.ySize>0){var p=K.a.translate(t.shapes.offsetX,t.shapes.offsetY).rotateD(t.rotation),d=new Array,y=.1;switch(u.type){case S.d.ROUND:u.xSize<u.ySize&&(p=K.a.ROT_90.multiply3(p));var b=Math.abs(u.xSize-u.ySize)/2,v=Math.min(u.xSize,u.ySize)/2;d.push(_.a.build3(t.location.add1(-b,0),270,-180,v,v)),d.push(_.a.build3(t.location.add1(b,0),90,-180,v,v));break;case S.d.OCTAGONAL:var m=void 0,w=void 0,O=void 0,N=void 0,A=void 0;if(u.xSize<=u.ySize){m=u.xSize/2,w=22.5,O=-157.5;var T=(u.ySize-u.xSize)/2;N=t.location.add1(0,T),A=t.location.add1(0,-T)}else{m=u.ySize/2,w=112.5,O=-67.5;T=(u.xSize-u.ySize)/2;N=t.location.add1(-T,0),A=t.location.add1(T,0)}d.push(_.a.build3(N,w,135,m,m)),d.push(_.a.build3(A,O,135,m,m)),y=2*Math.PI*m/8;break;case S.d.RECTANGLE:b=u.xSize/2,v=u.ySize/2;d.push(new E.a(t.location.add1(-b,v),t.location.add1(b,v))),d.push(new E.a(t.location.add1(b,-v),t.location.add1(-b,-v)));break;case S.d.ROUND_RECTANGLE:if(u.cornerRadius>0){m=Math.min(u.xSize,u.ySize)/2*u.cornerRadius/100,b=u.xSize/2-m,v=u.ySize/2-m;d.push(_.a.build3(t.location.add1(-b,v),180,-90,m,m)),d.push(_.a.build3(t.location.add1(b,v),90,-90,m,m)),d.push(_.a.build3(t.location.add1(b,-v),0,-90,m,m)),d.push(_.a.build3(t.location.add1(-b,-v),-90,-90,m,m))}else{b=u.xSize/2,v=u.ySize/2;d.push(new E.a(t.location.add1(-b,v),t.location.add1(b,v))),d.push(new E.a(t.location.add1(b,-v),t.location.add1(-b,-v)))}}p=p.setOrigin1(t.location);try{for(var R=Gt(d),I=R.next();!I.done;I=R.next()){var P=I.value;try{for(var C=(o=void 0,Gt(P.multiply3(p).points(y))),L=C.next();!L.done;L=C.next()){var D=L.value;this.obPoint2D(D)}}catch(t){o={error:t}}finally{try{L&&!L.done&&(a=C.return)&&a.call(C)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{I&&!I.done&&(i=R.return)&&i.call(R)}finally{if(n)throw n.error}}}this.setSeparator("~",!1),this.obNumber(Bt.a.regularD("POLYGON"===l?t.rotation+t.hole.rotation:t.rotation)),this.obAny(""),this.obNumber(t.hole.length),this.obAny(""),this.obAny(t.plated?"Y":"N")}return this.ensureLayerVisible(s),[this.obGetClean()]},e.prototype.gnrFill=function(t){var e=(new vt.b).ext2(t.location1).ext2(t.location2).build();if(this.ensureLayerVisible(t.layer),this.isLib||this.isInComponent||t.rotation%360!=0){var r=e.center(),n=K.a.rotateD(t.rotation).setOrigin1(r),i=e.LL().multiply3(n),o=e.LR().multiply3(n),a=e.UR().multiply3(n),s=e.UL().multiply3(n),u=[new E.a(i,o),new E.a(o,a),new E.a(a,s),new E.a(s,i)];return this.gnrRegion(new I.a(this.net(t.net),t.layer,I.b.SOLID,P.a.build2(u)))}return this.obStart(),this.setSeparator("~",!0),this.obAny("RECT"),this.obPoint2D(e.UL()),this.obNumber(e.width()),this.obNumber(e.height()),this.obLayer(t.layer),this.obAny(""),this.obAny(""),this.obAny(""),this.obAny(""),this.obAny(""),this.obAny(t.net),[this.obGetClean()]},e.prototype.gnrRegion=function(t){var e,r,n,i,o,a;switch(t.kind){case I.b.POLYGON_CUTOUT:t.layer.type===x.a.MULTI?(this.logger.warning1("Multi Layer of Region in Polygon Cutout mode is not supported, use Document Layer instead"),a=x.c.DOCUMENT):a=t.layer,o="cutout";break;case I.b.BOARD_CUTOUT:a=t.layer,o="npth";break;default:t.layer.type===x.a.MULTI?(this.logger.warning1("Multi Layer of Region is not supported, use Document Layer instead"),a=x.c.DOCUMENT):a=t.layer,o="solid"}this.obStart(),this.setSeparator("~",!0),this.obAny("SOLIDREGION"),this.obLayer(a),this.obAny(this.net(t.net)),this.obWrite("~"),this.setSeparator(" ",!0);try{for(var s=Gt(t.outlines.primitives),u=s.next();!u.done;u=s.next()){var l=u.value;try{for(var h=(n=void 0,Gt(l.points(1))),c=h.next();!c.done;c=h.next()){var f=c.value;this.obPoint2D(f)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return this.setSeparator("~",!1),this.obAny(o),this.obAny(""),this.obAny(""),this.ensureLayerVisible(a),[this.obGetClean()]},e.prototype.gnrPolygonPour=function(t){var e,r,n,i,o;o=g.a.nullOrEmpty(t.net)?"GND":t.net,this.obStart(),this.setSeparator("~",!0),this.obAny("COPPERAREA"),this.obNumber(2),this.obLayer(t.layer),this.obAny(this.net(o)),this.obWrite("~"),this.setSeparator(" ",!0);try{for(var a=Gt(t.outlines),s=a.next();!s.done;s=a.next()){var u=s.value;try{for(var l=(n=void 0,Gt(u.points(1))),h=l.next();!h.done;h=l.next()){var c=h.value;this.obPoint2D(c)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return this.setSeparator("~",!1),this.obNumber(1),this.obPourMethod(t.method),this.obAny(""),this.obAny(t.thermal?"spoke":"direct"),this.obAny(t.keepIsland?"yes":"none"),this.obAny(""),this.obAny(""),this.obAny(""),this.obNumber(t.pourIndex),t.method instanceof C.a?(this.obNumber(t.method.gridWidth),this.obNumber(t.method.gridClearance)):(this.obAny("1"),this.obAny("1")),this.obNumber(t.outlineClearance),t.method instanceof C.c?this.obAny(t.method.neckThickness>0?"yes":"none"):this.obAny(""),[this.obGetClean()]},e.prototype.gnrTrack=function(t){var e=this.checkMultiLayer(t.layer,"Track");return t.keepout&&this.logger.warning1("Track is not support keepout"),this.obStart(),this.setSeparator("~",!0),this.obAny("TRACK"),e.type===x.a.OUTLINE?this.obNumber(1):this.obNumber(t.width),this.obLayer(e),this.obAny(this.net(t.net)),this.obWrite("~"),this.setSeparator(" ",!0),this.obPoint2D(t.start),this.obPoint2D(t.end),this.setSeparator("~",!1),this.obAny(""),this.ensureLayerVisible(e),[this.obGetClean()]},e.prototype.gnrVia=function(t){var e;return!isNaN(t.topPad)&&isNaN(t.botPad)?e=x.c.TOP_COPPER:!isNaN(t.botPad)&&isNaN(t.topPad)?e=x.c.BOT_COPPER:(isNaN(t.topPad)&&isNaN(t.botPad)&&this.logger.warning1("Buried hole is not supported"),e=x.c.MULTI),this.obStart(),this.setSeparator("~",!0),this.obAny("VIA"),this.obPoint2D(t.center),this.obNumber(t.innerPad),this.obAny(this.net(t.net)),this.obNumber(t.holeDiameter/2),this.obAny(""),this.ensureLayerVisible(e),[this.obGetClean()]},e.prototype.gnrComponent=function(t){var e,r,n,i,o,a,s,u;this.isInComponent=!0;try{this.obStart(),this.setSeparator("~",!0),this.obAny("LIB"),this.obPoint2D(t.location),this.obWrite("~"),this.setSeparator("`",!0),this.obAny("package"),this.obAny(t.pattern.toUpperCase()),this.obAny("value"),this.obAny(t.comment.text),this.setSeparator("~",!1),this.obNumber(t.orientation),this.obAny(""),this.obAny(""),this.obLayer(t.layer),this.setSeparator("#@$",!1);var l=t.showDesignator,h=t.designator;g.a.nullOrEmpty(t.designator.text)&&(h=new O.a(h.net,h.layer,h.location,h.rotation,"U?",h.font,h.mirror),l=!1),this.obAny(this.gnrString(h,"P",l)[0],!1,!1),this.obAny(this.gnrString(t.comment,"N",t.showComment)[0],!1,!1);var c=new Array;try{for(var f=Gt(t.shapes),p=f.next();!p.done;p=f.next()){if((N=p.value)instanceof B.a)c.push(N);else try{for(var d=(n=void 0,Gt(this.dispatcher(N))),y=d.next();!y.done;y=d.next()){var b=y.value;this.obAny(b,!1,!1)}}catch(t){n={error:t}}finally{try{y&&!y.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}if(0===c.length)return[this.obGetClean()];var v=new Array;v.push(this.obGetClean());try{for(var m=Gt(c),w=m.next();!w.done;w=m.next()){var x=w.value;try{for(var E=(s=void 0,Gt(this.dispatcher(x))),_=E.next();!_.done;_=E.next()){var N=_.value;v.push(N)}}catch(t){s={error:t}}finally{try{_&&!_.done&&(u=E.return)&&u.call(E)}finally{if(s)throw s.error}}}}catch(t){o={error:t}}finally{try{w&&!w.done&&(a=m.return)&&a.call(m)}finally{if(o)throw o.error}}return v}finally{this.isInComponent=!1}},e}(Mt),Xt=r(74),jt=r(32),Ht=r(60),Vt=r(61),Kt=r(64),Zt=r(110),qt=r(113),Qt=r(114),Jt=r(90),$t=r(102),te=r(103),ee=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),re=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ne=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},ie=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ne(arguments[e]));return t},oe=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ee(e,t),e.prototype.decide1=function(t){return t[0]&&!t[1]},e}(Xt.a))(2),ae=3*new w.b(w.a.MM,w.a.MIL).ratio/10;function se(t){return new Array}function ue(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=new Array;try{for(var o=re(r),a=o.next();!a.done;a=o.next()){var s=a.value;null!==s&&Rt.a.addAll(i,s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return i}var le=function(t){this.tsilk_debug=!1,this.tpaste_debug=!1,this.tmask_debug=!1,this.tco_debug=!1,this.core_debug=!1,this.inner_debug=!1,this.bco_debug=!1,this.bmask_debug=!1,this.bpaste_debug=!1,this.bsilk_debug=!1,this.resolution=.01,this.ignoreVia=!1,this.ignorePad=!1,this.logger=t},he=function(){function t(t,e){this.normal=new jt.a,this.innerPad=new jt.a,this.plane=new jt.a,this.topModels=new Array,this.botModels=new Array,this.outlineCache=new Array,this.doc=t,this.setting=e}return t.prototype.export=function(){var t,e,r,n,i,o,s,u,l=new Array,h=new vt.b;try{for(var c=re(this.doc.shapes),f=c.next();!f.done;f=c.next()){var p=f.value;h.ext1(p.bbox())}}catch(e){t={error:e}}finally{try{f&&!f.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}if(h.valid()){var d=h.build(),y=d.center();Math.abs(y.x)<1e4&&Math.abs(y.y)<1e4&&(y=U.a.ORIGIN);var b=K.a.translate(-y.x,-y.y).scale(this.doc.scale/10);try{for(var v=re(this.doc.shapes),m=v.next();!m.done;m=v.next()){p=m.value;this.dispatcher(p.multiply3(b))}}catch(t){r={error:t}}finally{try{m&&!m.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}d=d.transform(b);var w=this.buildOutline(d).items,g=this.polyv2(this.normal.get(x.c.TOP_SILK)),O=this.polyv2(this.normal.get(x.c.TOP_PASTE)),E=this.polyv2(this.normal.get(x.c.TOP_SOLDER_MASK)),_=this.polyv2(this.normal.get(x.c.TOP_COPPER)),N=this.polyv2(this.normal.get(x.c.BOT_COPPER)),A=this.polyv2(this.normal.get(x.c.BOT_SOLDER_MASK)),T=this.polyv2(this.normal.get(x.c.BOT_PASTE)),S=this.polyv2(this.normal.get(x.c.BOT_SILK)),R=this.normal.get(x.c.MULTI),I=this.merge(this.setting.core_debug,oe,[w,R]),P=new Array;try{for(var C=re(I.plGrps),L=C.next();!L.done;L=C.next()){var D=L.value;Rt.a.addAll(P,this.v2(D.items))}}catch(t){i={error:t}}finally{try{L&&!L.done&&(o=C.return)&&o.call(C)}finally{if(i)throw i.error}}var M=this.poly(P),k=1;this.write(l,"TopSilkLayer","silk",new Jt.a(M,g)),this.write(l,"TopSolderMaskLayer","solder-mask",new $t.a(M,E)),this.write(l,"TopPasteMaskLayer","paste",new te.a(M,O,_,E)),this.write(l,"TopLayer","copper",new Jt.a(M,_)),this.write(l,a.a.format("Substrate%d",k++),"substrate",M);try{for(var B=re(this.doc.layerStack),F=B.next();!F.done;F=B.next()){var Y=F.value,G=void 0;if(Y.type===x.a.INNER)G=this.normal.get(Y);else{if(Y.type!==x.a.PLANE)continue;G=this.plane.get(Y)}var z="Inner"+Y.order,W=this.innerPad.get(x.c.MULTI);this.write(l,z,"copper",new Jt.a(M,this.polyv2(ue(G,W)))),this.write(l,a.a.format("Substrate%d",k++),"substrate",M)}}catch(t){s={error:t}}finally{try{F&&!F.done&&(u=B.return)&&u.call(B)}finally{if(s)throw s.error}}this.write(l,"BottomLayer","copper",new Jt.a(M,N)),this.write(l,"BottomPasteMaskLayer","paste",new te.a(M,T,N,A)),this.write(l,"BottomSolderMaskLayer","solder-mask",new $t.a(M,A)),this.write(l,"BottomSilkLayer","silk",new Jt.a(M,S)),this.write(l,"Top","3dmodel",this.topModels),this.write(l,"Bottom","3dmodel",this.botModels)}return l},t.prototype.v2=function(t){var e,r,n,i,o,a,s=new Array;if(null!==t)try{for(var u=re(t),l=u.next();!l.done;l=u.next()){var h=l.value,c=new Array,f=null;try{for(var p=(n=void 0,re(h.primitives)),d=p.next();!d.done;d=p.next()){var y=d.value;try{for(var b=(o=void 0,re(y.points(this.setting.resolution))),v=b.next();!v.done;v=b.next()){var m=v.value;null!==f&&f.equals(m)||c.push(new U.a(m.x,m.y)),f=m}}catch(t){o={error:t}}finally{try{v&&!v.done&&(a=b.return)&&a.call(b)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}s.push(c)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return s},t.prototype.poly=function(t){return new Qt.a(t)},t.prototype.polyv2=function(t){return this.poly(this.v2(t))},t.prototype.write=function(t,e,r,n){t.push({name:e,material:r,data:n})},t.prototype.add1=function(t,e,r){var n,i,o,a;try{for(var s=re(r),u=s.next();!u.done;u=s.next()){var l=u.value;try{for(var h=(o=void 0,re(l.items)),c=h.next();!c.done;c=h.next()){var f=c.value;this.add2(t,e,f)}}catch(t){o={error:t}}finally{try{c&&!c.done&&(a=h.return)&&a.call(h)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.add2=function(t,e,r){t.computeIfAbsent(e,se).push(r)},t.prototype.add3=function(t,e,r){null!==r&&(r instanceof P.a?this.add2(t,e,r):r instanceof Vt.a?this.add1(t,e,[r]):this.add1(t,e,r))},t.prototype.merge=function(t,e,r){var n,i,o=new Ht.a(t);if(null!=r){for(var a=new Kt.a(e.rule,this.setting.logger,o),s=0;s<r.length;s++){var u=e.weight(s),l=r[s];if(null!=l)try{for(var h=(n=void 0,re(l)),c=h.next();!c.done;c=h.next()){var f=c.value;a.addPolyline(f,u,this.setting.resolution)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}a.simplify()}return o},t.prototype.buildOutline=function(t){return new Zt.a(t,2,1.2,this.setting.logger,this.outlineCache).detect()},t.prototype.dispatcher=function(t){t instanceof M.a?this.generatePcbTrack(t):t instanceof T.a?this.generatePcbArc(t):t instanceof k.a?this.generatePcbComponent(t):t instanceof I.a?this.generatePcbRegion(t):t instanceof R.a?this.generatePcbVia(t):t instanceof S.f?this.generatePcbPad(t):t instanceof C.b?this.generatePcbPolygonPour(t):t instanceof D.a?this.generatePcbFill(t):t instanceof qt.a?this.generatePcbModel(t):t instanceof L.a?this.generatePcbPlaneZone(t):t instanceof B.a?this.generatePcbImage(t):this.setting.logger.warning3("shape %s is not suppored",t)},t.prototype.generatePcbImage=function(t){var e,r,n,i,o=0;try{for(var a=re(t.plg),s=a.next();!s.done;s=a.next()){o+=(h=s.value).area(this.setting.resolution)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}try{for(var u=re(t.plg),l=u.next();!l.done;l=u.next()){var h=l.value;this.add2(this.normal,t.layer,o>0?h.reverse():h)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}},t.prototype.generatePcbPlaneZone=function(t){var e=t.shape(t.layer,0);null!==e&&this.add2(this.plane,t.layer,e)},t.prototype.generatePcbModel=function(t){var e=t.layer,r={id:t.uri,originX:t.origin.x,originY:t.origin.y,originRotation:t.orientation,x:t.position.x,y:t.position.y,z:t.position.z,rx:t.rotation.x,ry:t.rotation.y,rz:t.rotation.z,width:t.width,height:t.height,isTop:x.c.isTop(e.type)};x.c.isTop(e.type)?this.topModels.push(r):x.c.isBot(e.type)?this.botModels.push(r):this.setting.logger.warning3("model on layer %s not suuport",e)},t.prototype.generatePcbFill=function(t){var e=t.shape(t.layer,0);null!==e&&this.add2(this.normal,t.layer,e)},t.prototype.generatePcbPolygonPour=function(t){var e,r;if(null!==t.coppered)try{for(var n=re(t.coppered),i=n.next();!i.done;i=n.next()){var o=i.value;this.add1(this.normal,t.layer,[o])}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.isHole=function(t){var e=t.shapes.top,r=t.shapes.inner,n=t.shapes.bot;return!!(e&&r&&n)&&(e.type===S.d.ROUND&&r.type===S.d.ROUND&&n.type===S.d.ROUND&&(e.xSize<=t.hole.length&&r.xSize<=t.hole.length&&n.xSize<=t.hole.length))},t.prototype.generatePcbPad=function(t){if(!(this.setting.ignorePad&&t.hole.length<ae)||this.isHole(t)){var e=t.shape(x.c.MULTI,0);if(this.add3(this.normal,x.c.MULTI,e),null!==t.shapes.top){var r=t.shape(x.c.TOP_COPPER,0);this.add3(this.normal,x.c.TOP_COPPER,r);var n=t.shape(x.c.TOP_COPPER,t.solderMaskEx);if(this.add3(this.normal,x.c.TOP_SOLDER_MASK,n),t.plated){var i=t.shape(x.c.TOP_COPPER,t.pasteMaskEx);this.add3(this.normal,x.c.TOP_PASTE,i)}}if(null!==t.shapes.bot){var o=t.shape(x.c.BOT_COPPER,0);this.add3(this.normal,x.c.BOT_COPPER,o);var a=t.shape(x.c.BOT_COPPER,t.solderMaskEx);if(this.add3(this.normal,x.c.BOT_SOLDER_MASK,a),t.plated){var s=t.shape(x.c.BOT_COPPER,t.pasteMaskEx);this.add3(this.normal,x.c.BOT_PASTE,s)}}if(null!==t.shapes.top&&null!==t.shapes.bot&&null!==t.shapes.inner){var u=t.shape(new x.c(x.a.INNER,1),0);this.add3(this.innerPad,x.c.MULTI,u)}}},t.prototype.generatePcbVia=function(t){if(!(this.setting.ignoreVia&&t.holeDiameter<ae)){var e=t.shape(x.c.MULTI,0);if(null!==e&&this.add2(this.normal,x.c.MULTI,e),!isNaN(t.topPad)){var r=t.shape(x.c.TOP_COPPER,0);if(null!==r&&(this.add2(this.normal,x.c.TOP_COPPER,r),!t.mask)){var n=t.shape(x.c.TOP_COPPER,.4);null!==n&&(this.add2(this.normal,x.c.TOP_SOLDER_MASK,n),this.add2(this.normal,x.c.TOP_PASTE,n))}}if(!isNaN(t.botPad)){var i=t.shape(x.c.BOT_COPPER,0);if(null!==i&&(this.add2(this.normal,x.c.BOT_COPPER,i),!t.mask)){var o=t.shape(x.c.BOT_COPPER,.4);null!==o&&(this.add2(this.normal,x.c.BOT_SOLDER_MASK,o),this.add2(this.normal,x.c.BOT_PASTE,o))}}if(!isNaN(t.innerPad)){var a=t.shape(new x.c(x.a.INNER,1),0);null!==a&&this.add2(this.innerPad,x.c.MULTI,a)}}},t.prototype.generatePcbRegion=function(t){if(t.kind==I.b.POLYGON_CUTOUT);else{var e=t.shape(t.layer,0);null!==e&&(e.area(this.setting.resolution)>0?this.add2(this.normal,t.layer,e.reverse()):this.add2(this.normal,t.layer,e))}},t.prototype.generatePcbTrack=function(t){if(t.layer.equals(x.c.OUTLINE))this.outlineCache.push(new E.a(t.start,t.end));else{var e=t.shape(t.layer,0);null!==e&&this.add2(this.normal,t.layer,e)}},t.prototype.generatePcbArc=function(t){var e;if(t.layer.equals(x.c.OUTLINE)){var r=P.a.build4(t.arc.points(this.setting.resolution));(e=this.outlineCache).push.apply(e,ie(r.primitives))}else{var n=t.shape(t.layer,0);null!==n&&this.add2(this.normal,t.layer,n)}},t.prototype.generatePcbComponent=function(t){var e,r;try{for(var n=re(t.shapes),i=n.next();!i.done;i=n.next()){var o=i.value;this.dispatcher(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}t.showComment&&this.dispatcher(t.comment),t.showDesignator&&this.dispatcher(t.designator)},t}(),ce=r(16),fe=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),pe=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},de=new U.a(3e3,-4e3);function ye(t){return Ct.wrap(t).toFixed(1).toString()+"pt"}var be,ve=function(t){function e(e,r){var n=t.call(this,r)||this;return n.doc=e,n}return fe(e,t),e.prototype.export=function(t){var e,r,n,i;void 0===t&&(t=Rt.a.uuid()),this.isLib=!1;var o=K.a.scale(this.doc.scale*Pt.ratio),a=new Array,s=new vt.b,u=new Array;try{for(var l=pe(this.doc.shapes),h=l.next();!h.done;h=l.next()){var c=h.value;c=c.multiply3(o),s.ext1(c.bbox()),c instanceof ft.a?u.push(c):Rt.a.addAll(a,this.dispatcher(c))}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}try{for(var f=pe(u),p=f.next();!p.done;p=f.next()){var d=p.value;Rt.a.addAll(a,this.gnrJunction(d))}}catch(t){n={error:t}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}s.valid()||s.ext6(0,0);var y=s.build(),b={};this.obStart();var v={docType:At.SCH};return g.a.nullOrEmpty(this.doc.contributor)||(v.importedFrom=this.doc.contributor),b.head=v,this.setSeparator("~",!0),this.obAny("CA"),this.obPoint2D(y.UL()),this.obAny("#FFFFFF"),this.obAny("yes"),this.obAny("#CCCCCC"),this.obNumber(5),this.obNumber(y.width()),this.obNumber(y.height()),this.obAny("line"),this.obNumber(5),this.obAny("pixel"),this.obNumber(5),this.obNumber(45),this.obAny("visible"),this.obNumber(.5),this.obPoint2D(new U.a(0,0)),b.canvas=this.obGetClean(),b.shape=a,b.BBox={x:y.minX,y:-y.maxY,width:y.width(),height:y.height()},{uuid:t,docType:At.SCH,title:this.doc.sourceName,dataStr:b}},e.prototype.exportLib=function(t,e){void 0===e&&(e=Rt.a.uuid());var r=new Array;for(var n in t.shapes){var i=t.shapes[n];for(var o in i){var s=this.exportLib1(t,n,o);r.push({uuid:e,title:a.a.format("%s.%s",t.name,o),docType:At.SCH_LIB_SUBPART,dataStr:s})}break}if(1==r.length){var u=r[0];return u.title=t.name,u.docType=At.SCH_LIB,u.dataStr.head.docType=At.SCH_LIB,u.dataStr.head.c_para.pre=t.abbreviation,u}var l=JSON.parse(JSON.stringify(r[0]));return l.title=t.name,l.docType=At.SCH_LIB,l.uuid=e,l.dataStr.head.c_para.pre=t.abbreviation,l.subpart=r,l},e.prototype.exportLib1=function(t,e,r){var n,i,o,s;this.isLib=!0;var u,l=K.a.scale(this.doc.scale*Pt.ratio),h=null,c=new vt.b,f=t.shapes[e][r];try{for(var p=pe(f),d=p.next();!d.done;d=p.next()){var y=d.value;c.ext1(y.bbox()),null==h&&y instanceof q.a&&(h=y.location)}}catch(t){n={error:t}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}u=c.valid()?c.build():new vt.a(0,0,0,0),null==h&&(h=U.a.ORIGIN);var b=u.center();h=h.multiply3(l),b=b.multiply3(l);var v=h.x-5*Math.round(h.x/5),m=h.y-5*Math.round(h.y/5);b=new U.a(0|b.x,0|b.y),l=l.translate(-b.x+v,-b.y+m).translate1(de),u=u.transform(l);var w=new Array;try{for(var x=pe(f),O=x.next();!O.done;O=x.next()){y=O.value;Rt.a.addAll(w,this.dispatcher(y.multiply3(l)))}}catch(t){o={error:t}}finally{try{O&&!O.done&&(s=x.return)&&s.call(x)}finally{if(o)throw o.error}}var E,_,N,A={},T={name:t.name,package:e,pre:a.a.format("%s.%s",t.abbreviation,r)};if(t.props&&t.props.length>0)for(var S=0;S<t.props.length;S++)N=t.props[S],E=this.fixedGarbledText(N&&N.name),_=this.fixedGarbledText(N&&N.value),E&&_&&(T.hasOwnProperty(E)||(T[E]=_));var R={docType:At.SCH_LIB_SUBPART,c_para:T};return g.a.nullOrEmpty(this.doc.contributor)||(R.importedFrom=this.doc.contributor),A.head=R,this.obStart(),this.setSeparator("~",!0),this.obAny("CA"),this.obNumber(1e3),this.obNumber(1e3),this.obAny("#FFFFFF"),this.obAny("yes"),this.obAny("#CCCCCC"),this.obNumber(5),this.obNumber(u.width()),this.obNumber(u.height()),this.obAny("line"),this.obNumber(5),this.obAny("pixel"),this.obNumber(5),this.obPoint2D(de),A.canvas=this.obGetClean(),A.shape=w,A.BBox={x:u.minX,y:-u.maxY,width:u.width(),height:u.height()},A},e.prototype.obElectrical=function(t){if(this.obSeparator(),null!=t)switch(t){case q.b.INPUT:this.obWrite("1");break;case q.b.OUTPUT:this.obWrite("2");break;case q.b.IO:this.obWrite("3");break;case q.b.POWER:this.obWrite("4");break;default:this.logger.warning3("Pin Electrical %s is not supported",Object(q.d)(t))}},e.prototype.obStrokeStyle=function(t){if(this.obSeparator(),null==t)this.obWrite("0");else switch(t){case Z.b.SOLID:this.obWrite("0");break;case Z.b.DASHED:this.obWrite("1");break;case Z.b.DOTTED:this.obWrite("2")}},e.prototype.obVAligment=function(t){if(this.obSeparator(),null!=t)switch(t){case V.c.TOP:this.obWrite("text-before-edge");break;case V.c.CENTER:this.obWrite("middle");break;case V.c.BOTTOM:this.obWrite("text-after-edge")}},e.prototype.obHAligment=function(t){if(this.obSeparator(),null!=t)switch(t){case V.b.LEFT:this.obWrite("start");break;case V.b.CENTER:this.obWrite("middle");break;case V.b.RIGHT:this.obWrite("end")}},e.prototype.dispatcher=function(t){return t instanceof J.a?this.gnrBezier(t):t instanceof st.a?this.gnrBus(t):t instanceof rt.a?this.gnrEllipse(t):t instanceof ot.a?this.gnrArc(t):t instanceof Q.a?this.gnrAnnotation(t,"L",!0):t instanceof et.a?this.gnrPolyline(t):t instanceof nt.a?this.gnrPie(t):t instanceof q.a?this.gnrPin(t):t instanceof it.a?this.gnrRectangle(t):t instanceof at.a?this.gnrWire(t):t instanceof ut.a?this.gnrBusEntry(t):t instanceof lt.a?this.gnrPowerPort(t):t instanceof ct.a?this.gnrNetLabel(t):t instanceof ft.a?this.gnrJunction(t):t instanceof pt.a?this.gnrNoERC(t):t instanceof j.a?this.gnrComponent(t):t instanceof ht.a?this.gnrPort(t):(this.logger.warning3("unsupported shape %s",t),[])},e.prototype.gnrBezier=function(t){var e=t.style,r=t.bezier._points;if(r.length<=4){var n,i,o=void 0,a=void 0;switch(n=t.bezier.start(),i=t.bezier.end(),r.length){case 2:o=n,a=i;break;case 3:a=o=r[1];break;default:o=r[1],a=r[2]}return this.obStart(),this.obWrite("PT~"),this.setSeparator(" ",!0),this.obAny("M"),this.obPoint2D(n),this.obAny("C"),this.obPoint2D(o),this.obPoint2D(a),this.obPoint2D(i),this.setSeparator("~",!1),this.obColor(e.stroke.color),this.obNumber(e.stroke.width),this.obStrokeStyle(e.stroke.style),this.obAny(""),this.obAny(""),[this.obGetClean()]}return this.logger.warning3("Bezier endpoints more than 4 is not supported"),[]},e.prototype.gnrBus=function(t){var e,r;this.obStart(),this.obWrite("B~"),this.setSeparator(" ",!0);try{for(var n=pe(t.points),i=n.next();!i.done;i=n.next()){var o=i.value;this.obPoint2D(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this.setSeparator("~",!1),this.obColor(t.stroke.color),this.obNumber(t.stroke.width),this.obStrokeStyle(t.stroke.style),this.obAny(""),this.obAny(""),[this.obGetClean()]},e.prototype.gnrEllipse=function(t){var e=t.style,r=e.stroke;return this.obStart(),this.setSeparator("~",!0),this.obAny("E"),this.obPoint2D(t.center),this.obNumber(t.rx),this.obNumber(t.ry),this.obColor(r.color),this.obNumber(r.width),this.obStrokeStyle(r.style),null!==e.fill&&1===e.transparency&&this.obColor(e.fill),this.obAny(""),[this.obGetClean()]},e.prototype.gnrArc=function(t){var e,r=t.style,n=r.stroke,i=t.arc,o=i.isLarge()?1:0;switch(i.sweep()){case N.a.CCW:e=0;break;case N.a.CW:e=1;break;default:throw new Error("unsupported sweep")}return this.obStart(),this.obWrite("A~"),this.setSeparator(" ",!0),this.obAny("M"),this.obPoint2D(i.start()),this.obAny("A"),this.obNumber(i.rx),this.obNumber(i.ry),this.obNumber(0),this.obNumber(o),this.obNumber(e),this.obPoint2D(i.svgEnd),this.setSeparator("~",!1),this.obAny(""),this.obColor(n.color),this.obNumber(Math.max(n.width,1)),this.obStrokeStyle(n.style),this.obColor(r.fill),this.obAny(""),[this.obGetClean()]},e.prototype.gnrAnnotation=function(t,e,r){var n,i,o,a=Bt.a.regularD(-t.orientation);if(a>90&&a<270){switch(this.logger.warning1("orientation 180 of Annotation will not inverted"),a=0,t.aligment.horizontal){case V.b.LEFT:n=V.b.RIGHT;break;case V.b.CENTER:n=V.b.CENTER;break;case V.b.RIGHT:n=V.b.LEFT;break;default:this.logger.warning1("bug in processing text horizontal"),n=V.b.RIGHT}switch(t.aligment.vertical){case V.c.TOP:i=V.c.BOTTOM;break;case V.c.CENTER:i=V.c.CENTER;break;case V.c.BOTTOM:i=V.c.TOP;break;default:this.logger.warning1("bug in processing text vertical"),i=V.c.TOP}}else n=t.aligment.horizontal,i=t.aligment.vertical;if(t.mAligment===V.c.BOTTOM){for(var s=1;null!==t.text.match(It);)s++;var u=Ct.wrap(t.font.size);o=s>1?t.location.add1(0,u*(s-1)).multiply3(K.a.rotateD(-a).setOrigin1(t.location)):t.location}else o=t.location;return this.obStart(),this.setSeparator("~",!0),this.obAny("T"),this.obAny(e),this.obPoint2D(o),this.obNumber(a),this.obColor(t.color),this.obAny(t.font.familly),this.obAny(ye(t.font.size)),this.obNumber(t.font.weight),this.obAny(t.font.italic?"Italic":""),this.obVAligment(i),this.obAny("comment"),this.obAny(t.text.replace(It,"\\n"),!1,!0),this.obNumber(r?1:0),this.obHAligment(n),this.obAny(""),[this.obGetClean()]},e.prototype.gnrPolyline=function(t){var e=this,r=t.style,n=r.stroke;return null!==r.fill&&1===r.transparency?(this.obStart(),this.obWrite("PG~"),this.setSeparator(" ",!0),t.pl.points(1,(function(t){e.obPoint2D(t)})),this.setSeparator("~",!1),this.obColor(n.color),this.obNumber(n.width),this.obStrokeStyle(n.style),1===r.transparency&&this.obColor(r.fill),[this.obGetClean()]):(this.obStart(),this.obWrite("PL~"),this.setSeparator(" ",!0),t.pl.points(1,(function(t){e.obPoint2D(t)})),this.setSeparator("~",!1),this.obColor(n.color),this.obNumber(Math.max(n.width,1)),this.obStrokeStyle(n.style),this.obAny(""),this.obAny(""),[this.obGetClean()])},e.prototype.gnrPie=function(t){var e=t.style,r=e.stroke,n=t.arc,i=t.arc.isLarge()?1:0;return this.obStart(),this.obWrite("PI~"),this.setSeparator(" ",!0),this.obAny("M"),this.obPoint2D(n.center),this.obAny("L"),this.obPoint2D(n.start()),this.obAny("A"),this.obNumber(n.rx),this.obNumber(n.ry),this.obNumber(0),this.obNumber(i),this.obNumber(0),this.obPoint2D(n.svgEnd),this.obAny("Z"),this.setSeparator("~",!1),this.obAny(""),this.obColor(r.color),this.obNumber(r.width),this.obStrokeStyle(r.style),this.obColor(e.fill),[this.obGetClean()]},e.prototype.gnrPin=function(t){var e,r,n,i=!1,o=!1;try{for(var s=pe(t.pinShapes),u=s.next();!u.done;u=s.next()){var l=u.value;switch(l){case q.c.CLOCK:i=!0;break;case q.c.DOT:o=!0;break;default:this.logger.warning3("Pin Shape %s is not supported",l)}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}t.name.text.indexOf("\\")>=0?(this.logger.warning3("Pin Display Name is not support \\ placeholder"),n=t.name.text.replace(/\\/g,"")):n=t.name.text;var h,c,f,p=t.location.x,d=t.location.y,y=t.length,b=Bt.a.toQuarterBaseD(t.orientation);switch(b){case 0:c=!1,h=(o?ce.a:0)-y,p+=y;break;case 180:c=!1,h=y-(o?ce.a:0),p-=y;break;case 270:c=!0,h=(o?ce.a:0)-y,d-=y;break;case 90:c=!0,h=y-(o?ce.a:0),d+=y;break;default:throw new Error(a.a.format("pin orientation %f -> %d",t.orientation,b))}switch(t.name.aligment.vertical){case V.c.CENTER:f=-t.name.font.size/2;break;case V.c.TOP:f=-t.name.font.size;break;default:f=0}var v,m=t.name.location.add1(0,f).multiply3(K.a.rotateD(t.name.orientation).setOrigin1(t.name.location));switch(t.number.aligment.vertical){case V.c.CENTER:v=-t.number.font.size/2;break;case V.c.TOP:v=-t.number.font.size;break;default:v=0}var w=t.number.location.add1(0,v).multiply3(K.a.rotateD(t.number.orientation).setOrigin1(t.number.location)),g=new U.a(p,d);return this.obStart(),this.setSeparator("~",!0),this.obAny("P"),this.obAny(t.visible?"show":"none"),this.obElectrical(t.electrical),this.obAny(t.number.text),this.obPoint2D(g),this.obNumber(t.orientation),this.obAny(""),this.obWrite("^^"),this.setSeparator("~",!0),this.obPoint2D(g),this.obWrite("^^"),this.setSeparator(" ",!0),this.obAny("M"),this.obPoint2D(g),this.obAny(c?"v":"h"),this.obNumber(h),this.obWrite("~"),this.setSeparator(" ",!0),this.obColor(t.color),this.obWrite("^^"),this.setSeparator("~",!0),this.obBoolean(t.nameVisible),this.obPoint2D(m),this.obNumber(Bt.a.regularD(-t.name.orientation)),this.obAny(n),this.obHAligment(t.name.aligment.horizontal),this.obAny(t.name.font.familly),this.obAny(ye(t.name.font.size)),this.obWrite("^^"),this.setSeparator("~",!0),this.obBoolean(t.numVisible),this.obPoint2D(w),this.obNumber(Bt.a.regularD(-t.number.orientation)),this.obAny(t.number.text),this.obHAligment(t.number.aligment.horizontal),this.obAny(t.number.font.familly),this.obAny(ye(t.number.font.size)),this.obWrite("^^"),this.setSeparator("~",!0),this.obBoolean(o),this.obWrite("^^"),this.setSeparator("~",!0),this.obBoolean(i),[this.obGetClean()]},e.prototype.gnrRectangle=function(t){var e=t.style,r=e.stroke;this.obStart();var n=(new vt.b).ext2(t.location1).ext2(t.location2).build();return this.setSeparator("~",!0),this.obAny("R"),this.obPoint2D(n.UL()),this.obNumber(t.rx),this.obNumber(t.ry),this.obNumber(n.width()),this.obNumber(n.height()),this.obColor(r.color),this.obNumber(r.width),this.obStrokeStyle(r.style),1===e.transparency&&this.obColor(e.fill),[this.obGetClean()]},e.prototype.gnrWire=function(t){var e,r;this.obStart(),this.obWrite("W~"),this.setSeparator(" ",!0);try{for(var n=pe(t.points),i=n.next();!i.done;i=n.next()){var o=i.value;this.obPoint2D(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return this.setSeparator("~",!1),this.obColor(t.stroke.color),this.obNumber(Math.max(t.stroke.width,1)),this.obStrokeStyle(t.stroke.style),this.obAny(""),this.obAny(""),[this.obGetClean()]},e.prototype.gnrPowerPort=function(t){var e,r,n,i,o=new Array,a=K.a.rotateD(t.orientation).setOrigin1(t.location),s=new tt.a(new Z.a(t.color,1),null),u=new tt.a(new Z.a(t.color,.1),null);switch(t.type){case lt.b.ARROW:var l=t.location.add1(ce.e-ce.f,0),h=t.location.add1(ce.e-ce.f,ce.f/2),c=t.location.add1(ce.e-ce.f,-ce.f/2),f=t.location.add1(ce.e,0),p=P.a.build4([t.location,l,h,f,c,l]).multiply3(a);o.push(new et.a(p,s));break;case lt.b.BAR:l=t.location.add1(ce.e,0),h=t.location.add1(ce.e,ce.e/2),c=t.location.add1(ce.e,-ce.e/2);var d=P.a.build4([t.location,l]).multiply3(a),y=P.a.build4([h,c]).multiply3(a);o.push(new et.a(d,s)),o.push(new et.a(y,s));break;case lt.b.CIRCLE:l=t.location.add1(ce.e-ce.f,0),h=t.location.add1(ce.e-ce.f/2,0),p=P.a.build4([t.location,l]).multiply3(a);o.push(new et.a(p,s));var b=ce.f/2,v=ce.f/2,m=_.a.build2(h,0,360,b,v,N.a.CCW).multiply3(a);o.push(new ot.a(m,u));break;case lt.b.WAVE:l=t.location.add1(ce.e-ce.f/2,0),h=t.location.add1(ce.e-ce.f,ce.f/2),c=t.location.add1(ce.e,ce.f/4).multiply3(a),f=t.location.add1(ce.e-ce.f,-ce.f/4);var w=t.location.add1(ce.e,-ce.f/2);p=P.a.build4([t.location,l]).multiply3(a);o.push(new et.a(p,s));var g=new $.a([h,c,f,w]).multiply3(a);o.push(new J.a(g,u));break;case lt.b.POWER_GROUND:l=t.location.add1(ce.e,0),d=P.a.build4([t.location,l]).multiply3(a);o.push(new et.a(d,s));h=t.location.add1(ce.e,ce.c/2),c=t.location.add1(ce.e,-ce.c/2),y=P.a.build4([h,c]).multiply3(a);o.push(new et.a(y,s));f=t.location.add1(ce.e+3,ce.c/2-3),w=t.location.add1(ce.e+3,-(ce.c/2-3));var x=P.a.build4([f,w]).multiply3(a);o.push(new et.a(x,s));var O=t.location.add1(ce.e+6,ce.c/2-6),E=t.location.add1(ce.e+6,-(ce.c/2-6)),A=P.a.build4([O,E]).multiply3(a);o.push(new et.a(A,s));var T=t.location.add1(ce.e+9,ce.c/2-9),S=t.location.add1(ce.e+9,-(ce.c/2-9)),R=P.a.build4([T,S]).multiply3(a);o.push(new et.a(R,s));break;case lt.b.SIGNAL_GROUND:l=t.location.add1(ce.e,0),h=t.location.add1(ce.e,ce.c/2),c=t.location.add1(ce.e,-ce.c/2),f=t.location.add1(ce.c,0),p=P.a.build4([t.location,l,h,f,c,l]).multiply3(a);o.push(new et.a(p,s));break;case lt.b.EARTH:l=t.location.add1(ce.e,0),h=t.location.add1(ce.e,ce.c/2),c=t.location.add1(ce.e,-ce.c/2),f=t.location.add1(ce.c,ce.c/2-3),w=t.location.add1(ce.c,-3),O=t.location.add1(ce.c,-(ce.c/2+3)),d=P.a.build4([t.location,l,w]).multiply3(a);o.push(new et.a(d,s));y=P.a.build4([f,h,c,O]).multiply3(a);o.push(new et.a(y,s))}var I,C=K.a.rotateD(t.net.orientation).setOrigin1(t.net.location);switch(t.net.aligment.vertical){case V.c.CENTER:I=t.net.location.add1(0,-t.net.font.size/2).multiply3(C);break;case V.c.TOP:I=t.net.location.add1(0,-t.net.font.size).multiply3(C);break;case V.c.BOTTOM:I=t.net.location.add1(0,.2*t.net.font.size).multiply3(C);break;default:I=t.net.location}this.obStart(),this.setSeparator("~",!0),this.obAny("F"),this.obAny("part_netLabel_"+Object(lt.c)(t.type).toLowerCase()),this.obPoint2D(t.location),this.obNumber(0),this.obAny(""),this.obWrite("^^"),this.setSeparator("~",!0),this.obPoint2D(t.location),this.obWrite("^^"),this.setSeparator("~",!0),this.obAny(t.net.text),this.obColor(t.color),this.obPoint2D(I),this.obNumber(Bt.a.regularD(-t.net.orientation)),this.obHAligment(t.net.aligment.horizontal),this.obBoolean(t.showNetName),this.obAny(t.net.font.familly),this.obAny(ye(t.net.font.size)),this.setSeparator("^^",!1);try{for(var L=pe(o),D=L.next();!D.done;D=L.next()){var M=D.value;try{for(var k=(n=void 0,pe(this.dispatcher(M))),U=k.next();!U.done;U=k.next()){var B=U.value;this.obAny(B,!1,!1)}}catch(t){n={error:t}}finally{try{U&&!U.done&&(i=k.return)&&i.call(k)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{D&&!D.done&&(r=L.return)&&r.call(L)}finally{if(e)throw e.error}}return[this.obGetClean()]},e.prototype.gnrBusEntry=function(t){return t.stroke.color!==d.a.GREEN&&this.logger.warning3("BusEntry Color %s is not supported",t.stroke.color.toString()),2!==t.stroke.width&&this.logger.warning3("BusEntry Line Width %f is not supported",t.stroke.width),this.obStart(),this.setSeparator("~",!0),this.obAny("BE"),this.obNumber(0),this.obPoint2D(t.location1),this.obPoint2D(t.location2),this.obAny(""),[this.obGetClean()]},e.prototype.gnrNetLabel=function(t){var e;t.net.indexOf("\\")>=0?(this.logger.warning1("NetLabel Net is not support \\ placeholder"),e=t.net.replace(/\\/g,"")):e=t.net;var r=K.a.rotateD(t.orientation).setOrigin1(t.location),n=t.location.add1(0,.2*t.font.size).multiply3(r);return this.obStart(),this.setSeparator("~",!0),this.obAny("N"),this.obPoint2D(t.location),this.obNumber(Bt.a.regularD(-t.orientation)),this.obColor(t.color),this.obAny(e),this.obAny(""),this.obAny("left"),this.obPoint2D(n),this.obAny(t.font.familly),this.obAny(ye(t.font.size)),[this.obGetClean()]},e.prototype.gnrNoERC=function(t){return this.obStart(),this.setSeparator("~",!0),this.obAny("O"),this.obPoint2D(t.location),this.obAny(""),this.obWrite("~"),this.setSeparator(" ",!0),this.obAny("M"),this.obPoint2D(t.location.add1(-4,-4)),this.obAny("L"),this.obPoint2D(t.location.add1(4,4)),this.obAny("M"),this.obPoint2D(t.location.add1(4,-4)),this.obAny("L"),this.obPoint2D(t.location.add1(-4,4)),this.setSeparator("~",!1),this.obColor(t.color),[this.obGetClean()]},e.prototype.gnrJunction=function(t){return this.obStart(),this.setSeparator("~",!0),this.obAny("J"),this.obPoint2D(t.location),this.obNumber(t.size),this.obColor(t.fill),this.obAny(""),[this.obGetClean()]},e.prototype.gnrPort=function(t){var e,r,n,i;t.name.text.indexOf("\\")>=0&&this.logger.warning1("\\ placeholder of port is not supported");var o=new Array,a=new Array,s=t.name.font.size,u=t.width,l=t.location,h=t.location.add1(u,0),c=!1,f=!1;switch(t.ioType){case ht.b.INPUT:t.startSharp&&(c=!0),t.endSharp&&(f=!0);break;case ht.b.OUTPUT:t.startSharp&&(f=!0),t.endSharp&&(c=!0)}var p=null,d=t.location,y=V.b.LEFT;c&&!f?(u=3*s,p=h=l.add1(u,0),d=l):f&&!c&&(u=3*s,p=l=h.add1(-u,0),d=h,y=V.b.RIGHT),t.startSharp?(a.push(l.add1(s,-s/2)),a.push(l),a.push(l.add1(s,s/2))):(a.push(l.add1(0,-s/2)),a.push(l.add1(0,s/2))),t.endSharp?(a.push(h.add1(-s,s/2)),a.push(h),a.push(h.add1(-s,-s/2))):(a.push(h.add1(0,s/2)),a.push(h.add1(0,-s/2))),a.push(a[0]),null===p&&(p=h);var b=K.a.rotateD(t.orientation).setOrigin1(t.location),v=P.a.build4(a.map((function(t){return t.multiply3(b)})));o.push(new et.a(v,new tt.a(new Z.a(t.strokeColor,.5),t.fillColor)));var m=t.orientation>90&&t.orientation<=270,w=p.add1(0,(m?1:-1)*s/2*.7).multiply3(b);this.obStart(),this.setSeparator("~",!0),this.obAny("F"),this.obAny("part_netLabel_netPort"),this.obPoint2D(t.location),this.obNumber(0),this.obAny(""),this.obWrite("^^"),this.setSeparator("~",!0),this.obPoint2D(d.multiply3(b)),this.obWrite("^^"),this.setSeparator("~",!0),this.obAny(t.name.text),this.obColor(t.name.color),this.obPoint2D(w),this.obNumber(Bt.a.regularD(-t.orientation%180)),m?y===V.b.LEFT?this.obHAligment(V.b.RIGHT):this.obHAligment(V.b.LEFT):this.obHAligment(y),this.obBoolean(!0),this.obAny(t.name.font.familly),this.obAny(ye(t.name.font.size)),this.setSeparator("^^",!1);try{for(var g=pe(o),x=g.next();!x.done;x=g.next()){var O=x.value;try{for(var E=(n=void 0,pe(this.dispatcher(O))),_=E.next();!_.done;_=E.next()){var N=_.value;this.obAny(N,!1,!1)}}catch(t){n={error:t}}finally{try{_&&!_.done&&(i=E.return)&&i.call(E)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{x&&!x.done&&(r=g.return)&&r.call(g)}finally{if(e)throw e.error}}return[this.obGetClean()]},e.prototype.gnrComponent=function(t){var e,r,n,i,o,s,u,l,h,c,f,p,d,y,b=t.shapes[t.footprint][t.partId];this.obStart(),this.setSeparator("~",!0),this.obAny("LIB"),this.obPoint2D(t.location),this.obWrite("~"),this.setSeparator("`",!0),this.obAny("package"),this.obAny(t.footprint.toUpperCase());try{for(var v=pe(t.props),m=v.next();!m.done;m=v.next()){var w=(I=m.value).name.trim();"package"!==w.toLowerCase()&&(this.obAny(w),this.obAny(I.value.trim()))}}catch(t){e={error:t}}finally{try{m&&!m.done&&(r=v.return)&&r.call(v)}finally{if(e)throw e.error}}this.setSeparator("~",!1),this.obNumber(t.orientation),this.obAny(""),this.obAny(""),this.obAny(""),this.setSeparator("#@$",!1);var g,x=new Q.a(t.value.location,t.value.font,t.value.aligment,V.c.TOP,t.value.value,t.value.orientation,t.value.color,!1);try{for(var O=pe(this.gnrAnnotation(x,"N",t.value.display)),E=O.next();!E.done;E=O.next()){var _=E.value;this.obAny(_,!1,!1)}}catch(t){n={error:t}}finally{try{E&&!E.done&&(i=O.return)&&i.call(O)}finally{if(n)throw n.error}}g=t.hasMultiParts()?a.a.format("%s.%s",t.prefix.value,t.partId):t.prefix.value;var N=new Q.a(t.prefix.location,t.prefix.font,t.prefix.aligment,V.c.TOP,g,t.prefix.orientation,t.prefix.color,!1);try{for(var A=pe(this.gnrAnnotation(N,"P",t.prefix.display)),T=A.next();!T.done;T=A.next()){_=T.value;this.obAny(_,!1,!1)}}catch(t){o={error:t}}finally{try{T&&!T.done&&(s=A.return)&&s.call(A)}finally{if(o)throw o.error}}try{for(var S=pe(t.props),R=S.next();!R.done;R=S.next()){var I;if((I=R.value).display){var P=void 0;P=I.showName?I.name+" = "+I.value:I.value;var C=new Q.a(I.location,I.font,I.aligment,V.c.TOP,P,I.orientation,I.color,!1);try{for(var L=(h=void 0,pe(this.dispatcher(C))),D=L.next();!D.done;D=L.next()){_=D.value;this.obAny(_,!1,!1)}}catch(t){h={error:t}}finally{try{D&&!D.done&&(c=L.return)&&c.call(L)}finally{if(h)throw h.error}}}}}catch(t){u={error:t}}finally{try{R&&!R.done&&(l=S.return)&&l.call(S)}finally{if(u)throw u.error}}try{for(var M=pe(b),k=M.next();!k.done;k=M.next()){var U=k.value;try{for(var B=(d=void 0,pe(this.dispatcher(U))),F=B.next();!F.done;F=B.next()){_=F.value;this.obAny(_,!1,!1)}}catch(t){d={error:t}}finally{try{F&&!F.done&&(y=B.return)&&y.call(B)}finally{if(d)throw d.error}}}}catch(t){f={error:t}}finally{try{k&&!k.done&&(p=M.return)&&p.call(M)}finally{if(f)throw f.error}}return[this.obGetClean()]},e}(Mt),me=r(59),we=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ge=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xe=new w.b(w.a.MIL,w.a.PX100);function Oe(t){return Bt.a.regularD(t)/90|0}!function(t){t[t.H_NONE=0]="H_NONE",t[t.H_LEFT=1]="H_LEFT",t[t.H_RIGHT=2]="H_RIGHT",t[t.H_LEFT_RIGHT=3]="H_LEFT_RIGHT",t[t.V_NONE=4]="V_NONE",t[t.V_TOP=5]="V_TOP",t[t.V_BOTTOM=6]="V_BOTTOM",t[t.V_TOP_BOTTOM=7]="V_TOP_BOTTOM"}(be||(be={}));var Ee=function(t){function e(e,r){var n=t.call(this,r)||this;return n.fonts=new jt.a,n.fontIdx=0,n.curCompLine=0,n.zIdx=0,n.partId=NaN,n.modeId=NaN,n.line=0,n.doc=e,n}return we(e,t),e.prototype.export=function(){var t,e,r,n,i,o,s=this,u=new vt.b;try{for(var l=ge(this.doc.shapes),h=l.next();!h.done;h=l.next()){var c=h.value;u.ext1(c.bbox())}}catch(e){t={error:e}}finally{try{h&&!h.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}if(u.valid()){var f=u.build(),p=new Array,d=K.a.scale(this.doc.scale*xe.ratio).translate(40-f.minX,40-f.minY),y=new Array;try{for(var b=ge(this.doc.shapes),v=b.next();!v.done;v=b.next()){c=v.value;var m=this.dispatcher(c.multiply3(d));Rt.a.addAll(y,m)}}catch(t){r={error:t}}finally{try{v&&!v.done&&(n=b.return)&&n.call(b)}finally{if(r)throw r.error}}this.item("HEADER","Protel for Windows - Schematic Capture Ascii File Version 5.0"),this.itemN("WEIGHT",2*y.length),this.obWrite(me.b),p.push(this.obGetClean()),this.itemN("RECORD",31),this.itemN("FONTIDCOUNT",this.fonts.size()),Object(Ft.c)(this.fonts.entries(),(function(t,e){var r=e.key,n=e.value;return s.itemN(a.a.format("SIZE%d",n),0|r.size),s.item(a.a.format("FONTNAME%d",n),""===r.familly?"Arial":r.familly),!0})),this.item("USEMBCS","T"),this.item("ISBOC","T"),this.item("HOTSPOTGRIDON","T"),this.item("HOTSPOTGRIDON","T"),this.item("HOTSPOTGRIDSIZE","4"),this.item("SHEETSTYLE","17"),this.item("SYSTEMFONT","1"),this.item("BORDERON","T"),this.item("SHEETNUMBERSPACESIZE","4"),this.item("AREACOLOR","16317695"),this.item("SNAPGRIDON","T"),this.item("VISIBLEGRIDON","T"),this.item("SNAPGRIDSIZE","10"),this.item("VISIBLEGRIDSIZE","10"),this.itemN("CUSTOMX",f.width()+80),this.itemN("CUSTOMY",f.height()+80),this.item("USECUSTOMSHEET","T"),this.item("CUSTOMXZONES","6"),this.item("CUSTOMYZONES","4"),this.item("CUSTOMMARGINWIDTH","20"),this.item("DISPLAY_UNIT","4"),this.obWrite(me.b),p.push(this.obGetClean());try{for(var w=ge(y),g=w.next();!g.done;g=w.next()){m=g.value;p.push(m),p.push(me.b)}}catch(t){i={error:t}}finally{try{g&&!g.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}return this.item("HEADER","Icon storage"),this.obWrite(me.b),p.push(this.obGetClean()),this.item("HEADER","Protel for Windows - Schematic Capture Ascii File Version 5.0"),this.obWrite(me.b),p.push(this.obGetClean()),p}return null},e.prototype.itemN=function(t,e){var r=this.autoD(e),n=r.indexOf(".");if(n<0)this.item(t,r);else{this.item(t,r.substring(0,n));var i=Rt.a.rpad(r.substring(n+1),"0",5);r.startsWith("-")&&(i="-"+i),this.item(t+"_FRAC",i)}},e.prototype.font=function(t){var e=this;this.item("FONTID",this.fonts.computeIfAbsent(t,(function(t){return++e.fontIdx})))},e.prototype.comp=function(t){isFinite(this.partId)&&isFinite(this.modeId)&&(this.item("OWNERINDEX",this.curCompLine),this.item("OWNERPARTID",this.partId),this.item("OWNERPARTDISPLAYMODE",this.modeId),this.item("ISNOTACCESIBLE",t?"F":"T"))},e.prototype.index=function(t){void 0===t&&(t=++this.zIdx),this.itemN("INDEXINSHEET",t)},e.prototype.autoColor=function(t){return t.B<<16|t.G<<8|t.R},e.prototype.autoStyle=function(t){switch(t){case Z.b.SOLID:return 0;case Z.b.DASHED:return 1;case Z.b.DOTTED:return 2;default:return this.logger.warning3("unknow Stroke Style %s",t),0}},e.prototype.autoElectrical=function(t){switch(t){case q.b.INPUT:return 0;case q.b.IO:return 1;case q.b.OUTPUT:return 2;case q.b.OPEN_COLLECTOR:return 3;case q.b.PASSIVE:return 4;case q.b.HIZ:return 5;case q.b.EMITTER:return 6;case q.b.POWER:return 7;default:return this.logger.warning3("unknow electrical %s",t),1}},e.prototype.autoPortType=function(t){switch(t){case lt.b.CIRCLE:return 0;case lt.b.ARROW:return 1;case lt.b.BAR:return 2;case lt.b.WAVE:return 3;case lt.b.POWER_GROUND:return 4;case lt.b.SIGNAL_GROUND:return 5;case lt.b.EARTH:return 6;default:return this.logger.warning3("unknow Power Port style %s",t),2}},e.prototype.autoIOType=function(t){switch(t){case ht.b.UNSPECIFIED:return 0;case ht.b.OUTPUT:return 1;case ht.b.INPUT:return 2;case ht.b.BIDIRECTIONAL:return 3;default:return this.logger.warning3("unknow IOType %s of Port",t),0}},e.prototype.justification=function(t){var e,r;switch(t.horizontal){case V.b.LEFT:e=0;break;case V.b.CENTER:e=1;break;case V.b.RIGHT:e=2;break;default:this.logger.warning3("unknow horizontal %s",t.horizontal),e=0}switch(t.vertical){case V.c.TOP:r=2;break;case V.c.CENTER:r=1;break;case V.c.BOTTOM:r=0;break;default:this.logger.warning3("unknow vertical %s",t.vertical),r=0}return 3*r+e},e.prototype.dispatcher=function(t){return this.line++,t instanceof j.a?this.gnrComponent(t):t instanceof Q.a?this.gnrAnnotation(t):t instanceof it.a?this.gnrRectangle(t):t instanceof et.a?this.gnrPolyline(t):t instanceof J.a?this.gnrBezier(t):t instanceof nt.a?this.gnrPie(t):t instanceof rt.a?this.gnrEllipse(t):t instanceof ot.a?this.gnrArc(t):t instanceof q.a?this.gnrPin(t):t instanceof at.a?this.gnrWire(t):t instanceof st.a?this.gnrBus(t):t instanceof ft.a?this.gnrJunction(t):t instanceof ut.a?this.gnrBusEntry(t):t instanceof pt.a?this.gnrNoERC(t):t instanceof lt.a?this.gnrPowerPort(t):t instanceof ct.a?this.gnrNetLabel(t):t instanceof ht.a?this.gnrPort(t):(this.line--,this.logger.warning3("%s is not supported",t),[])},e.prototype.gnrComponent=function(t){var e,r,n,i,o=this,a=new Array;this.curCompLine=this.line,this.itemN("RECORD",1),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("ORIENTATION",Oe(t.orientation)),this.item("LIBREFERENCE",t.name),this.item("SHOWHIDDENPINS","F"),this.item("CURRENTPARTID",t.partId),this.item("DISPLAYMODE",t.footprint),this.item("ISMIRRORED",t.mirrored?"T":"F"),a.push(this.obGetClean());try{for(var s=ge(t.props),u=s.next();!u.done;u=s.next()){var l=u.value;this.line++,a.push(this.gnrProperty(l))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}this.line++,a.push(this.gnrProperty(new H.a("Designator",t.prefix.value,t.prefix.location,t.prefix.orientation,t.prefix.showName,t.prefix.display,t.prefix.font,t.prefix.color,t.prefix.aligment))),this.line++,a.push(this.gnrProperty(new H.a("Comment",t.value.value,t.value.location,t.value.orientation,t.value.showName,t.value.display,t.value.font,t.value.color,t.value.aligment)));var h=new c.a,f=0,p=new c.a,d=0;for(var y in t.shapes){var b=t.shapes[y];for(var v in this.modeId=p.computeIfAbsent(y,(function(t){return d++})),b){this.partId=h.computeIfAbsent(v,(function(t){return++f}));try{for(var m=(n=void 0,ge(b[v])),w=m.next();!w.done;w=m.next()){var g=w.value;Rt.a.addAll(a,this.dispatcher(g))}}catch(t){n={error:t}}finally{try{w&&!w.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}}}this.modeId=NaN,this.partId=NaN,this.line++;var x=this.line;return this.itemN("RECORD",44),this.itemN("OWNERINDEX",this.curCompLine),a.push(this.obGetClean()),p.iterator((function(t,e){return o.line++,o.itemN("RECORD",45),o.itemN("OWNERINDEX",x),o.item("MODELNAME",t),o.item("MODELTYPE","PCBLIB"),o.item("DESCRIPTION",""),a.push(o.obGetClean()),!0})),a},e.prototype.gnrAnnotation=function(t){var e=t.text.indexOf("\n")>=0;if(this.itemN("RECORD",e?28:4),this.comp(!1),this.index(),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),e&&(this.itemN("CORNER.X",t.location.x+100),this.itemN("CORNER.Y",t.location.y-100)),e?this.itemN("TEXTCOLOR",this.autoColor(t.color)):this.itemN("COLOR",this.autoColor(t.color)),this.font(t.font),e?this.item("TEXT",t.text.replace(/~/g,"~~").replace(/\n/g,"~1")):this.item("TEXT",t.text),this.itemN("ORIENTATION",Oe(t.orientation)),e){var r=void 0;switch(t.aligment.horizontal){case V.b.CENTER:r=0;break;case V.b.LEFT:r=1;break;case V.b.RIGHT:r=2;break;default:this.logger.warning3("unknow horizontal %s",t.aligment.horizontal),r=0}this.itemN("ALIGNMENT",r)}else this.itemN("JUSTIFICATION",this.justification(t.aligment));return this.item("ISMIRRORED",t.mirror?"T":"F"),[this.obGetClean()]},e.prototype.gnrRectangle=function(t){var e=t.style,r=e.stroke;return this.itemN("RECORD",10),this.comp(!1),this.index(),this.itemN("LOCATION.X",t.location1.x),this.itemN("LOCATION.Y",t.location1.y),this.itemN("CORNER.X",t.location2.x),this.itemN("CORNER.Y",t.location2.y),this.itemN("CORNERXRADIUS",t.rx),this.itemN("CORNERYRADIUS",t.ry),this.itemN("LINEWIDTH",0|r.width),this.itemN("COLOR",this.autoColor(r.color)),null!==e.fill&&(this.itemN("AREACOLOR",this.autoColor(e.fill)),this.item("ISSOLID","T")),[this.obGetClean()]},e.prototype.gnrPolyline=function(t){var e,r,n,i,o=t.style,s=o.stroke;if(null!==o.fill){var u=new Array;try{for(var l=ge(t.pl.asClosed().primitives),h=l.next();!h.done;h=l.next()){var c=h.value;Rt.a.addAll(u,c.points(2))}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}this.itemN("RECORD",6),this.comp(!1),this.index(),this.itemN("LINEWIDTH",Math.min(3,0|s.width)),this.itemN("LOCATIONCOUNT",u.length);for(var f=0;f<u.length;f++){var p=u[f];this.itemN(a.a.format("X%d",f+1),p.x),this.itemN(a.a.format("Y%d",f+1),p.y)}return this.itemN("COLOR",this.autoColor(s.color)),this.itemN("AREACOLOR",this.autoColor(o.fill)),this.item("ISSOLID","T"),this.item("TRANSPARENT",1!==o.transparency?"T":"F"),[this.obGetClean()]}u=new Array;try{for(var d=ge(t.pl.primitives),y=d.next();!y.done;y=d.next()){c=y.value;Rt.a.addAll(u,c.points(2))}}catch(t){n={error:t}}finally{try{y&&!y.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}this.itemN("RECORD",6),this.comp(!1),this.index(),this.itemN("LINEWIDTH",Math.min(3,0|s.width)),this.itemN("LOCATIONCOUNT",u.length);for(f=0;f<u.length;f++){p=u[f];this.itemN(a.a.format("X%d",f+1),p.x),this.itemN(a.a.format("Y%d",f+1),p.y)}return this.itemN("COLOR",this.autoColor(s.color)),this.itemN("LINESTYLE",this.autoStyle(s.style)),this.item("STARTLINESHAPE",0),this.item("ENDLINESHAPE",0),[this.obGetClean()]},e.prototype.gnrBezier=function(t){var e,r,n=t.style.stroke;this.itemN("RECORD",5),this.comp(!1),this.index(),this.itemN("LINEWIDTH",0|n.width),this.itemN("LOCATIONCOUNT",4);var i=0;try{for(var o=ge(t.bezier._points),s=o.next();!s.done;s=o.next()){var u=s.value;i++,this.itemN(a.a.format("X%d",i),u.x),this.itemN(a.a.format("Y%d",i),u.y)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return this.itemN("COLOR",this.autoColor(n.color)),[this.obGetClean()]},e.prototype.gnrPie=function(t){var e=t.style,r=e.stroke,n=t.arc;return n.sweep()!==N.a.CCW&&(n=n.exchangeSweep()),this.itemN("RECORD",9),this.comp(!1),this.index(),this.itemN("LOCATION.X",n.center.x),this.itemN("LOCATION.Y",n.center.y),this.itemN("RADIUS",n.rx),this.item("STARTANGLE",this.autoD(n.startAngle)),this.item("ENDANGLE",this.autoD(n.endAngle())),this.itemN("LINEWIDTH",0|r.width),this.itemN("COLOR",this.autoColor(r.color)),null!==e.fill&&(this.itemN("AREACOLOR",this.autoColor(e.fill)),this.item("ISSOLID","T")),[this.obGetClean()]},e.prototype.gnrEllipse=function(t){var e=t.style,r=e.stroke;return this.itemN("RECORD",8),this.comp(!1),this.index(),this.itemN("LOCATION.X",t.center.x),this.itemN("LOCATION.Y",t.center.y),this.itemN("RADIUS",t.rx),this.itemN("SECONDARYRADIUS",t.ry),this.itemN("LINEWIDTH",0|r.width),this.itemN("COLOR",this.autoColor(r.color)),null!==e.fill&&(this.itemN("AREACOLOR",this.autoColor(e.fill)),this.item("ISSOLID","T")),this.item("TRANSPARENT",1!==e.transparency?"T":"F"),[this.obGetClean()]},e.prototype.gnrArc=function(t){var e=t.style.stroke,r=t.arc;return r.sweep()!==N.a.CCW&&(r=r.exchangeSweep()),this.itemN("RECORD",11),this.comp(!1),this.index(),this.itemN("LOCATION.X",r.center.x),this.itemN("LOCATION.Y",r.center.y),this.itemN("RADIUS",r.rx),this.itemN("SECONDARYRADIUS",r.ry),this.item("STARTANGLE",this.autoD(r.startAngle)),this.item("ENDANGLE",this.autoD(r.endAngle())),this.itemN("LINEWIDTH",0|e.width),this.itemN("COLOR",this.autoColor(e.color)),[this.obGetClean()]},e.prototype.gnrPin=function(t){var e,r;this.itemN("RECORD",2),this.comp(!1),this.itemN("ELECTRICAL",this.autoElectrical(t.electrical));var n=0,i=0,o=0,a=0;try{for(var s=ge(t.pinShapes),u=s.next();!u.done;u=s.next()){var l=u.value;switch(l){case q.c.POSTPONED_OUTPUT:n=8;break;case q.c.OPEN_COLLECTOR:n=9;break;case q.c.HIZ:n=10;break;case q.c.HIGH_CURRENT:n=11;break;case q.c.PULSE:n=12;break;case q.c.SCHMITT:n=13;break;case q.c.OPEN_COLLECTOR_PULL_UP:n=22;break;case q.c.OPEN_EMITTER:n=23;break;case q.c.OPEN_EMITTER_PULL_UP:n=24;break;case q.c.SHIFT_LEFT:n=30;break;case q.c.OPEN_OUTPUT:n=32;break;case q.c.CLOCK:i=3;break;case q.c.RIGHT_LEFT_SIGNAL_FLOW:o=2;break;case q.c.ANALOG_SIGNAL_IN:o=5;break;case q.c.NOT_LOGIC_CONNECTION:o=6;break;case q.c.DIGITAL_SIGNAL_IN:o=25;break;case q.c.LEFT_RIGHT_SIGNAL_FLOW:o=33;break;case q.c.BIDIRECTIONAL_SIGNAL_FLOW:o=34;break;case q.c.DOT:a=1;break;case q.c.ACTIVE_LOW_INPUT:a=4;break;case q.c.ACTIVE_LOW_OUTPUT:a=17;break;default:this.logger.warning3("unknow pin shape %s",l)}}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}this.item("SYMBOL_INNER",this.autoD(n)),this.item("SYMBOL_INNEREDGE",this.autoD(i)),this.item("SYMBOL_OUTER",this.autoD(o)),this.item("SYMBOL_OUTEREDGE",this.autoD(a)),this.itemN("COLOR",this.autoColor(t.color)),this.font(t.name.font),this.item("DESIGNATOR",t.number.text),this.item("NAME",t.name.text);var h=0;return h+=t.orientation/90,h+=(t.nameVisible?1:0)<<3,h+=(t.numVisible?1:0)<<4,h+=(t.visible?1:0)<<5,this.itemN("PINCONGLOMERATE",h),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("PINLENGTH",t.length),[this.obGetClean()]},e.prototype.gnrWire=function(t){var e=t.stroke;this.itemN("RECORD",27),this.index();var r=0|e.width;r=Math.max(r,0),r=Math.min(r,3),this.itemN("LINEWIDTH",r),this.itemN("LOCATIONCOUNT",t.points.length);for(var n=0;n<t.points.length;n++){var i=t.points[n];this.itemN(a.a.format("X%d",n+1),i.x),this.itemN(a.a.format("Y%d",n+1),i.y)}return this.itemN("COLOR",this.autoColor(t.stroke.color)),[this.obGetClean()]},e.prototype.gnrBus=function(t){var e=t.stroke;this.itemN("RECORD",26),this.index(),this.itemN("LINEWIDTH",0|Math.min(e.width,3)),this.itemN("LOCATIONCOUNT",t.points.length);for(var r=0;r<t.points.length;r++){var n=t.points[r];this.itemN(a.a.format("X%d",r+1),n.x),this.itemN(a.a.format("Y%d",r+1),n.y)}return this.itemN("COLOR",this.autoColor(t.stroke.color)),[this.obGetClean()]},e.prototype.gnrJunction=function(t){var e;return this.itemN("RECORD",29),this.index(),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("COLOR",this.autoColor(t.fill)),e=t.size<=2?0:t.size<=3?1:t.size<=5?2:3,this.itemN("SIZE",e),[this.obGetClean()]},e.prototype.gnrBusEntry=function(t){return this.itemN("RECORD",37),this.index(),this.itemN("LOCATION.X",t.location1.x),this.itemN("LOCATION.Y",t.location1.y),this.itemN("CORNER.X",t.location2.x),this.itemN("CORNER.Y",t.location2.y),this.itemN("LINEWIDTH",t.stroke.width),this.itemN("COLOR",this.autoColor(t.stroke.color)),[this.obGetClean()]},e.prototype.gnrNoERC=function(t){return this.itemN("RECORD",22),this.index(),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("COLOR",this.autoColor(t.color)),[this.obGetClean()]},e.prototype.gnrPowerPort=function(t){return this.itemN("RECORD",17),this.index(),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("ORIENTATION",Oe(t.orientation)),this.itemN("COLOR",this.autoColor(t.color)),this.itemN("STYLE",this.autoPortType(t.type)),this.item("TEXT",t.net.text),this.item("SHOWNETNAME",t.showNetName?"T":"F"),[this.obGetClean()]},e.prototype.gnrNetLabel=function(t){return this.itemN("RECORD",25),this.index(),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("ORIENTATION",Oe(t.orientation)),this.itemN("COLOR",this.autoColor(t.color)),this.font(t.font),this.item("TEXT",t.net),[this.obGetClean()]},e.prototype.gnrPort=function(t){var e,r=180===t.orientation||270===t.orientation;e=r?t.location.add1(t.width,0).multiply3(K.a.rotateD(t.orientation).setOrigin1(t.location)):t.location;var n,i=0===t.orientation||180===t.orientation;return n=t.ioType===ht.b.UNSPECIFIED?i?t.startSharp&&t.endSharp?be.H_LEFT_RIGHT:t.startSharp?r?be.H_RIGHT:be.H_LEFT:t.endSharp?r?be.H_LEFT:be.H_RIGHT:be.H_NONE:t.startSharp&&t.endSharp?be.V_TOP_BOTTOM:t.startSharp?r?be.V_TOP:be.V_BOTTOM:t.endSharp?r?be.V_BOTTOM:be.V_TOP:be.V_NONE:i?be.H_NONE:be.V_NONE,this.itemN("RECORD",18),this.index(),this.itemN("LOCATION.X",e.x),this.itemN("LOCATION.Y",e.y),this.itemN("COLOR",this.autoColor(t.strokeColor)),this.itemN("AREACOLOR",this.autoColor(t.fillColor)),this.itemN("TEXTCOLOR",this.autoColor(t.name.color)),this.itemN("WIDTH",t.width),this.itemN("IOTYPE",this.autoIOType(t.ioType)),this.item("NAME",t.name.text),this.itemN("ALIGMENT",0),this.itemN("STYLE",n),this.font(t.name.font),[this.obGetClean()]},e.prototype.gnrProperty=function(t){return"Designator"===t.name?this.itemN("RECORD",34):this.itemN("RECORD",41),this.itemN("COLOR",this.autoColor(t.color)),this.itemN("LOCATION.X",t.location.x),this.itemN("LOCATION.Y",t.location.y),this.itemN("OWNERINDEX",this.curCompLine),this.itemN("OWNERPARTID",-1),this.index(),this.font(t.font),this.item("NAME",t.name),this.item("TEXT",t.value),this.item("SHOWNAME",t.showName?"T":"F"),this.item("ISHIDDEN",t.display?"F":"T"),this.itemN("ORIENTATION",Oe(t.orientation)),this.itemN("JUSTIFICATION",this.justification(t.aligment)),this.obGetClean()},e}(me.a),_e=r(53);r.d(e,"b",(function(){return Te})),r.d(e,"c",(function(){return Se})),r.d(e,"a",(function(){return Re})),r.d(e,"d",(function(){return Pe}));var Ne=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Ae(t,e){var r=new o.c(t,(function(t,r){e.push(r)}),(function(t,e){return a.a.format("%s: %s",Object(o.b)(t),e)})),n=new o.c(t);return o.c.mix(n,r)}function Te(t,e,r){var a,l,h=new Array,c=Ae(o.a.WARNING,h),f=new n.a(new i.a(t,c)).parse(e).getDocs();try{for(var p=Ne(f),d=p.next();!d.done;d=p.next()){var y=d.value;if(y instanceof s.a){if(null!==(b=new u.a(y,c).export()))r(y.sourceName+".pcbdoc",new Blob(b))}else if(y instanceof dt.a){var b;if(null!==(b=new Ee(y,c).export()))r(y.sourceName+".schdoc",new Blob(b))}}}catch(t){a={error:t}}finally{try{d&&!d.done&&(l=p.return)&&l.call(p)}finally{if(a)throw a.error}}return h}function Se(t,e,r){var a,u;void 0===e&&(e=.01),void 0===r&&(r=!1);var l=new o.c(o.a.INFO);try{l.info1("start easyeda to three");var h=new i.a("inner",l);h.preferOriginShape=!0;var c=new n.a(h).parse(t).getDocs();l.info1("complete parse");try{for(var f=Ne(c),p=f.next();!p.done;p=f.next()){var d=p.value;if(d instanceof s.a){var y=new le(l);y.resolution=e,y.ignoreVia=r,y.ignorePad=r;var b=new he(d,y).export();return l.info2("end easyeda to three"),b}throw new Error("unsupported doc type")}}catch(t){a={error:t}}finally{try{p&&!p.done&&(u=f.return)&&u.call(f)}finally{if(a)throw a.error}}}catch(t){l.error2(t)}return null}function Re(t,e,r,n){var i,a,u,l,h,c,f=new Array,p=Ae(o.a.WARNING,f),d=new Tt(t,p,r).parse(e).getDocs();try{for(var y=Ne(d),b=y.next();!b.done;b=y.next()){var v=b.value;try{if(v instanceof s.a){var m=new Wt(v,p);if(r)try{for(var w=(u=void 0,Ne(v.components())),g=w.next();!g.done;g=w.next()){var x=g.value;n(m.exportLib(x))}}catch(t){u={error:t}}finally{try{g&&!g.done&&(l=w.return)&&l.call(w)}finally{if(u)throw u.error}}else n(m.export())}else if(v instanceof dt.a){m=new ve(v,p);if(r)try{for(var O=(h=void 0,Ne(v.components())),E=O.next();!E.done;E=O.next()){x=E.value;n(m.exportLib(x))}}catch(t){h={error:t}}finally{try{E&&!E.done&&(c=O.return)&&c.call(O)}finally{if(h)throw h.error}}else n(m.export())}}catch(t){p.error2(t)}}}catch(t){i={error:t}}finally{try{b&&!b.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}return f}function Ie(t){return 1e-4*Math.round(1e4*parseFloat(t))}function Pe(t){for(var e,r,n,i,a=new o.c(o.a.DEBUG),s=new Ht.a(!1),l=new Kt.a(_e.b,a,s),h=0;h<t.length;h++)for(var c=t[h].polygon,f=0;f<c.length;f++)for(var p=c[f],d=0;d<p.length;d++){for(var y=p[d],b=new Array,v=0;v<y.length;v++){var m=y[v];b.push(new U.a(Ie(m[0]),-Ie(m[1])))}b.length>=3&&l.addPolyline(P.a.build4(b))}if(l.simplify(),s.debug){var w=s.display();new u.a(w,a).export()}var g=new Array;try{for(var x=Ne(s.plGrps),O=x.next();!O.done;O=x.next()){var E=O.value,_=new Array,N=function(t){var e=new Array;t.points(1,(function(t){return e.push([t.x,-t.y])})),_.push(e)};try{for(var A=(n=void 0,Ne(E.items)),T=A.next();!T.done;T=A.next()){N(T.value)}}catch(t){n={error:t}}finally{try{T&&!T.done&&(i=A.return)&&i.call(A)}finally{if(n)throw n.error}}g.push({polygon:[_]})}}catch(t){e={error:t}}finally{try{O&&!O.done&&(r=x.return)&&r.call(x)}finally{if(e)throw e.error}}return g}},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return o}));var n=r(4);function i(t){return t===n.a.SPACE||t===n.a.TAB||t===n.a.CR||t===n.a.LF}var o=function(){function t(){this._line=1,this._col=0}return t.prototype.line=function(){return this._line},t.prototype.col=function(){return this._col},t.prototype._feed=function(t){return t===n.a.LF?(this._col=0,this._line++):this._col++,this.feed(t)},t.prototype.parse=function(t){for(var e=t.length,r=0;r<e;r++){var n=t.charCodeAt(r);if(!this._feed(n))return this}return this.finish(),this},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n,i=r(25),o=r(7),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r){var n=t.call(this,"")||this;return n.points=e,n.stroke=r,n}return a(e,t),e.prototype.multiply3=function(t){return new e(this.points.map((function(e){return e.multiply3(t)})),this.stroke.transform(t))},e.prototype.bbox=function(){return(new o.b).ext3(this.points).ext7(this.stroke.width/2).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(25),o=r(7),a=r(1),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r,n){var i=t.call(this,"")||this;return i.location=e,i.size=a.a.normal(r),i.fill=n,i}return s(e,t),e.prototype.multiply3=function(t){return new e(this.location.multiply3(t),t.iScale*this.size,this.fill)},e.prototype.bbox=function(){return(new o.b).ext2(this.location).ext7(this.size/2).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(25),o=r(7),a=r(1),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r,n,i,o){var s=t.call(this,"")||this;return s.location1=e,s.location2=r,s.rx=a.a.normal(n),s.ry=a.a.normal(i),s.style=o,s}return s(e,t),e.prototype.multiply3=function(t){return new e(this.location1.multiply3(t),this.location2.multiply3(t),t.iScale*this.rx,t.jScale*this.ry,this.style.transform(t))},e.prototype.bbox=function(){return(new o.b).ext2(this.location1).ext2(this.location2).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,i=r(25),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(e,r){var n=t.call(this,"")||this;return n.arc=e,n.style=r,n}return o(e,t),e.prototype.multiply3=function(t){return new e(this.arc.multiply3(t),this.style.transform(t))},e.prototype.bbox=function(){return this.arc.bbox().extendOfSize(this.style.stroke.width/2)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,i=r(25),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(e,r){var n=t.call(this,"")||this;return n.bezier=e,n.style=r,n}return o(e,t),e.prototype.multiply3=function(t){return new e(this.bezier.multiply3(t),this.style.transform(t))},e.prototype.bbox=function(){return this.bezier.bbox().extendOfSize(this.style.stroke.width/2)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n,i=r(25),o=r(7),a=r(12),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r,n,i){var o=t.call(this,"")||this;return o.center=e,o.rx=r,o.ry=n,o.style=i,o}return s(e,t),e.prototype.multiply3=function(t){var r,n;return a.a.transformD(0,t)%180==90?(r=this.ry,n=this.rx):(r=this.rx,n=this.ry),new e(this.center.multiply3(t),t.iScale*r,t.iScale*n,this.style.transform(t))},e.prototype.bbox=function(){var t=this.center.x,e=this.center.y,r=this.rx/2,n=this.ry/2,i=this.style.stroke.width/2;return(new o.b).ext6(t-r,e-n).ext6(t+r,e+n).ext7(i).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(69),i=r(2),o=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},a=function(){function t(t){this.bo=null,this.sides=new Array,this.polyGrp=0,this.polyIndex=0,this.prevSide=null,this.firstSide=null,this.noWeight0=t}return t.prototype.completeGroup=function(t){var e,r;null==this.prevSide||null==this.firstSide||this.prevSide.end.equals(this.firstSide.start)||this.addSide(new i.a(this.prevSide.end,this.firstSide.start),t);var n=new Array,a=null,s=null;try{for(var u=o(this.sides),l=u.next();!l.done;l=u.next()){var h=l.value;this.noWeight0&&0===h.weight||(null!=a?(a.next=h,h.previous=a):s=h,a=h,n.push(h))}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}return null!=a&&null!=s&&(s.previous=a,a.next=s),this.polyGrp++,this.sides.length=0,this.prevSide=null,this.firstSide=null,this.polyIndex=0,n},t.prototype.buildGroup=function(t,e,r){var n,a,s,u;try{for(var l=o(t.primitives),h=l.next();!h.done;h=l.next()){var c=h.value;if(c instanceof i.a)this.addSide(c,e);else{var f=null;try{for(var p=(s=void 0,o(c.points(r))),d=p.next();!d.done;d=p.next()){var y=d.value;null!=f&&this.addSide(new i.a(f,y),e),f=y}}catch(t){s={error:t}}finally{try{d&&!d.done&&(u=p.return)&&u.call(p)}finally{if(s)throw s.error}}}}}catch(t){n={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return this.completeGroup(e)},t.prototype.addSide=function(t,e){if(!t.start().equals(t.end())){var r,o=t.start();null!=this.prevSide?(this.prevSide.end.equals(o)||this.addSide(new i.a(this.prevSide.end,o),e),r=new n.a(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++)):(r=new n.a(this.bo,t,e,t.start(),t.end(),this.polyGrp,this.polyIndex++),this.firstSide=r),this.prevSide=r,this.sides.push(r)}},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(19),i=function(){function t(t,e,r){this.eps=new Array,this.curWeight=0,this.start=null,this.last=null,this.prevStart=null,this.prevEnd=null,this.y=r,this.rule=t,this.bo=e,this.event=e.event}return t.prototype.onEp=function(t){this.tuningWeight(t),null===this.start?this.rule(this.curWeight)?this.in(t):t.setInvalid(this.y):this.rule(this.curWeight)?t.setInvalid(this.y):this.out(t,this.start),null!==this.last&&this.event.onSweep1(this.last,t,this.y),this.last=t},t.prototype.in=function(t){null!=this.prevEnd&&this.onSameX(t,this.prevEnd)?(this.start=this.prevStart,this.prevStart=null,this.prevEnd.revokeInside(this.y),this.prevEnd=null):(this.start=t,this.start.setOutside(this.y))},t.prototype.out=function(t,e){this.onSameX(e,t)?e.revokeOutside(this.y):(t.setInside(this.y)>0&&e.confidence(this.y)>0&&(t.connect.push(e),e.connect.push(t)),this.event.onSegment1(e,t,this.y),this.eps.push(e),this.eps.push(t),this.prevStart=e,this.prevEnd=t),this.start=null},t.prototype.onSameX=function(t,e){return t.bbox().isIntersect(e.bbox())&&n.a.eq(t.getX(this.y),e.getX(this.y))},t.prototype.tuningWeight=function(t){this.curWeight+=t.weight;var e=t.nextNot0(),r=t.prevNot0();null!=e&&t.weight===e.weight&&e.trans===this.y&&(this.curWeight-=t.weight),null!=r&&t.weight===r.weight&&r.trans===this.y&&(this.curWeight-=t.weight),t.trans=this.y},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,i=r(25),o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(e,r){var n=t.call(this,"")||this;return n.arc=e,n.style=r,n}return o(e,t),e.prototype.multiply3=function(t){return new e(this.arc.multiply3(t),this.style.transform(t))},e.prototype.bbox=function(){return this.arc.bbox().extendOfSize(this.style.stroke.width/2)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n,i=r(25),o=r(7),a=r(10),s=r(1),u=r(12),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){function e(e,r,n,i,o){var a=t.call(this,"")||this;return a.location=e,a.orientation=s.a.normal(r),a.net=n,a.font=i,a.color=o,a}return l(e,t),e.prototype.multiply3=function(t){return new e(this.location.multiply3(t),u.a.transformD(this.orientation,t),this.net,this.font.transform(t),this.color)},e.prototype.bbox=function(){var t=this.location,e=this.font.size,r=e*this.net.length/2,n=a.a.rotateD(this.orientation).setOrigin1(t);return(new o.b).ext2(t).ext2(t.add1(r,e)).build().transform(n)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n,i=r(25),o=r(7),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r){var n=t.call(this,"")||this;return n.points=e,n.stroke=r,n}return a(e,t),e.prototype.multiply3=function(t){return new e(this.points.map((function(e){return e.multiply3(t)})),this.stroke.transform(t))},e.prototype.bbox=function(){return(new o.b).ext3(this.points).ext7(this.stroke.width/2).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n,i=r(25),o=r(7),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r,n){var i=t.call(this,"")||this;return i.location1=e,i.location2=r,i.stroke=n,i}return a(e,t),e.prototype.multiply3=function(t){return new e(this.location1.multiply3(t),this.location2.multiply3(t),this.stroke.transform(t))},e.prototype.bbox=function(){return(new o.b).ext2(this.location1).ext2(this.location2).ext7(this.stroke.width/2).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n,i=r(25),o=r(7),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(e,r){var n=t.call(this,"")||this;return n.location=e,n.color=r,n}return a(e,t),e.prototype.multiply3=function(t){return new e(this.location.multiply3(t),this.color)},e.prototype.bbox=function(){var t=this.location.x,e=this.location.y;return new o.a(t,t,e,e)},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t,e){this.geo1=t,this.geo2=e}return t.prototype.bbox=function(){return this.geo2.bbox()},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t,e){this.preferOriginShape=!1,this.pourOnly=!1,this.exportAsLib=!1,this.sourceName=t,this.logger=e}},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n,i=r(107),o=r(68),a=r(27),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t){function e(e,r,n,i,o){var a=t.call(this,e,r,n)||this;return a.shapes=i,a.props=o,a}return s(e,t),e.prototype.components=function(){var t,e,r=new a.a,n=new Array;try{for(var i=u(this.shapes),s=i.next();!s.done;s=i.next()){var l=s.value;l instanceof o.a&&(r.put(l.name,!0)||n.push(l))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},e}(i.a)},function(t,e,r){"use strict";var n,i=r(29),o=r(48),a=r(117),s=r(115),u=r(11),l=r(116),h=r(100),c=r(21),f=(Object(c.b)(.0215,.1745,.0215,.07568,.61424,.07568,.633,.727811,.633,.6),Object(c.b)(.135,.2225,.1575,.54,.89,.63,.316228,.316228,.316228,.1),Object(c.b)(.05375,.05,.06625,.18275,.17,.22525,.332741,.328634,.346435,.3),Object(c.b)(.25,.20725,.20725,1,.829,.829,.296648,.296648,.296648,.088),Object(c.b)(.1745,.01175,.01175,.61424,.04136,.04136,.727811,.626959,.626959,.6),Object(c.b)(.1,.18725,.1745,.396,.74151,.69102,.297254,.30829,.306678,.1),Object(c.b)(.329412,.223529,.027451,.780392,.568627,.113725,.992157,.941176,.807843,.21794872)),p=(Object(c.b)(.2125,.1275,.054,.714,.4284,.18144,.393548,.271906,.166721,.2),Object(c.b)(.25,.25,.25,.4,.4,.4,.774597,.774597,.774597,.6),Object(c.b)(.19125,.0735,.0225,.7038,.27048,.0828,.256777,.137622,.086014,.1),Object(c.b)(.24725,.1995,.0745,.75164,.60648,.22648,.628281,.555802,.366065,.4)),d=Object(c.b)(.19225,.19225,.19225,.50754,.50754,.50754,.508273,.508273,.508273,.4),y=(Object(c.b)(0,0,0,.01,.01,.01,.5,.5,.5,.25),Object(c.b)(0,.1,.06,0,.50980392,.50980392,.50196078,.50196078,.50196078,.25),Object(c.b)(0,0,0,.1,.35,.1,.45,.55,.45,.25),Object(c.b)(0,0,0,.5,0,0,.7,.6,.6,.25),Object(c.b)(0,0,0,.55,.55,.55,.7,.7,.7,.25),Object(c.b)(0,0,0,.5,.5,0,.6,.6,.5,.25),Object(c.b)(.02,.02,.02,.01,.01,.01,.4,.4,.4,.078125),Object(c.b)(0,.05,.05,.4,.5,.5,.04,.7,.7,.078125),Object(c.b)(0,.05,0,.4,.5,.4,.04,.7,.04,.078125),Object(c.b)(.05,0,0,.5,.4,.4,.7,.04,.04,.078125),Object(c.b)(.05,.05,.05,.5,.5,.5,.7,.7,.7,.078125),Object(c.b)(.05,.05,0,.5,.5,.4,.7,.7,.04,.078125),r(41)),b=r(57),v=r(38),m=r(4);!function(t){t[t.LEFT=0]="LEFT",t[t.MID=1]="MID",t[t.RIGHT=2]="RIGHT"}(n||(n={}));var w=function(){function t(t,e,r,n){this.mouseLeftDown=!1,this.mouseMidDown=!1,this.mouseRightDown=!1,this.prevMoveX=0,this.prevMoveY=0,this.prevScaleX=0,this.prevScaleY=0,this.prevRotX=0,this.prevRotY=0,this.rotX=0,this.rotY=0,this.element=t,this.obj=e,this.camera=r,this.originObjAddiMatrix=e.getAddiMatrix(),this.originOffset=r.getOffset(),this.originScale=r.getScale(),this.originCameraPosition=r.getPosition(),this.originCameraTarget=r.getTarget(),this.updateNotifier=n}return t.prototype.cameraMoveVertical=function(t){var e=this.camera,r=e.getTarget(),n=e.getPosition(),i=r.sub(n),o=t/i.length(),a=new u.a(i.x*o,i.y*o,i.z*o);e.setTarget(r.add(a)),e.setPosition(n.add(a))},t.prototype.scale=function(t){var e=this.camera,r=Math.max(1+t,.001);e.setScale(Math.max(e.getScale()*r,.8))},t.prototype.onKeyDown=function(t){t.keyCode!==m.a.k&&t.keyCode!==m.a.K||this.reset()},t.prototype.onMouseDown=function(t){t.button===n.LEFT?(this.mouseLeftDown=!0,this.prevRotX=t.clientX,this.prevRotY=t.clientY):t.button===n.MID?(this.mouseMidDown=!0,this.prevScaleX=t.clientX,this.prevScaleY=t.clientY):t.button===n.RIGHT&&(this.mouseRightDown=!0,this.prevMoveX=t.clientX,this.prevMoveY=t.clientY)},t.prototype.onMouseUp=function(t){t.button===n.LEFT?this.mouseLeftDown=!1:t.button===n.MID?this.mouseMidDown=!1:t.button===n.RIGHT&&(this.mouseRightDown=!1)},t.prototype.onMouseMove=function(t){var e=this.element.offsetWidth,r=this.element.offsetHeight,n=this.camera.getScale();if(this.mouseLeftDown){var i=t.clientX-this.prevRotX,o=t.clientY-this.prevRotY;if(0!==i||0!==o){var a=Math.PI*o/r,s=Math.PI*i/e;this.rotX+=a/n,this.rotY+=s/n;var l=this.originObjAddiMatrix.multiply4(v.a.rotateY(this.rotY)).multiply4(v.a.rotateX(this.rotX));this.obj.setAddiMatrix(l),this.prevRotX=t.clientX,this.prevRotY=t.clientY,this.updateNotifier()}}if(this.mouseMidDown){var h=-(o=t.clientY-this.prevScaleY)/r*20;this.cameraMoveVertical(h/n),this.prevScaleX=t.clientX,this.prevScaleY=t.clientY,this.updateNotifier()}if(this.mouseRightDown){i=t.clientX-this.prevMoveX,o=t.clientY-this.prevMoveY;var c=new u.a(i/100/n,-o/100/n,0);this.camera.setOffset(this.camera.getOffset().add(c)),this.prevMoveX=t.clientX,this.prevMoveY=t.clientY,this.updateNotifier()}},t.prototype.onMouseWheel=function(t){t.deltaY<0?this.scale(.1):this.scale(-.1),this.updateNotifier()},t.prototype.reset=function(){this.rotX=0,this.rotY=0,this.obj.setAddiMatrix(this.originObjAddiMatrix),this.camera.setOffset(this.originOffset),this.camera.setScale(this.originScale),this.camera.setPosition(this.originCameraPosition),this.camera.setTarget(this.originCameraTarget),this.updateNotifier()},t.prototype.install=function(){var t=this.element;window.addEventListener("keydown",this.onKeyDown.bind(this),!1),t.addEventListener("mousedown",this.onMouseDown.bind(this),!1),t.addEventListener("mouseup",this.onMouseUp.bind(this),!1),t.addEventListener("mousemove",this.onMouseMove.bind(this),!1),t.addEventListener("wheel",this.onMouseWheel.bind(this),!1),t.oncontextmenu=function(){return!1}},t.prototype.uninstall=function(){},t}(),g=r(6),x=r(104),O=r(12),E=r(51),_=r(72),N=r(1),A=r(27);r.d(e,"b",(function(){return C})),r.d(e,"a",(function(){return k}));var T=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},S=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},R=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},I={green:i.a.of1(1732404),red:i.a.of1(14882582),blue:i.a.of1(599383),yellow:i.a.of1(11583488),black:i.a.of1(0),purple:i.a.of1(6556786),white:i.a.of1(16765907),board:i.a.of1(10329437)},P={TopLayer:"attr-view-layer-1",BottomLayer:"attr-view-layer-2",TopSilkLayer:"attr-view-layer-3",BottomSilkLayer:"attr-view-layer-4",TopPasteMaskLayer:"attr-view-layer-5",BottomPasteMaskLayer:"attr-view-layer-6",TopSolderMaskLayer:"attr-view-layer-7",BottomSolderMaskLayer:"attr-view-layer-8",Ratlines:"attr-view-layer-9",BoardOutline:"attr-view-layer-10","Multi-Layer":"attr-view-layer-11",Document:"attr-view-layer-12",TopAssembly:"attr-view-layer-13",BottomAssembly:"attr-view-layer-14",Mechanical:"attr-view-layer-15","3DModel":"attr-view-layer-19",Inner1:"attr-view-layer-21",Inner2:"attr-view-layer-22",Inner3:"attr-view-layer-23",Inner4:"attr-view-layer-24",Inner5:"attr-view-layer-25",Inner6:"attr-view-layer-26",Inner7:"attr-view-layer-27",Inner8:"attr-view-layer-28",Inner9:"attr-view-layer-29",Inner10:"attr-view-layer-30",Inner11:"attr-view-layer-31",Inner12:"attr-view-layer-32",Inner13:"attr-view-layer-33",Inner14:"attr-view-layer-34",Inner15:"attr-view-layer-35",Inner16:"attr-view-layer-36",Inner17:"attr-view-layer-37",Inner18:"attr-view-layer-38",Inner19:"attr-view-layer-39",Inner20:"attr-view-layer-40",Inner21:"attr-view-layer-41",Inner22:"attr-view-layer-42",Inner23:"attr-view-layer-43",Inner24:"attr-view-layer-44",Inner25:"attr-view-layer-45",Inner26:"attr-view-layer-46",Inner27:"attr-view-layer-47",Inner28:"attr-view-layer-48",Inner29:"attr-view-layer-49",Inner30:"attr-view-layer-50",Inner31:"attr-view-layer-51",Inner32:"attr-view-layer-52",Substrate1:"attr-view-layer-53",Substrate2:"attr-view-layer-54",Substrate3:"attr-view-layer-55",Substrate4:"attr-view-layer-56",Substrate5:"attr-view-layer-57",Substrate6:"attr-view-layer-58",Substrate7:"attr-view-layer-59",Substrate8:"attr-view-layer-60",Substrate9:"attr-view-layer-61",Substrate10:"attr-view-layer-62",Substrate11:"attr-view-layer-63",Substrate12:"attr-view-layer-64",Substrate13:"attr-view-layer-65",Substrate14:"attr-view-layer-66",Substrate15:"attr-view-layer-67",Substrate16:"attr-view-layer-68",Substrate17:"attr-view-layer-69",Substrate18:"attr-view-layer-70",Substrate19:"attr-view-layer-71",Substrate20:"attr-view-layer-72",Substrate21:"attr-view-layer-73",Substrate22:"attr-view-layer-74",Substrate23:"attr-view-layer-75",Substrate24:"attr-view-layer-76",Substrate25:"attr-view-layer-77",Substrate26:"attr-view-layer-78",Substrate27:"attr-view-layer-79",Substrate28:"attr-view-layer-80",Substrate29:"attr-view-layer-81",Substrate30:"attr-view-layer-82",Substrate31:"attr-view-layer-83",Substrate32:"attr-view-layer-84",Substrate33:"attr-view-layer-85"},C={};for(var L in P)C[P[L]]=L;var D=new c.a(i.a.WHITE,i.a.WHITE,i.a.WHITE,.1,1),M=new c.a(i.a.BLACK,i.a.BLACK,i.a.BLACK,.1,1),k=function(){function t(t,e,r,n){var c=this;this.layerGroup=new o.a,this.topModelGroup=new o.a,this.botModelGroup=new o.a,this.modelGroup=new o.a,this.bbox=new _.a,this.modelCache=new A.a,this.lastSubstrate=null,this.topIsolator=null,this.botIsolator=null,this.zIndex=0,this.index=0,this.substrateCnt=0,this.tick=0,this.idleStart=0,this.botModelZindex=null,this.botModelIndex=null,this.bboxChanged=!1,this.settings=r,this.updateHandlers=n,this.renderer=new s.a(e,{stencil:!0,depth:!0});var f=this.renderer.width(),p=this.renderer.height(),d=new l.a(Math.PI/4,f/p,.5,100,new u.a(0,-10,10)),y=new h.a(new i.a(.5,.5,.5)),b=new h.b(new i.a(.8,.8,.8),new u.a(0,0,10)),v=new a.a(this.renderer,d,y,b);v.group.add(this.layerGroup),v.group.add(this.modelGroup),this.modelGroup.add(this.topModelGroup),this.modelGroup.add(this.botModelGroup);var m=new w(e,v.group,d,(function(){c.updateTick()}));m.install(),this.control=m,this.scene=v,window.addEventListener("resize",(function(){c.scene.reset(),c.updateTick()}),!1),n.push((function(t){if(t instanceof E.a)"fogColor"===t.type&&c.setFogColor(t.value);else if(t instanceof E.d)"3DModel"===t.layer&&c.setModelVisible(t.layer,t.visible);else if(t instanceof E.b)c.clearAndSet3DModel(t);else if(t instanceof E.e){if(null!==c.botModelIndex&&null!==c.botModelZindex){var e=t.scale/10/Math.max(c.substrateCnt,1),r=t.distance;c.botModelGroup.setPosition(new u.a(0,0,c.botModelZindex*e-r*c.botModelIndex))}}else t instanceof E.c&&c.scene.render()})),this.loadPCB(t),this.render()}return t.prototype.render=function(){var t=performance.now();this.bboxChanged&&this.bbox.isValid()&&(this.updateScale(),this.bboxChanged=!1),this.tick>0&&(this.scene.antialias=!1,this.scene.render(),this.tick=0,this.idleStart=t),!this.scene.antialias&&t-this.idleStart>1e3&&(this.scene.antialias=!0,this.scene.render()),requestAnimationFrame(this.render.bind(this))},t.prototype.updateTick=function(){this.tick++},t.prototype.setFogColor=function(t){this.renderer.setClearColor(i.a.of3(t)),this.updateTick()},t.prototype.setModelVisible=function(t,e){var r=P[t];e===("visible"===this.settings[r])&&(e?(this.scene.group.add(this.modelGroup),this.settings[r]="visible"):(this.scene.group.remove(this.modelGroup),this.settings[r]="invisible")),this.updateTick()},t.prototype.clearAndSet3DModel=function(t){this.topModelGroup.clear(),this.botModelGroup.clear(),this.preLoadModel(t.id,{id:t.id,width:t.width,height:t.height,isTop:!0,originRotation:0,originX:t.originX,originY:-t.originY,rx:t.rx,ry:t.ry,rz:t.rz,x:t.x,y:t.y,z:t.z,zIndex:0})},t.prototype.locadPCBLayer=function(t){var e,r;this.index++;var n=null,i=this.zIndex;switch(t.material){case"silk":n=new y.a(t.data,D),this.zIndex-=.1;break;case"solder-mask":n=new y.a(t.data,new c.a(I.blue,I.blue,I.blue,.5,.9));var o=new y.a(n.geometry,new c.a(I.black,I.black,I.black,0,1));"TopSolderMaskLayer"==t.name?this.topIsolator=o.setPosition(new u.a(0,0,.05)):"BottomSolderMaskLayer"==t.name&&(this.botIsolator=o.setPosition(new u.a(0,0,-10.05)),null!==this.lastSubstrate&&this.lastSubstrate.add(o)),this.zIndex-=.1;break;case"paste":n=new y.a(t.data,p),this.zIndex-=.1;break;case"copper":n=new y.a(t.data,f),this.zIndex-=.1;break;case"substrate":n=this.gnrSubstrate(t.data,new c.a(I.board,I.board,I.board,.1,1),10),null!==this.topIsolator&&n.add(this.topIsolator),this.lastSubstrate=n,this.zIndex-=10.1,this.substrateCnt++;break;case"3dmodel":var a="Top"===t.name;try{for(var s=R(t.data),l=s.next();!l.done;l=s.next()){var h=l.value;h.isTop=a,this.preLoadModel(h.id,h)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}null===this.botModelIndex&&null===this.botModelZindex&&(this.botModelIndex=this.index,this.botModelZindex=this.zIndex+.1,this.botModelGroup.setPosition(new u.a(0,0,this.botModelZindex))),this.settings["attr-view-layer-19"]="visible"}if(null!==n){var d=n.bbox();null!==d&&this.bbox.ext1(d.minX,d.minY,i,d.maxX,d.maxY,i),n.setPosition(new u.a(0,0,i)),t.name in P&&(this.settings[P[t.name]]="visible"),this.updateHandlers.push(this.pcbLayerEvents(t,n,i)),this.layerGroup.add(n)}},t.prototype.pcbLayerEvents=function(t,e,r){var n=this.index,i=this;return function(o){if(o instanceof E.d)o.layer==t.name&&(o.visible?(null!==e&&i.layerGroup.add(e),i.tryShowIsolator1(t.name),i.settings[P[t.name]]="visible"):(null!==e&&i.layerGroup.remove(e),i.tryHideIsolator1(t.name),i.settings[P[t.name]]="invisible"),i.updateTick());else if(o instanceof E.e){if(null!==e){o.distance>0?i.tryHideIsolator2(t.name):i.tryShowIsolator2(t.name);var a=o.scale/10/i.substrateCnt,s=o.distance;e.setScale(new u.a(1,1,a)),e.setPosition(new u.a(0,0,r*a-s*n)),i.updateTick()}}else if(o instanceof E.a)if("boardColor"===o.type){if(e instanceof y.a)if("solder-mask"==t.material){var l=I[o.value];null!=l&&(e.material=new c.a(l,l,l,.5,e.material.opacity),i.updateTick())}else"silk"==t.material&&("white"==o.value?(e.material=M,i.updateTick()):(e.material=D,i.updateTick()))}else"solderColor"===o.type&&e instanceof y.a&&"paste"==t.material&&("silver"==o.value?e.material=d:"gold"==o.value&&(e.material=p),i.updateTick())}},t.prototype.tryScale=function(t,e,r){var n=v.a.scale(e).multiply4(r);return(t=t.transform(n)).minX>=-1&&t.minY>=-1&&t.maxX<=1&&t.maxY<=1},t.prototype.updateScale=function(){var t=this.bbox.build(),e=t.center(),r=new u.a(-e.x,-e.y,-e.z);t=t.transform(v.a.translate1(r));for(var n=this.scene.camera.viewMatrix().inverse().multiply4(this.scene.camera.projectionMatrix()),i=this.tryScale(t,1,n)?1.1:.9,o=i,a=0;a<100;a++){if(o>1!==this.tryScale(t,o,n)){o>1&&(o/=i);break}o*=i}this.layerGroup.setPosition(r),this.modelGroup.setPosition(r),this.scene.group.setScale(new u.a(o,o,o)),this.updateTick()},t.prototype.loadPCB=function(t){var e,r;if(null!==t){try{for(var n=R(t),i=n.next();!i.done;i=n.next()){var o=i.value;this.locadPCBLayer(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}this.bbox.isValid()&&(this.bboxChanged=!0)}},t.prototype.gnrSubstrate=function(t,e,r){var n,i,a,s;N.a.positive(r);var l=new o.a,h=-r,c=new y.a(t,e);c.setPosition(new u.a(0,0,0)),l.add(c);var f=new y.a(t,e);f.setPosition(new u.a(0,0,h)),l.add(f);var p=new Array;try{for(var d=R(t.vertexsGroup),v=d.next();!v.done;v=d.next()){var m=v.value,w=null;try{for(var g=(a=void 0,R(m)),x=g.next();!x.done;x=g.next()){var O=x.value;null!==w&&(p.push(new u.a(w.x,w.y,h)),p.push(new u.a(O.x,O.y,h)),p.push(new u.a(O.x,O.y,0)),p.push(new u.a(O.x,O.y,0)),p.push(new u.a(w.x,w.y,0)),p.push(new u.a(w.x,w.y,h))),w=O}}catch(t){a={error:t}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}}}catch(t){n={error:t}}finally{try{v&&!v.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}var E=new b.a(p);return l.add(new y.a(E,e)),l},t.prototype.preLoadModel=function(t,e){if(t.indexOf("\n")>=0)this.loadModel(Object(x.a)(t),e);else{var r=this.modelCache.get(t);void 0!==r?Array.isArray(r)?r.push(e):this.loadModel(r,e):(this.modelCache.put(t,[e]),fetch(g.a.prefix()+"/api/3dmodel/"+t,{cache:"no-cache",credentials:"same-origin"}).then(this.onModelData(t),(function(){})))}},t.prototype.onModelData=function(t){var e=this;return function(r){return T(this,void 0,void 0,(function(){var n,i,o,a;return S(this,(function(s){switch(s.label){case 0:return r.ok?(n=e.modelCache.get(t),Array.isArray(n)?(o=x.a,[4,r.text()]):[3,2]):[3,3];case 1:for(i=o.apply(void 0,[s.sent()]),e.modelCache.put(t,i);void 0!==(a=n.shift());)e.loadModel(i,a);s.label=2;case 2:return[3,4];case 3:throw r;case 4:return[2]}}))}))}},t.prototype.loadModel=function(t,e){var r=new v.a,n=t.bbox();if(null!==n){var i=(n.maxX+n.minX)/2,a=(n.maxY+n.minY)/2,s=n.minZ;r=r.translate(new u.a(-i,-a,-s));var l=O.a.toRadians(e.rx),h=O.a.toRadians(e.ry),c=O.a.toRadians(e.rz);r=r.rotateZ(c).rotateX(l).rotateY(h);var f=e.width/(n.maxX-n.minX),p=e.height/(n.maxY-n.minY),d=Math.min(f,p);r=(r=r.scale(d)).translate(new u.a(e.x,e.y,e.z)),e.isTop||(r=r.rotateY(Math.PI));var y=O.a.toRadians(e.originRotation);r=(r=r.rotateZ(y)).translate(new u.a(e.originX,e.originY,0));var b=new o.a;b.add(t),b.setAddiMatrix(r),this.bbox.ext4(n.transform(r)),this.bboxChanged=!0,e.isTop?this.topModelGroup.add(b):this.botModelGroup.add(b),this.updateTick()}},t.prototype.chooseIsolator=function(t){return"TopSolderMaskLayer"===t?this.topIsolator:"BottomSolderMaskLayer"===t?this.botIsolator:null},t.prototype.tryHideIsolator1=function(t){var e=this.chooseIsolator(t);if(null!==e){var r=e.getPosition();e.setPosition(new u.a(1e5,r.y,r.z))}},t.prototype.tryShowIsolator1=function(t){var e=this.chooseIsolator(t);if(null!==e){var r=e.getPosition();e.setPosition(new u.a(0,r.y,r.z))}},t.prototype.tryHideIsolator2=function(t){var e=this.chooseIsolator(t);if(null!==e){var r=e.getPosition();e.setPosition(new u.a(r.x,1e5,r.z))}},t.prototype.tryShowIsolator2=function(t){var e=this.chooseIsolator(t);if(null!==e){var r=e.getPosition();e.setPosition(new u.a(r.x,0,r.z))}},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){}},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(22),i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=function(){function t(){this.inner=new Array}return t.prototype.contains=function(t){var e,r;try{for(var n=i(this.inner),o=n.next();!o.done;o=n.next()){if(o.value.equals(t))return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.add=function(t){this.contains(t)||this.inner.push(t)},t.prototype.addAll1=function(t){this.addAll2(t.iterator())},t.prototype.addAll2=function(t){var e=this;Object(n.c)(t,(function(t,r){return e.add(r),!0}))},t.prototype.array=function(){return this.inner},t.prototype.size=function(){return this.inner.length},t.prototype.isEmpty=function(){return 0===this.inner.length},t.prototype.iterator=function(){return Object(n.a)(this.inner)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var n=r(0),i=r(40),o=r(1),a=r(71),s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},u=function(t,e,r,n,i,o,a){this.id=t,this.name=e,this.color=r,this.visible=n,this.active=i,this.config=o,this.isSignal=!0,this.layer=a},l=function(){function t(t,e){this.idIndex={},this.layers=new a.a,this.define(1,"TopLayer",16711680,!0,!0,!0,n.a.TOP_COPPER,0),this.define(2,"BottomLayer",255,!0,!1,!0,n.a.BOT_COPPER,0),this.define(3,"TopSilkLayer",16763904,!0,!1,!0,n.a.TOP_SILK,0),this.define(4,"BottomSilkLayer",6736947,!0,!1,!0,n.a.BOT_SILK,0),this.define(5,"TopPasteMaskLayer",8421504,!0,!1,!0,n.a.TOP_PASTE,0),this.define(6,"BottomPasteMaskLayer",8388608,!0,!1,!0,n.a.BOT_PASTE,0),this.define(7,"TopSolderMaskLayer",8388736,!0,!1,!0,n.a.TOP_SOLDER_MASK,0),this.define(8,"BottomSolderMaskLayer",11141375,!0,!1,!0,n.a.BOT_SOLDER_MASK,0),this.define(9,"Ratlines",6579455,!0,!1,!0,n.a.RATELINE,0),this.define(10,"BoardOutLine",16711935,!0,!1,!0,n.a.OUTLINE,0),this.define(11,"Multi-Layer",12632256,!0,!1,!0,n.a.MULTI,0),this.define(12,"Document",16777215,!0,!1,!0,n.a.DOCUMENT,0),this.define(13,"TopAssembly",3394713,!0,!1,!0,n.a.MECHANICAL,2),this.define(14,"BottomAssembly",5592575,!0,!1,!0,n.a.MECHANICAL,3),this.define(15,"Mechanical",15737584,!1,!1,!1,n.a.MECHANICAL,1),this.define(19,"3DModel",6737151,!1,!1,!1,n.a.MODEL,0),this.define(21,"Inner1",10066278,!1,!1,!1,n.a.INNER,1),this.define(22,"Inner2",32768,!1,!1,!1,n.a.INNER,2),this.define(23,"Inner3",65280,!1,!1,!1,n.a.INNER,3),this.define(24,"Inner4",12357120,!1,!1,!1,n.a.INNER,4),this.define(25,"Inner5",7396346,!1,!1,!1,n.a.INNER,5),this.define(26,"Inner6",52326,!1,!1,!1,n.a.INNER,6),this.define(27,"Inner7",10053375,!1,!1,!1,n.a.INNER,7),this.define(28,"Inner8",8388736,!1,!1,!1,n.a.INNER,8),this.define(29,"Inner9",32896,!1,!1,!1,n.a.INNER,9),this.define(30,"Inner10",1413983,!1,!1,!1,n.a.INNER,10),this.define(31,"Inner11",128,!1,!1,!1,n.a.INNER,11),this.define(32,"Inner12",46080,!1,!1,!1,n.a.INNER,12),this.define(33,"Inner13",3032918,!1,!1,!1,n.a.INNER,13),this.define(34,"Inner14",10060847,!1,!1,!1,n.a.INNER,14),this.define(35,"Inner15",16777130,!1,!1,!1,n.a.INNER,15),this.define(36,"Inner16",10060847,!1,!1,!1,n.a.INNER,16),this.define(37,"Inner17",3032918,!1,!1,!1,n.a.INNER,17),this.define(38,"Inner18",3487231,!1,!1,!1,n.a.INNER,18),this.define(39,"Inner19",8388796,!1,!1,!1,n.a.INNER,19),this.define(40,"Inner20",4435551,!1,!1,!1,n.a.INNER,20),this.define(41,"Inner21",12840142,!1,!1,!1,n.a.INNER,21),this.define(42,"Inner22",7506296,!1,!1,!1,n.a.INNER,22),this.define(43,"Inner23",3756095,!1,!1,!1,n.a.INNER,23),this.define(44,"Inner24",815453,!1,!1,!1,n.a.INNER,24),this.define(45,"Inner25",5933696,!1,!1,!1,n.a.INNER,25),this.define(46,"Inner26",2855806,!1,!1,!1,n.a.INNER,26),this.define(47,"Inner27",2333085,!1,!1,!1,n.a.INNER,27),this.define(48,"Inner28",4568291,!1,!1,!1,n.a.INNER,28),this.define(49,"Inner29",2186657,!1,!1,!1,n.a.INNER,29),this.define(50,"Inner30",4547799,!1,!1,!1,n.a.INNER,30),this.define(51,"Inner31",6908393,!1,!1,!1,n.a.INNER,31),this.define(52,"Inner32",9464297,!1,!1,!1,n.a.INNER,32),this.define(99,"ComponentShapeLayer",52428,!1,!1,!1,n.a.MECHANICAL,4),this.define(100,"LeadShapeLayer",13408665,!1,!1,!1,n.a.MECHANICAL,5),this.define(101,"ComponentPolarityLayer",6750156,!1,!1,!1,n.a.MECHANICAL,6),this.logger=t,this.reOrderLayers(e)}return t.prototype.reOrderLayers=function(t){var e,r,i=20;if(null!==t&&t.length>0)try{for(var o=s(t),a=o.next();!a.done;a=o.next()){var u=a.value;if(u.type===n.a.INNER||u.type===n.a.PLANE){i++;var l=this.idIndex[i];l.isSignal=u.type===n.a.INNER,this.logger.debug3("alias %s to %s",u,l.layer)}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}},t.prototype.info1=function(t){return o.a.notNullOrUndef(this.idIndex[t])},t.prototype.info2=function(t){switch(t.type){case n.a.MULTI:return this.idIndex[11];case n.a.RATELINE:return this.idIndex[9];case n.a.BOT_COPPER:return this.idIndex[2];case n.a.BOT_PASTE:return this.idIndex[6];case n.a.BOT_SILK:return this.idIndex[4];case n.a.BOT_SOLDER_MASK:return this.idIndex[8];case n.a.DOCUMENT:return this.idIndex[12];case n.a.INNER:return this.info1(Math.min(20+t.order,52));case n.a.PLANE:var e=this.info1(Math.min(20+t.order,52));return e.isSignal=!1,e;case n.a.OTHER:case n.a.MECHANICAL:return this.idIndex[15];case n.a.OUTLINE:return this.idIndex[10];case n.a.MODEL:return this.idIndex[19];case n.a.TOP_COPPER:return this.idIndex[1];case n.a.TOP_PASTE:return this.idIndex[5];case n.a.TOP_SILK:return this.idIndex[3];case n.a.TOP_SOLDER_MASK:return this.idIndex[7];default:return this.logger.warning3("unsupported layer type %d, use Document instead",t.type),this.idIndex[12]}},t.prototype.encode=function(t){var e=this.idIndex[t];return null===e?(this.logger.warning3("unknown layer id %d, use Document layer instead",t),this.idIndex[12].layer):e.layer.type===n.a.INNER?e.isSignal?e.layer:new n.c(n.a.PLANE,e.layer.order):e.layer},t.prototype.define=function(t,e,r,o,a,s,l,h){var c=new n.c(l,h),f=new u(t,e,i.a.of(r),o,a,s,c);this.idIndex[t]=f,this.layers.add(f)},t.prototype.iterator=function(){return this.layers.iterator()},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return O}));var n,i=r(0),o=r(108),a=r(6),s=(r(14),r(8)),u=r(2),l=r(18),h=r(30),c=r(9),f=r(36),p=r(26),d=r(17),y=r(66),b=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),v=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},m=(new i.c(i.a.INNER,1),new i.c(i.a.INNER,2),new i.c(i.a.INNER,3)),w=new i.c(i.a.INNER,4),g=new i.c(i.a.INNER,5),x=new i.c(i.a.INNER,6),O=function(t){function e(e){var r=t.call(this)||this;return r.shapes=[],r.debug=e,r}return b(e,t),e.prototype.display=function(){var t=new y.b;return t.contributor="",t.sourceName="",t.scale=10,a.a.addAll(t.shapes,this.shapes),t.build()},e.prototype.onPolylineGroup=function(t,e){var r,n;if(this.debug)try{for(var i=v(t.items),o=i.next();!o.done;o=i.next()){var a=o.value;this.debug1(g,e.toString(),a)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.onRTreeBBox=function(t){this.debug},e.prototype.onSegment=function(t,e,r,n,o,a){if(this.debug){var l=s.a.format("SG (%d,%d,%d) : (%d,%d,%d) : %s : %s",r.polyGrp,r.polyIndex,e,a.polyGrp,a.polyIndex,o,t,n);this.debug2(i.c.BOT_COPPER,l,new u.a(t,n),.003)}},e.prototype.onIntersect=function(t,e,r){this.debug},e.prototype.onResultSide=function(t){this.debug&&this.debug2(w,t.toString(),t.shape,.003)},e.prototype.onOriginSide=function(t){this.debug&&this.debug2(i.c.TOP_COPPER,t.toString(),t.shape,.003)},e.prototype.onSplitedSide=function(t){this.debug&&this.debug2(m,t.toString(),t.shape,.003)},e.prototype.onDebugSide=function(t){this.debug&&this.debug2(x,t.toString(),t.shape,.003)},e.prototype.onSweep=function(t,e,r,n,i,o){this.debug},e.prototype.debug1=function(t,e){for(var r,n,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];try{for(var a=v(i),s=a.next();!s.done;s=a.next()){var u=s.value;this.shapes.push(new l.a(e,t,l.b.SOLID,u))}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e.prototype.debug2=function(t,e,r,n){r instanceof u.a?this.shapes.push(new h.a(e,t,r.start(),r.end(),n,!1)):r instanceof c.a?this.shapes.push(new f.a(e,t,r,n,!1)):this.debug1(t,e,r.stroke(n,p.a.BUTT,d.a.CW))},e}(o.a)},function(t,e,r){"use strict";function n(t){throw new Error("")}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n,i=r(8),o=r(2),a=r(9),s=r(17),u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},h=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t};!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.ENC_LINE=1]="ENC_LINE",t[t.ENC_ARC=2]="ENC_ARC"}(n||(n={}));var c=i.a.fmtNumber,f=function(){function t(){this.state=n.UNKNOWN,this.prev=null,this.buffer=new Array}return t.prototype.encPl=function(t){var e,r;try{for(var n=u(t.primitives),i=n.next();!i.done;i=n.next()){var o=i.value;this.encPt(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.encPt=function(t){if(t instanceof o.a)this.encLine1(t);else{if(!(t instanceof a.a))throw new Error("");this.encArc(t)}},t.prototype.encArc=function(t){var e=t.svgEnd;this.state===n.UNKNOWN?this.out("M %s %s A %s %s %s %d %d %s %s ",c(t.start().x),c(-t.start().y),c(t.rx),c(t.ry),0,t.isLarge()?1:0,t.sweep()===s.a.CCW?0:1,c(e.x),c(-e.y)):t.start().equals(this.prev)?this.state!==n.ENC_ARC?this.out("A %s %s %s %d %d %s %s ",c(t.rx),c(t.ry),0,t.isLarge()?1:0,t.sweep()===s.a.CCW?0:1,c(e.x),c(-e.y)):this.out("%s %s %s %d %d %s %s ",c(t.rx),c(t.ry),0,t.isLarge()?1:0,t.sweep()===s.a.CCW?0:1,c(e.x),c(-e.y)):this.out("L %s %s A %s %s %s %d %d %s %s ",c(t.start().x),c(-t.start().y),t.rx,t.ry,0,t.isLarge()?1:0,t.sweep()===s.a.CCW?0:1,c(e.x),c(-e.y)),this.prev=e,this.state=n.ENC_ARC},t.prototype.encLine1=function(t){this.encLine2(t.start(),t.end())},t.prototype.encLine2=function(t,e){this.state===n.UNKNOWN?this.out("M %s %s L %s %s ",c(t.x),c(-t.y),c(e.x),c(-e.y)):(this.state!==n.ENC_LINE&&this.out("L "),t.equals(this.prev)?this.out("%s %s ",c(e.x),c(-e.y)):this.out("%s %s %s %s ",c(t.x),c(-t.y),c(e.x),c(-e.y))),this.prev=e,this.state=n.ENC_LINE},t.prototype.close=function(t){this.state!==n.UNKNOWN&&(t&&this.out("Z "),this.state=n.UNKNOWN,this.prev=null)},t.prototype.toString=function(){return this.buffer.join("")},t.prototype.out=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];0===e.length?this.buffer.push(t):this.buffer.push(i.a.format.apply(i.a,h([t],e)))},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return o}));var n=r(11),i=function(t){this.color=t},o=function(){function t(t,e,r){void 0===r&&(r=n.a.ORIGIN),this.color=t,this.position=e,this.target=r}return t.prototype.direction=function(){return this.target.sub(this.position)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return B}));var n,i=r(59),o=r(43),a=r(95),s=r(0),u=r(15),l=r(10),h=r(30),c=r(111),f=r(8),p=r(44),d=r(20),y=r(47),b=r(36),v=r(18),m=r(55),w=r(63),g=r(1),x=r(2),O=r(9),E=r(17),_=r(12),N=r(27),A=r(54),T=r(39),S=r(64),R=r(53),I=r(60),P=r(6),C=r(7),L=r(5),D=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),M=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},k=new L.a(1500,1500),U=new u.c(u.d.ROUND,0,0,0,null),B=function(t){function e(e,r){var n=t.call(this,r)||this;return n.comp_idx=-1,n.net_idx=0,n.polygon_idx=-1,n.comp=null,n.nets=new N.a,n.usedLayers=new a.a,n.doc=e,n}return D(e,t),e.prototype.net=function(t){var e=this;if(!g.a.nullOrEmpty(t)){var r=this.nets.computeIfAbsent(t,(function(){return e.net_idx++}));this.item("NET",r)}},e.prototype.autoPO=function(t){switch(t){case u.d.ROUND:return"ROUND";case u.d.RECTANGLE:return"RECTANGLE";case u.d.OCTAGONAL:return"OCTAGONAL";case u.d.ROUND_RECTANGLE:return"ROUNDEDRECTANGLE";default:return this.logger.warning3("unknow pad out shape %s",t),"ROUND"}},e.prototype.autoLayer=function(t){switch(this.usedLayers.add(t),t.type){case s.a.TOP_COPPER:return"TOP";case s.a.TOP_PASTE:return"TOPPASTE";case s.a.TOP_SILK:return"TOPOVERLAY";case s.a.TOP_SOLDER_MASK:return"TOPSOLDER";case s.a.BOT_COPPER:return"BOTTOM";case s.a.BOT_PASTE:return"BOTTOMPASTE";case s.a.BOT_SILK:return"BOTTOMOVERLAY";case s.a.BOT_SOLDER_MASK:return"BOTTOMSOLDER";case s.a.PLANE:return"PLANE"+t.order;case s.a.INNER:return"MID"+t.order;case s.a.MECHANICAL:return"MECHANICAL"+t.order;case s.a.MULTI:return"MULTILAYER";case s.a.OTHER:return"MECHANICAL16";case s.a.OUTLINE:return"KEEPOUT";case s.a.DOCUMENT:return"MECHANICAL15";default:return this.logger.warning3("unknow layer type %d use mechanical instead",Object(s.b)(t.type)),"MECHANICAL16"}},e.prototype.autoMil=function(t){return this.autoD(t)+"mil"},e.prototype.export=function(){var t,e,r,n,a,u,p,d,y,b,v,m,w,g,x,O,E=this,_=new C.b;try{for(var N=M(this.doc.shapes),A=N.next();!A.done;A=N.next()){var T=A.value;_.ext1(T.bbox())}}catch(e){t={error:e}}finally{try{A&&!A.done&&(e=N.return)&&e.call(N)}finally{if(t)throw t.error}}if(_.valid()){var S=_.build(),R=l.a.translate(-S.minX,-S.minY).scale(this.doc.scale).translate1(k),I=new Array,P=new Array;try{for(var L=M(this.doc.shapes),D=L.next();!D.done;D=L.next()){var U=(T=D.value)instanceof o.a;try{for(var B=(a=void 0,M(this.dispatcher(T.multiply3(R)))),F=B.next();!F.done;F=B.next()){var Y=F.value;U?(U=!1,I.push(Y)):P.push(Y)}}catch(t){a={error:t}}finally{try{F&&!F.done&&(u=B.return)&&u.call(B)}finally{if(a)throw a.error}}}}catch(t){r={error:t}}finally{try{D&&!D.done&&(n=L.return)&&n.call(L)}finally{if(r)throw r.error}}if(S=S.transform(R),!this.usedLayers.contains(s.c.DOCUMENT)){var G=new h.a("",s.c.DOCUMENT,S.center().add1(-1,-1),S.center().add1(1,1),.1,!1);P.push(this.gnrPcbTrack(G)[0])}var z=new Array;this.item("RECORD","Board"),this.item("KIND","Protel_Advanced_PCB"),this.item("VERSION","5.00");for(var W=[S.LR().add1(500,-500),S.LL().add1(-500,-500),S.UL().add1(-500,500),S.UR().add1(500,500),S.LR().add1(500,-500)],X=0;X<W.length;X++){var j=W[X];this.item("KIND"+X,this.autoD(0)),this.item("VX"+X,this.autoMil(j.x)),this.item("VY"+X,this.autoMil(j.y)),this.item("CX"+X,this.autoMil(0)),this.item("CY"+X,this.autoMil(0)),this.item("SA"+X,this.autoD(0)),this.item("EA"+X,this.autoD(0)),this.item("R"+X,this.autoMil(0))}z.push(this.obGetClean());try{for(var H=M((new c.a).layers()),V=H.next();!V.done;V=H.next()){(Y=V.value).id%5==1&&(z.push(this.obGetClean()),this.item("RECORD","Board"));var K=f.a.format("LAYER%d",Y.id);this.item(K+"NAME",Y.name);var Z=void 0;switch(Y.name){case"Top Layer":Z=32;break;case"Top Overlay":case"Top Paste":case"Top Solder":Z=1;break;default:Z=0}if(f.a.startsWith(Y.name,"Mechanical")){var q=parseInt(Y.name.substring("Mechanical ".length));(this.usedLayers.contains(new s.c(s.a.MECHANICAL,q))||15===q&&this.usedLayers.contains(s.c.DOCUMENT)||16===q&&this.usedLayers.contains(s.c.OTHER))&&this.item(K+"MECHENABLED","TRUE")}this.item(K+"NEXT",Z),this.item(K+"DIELTYPE","0"),this.item(K+"DIELCONST","4.800"),this.item(K+"DIELHEIGHT","12.6mil"),this.item(K+"DIELMATERIAL","FR-4")}}catch(t){p={error:t}}finally{try{V&&!V.done&&(d=H.return)&&d.call(H)}finally{if(p)throw p.error}}z.push(this.obGetClean());var Q=new Array;this.nets.iterator((function(t,e){return E.item("RECORD","Net"),E.item("ID",e),E.item("NAME",t),E.item("VISIBLE","FALSE"),E.item("JUMPERSVISIBLE","FALSE"),Q.push(E.obGetClean()),!0}));var J=!0,$=new Array;try{for(var tt=M(z),et=tt.next();!et.done;et=tt.next()){(it=et.value).length>0&&(J?J=!1:$.push(i.c),$.push(it))}}catch(t){y={error:t}}finally{try{et&&!et.done&&(b=tt.return)&&b.call(tt)}finally{if(y)throw y.error}}try{for(var rt=M(Q),nt=rt.next();!nt.done;nt=rt.next()){var it=nt.value;$.push(i.b),$.push(it)}}catch(t){v={error:t}}finally{try{nt&&!nt.done&&(m=rt.return)&&m.call(rt)}finally{if(v)throw v.error}}try{for(var ot=M(I),at=ot.next();!at.done;at=ot.next()){it=at.value;$.push(i.b),$.push(it)}}catch(t){w={error:t}}finally{try{at&&!at.done&&(g=ot.return)&&g.call(ot)}finally{if(w)throw w.error}}try{for(var st=M(P),ut=st.next();!ut.done;ut=st.next()){it=ut.value;$.push(i.b),$.push(it)}}catch(t){x={error:t}}finally{try{ut&&!ut.done&&(O=st.return)&&O.call(st)}finally{if(x)throw x.error}}return $.push(i.b),$}return null},e.prototype.dispatcher=function(t){return t instanceof h.a?this.gnrPcbTrack(t):t instanceof p.a?this.gnrPcbString(t):t instanceof d.b?this.gnrPcbPolygonPour(t):t instanceof y.a?this.gnrPcbVia(t):t instanceof u.f?this.gnrPcbPad(t):t instanceof o.a?this.gnrPcbComponent(t):t instanceof b.a?this.gnrPcbArc(t):t instanceof v.a?this.gnrPcbRegion(t):t instanceof m.a?this.gnrPcbFill(t):t instanceof w.a?this.gnrPcbPlaneZone(t):t instanceof A.a?this.gnrPcbImage(t):(this.logger.warning3("%s is not supported",t),[])},e.prototype.gnrPcbImage=function(t){var e,r,n,i;if(null===this.comp){var a=new o.b;return a.location=t.bbox().UL(),a.pattern="IMPORTED_IMAGE",a.comment=new p.a(t.net,t.layer,a.location,0,a.pattern,new T.a("",1,1),!1),a.showComment=!1,a.designator=a.comment,a.showDesignator=!1,a.layer=t.layer,a.orientation=0,a.shapes.push(t),this.gnrPcbComponent(a.build())}var s=new I.a(!1),u=new S.a(R.a,this.logger,s);try{for(var l=M(t.plg),h=l.next();!h.done;h=l.next()){var c=h.value;u.addPolyline(c)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}u.simplify();var f=new Array;try{for(var d=M(s.plGrps),y=d.next();!y.done;y=d.next()){var b=y.value;f.push(this.gnrPcbImagePolygonGroup(t,b))}}catch(t){n={error:t}}finally{try{y&&!y.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}return f},e.prototype.gnrPcbImagePolygonGroup=function(t,e){this.item("RECORD","Region"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("POLYGONOUTLINE","FALSE"),this.item("ISSHAPEBASED","TRUE"),this.item("KIND","0");for(var r=e.items,n=0;n<r.length;n++){var i=r[n];if(0===n)if(0===i.primitives.length)this.item("MAINCONTOURVERTEXCOUNT",this.autoD(0));else{var o=i.primitives,a=i.closed()?o.length+1:o.length+2;this.item("MAINCONTOURVERTEXCOUNT",this.autoD(a)),this.generatePolygon(o)}else 1===n&&this.item("HOLECOUNT",this.autoD(r.length-1)),this.generatePolygonHole(i,n-1)}return this.obGetClean()},e.prototype.gnrPcbPlaneZone=function(t){return this.item("RECORD","Polygon"),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("POLYGONTYPE","Split Plane"),this.item("POLYGONOUTLINE","FALSE"),this.generatePolygon(t.outline.primitives),[this.obGetClean()]},e.prototype.gnrPcbTrack=function(t){return this.item("RECORD","Track"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("POLYGONOUTLINE",t.keepout?"TRUE":"FALSE"),this.item("X1",this.autoMil(t.start.x)),this.item("Y1",this.autoMil(t.start.y)),this.item("X2",this.autoMil(t.end.x)),this.item("Y2",this.autoMil(t.end.y)),this.item("WIDTH",this.autoMil(t.width)),[this.obGetClean()]},e.prototype.gnrPcbString=function(t){this.item("RECORD","Text"),null!==this.comp&&(this.item("COMPONENT",this.autoD(this.comp_idx)),t===this.comp.designator&&this.item("DESIGNATOR","True"),t===this.comp.comment&&this.item("COMMENT","True")),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),g.a.nullOrEmpty(t.font.familly)?(this.item("FONTNAME","Arial"),this.item("USETTFONTS","FALSE")):(this.item("FONTNAME",t.font.familly),this.item("USETTFONTS","TRUE"));for(var e=new Array,r=0;r<t.text.length;r++){var n=t.text.charCodeAt(r);e.push(n.toString())}return this.item("WIDESTRING",e.join(",")),t.text.indexOf("\n")>=0&&this.item("MULTILINE","TRUE"),this.item("WIDTH",this.autoMil(t.font.weight)),this.item("HEIGHT",this.autoMil(t.font.size)),this.item("ROTATION",this.autoD(t.rotation)),this.item("MIRROR",t.mirror?"TRUE":"FALSE"),this.item("X",this.autoMil(t.location.x)),this.item("Y",this.autoMil(t.location.y)),[this.obGetClean()]},e.prototype.gnrPcbPolygonPour=function(t){return this.item("RECORD","Polygon"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("ID",this.autoD(++this.polygon_idx)),this.item("POLYGONTYPE","Polygon"),this.item("POUROVERSTYLE",this.autoD(1)),this.item("HATCHSTYLE","Solid"),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.generatePolygon(t.outlines),[this.obGetClean()]},e.prototype.generatePolygonHole=function(t,e){var r,n,i,o,a=new Array;try{for(var s=M(t.asClosed().primitives),u=s.next();!u.done;u=s.next()){var l=u.value;try{for(var h=(i=void 0,M(l.points(1))),c=h.next();!c.done;c=h.next()){var f=c.value;a.push(f)}}catch(t){i={error:t}}finally{try{c&&!c.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.item("HOLE"+e+"VERTEXCOUNT",this.autoD(a.length));for(var p="H"+e,d=0;d<a.length;d++){f=a[d];this.item(p+"VX"+d,this.autoD(1e4*f.x)),this.item(p+"VY"+d,this.autoD(1e4*f.y))}},e.prototype.generatePolygon=function(t){var e,r,n=null,i=null,o=0;try{for(var a=M(t),s=a.next();!s.done;s=a.next()){var u=s.value;u instanceof x.a?(null===n&&(n=u.start()),i=u.end(),this.generatePolygonSideP(u.start(),o++)):u instanceof O.a&&(null===n&&(n=u.start()),i=u.end(),this.generatePolygonSideA(u,o++))}}catch(t){e={error:t}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}null!==i&&this.generatePolygonSideP(i,o++),null===n||n.equals(i)||this.generatePolygonSideP(n,o)},e.prototype.generatePolygonSideA=function(t,e){this.item("KIND"+e,this.autoD(1)),this.item("VX"+e,this.autoMil(t.start().x)),this.item("VY"+e,this.autoMil(t.start().y)),t.sweep()===E.a.CW&&(t=t.exchangeSweep()),this.item("CX"+e,this.autoMil(t.center.x)),this.item("CY"+e,this.autoMil(t.center.y)),this.item("SA"+e,this.autoD(t.startAngle)),this.item("EA"+e,this.autoD(t.endAngle())),this.item("R"+e,this.autoD(t.rx))},e.prototype.generatePolygonSideP=function(t,e){this.item("KIND"+e,this.autoD(0)),this.item("VX"+e,this.autoMil(t.x)),this.item("VY"+e,this.autoMil(t.y)),this.item("CX"+e,this.autoMil(0)),this.item("CY"+e,this.autoMil(0)),this.item("SA"+e,this.autoD(0)),this.item("EA"+e,this.autoD(0)),this.item("R"+e,this.autoMil(0))},e.prototype.gnrPcbVia=function(t){return this.item("RECORD","Via"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("SELECTION","FALSE"),isNaN(t.topPad)?isNaN(t.botPad)?this.item("STARTLAYER","MIDLAYER1"):this.item("STARTLAYER","BOTTOM"):this.item("STARTLAYER","TOP"),isNaN(t.botPad)?isNaN(t.topPad)?this.item("ENDLAYER","MIDLAYER1"):this.item("ENDLAYER","TOP"):this.item("ENDLAYER","BOTTOM"),this.item("LOCKED","FALSE"),this.item("X",this.autoMil(t.center.x)),this.item("Y",this.autoMil(t.center.y)),this.item("HOLESIZE",this.autoD(t.holeDiameter)),this.item("PADMODE",this.autoD(0)),this.item("TOPLAYERSIZE",this.autoMil(t.topPad)),this.item("MIDLAYER1SIZE",this.autoMil(t.innerPad)),this.item("BOTTOMLAYERSIZE",this.autoMil(t.botPad)),this.item("DIAMETER",this.autoD(t.innerPad)),[this.obGetClean()]},e.prototype.gnrPcbPad=function(t){var e,r,n,i,o,a=new Array,l=new Array,h=t.shapes,c=h.top,f=h.inner,p=h.bot;if(null!==c&&null!==c.outline){var d=c.outline;l.push(new v.a(t.net,s.c.TOP_COPPER,v.b.SOLID,d)),t.plated&&l.push(new v.a(t.net,s.c.TOP_PASTE,v.b.SOLID,d)),l.push(new v.a(t.net,s.c.TOP_SOLDER_MASK,v.b.SOLID,d)),c=U}if(null!==p&&null!==p.outline){d=p.outline;l.push(new v.a(t.net,s.c.BOT_COPPER,v.b.SOLID,d)),t.plated&&l.push(new v.a(t.net,s.c.BOT_PASTE,v.b.SOLID,d)),l.push(new v.a(t.net,s.c.BOT_SOLDER_MASK,v.b.SOLID,d)),p=U}if(null!==f&&null!==f.outline){d=f.outline;try{for(var y=M(this.doc.layerStack),b=y.next();!b.done;b=y.next()){var m=b.value;m.type===s.a.INNER&&l.push(new v.a(t.net,m,v.b.SOLID,d))}}catch(t){e={error:t}}finally{try{b&&!b.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}f=U}try{for(var w=M(l),x=w.next();!x.done;x=w.next()){var O=x.value;P.a.addAll(a,this.gnrPcbRegion(O))}}catch(t){n={error:t}}finally{try{x&&!x.done&&(i=w.return)&&i.call(w)}finally{if(n)throw n.error}}switch(this.item("RECORD","Pad"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("ROTATION",this.autoD(_.a.regularD(t.rotation))),this.item("NAME",t.designator),this.item("HOLEWIDTH",this.autoD(t.hole.length)),this.item("PLATED",t.plated?"TRUE":"FALSE"),t.hole.type){case u.b.ROUND:this.item("HOLETYPE",this.autoD(0));break;case u.b.SQUARE:this.item("HOLETYPE",this.autoD(1));break;case u.b.SLOT:this.item("HOLETYPE",this.autoD(2));break;default:this.logger.warning3("unknow hole shape %s",t.hole.type),this.item("HOLETYPE",this.autoD(0))}return this.item("HOLESIZE",this.autoMil(t.hole.size)),this.item("HOLEROTATION",this.autoD(_.a.regularD(t.hole.rotation))),this.item("PADXOFFSET0",this.autoMil(h.offsetX)),this.item("PADYOFFSET0",this.autoMil(h.offsetY)),this.item("X",this.autoMil(t.location.x)),this.item("Y",this.autoMil(t.location.y)),this.item("PADMODE",this.autoD(0)),null!==c&&null!==p?(this.item("TOPSHAPE",this.autoPO(c.type)),this.item("TOPXSIZE",this.autoMil(c.xSize)),this.item("TOPYSIZE",this.autoMil(c.ySize)),this.item("TOPLAYERCRPCT",this.autoD(c.cornerRadius)),this.item("BOTSHAPE",this.autoPO(p.type)),this.item("BOTXSIZE",this.autoMil(p.xSize)),this.item("BOTYSIZE",this.autoMil(p.ySize)),this.item("BOTTOMLAYERCRPCT",this.autoD(p.cornerRadius)),o=g.a.notnull(f)):null!==c?(o=c,this.item("TOPLAYERCRPCT",this.autoD(c.cornerRadius))):null!==p?(o=p,this.item("BOTTOMLAYERCRPCT",this.autoD(p.cornerRadius))):o=g.a.notnull(t.shapes.inner),this.item("SHAPE",this.autoPO(o.type)),this.item("XSIZE",this.autoMil(o.xSize)),this.item("YSIZE",this.autoMil(o.ySize)),this.item("MIDLAYER1CRPCT",this.autoD(o.cornerRadius)),a.push(this.obGetClean()),a},e.prototype.gnrPcbComponent=function(t){var e,r,n=new Array;this.comp_idx++,this.item("RECORD","Component"),this.item("ID",this.autoD(this.comp_idx)),this.item("LAYER",this.autoLayer(t.layer)),this.item("X",this.autoMil(t.location.x)),this.item("Y",this.autoMil(t.location.y)),this.item("ROTATION",this.autoD(t.orientation)),this.item("PATTERN",t.pattern),this.item("SOURCEDESIGNATOR",t.designator.text),this.item("NAMEON",t.showDesignator?"TRUE":"FALSE"),this.item("COMMENTON",t.showComment?"TRUE":"FALSE"),n.push(this.obGetClean()),this.comp=t,P.a.addAll(n,this.gnrPcbString(t.designator)),P.a.addAll(n,this.gnrPcbString(t.comment));try{for(var i=M(t.shapes),o=i.next();!o.done;o=i.next()){var a=o.value;P.a.addAll(n,this.dispatcher(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return this.comp=null,n},e.prototype.gnrPcbArc=function(t){var e=t.arc,r=e.start(),n=e.end();if(r.distance2(n)>1e-4||e.isLarge()){this.item("RECORD","Arc"),null===this.comp||this.item("COMPONENT",this.autoD(this.comp_idx));var i=t.arc;return i.sweep()===E.a.CW&&(i=i.exchangeSweep()),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("WIDTH",this.autoD(t.width)),this.item("LOCATION.X",this.autoMil(i.center.x)),this.item("LOCATION.Y",this.autoMil(i.center.y)),this.item("STARTANGLE",this.autoD(i.startAngle)),this.item("ENDANGLE",this.autoD(i.endAngle())),this.item("RADIUS",this.autoMil(i.rx)),this.item("SECONDARYRADIUS",this.autoMil(i.ry)),this.item("KEEPOUT",t.keepout?"TRUE":"FALSE"),[this.obGetClean()]}return this.gnrPcbTrack(new h.a(t.net,t.layer,r,n,t.width,t.keepout))},e.prototype.gnrPcbRegion=function(t){switch(this.item("RECORD","Region"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("POLYGONOUTLINE","FALSE"),this.item("ISSHAPEBASED","TRUE"),t.kind){case v.b.BOARD_CUTOUT:this.item("KIND","0"),this.item("ISBOARDCUTOUT","TRUE");break;case v.b.POLYGON_CUTOUT:this.item("KIND","1");break;case v.b.SOLID:this.item("KIND","0");break;default:this.logger.warning3("unknow region kind %s",t.kind),this.item("KIND","0")}if(0===t.outlines.primitives.length)this.item("MAINCONTOURVERTEXCOUNT",this.autoD(0));else{var e=t.outlines.primitives,r=t.outlines.closed()?e.length:e.length+1;this.item("MAINCONTOURVERTEXCOUNT",this.autoD(r)),this.generatePolygon(e)}return this.item("HOLECOUNT",this.autoD(0)),[this.obGetClean()]},e.prototype.gnrPcbFill=function(t){return this.item("RECORD","Fill"),null!==this.comp&&this.item("COMPONENT",this.autoD(this.comp_idx)),this.net(t.net),this.item("SELECTION","FALSE"),this.item("LAYER",this.autoLayer(t.layer)),this.item("LOCKED","FALSE"),this.item("ROTATION",this.autoD(t.rotation)),this.item("X1",this.autoMil(t.location1.x)),this.item("Y1",this.autoMil(t.location1.y)),this.item("X2",this.autoMil(t.location2.x)),this.item("Y2",this.autoMil(t.location2.y)),this.item("KEEPOUT",t.keepout?"TRUE":"FALSE"),[this.obGetClean()]},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t,e){this.geo1=t,this.geo2=e}return t.prototype.bbox=function(){return this.geo2.bbox()},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t,e,r,n){this.geo1=t,this.geo2=e,this.geo3=r,this.geo4=n}return t.prototype.bbox=function(){return this.geo2.bbox()},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r(48),i=r(57),o=r(11),a=r(41),s=r(21),u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(){this.idx=new Array,this.vs=new Array,this.ns=new Array,this.vIdx={},this.invalidNormal=0},h=function(t){this.ambient=null,this.diffuse=null,this.specular=null,this.d=0,this.name=t},c=new h("__default__");function f(t){var e=new n.a,r=new Array,f=new Array,p={},d=new l,y=null,b=null;p.__default__={material:c,vs:[],ns:[]};for(var v=0;;){var m=t.indexOf("\n",v);if(!(m>-1))break;var w=t.substring(v,m).replace(/^[\s\r\n]+|[\s\r\n]+$/,"");v=m+1;var g=w.split(/\s+/);switch(g.shift()){case"v":C(g);break;case"vn":L(g);break;case"f":D(g);break;case"newmtl":M(g);break;case"Ka":k(g);break;case"Kd":U(g);break;case"Ks":B(g);break;case"d":F(g);break;case"endmtl":Y(g);break;case"usemtl":G(g)}}for(var x in d.idx.length>0&&(z(d),d=new l),p){var O=p[x],E=O.material,_=O.vs,N=O.ns;if(_.length>0){var A=new i.a(_,N),T=E.ambient,S=E.diffuse,R=E.specular,I=Object(s.b)(T[0],T[1],T[2],S[0],S[1],S[2],R[0],R[1],R[2],1,1),P=new a.a(A,I);e.add(P)}}return e;function C(t){var e,n;try{for(var i=u(t),o=i.next();!o.done;o=i.next()){var a=o.value;r.push(parseFloat(a))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}function L(t){var e,r;try{for(var n=u(t),i=n.next();!i.done;i=n.next()){var o=i.value;f.push(parseFloat(o))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}}function D(t){var e,n,i=0,o=0,a=0;try{for(var s=u(t),l=s.next();!l.done;l=s.next()){var h=l.value,c=/(\d*)\/(\d*)\/(\d*)/.exec(h);if(null!==c){var p=3*(parseInt(c[1])-1),y=3*(parseInt(c[3])-1),b=r[p],v=r[p+1],m=r[p+2],w=f[y],g=f[y+1],x=f[y+2];void 0!==w&&void 0!==g&&void 0!==x||(d.invalidNormal+=1);var O=[p,w,g,x].join("|"),E=d.vIdx[O];"number"!=typeof E&&(E=d.vs.length/3,d.vIdx[O]=E,d.vs.push(b,v,m),d.ns.push(w,g,x)),i>=3&&(d.idx.push(o),d.idx.push(a)),d.idx.push(E),0===i&&(o=E),a=E,i++}}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}function M(t){y=new h(t.join(" "))}function k(t){y&&(y.ambient=[parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])])}function U(t){y&&(y.diffuse=[parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])])}function B(t){y&&(y.specular=[parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])])}function F(t){y&&(y.d=parseFloat(t[0]))}function Y(t){y&&y.ambient&&y.diffuse&&y.specular&&(p[y.name]={material:y,vs:[],ns:[]},y=null)}function G(t){d.idx.length>0&&(z(d),d=new l),b=t.join(" ")}function z(t){var e,r,n,i,a=p[b]||p.__default__,s=a.vs,l=a.ns;if(t.invalidNormal>0){var h=s.length;try{for(var c=u(t.idx),f=c.next();!f.done;f=c.next()){var d=f.value;d*=3,s.push(new o.a(t.vs[d],t.vs[d+1],t.vs[d+2]))}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}for(var y=h;y<s.length;y+=3){var v=s[y],m=s[y+1],w=s[y+2],g=o.a.normal(v,m,w);l.push(g),l.push(g),l.push(g)}}else try{for(var x=u(t.idx),O=x.next();!O.done;O=x.next()){d=O.value;d*=3,s.push(new o.a(t.vs[d],t.vs[d+1],t.vs[d+2])),l.push(new o.a(t.ns[d],t.ns[d+1],t.ns[d+2]))}}catch(t){n={error:t}}finally{try{O&&!O.done&&(i=x.return)&&i.call(x)}finally{if(n)throw n.error}}}}c.ambient=[0,0,0],c.diffuse=[0,0,0],c.specular=[0,0,0],c.d=1},function(t,e,r){"use strict";var n,i,o=r(76),a=r(4),s=r(56),u=r(70),l=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(t){t[t.UNKNOW=0]="UNKNOW",t[t.INSTRING=1]="INSTRING",t[t.INSTRING_ESCAPE=2]="INSTRING_ESCAPE",t[t.INSTRING_ESCAPE_UNICODE=3]="INSTRING_ESCAPE_UNICODE",t[t.INNUMBER=4]="INNUMBER",t[t.T=5]="T",t[t.TR=6]="TR",t[t.TRU=7]="TRU",t[t.F=8]="F",t[t.FA=9]="FA",t[t.FAL=10]="FAL",t[t.FALS=11]="FALS",t[t.N=12]="N",t[t.NU=13]="NU",t[t.NUL=14]="NUL"}(i||(i={}));var h=function(t){function e(){var e=t.call(this)||this;return e.state=i.UNKNOW,e.bufferStack=new Array,e.curBuffer=null,e}return l(e,t),e.prototype.finish=function(){this.feed(0)},e.prototype.feed=function(t){switch(this.state){case i.UNKNOW:switch(t){case a.a.QUOTE:this.state=i.INSTRING,this.startNewBuffer();break;case a.a.LBRACE:return this.onMapStart();case a.a.RBRACE:return this.onMapEnd();case a.a.LBRACKET:return this.onArrayStart();case a.a.RBRACKET:return this.onArrayEnd();case a.a.T:case a.a.t:this.state=i.T;break;case a.a.F:case a.a.f:this.state=i.F;break;case a.a.N:case a.a.n:this.state=i.N;break;case a.a.SPACE:case a.a.COLON:case a.a.COMMA:case a.a.TAB:case a.a.CR:case a.a.LF:case 0:break;default:if(!(a.a.NUM0<=t&&t<=a.a.NUM9||t==a.a.MINUS))throw new Error("invalid json");this.state=i.INNUMBER,this.startNewBuffer(),this.bufferWrite(t)}break;case i.INSTRING:switch(t){case a.a.QUOTE:return this.state=i.UNKNOW,this.on(new s.d(this.getReleaseBuffer()));case a.a.BSLASH:this.state=i.INSTRING_ESCAPE;break;default:this.bufferWrite(t)}break;case i.INSTRING_ESCAPE:switch(t){case a.a.b:this.state=i.INSTRING,this.bufferWrite(a.a.BS);break;case a.a.f:this.state=i.INSTRING,this.bufferWrite(a.a.FF);break;case a.a.r:this.state=i.INSTRING,this.bufferWrite(a.a.CR);break;case a.a.n:this.state=i.INSTRING,this.bufferWrite(a.a.LF);break;case a.a.t:this.state=i.INSTRING,this.bufferWrite(a.a.TAB);break;case a.a.u:this.state=i.INSTRING_ESCAPE_UNICODE,this.startNewBuffer();break;default:this.state=i.INSTRING,this.bufferWrite(t)}break;case i.INSTRING_ESCAPE_UNICODE:if(!function(t){return a.a.NUM0<=t&&t<=a.a.NUM9||a.a.a<=t&&t<=a.a.f||a.a.A<=t&&t<=a.a.F}(t))throw new Error("invalid unicode escape charactor");if(this.bufferWrite(t),4==this.getCurBuffer().size()){var e=this.getReleaseBuffer();this.bufferWrite(parseInt(e,16)),this.state=i.INSTRING}break;case i.INNUMBER:if(!function(t){return a.a.NUM0<=t&&t<=a.a.NUM9||t==a.a.DOT||t==a.a.PLUS||t==a.a.MINUS||t==a.a.e||t==a.a.E}(t)){var r=parseFloat(this.getReleaseBuffer());return!!this.on(new s.b(r))&&(this.state=i.UNKNOW,this.feed(t))}this.bufferWrite(t);break;case i.T:if(t!=a.a.r&&t!=a.a.R)throw new Error("invalid json");this.state=i.TR;break;case i.TR:if(t!=a.a.u&&t!=a.a.U)throw new Error("invalid json");this.state=i.TRU;break;case i.TRU:if(t!=a.a.e&&t!=a.a.E)throw new Error("invalid json");this.state=i.UNKNOW,this.on(s.f);break;case i.F:if(t!=a.a.a&&t!=a.a.A)throw new Error("invalid json");this.state=i.FA;break;case i.FA:if(t!=a.a.l&&t!=a.a.L)throw new Error("invalid json");this.state=i.FAL;break;case i.FAL:if(t!=a.a.s&&t!=a.a.S)throw new Error("invalid json");this.state=i.FALS;break;case i.FALS:if(t==a.a.e||t==a.a.E)return this.state=i.UNKNOW,this.on(s.a);throw new Error("invalid json");case i.N:if(t!=a.a.u&&t!=a.a.U)throw new Error("invalid json");this.state=i.NU;break;case i.NU:if(t!=a.a.l&&t!=a.a.L)throw new Error("invalid json");this.state=i.NUL;break;case i.NUL:if(t==a.a.l||t==a.a.L)return this.state=i.UNKNOW,this.on(s.e);throw new Error("invalid json");default:throw new Error("failed to parse JSON with bug.")}return!0},e.prototype.on=function(t){return this.onJObject(t)},e.prototype.startNewBuffer=function(){var t=new u.a;this.bufferStack.push(t),this.curBuffer=t},e.prototype.getReleaseBuffer=function(){var t=this.bufferStack.pop();if(void 0!==t){var e=this.bufferStack[this.bufferStack.length-1];return this.curBuffer=void 0!==e?e:null,t.toString()}throw new Error("invalid json")},e.prototype.bufferWrite=function(t){if(null!==this.curBuffer)return this.curBuffer.write(t);throw new Error("invalid json")},e.prototype.getCurBuffer=function(){var t=this.curBuffer;if(null!==t)return t;throw new Error("invalid json")},e}(o.a),c=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),f=function(t){function e(e){var r=t.call(this)||this;return r.stateStack=new Array,r.watcher=e,r}return c(e,t),e.prototype.onMapStart=function(){var t=this.stateStack,e=t.length-1,r=t[e];return"number"==typeof r&&(t[e]=r+1),this.stateStack.push(null),this.watcher(this.stateStack,null)},e.prototype.onArrayStart=function(){var t=this.stateStack,e=t.length-1,r=t[e];return"number"==typeof r&&(t[e]=r+1),this.stateStack.push(-1),this.watcher(this.stateStack,null)},e.prototype.onMapEnd=function(){var t=this.stateStack;if(null===t[t.length-1]){var e=this.watcher(t,null);return this.releaseCurrentState(),e}throw new Error("")},e.prototype.onArrayEnd=function(){var t=this.stateStack;if("number"==typeof t[t.length-1]){t[t.length-1]=-1;var e=this.watcher(t,null);return this.releaseCurrentState(),e}throw new Error("")},e.prototype.onJObject=function(t){var e=this.stateStack,r=e.length-1,n=e[r];if(null===n)return e[r]=t.toString(),!0;if("number"==typeof n)return e[r]=n+1,this.watcher(e,t);if("string"==typeof n){var i=this.watcher(e,t);return e[r]=null,i}return this.watcher(e,t)},e.prototype.releaseCurrentState=function(){var t=this.stateStack;t.pop(),"string"==typeof t[t.length-1]&&(t[t.length-1]=null)},e}(h),p=r(8),d=r(33),y=r(40),b=r(6),v=r(1),m=r(7),w=r(5),g=/[^\-\d.]+/g,x=/#([a-z0-9]{3,6})/i,O=new d.b(d.a.PT,d.a.PX100);function E(t){return v.a.normal(parseInt(t))}function _(t){return v.a.normal(parseFloat(t))}function N(t){var e=x.exec(t);if(null!==e){var r=e[1];if(3===r.length){var n=parseInt(b.a.repeat(r.charAt(0),2),16),i=parseInt(b.a.repeat(r.charAt(1),2),16),o=parseInt(b.a.repeat(r.charAt(2),2),16);return new y.a(n,i,o)}if(6===r.length)return y.a.of(parseInt(r,16));throw new Error("invalid color format")}return null}function A(t){return p.a.endsWith(t,"pt")?O.wrap(_(t.substring(0,t.length-2))):p.a.endsWith(t,"px")?_(t.substring(0,t.length-2)):_(t)}function T(t,e){return new w.a(_(t),-_(e))}var S,R,I=function(){function t(t,e,r){this.bbox=new m.b,this.decoder=t,this.sourceName=e,this.logger=r}return t.prototype.fontWeightVal=function(t){switch(t){case"normal":case"lighter":return 200;case"bold":case"bolder":return 600;default:try{return _(t)}catch(t){return this.logger.warning1(t.message),200}}},t}(),P=r(44),C=r(96),L=r(49),D=function(){function t(t,e){this.index=0,this.src=v.a.notEmpty(t),this.splitor=v.a.notEmpty(e)}return t.prototype.next=function(){if(this.index>=this.src.length)return null;var t=this.src.indexOf(this.splitor,this.index),e=void 0;return t<0?(e=this.src.substring(this.index),this.index=this.src.length+this.splitor.length):(e=this.src.substring(this.index,t),this.index=t+this.splitor.length),e},t.prototype.validNext=function(){var t=this.next();if(null!==t)return t;throw new Error("invalid state")},t.prototype.nextDecoded=function(t){void 0===t&&(t="");var e=this.next();return null===e?t:(e=e.trim(),v.a.nullOrEmpty(e)?t:b.a.xmlDecode(e))},t}(),M=r(0),k=r(22),U=r(14),B=r(62),F=r(17),Y=r(2),G=r(28),z=r(9),W=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function X(t){var e=parseFloat(t);if(isFinite(e))return e;throw new Error("expect number")}!function(t){t[t.UNKNOW=0]="UNKNOW",t[t.IN_NUMBER=1]="IN_NUMBER",t[t.IN_NUMBER_E=2]="IN_NUMBER_E",t[t.IN_NUMBER_E_SIGNED=3]="IN_NUMBER_E_SIGNED"}(S||(S={})),function(t){t[t.UNKNOW=0]="UNKNOW",t[t.MOVE_X=1]="MOVE_X",t[t.MOVE_Y=2]="MOVE_Y",t[t.LINE_X=3]="LINE_X",t[t.LINE_Y=4]="LINE_Y",t[t.HORIZONTAL_X=5]="HORIZONTAL_X",t[t.VERTICAL_Y=6]="VERTICAL_Y",t[t.CUBIC_BEZIER_X1=7]="CUBIC_BEZIER_X1",t[t.CUBIC_BEZIER_Y1=8]="CUBIC_BEZIER_Y1",t[t.CUBIC_BEZIER_X2=9]="CUBIC_BEZIER_X2",t[t.CUBIC_BEZIER_Y2=10]="CUBIC_BEZIER_Y2",t[t.CUBIC_BEZIER_X=11]="CUBIC_BEZIER_X",t[t.CUBIC_BEZIER_Y=12]="CUBIC_BEZIER_Y",t[t.ARC_RX=13]="ARC_RX",t[t.ARC_RY=14]="ARC_RY",t[t.ARC_ROTATION=15]="ARC_ROTATION",t[t.ARC_LARGE=16]="ARC_LARGE",t[t.ARC_SWEEP=17]="ARC_SWEEP",t[t.ARC_X=18]="ARC_X",t[t.ARC_Y=19]="ARC_Y",t[t.QUADRATIC_BEZIER_X1=20]="QUADRATIC_BEZIER_X1",t[t.QUADRATIC_BEZIER_Y1=21]="QUADRATIC_BEZIER_Y1",t[t.QUADRATIC_BEZIER_X=22]="QUADRATIC_BEZIER_X",t[t.QUADRATIC_BEZIER_Y=23]="QUADRATIC_BEZIER_Y"}(R||(R={}));var j=function(t){function e(e,r){void 0===r&&(r=G.c.DUMMY);var n=t.call(this)||this;return n.buffer=new u.a,n.group=new Array,n.subPartStart=w.a.ORIGIN,n.curPoint=w.a.ORIGIN,n.lexState=S.UNKNOW,n.parseState=R.UNKNOW,n.isAbsolute=!1,n.isLargeArc=!1,n.x1=Number.NaN,n.y1=Number.NaN,n.x2=Number.NaN,n.y2=Number.NaN,n.x=Number.NaN,n.y=Number.NaN,n.rx=Number.NaN,n.ry=Number.NaN,n.rotation=Number.NaN,n.sweep=F.a.CCW,n.logger=r,n.cb=e,n}return W(e,t),e.prototype.on=function(t){return this.cb(t)},e.prototype.feed=function(t){switch(this.logger.debug3("%c|%s",t,this.lexState),this.lexState){case S.UNKNOW:return!!Object(o.b)(t)||(a.a.NUM0<=t&&t<=a.a.NUM9||t===a.a.MINUS||t===a.a.DOT||t===a.a.PLUS?(this.pushBuffer(t),this.lexState=S.IN_NUMBER,!0):(e=t,a.a.a<=e&&e<=a.a.z||a.a.A<=e&&e<=a.a.Z?this.feedS(String.fromCharCode(t)):(this.logger.warning3("unknow letter %c",t),!0)));case S.IN_NUMBER:return a.a.NUM0<=t&&t<=a.a.NUM9||t===a.a.DOT?(this.pushBuffer(t),!0):t===a.a.e||t===a.a.E?(this.pushBuffer(t),this.lexState=S.IN_NUMBER_E,!0):!!this.feedS(this.getCleanBuffer())&&(this.lexState=S.UNKNOW,this.feed(t));case S.IN_NUMBER_E:return a.a.NUM0<=t&&t<=a.a.NUM9?(this.pushBuffer(t),!0):t===a.a.MINUS||t===a.a.PLUS?(this.pushBuffer(t),this.lexState=S.IN_NUMBER_E_SIGNED,!0):!!this.feedS(this.getCleanBuffer())&&(this.lexState=S.UNKNOW,this.feed(t));case S.IN_NUMBER_E_SIGNED:return a.a.NUM0<=t&&t<=a.a.NUM9?(this.pushBuffer(t),!0):!!this.feedS(this.getCleanBuffer())&&(this.lexState=S.UNKNOW,this.feed(t));default:return!0}var e},e.prototype.finish=function(){this.feed(a.a.SPACE),this.tryNotify()},e.prototype.feedS=function(t){switch(this.logger.debug3("%s|%s|%s|%s",t,this.parseState,this.curPoint,this.subPartStart),this.parseState){case R.UNKNOW:switch(t){case"M":this.isAbsolute=!0,this.parseState=R.MOVE_X;break;case"m":this.isAbsolute=!1,this.parseState=R.MOVE_X;break;case"L":this.isAbsolute=!0,this.parseState=R.LINE_X;break;case"l":this.isAbsolute=!1,this.parseState=R.LINE_X;break;case"H":this.isAbsolute=!0,this.parseState=R.HORIZONTAL_X;break;case"h":this.isAbsolute=!1,this.parseState=R.HORIZONTAL_X;break;case"V":this.isAbsolute=!0,this.parseState=R.VERTICAL_Y;break;case"v":this.isAbsolute=!1,this.parseState=R.VERTICAL_Y;break;case"z":case"Z":this.group.push(new Y.a(this.curPoint,this.subPartStart));var e=this.tryNotify();return this.curPoint=this.subPartStart,e;case"C":this.isAbsolute=!0,this.parseState=R.CUBIC_BEZIER_X1;break;case"c":this.isAbsolute=!1,this.parseState=R.CUBIC_BEZIER_X1;break;case"A":this.isAbsolute=!0,this.parseState=R.ARC_RX;break;case"a":this.isAbsolute=!1,this.parseState=R.ARC_RX;break;case"Q":this.isAbsolute=!0,this.parseState=R.QUADRATIC_BEZIER_X1;break;case"q":this.isAbsolute=!1,this.parseState=R.QUADRATIC_BEZIER_X1;break;default:this.logger.warning3("unknow %s",t)}return!0;case R.MOVE_X:var r=this.tryNotify();return this.x=X(t),this.parseState=R.MOVE_Y,r;case R.MOVE_Y:this.y=-X(t);var n=void 0;return n=this.isAbsolute?new w.a(this.x,this.y):this.curPoint.add1(this.x,this.y),this.curPoint=n,this.subPartStart=n,this.parseState=R.LINE_X,!0;case R.LINE_X:return this.x=parseFloat(t),isFinite(this.x)?(this.parseState=R.LINE_Y,!0):(this.parseState=R.UNKNOW,this.feedS(t));case R.LINE_Y:this.y=-X(t);n=void 0;return n=this.isAbsolute?new w.a(this.x,this.y):this.curPoint.add1(this.x,this.y),this.group.push(new Y.a(this.curPoint,n)),this.curPoint=n,this.parseState=R.LINE_X,!0;case R.HORIZONTAL_X:if(this.x=parseFloat(t),isFinite(this.x)){n=void 0;return n=this.isAbsolute?new w.a(this.x,this.curPoint.y):this.curPoint.add1(this.x,0),this.group.push(new Y.a(this.curPoint,n)),this.curPoint=n,!0}return this.parseState=R.UNKNOW,this.feedS(t);case R.VERTICAL_Y:if(this.y=parseFloat(t),isFinite(this.y)){this.y=-this.y;n=void 0;return n=this.isAbsolute?new w.a(this.curPoint.x,this.y):this.curPoint.add1(0,this.y),this.group.push(new Y.a(this.curPoint,n)),this.curPoint=n,!0}return this.parseState=R.UNKNOW,this.feedS(t);case R.CUBIC_BEZIER_X1:return this.x1=parseFloat(t),isFinite(this.x1)?(this.parseState=R.CUBIC_BEZIER_Y1,!0):(this.parseState=R.UNKNOW,this.feedS(t));case R.CUBIC_BEZIER_Y1:return this.y1=-X(t),this.parseState=R.CUBIC_BEZIER_X2,!0;case R.CUBIC_BEZIER_X2:return this.x2=X(t),this.parseState=R.CUBIC_BEZIER_Y2,!0;case R.CUBIC_BEZIER_Y2:return this.y2=-X(t),this.parseState=R.CUBIC_BEZIER_X,!0;case R.CUBIC_BEZIER_X:return this.x=X(t),this.parseState=R.CUBIC_BEZIER_Y,!0;case R.CUBIC_BEZIER_Y:this.y=-X(t);var i=void 0,o=void 0,a=void 0;return this.isAbsolute?(i=new w.a(this.x1,this.y1),o=new w.a(this.x2,this.y2),a=new w.a(this.x,this.y)):(i=this.curPoint.add1(this.x1,this.y1),o=this.curPoint.add1(this.x2,this.y2),a=this.curPoint.add1(this.x,this.y)),this.group.push(new B.a([this.curPoint,i,o,a])),this.curPoint=a,this.parseState=R.CUBIC_BEZIER_X1,!0;case R.ARC_RX:return this.rx=parseFloat(t),isFinite(this.rx)?(this.parseState=R.ARC_RY,!0):(this.parseState=R.UNKNOW,this.feedS(t));case R.ARC_RY:return this.ry=X(t),this.parseState=R.ARC_ROTATION,!0;case R.ARC_ROTATION:return this.rotation=X(t),this.parseState=R.ARC_LARGE,!0;case R.ARC_LARGE:return this.isLargeArc=1===X(t),this.parseState=R.ARC_SWEEP,!0;case R.ARC_SWEEP:return this.sweep=1===X(t)?F.a.CW:F.a.CCW,this.parseState=R.ARC_X,!0;case R.ARC_X:return this.x=X(t),this.parseState=R.ARC_Y,!0;case R.ARC_Y:this.y=-X(t);a=void 0;return a=this.isAbsolute?new w.a(this.x,this.y):this.curPoint.add1(this.x,this.y),this.group.push(z.a.build1(this.curPoint,a,this.rx,this.ry,this.isLargeArc,this.sweep)),this.curPoint=a,this.parseState=R.ARC_RX,!0;case R.QUADRATIC_BEZIER_X1:return this.x1=parseFloat(t),isFinite(this.x1)?(this.parseState=R.QUADRATIC_BEZIER_Y1,!0):(this.parseState=R.UNKNOW,this.feedS(t));case R.QUADRATIC_BEZIER_Y1:return this.y1=-X(t),this.parseState=R.QUADRATIC_BEZIER_X,!0;case R.QUADRATIC_BEZIER_X:return this.x=X(t),this.parseState=R.QUADRATIC_BEZIER_Y,!0;case R.QUADRATIC_BEZIER_Y:this.y=-X(t);i=void 0,a=void 0;return this.isAbsolute?(i=new w.a(this.x1,this.y1),a=new w.a(this.x,this.y)):(i=this.curPoint.add1(this.x1,this.y1),a=this.curPoint.add1(this.x,this.y)),this.group.push(new B.a([this.curPoint,i,i,a])),this.curPoint=a,this.parseState=R.QUADRATIC_BEZIER_X1,!0;default:return this.logger.warning3("unsupported parse state %s",this.parseState),!0}},e.prototype.pushBuffer=function(t){this.buffer.write(t)},e.prototype.getCleanBuffer=function(){var t=this.buffer.toString();return this.buffer.clear(),t},e.prototype.tryNotify=function(){if(0===this.group.length)return!0;var t=U.a.build1(Object(k.a)(this.group));return this.group.length=0,this.on(t)},e.prototype.onException=function(t){throw t},e}(o.a),H=r(18),V=r(63),K=r(10),Z=r(12),q=r(113),Q=r(61),J=r(54),$=r(30),tt=r(39),et=r(15),rt=r(26),nt=r(47),it=r(36),ot=r(20),at=r(55),st=r(27),ut=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lt=function(t){function e(r,n){var i=t.call(this,r.x,r.y)||this;return i.origin=n,i.dgree=e.dgree(n,r),i.distance=n.distance2(i),i}return ut(e,t),e.dgree=function(t,e){var r=e.y-t.y;return(e.x-t.x)/r},e.sortByDgreeDesc=function(t,e){return e.dgree-t.dgree},e}(w.a),ht=r(45),ct=r(50),ft=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pt=function(){function t(){}return t.reduce=function(t,e,r){var n=[];n.push(t[e]);for(var i=t[e].dgree,o=e+r,a=e+1;a<o;a++){var s=t[a];i!==s.dgree&&(n.push(s),i=s.dgree)}return n},t.hull=function(e){var r,n,i,o,a=null;try{for(var s=ft(e),u=s.next();!u.done;u=s.next()){var l=u.value;null!==a?(a.y>l.y||a.y===l.y&&a.x>l.x)&&(a=l):a=l}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}if(null===a)throw new Error("bug");var h=new Array(e.length),c=0;try{for(var f=ft(e),p=f.next();!p.done;p=f.next()){(l=p.value).equals(a)||(h[c++]=new lt(l,a))}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}if(Object(b.c)(h,lt.sortByDgreeDesc,0,c),1===(h=t.reduce(h,0,c)).length)return[a,h[0]];var d=[];d.push(a),d.push(h[0]);for(var y=1;y<=h.length;y++){var v=void 0;for(v=y===h.length?a:h[y];;){var m=d.pop();if(void 0===m)break;var w=d[d.length-1];if(ht.a.crossProd3(w,m,v)>0){d.push(m),d.push(v);break}}}return d.pop(),d},t.barycentre=function(e){if(0===e.length)return null;var r=t.hull(e);if(1===r.length)return r[0];if(2===r.length){var n=r[0].x+r[1].x,i=r[0].y+r[1].y;return new w.a(n/2,i/2)}n=0,i=0;for(var o=0,a=r[0],s=r[1],u=2;u<r.length;u++){var l=r[u],h=ct.a.barycentre(a,s,l),c=ct.a.area(a,s,l);n+=h.x*c,i+=h.y*c,o+=c,s=l}return new w.a(n/o,i/o)},t}(),dt=function(){function t(){}return t.smallestRect=function(t){for(var e=pt.hull(t),r=e[0],n=Number.POSITIVE_INFINITY,i=null,o=null,a=0,s=1;s<=e.length;s++){var u=e[s%e.length],l=-u.angle(r),h=K.a.rotate(l).setOrigin1(r),c=new m.b;c.ext2(r);for(var f=0;f<e.length;f++){var p=e[(f+s)%e.length];c.ext2(p.multiply3(h))}var d=c.build(),y=d.width()*d.height();y<n&&(n=y,i=d,o=r,a=l),r=u}if(null===i||null===o)throw new Error("points is empty");a=-a;h=K.a.rotate(a).setOrigin1(o);var b=i.LL(),v=i.LR(),w=i.UR(),g=i.UL();return[b.multiply3(h),v.multiply3(h),w.multiply3(h),g.multiply3(h)]},t}(),yt=r(66),bt=r(43),vt=r(11),mt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function gt(t){return new st.a}function xt(){return[]}var Ot=/(.*?`*)`|([^`]+)/g;var Et=function(t){function e(e,r,n){var i=t.call(this,e,r.sourceName,n)||this;return i.doc=new yt.b,i.shapeCache=new Array,i.ruleCache=new st.a,i.ruleNetCache=new st.a,i.lastPrefix=null,i.lastComment=null,i.displayLastPrefix=!1,i.displayLastComment=!1,i.curCompBuilder=null,i.lh=new C.a(n,[]),i.setting=r,i.doc.sourceName=i.sourceName,i.doc.contributor="EasyEDA",i.doc.scale=d.a.PX100,i}return mt(e,t),e.prototype.watcher=function(t,e){this.logger.debug2(e);try{if("shape"===t[0])this.shapeCache.push(e.asString());else if("layers"===t[0])this.parseLayer(e.asString());else if("DRCRULE"===t[0]){var r=t[1],n=t[2];"string"==typeof r&&"string"==typeof n&&("nets"===n?this.ruleNetCache.computeIfAbsent(r,xt).push(e.asString()):this.ruleCache.computeIfAbsent(r,gt).put(n,e.asNumber()))}}catch(t){this.logger.error2(t)}return!0},e.prototype.finish=function(){var t,e,r,n,i=this;try{for(var o=wt(this.shapeCache),a=o.next();!a.done;a=o.next()){var s=a.value;this.doc.shapes.push.apply(this.doc.shapes,this.dispatcher(s))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}if(this.ruleCache.iterator((function(t,e){var r,n,o,a=i.ruleNetCache.get(t);if(void 0===a)o=new L.e([]);else if(1===a.length)o=new L.d(a[0]);else{var s=new Array;try{for(var u=wt(a),l=u.next();!l.done;l=u.next()){var h=l.value;s.push(new L.d(h))}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}o=new L.e(s)}var c=e.get("clearance");return void 0!==c&&("Default"===t?i.doc.rules.push(new L.b(new L.a,c)):i.doc.rules.unshift(new L.b(o,c))),!0})),this.setting.exportAsLib){var u=new m.b;try{for(var l=wt(this.doc.shapes),h=l.next();!h.done;h=l.next()){var c=h.value;u.ext1(c.bbox())}}catch(t){r={error:t}}finally{try{h&&!h.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}if(u.valid()){var f=u.build(),p=new bt.b,d=this.decoder.c_para;p.pattern=d.getOrDefault("package","");var y=d.getOrDefault("pre","U?");p.designator=new P.a("",M.c.TOP_SILK,f.UR(),0,y,new tt.a("",1,.1),!1),p.showDesignator=!0,p.comment=new P.a("",M.c.TOP_SILK,f.LR(),0,this.doc.sourceName||"",new tt.a("",1,.1),!1),p.showComment=!0,p.location=f.center(),p.layer=M.c.TOP_COPPER,p.orientation=0,b.a.addAll(p.shapes,this.doc.shapes),this.doc.shapes.length=0,this.doc.shapes.push(p.build())}}this.decoder.on(this.doc.build())},e.prototype.parseLayer=function(t){var e=new D(t,"~"),r=parseInt(e.nextDecoded());if(!isFinite(r))return[];var n=e.nextDecoded(),i=(e.nextDecoded(),"true"===e.nextDecoded("false").toLowerCase()),o="true"===e.nextDecoded("false").toLowerCase(),a="true"===e.nextDecoded("false").toLowerCase();e.nextDecoded();var s="plane"!==e.nextDecoded("signal").toLowerCase(),u=this.lh.info1(r);null!==u?(u.name!==n&&this.logger.warning3("layer %s not matched name %s",t,u.name),u.visible=i,u.active=o,u.config=a,u.isSignal=s,u.config&&(u.isSignal?this.doc.addLayerOrder(u.layer):this.doc.addLayerOrder(new M.c(M.a.PLANE,u.layer.order)))):this.logger.warning3("layer %s not supported",t)},e.prototype.dispatcher=function(t){var e,r=t.indexOf("~");e=r>=0?t.substring(0,r):t;try{switch(e){case"TRACK":return this.parseTrack(t);case"TEXT":return this.parseText(t);case"LIB":return this.parseLib(t);case"PAD":return this.parsePad(t);case"VIA":return this.parseVia(t);case"HOLE":return this.parseHole(t);case"ARC":return this.parseArc(t);case"CIRCLE":return this.parseCircle(t);case"RECT":return this.parseRectangle(t);case"COPPERAREA":return this.parseCopperArea(t);case"SOLIDREGION":return this.parseSolidRegion(t);case"SVGNODE":return this.parseSVGNode(t);case"PLANEZONE":return this.parsePlaneZone(t);case"DIMENSION":return this.parseDimension(t);case"PROTRACTOR":return this.parseProtractor(t);default:return this.logger.warning2("unsupported command "+e),[]}}catch(t){return this.logger.error2(t),[]}},e.prototype.parseDimension=function(t){var e=new D(t,"~");e.next();var r=this.lh.encode(E(e.nextDecoded())),n=e.next();e.nextDecoded("");e.next(),e.next(),e.next();var i=_(e.nextDecoded("0.4"));if(!v.a.nullOrEmpty(n)){var o=(new bt.b).asContainer(),a=new m.b;return new j((function(t){var e,n;a.ext1(t.bbox());try{for(var s=wt(t.primitives),u=s.next();!u.done;u=s.next()){var l=u.value;l instanceof Y.a?o.shapes.push(new $.a("",r,l.start(),l.end(),i,!1)):l instanceof z.a&&o.shapes.push(new it.a("",r,l,i,!1))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return!0})).parse(n),o.layer=r,o.location=a.build().center(),[o.build()]}return[]},e.prototype.parseProtractor=function(t){var e=new D(t,"~");e.next();var r=this.lh.encode(E(e.nextDecoded())),n=e.next(),i=_(e.nextDecoded("0.4"));if(!v.a.nullOrEmpty(n)){var o=(new bt.b).asContainer(),a=new m.b;return new j((function(t){var e,n;a.ext1(t.bbox());try{for(var s=wt(t.primitives),u=s.next();!u.done;u=s.next()){var l=u.value;l instanceof Y.a?o.shapes.push(new $.a("",r,l.start(),l.end(),i,!1)):l instanceof z.a&&o.shapes.push(new it.a("",r,l,i,!1))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return!0})).parse(n),o.layer=r,o.location=a.build().center(),[o.build()]}return[]},e.prototype.parsePlaneZone=function(t){var e=new D(t,"#@$"),r=new D(e.validNext(),"~");r.nextDecoded();var n=this.lh.encode(E(r.nextDecoded())),i=r.nextDecoded(),o="none"===r.nextDecoded("none").toLowerCase();(r=new D(e.nextDecoded(),"~")).nextDecoded();var a=new Array,s=r.nextDecoded();return v.a.nullOrEmpty(s)||(this.logger.debug3("plane zone in layer %s",n),new j((function(t){return o?a.push(new H.a(i,n,H.b.POLYGON_CUTOUT,t)):a.push(new V.a(i,n,t)),!0})).parse(s)),a},e.prototype.parseSVGNode=function(t){var e,r,n=new D(t,"~");n.nextDecoded();var i=JSON.parse(n.nextDecoded());if(void 0===i)throw new Error("invalid svgnode json");var o=i.attrs,a=this.lh.encode(E(o.layerid));if(this.needByPour(a)&&1===i.nodeType){if("outline3D"===o.c_etype){var s,u=o.c_origin.split(","),l=_(u[0]),h=-_(u[1]),c=_(o.z),f=o.c_rotation.split(","),p=_(f[0]),d=_(f[1]),y=_(f[2]),b=_(o.c_width),v=_(o.c_height),m=void 0,g=void 0;if(null!==this.curCompBuilder){if(!this.curCompBuilder.layer||null===this.curCompBuilder.location||null===this.curCompBuilder.orientation)throw new Error("component is not inited correctly");m=this.curCompBuilder.location,s=this.curCompBuilder.layer,g=this.curCompBuilder.orientation}else m=w.a.ORIGIN,s=M.c.TOP_COPPER,g=0;var x=void 0;s.type===M.a.BOT_COPPER?(x=K.a.rotateD(-g).multiply3(K.a.MIRROR_X),y-=180):x=K.a.rotateD(-g);var O=new w.a(l-m.x,h-m.y).multiply3(x),N=new vt.a(O.x,O.y,c),A=new vt.a(p,d,Z.a.transformD(y,x));return[new q.a(s,m,g,N,A,b,v,o.uuid)]}var T=new Array;if(this.cvtImage2Region(i,a,T),"childNodes"in i)try{for(var S=wt(i.childNodes),R=S.next();!R.done;R=S.next()){var I=R.value;this.cvtImage2Region(I,a,T)}}catch(t){e={error:t}}finally{try{R&&!R.done&&(r=S.return)&&r.call(S)}finally{if(e)throw e.error}}return T}return[]},e.prototype.cvtImage2Region=function(t,e,r){try{var n=t.attrs.d;if(void 0!==n){var i=new Array;new j((function(t){return i.push(t),!0})).parse(n),i.length>0&&r.push(new J.a("","",e,i))}}catch(t){this.logger.warning2(t)}},e.prototype.parseTrack=function(t){var e=new D(t,"~");e.nextDecoded();for(var r=_(e.nextDecoded()),n=this.lh.encode(E(e.nextDecoded())),i=e.nextDecoded(),o=p.a.split(g,e.nextDecoded()),a=null,s=new Array,u=0;u<o.length-1;u+=2){var l=T(o[u+0],o[u+1]);null!==a&&s.push(new $.a(i,n,a,l,r,n.type===M.a.OUTLINE)),a=l}return s},e.prototype.parseText=function(t){var e=new D(t,"~");e.nextDecoded();var r,n,i=(r=e.nextDecoded(),n="L",v.a.nullOrEmpty(r)?n:r.charAt(0)),o=T(e.nextDecoded(),e.nextDecoded()),a=_(e.nextDecoded()),s=_(e.nextDecoded()),u="1"===e.nextDecoded();u=!1;var l=this.lh.encode(E(e.nextDecoded()));M.c.isBot(l.type)&&(u=!u);var h=e.nextDecoded(),c=_(e.nextDecoded("45")),f=e.nextDecoded().split("\\n").join("\n").trim(),p=e.nextDecoded(),d="none"!==e.nextDecoded();e.nextDecoded();var y=e.nextDecoded("Default");y="Default"===y?"":y;var b=new tt.a(y,c,a),m=!v.a.nullOrEmpty(y)||!/^[\x00-\x7F]*$/.test(f);if(!v.a.nullOrEmpty(p)&&this.needByPour(l)){if(this.setting.preferOriginShape){if(d){if(m){var w=new Array;return new j((function(t){return w.push(t),!0})).parse(p),w.length>0?[new J.a("",h,l,w)]:[]}if(this.setting.pourOnly){var g=new Array;return new j((function(t){var e,r;try{for(var n=wt(t.primitives),i=n.next();!i.done;i=n.next()){var o=i.value.stroke(b.weight,rt.a.ROUND,F.a.CW);g.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!0})).parse(p),g.length>0?[new J.a("",h,l,g)]:[]}var x=(new bt.b).asContainer();return x.layer=l,x.location=o,new j((function(t){var e,r;try{for(var n=wt(t.primitives),i=n.next();!i.done;i=n.next()){var o=i.value;o instanceof Y.a?x.shapes.push(new $.a(h,l,o.start(),o.end(),b.weight,!1)):o instanceof z.a&&x.shapes.push(new it.a(h,l,o,b.weight,!1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!0})).parse(p),[x.build()]}return[]}s=this.detectTextRealOrientation(p,f,o,b,u)}v.a.nullOrEmpty(y)&&(o=o.add1(0,-c/2).multiply3(K.a.rotateD(s).setOrigin1(o)));var O=new P.a(h,l,o,s,f,b,u);switch(i){case"P":this.lastPrefix=O,this.displayLastPrefix=d;break;case"N":this.lastComment=O,this.displayLastComment=d}return[O]},e.prototype.detectTextRealOrientation=function(t,e,r,n,i){var o,a,s=new Array;new j((function(t){var e,r;try{for(var n=wt(t.primitives),i=n.next();!i.done;i=n.next()){var o=i.value;b.a.addAll(s,o.points(1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return!0})).parse(t);var u,l=dt.smallestRect(s),h=l[0],c=l[1],f=l[2],p=l[3],d=Number.POSITIVE_INFINITY,y=null;try{for(var v=wt(l),m=v.next();!m.done;m=v.next()){var w=m.value,g=w.distance2(r);g<d&&(y=w,d=g)}}catch(t){o={error:t}}finally{try{m&&!m.done&&(a=v.return)&&a.call(v)}finally{if(o)throw o.error}}if(null===y)throw new Error;if(h.equals(y))u=p.distance2(h)>c.distance2(h)?p.angleD(h):c.angleD(h);else if(c.equals(y))u=h.distance2(c)>f.distance2(c)?h.angleD(c):f.angleD(c);else if(f.equals(y))u=p.distance2(f)>c.distance2(f)?p.angleD(f):c.angleD(f);else{if(!p.equals(y))throw new Error;u=h.distance2(p)>f.distance2(p)?h.angleD(p):f.angleD(p)}return i&&(u-=180),e.length<=1&&(u+=90),u=Z.a.regularD(Math.round(u))},e.prototype.parseLib=function(t){try{for(var e=new D(t,"#@$");;){var r=e.next();if(null===r||""===r)break;p.a.startsWith(r,"LIB")?(this.curCompBuilder=this.initComponentBuilder(r),this.lastPrefix=null,this.displayLastPrefix=!0,this.lastComment=null,this.displayLastComment=!0):null!==this.curCompBuilder&&b.a.addAll(this.curCompBuilder.shapes,this.dispatcher(r))}if(null!==this.curCompBuilder){var n=new P.a(this.curCompBuilder.pattern||"",M.c.DOCUMENT,this.curCompBuilder.location||w.a.ORIGIN,this.curCompBuilder.orientation,this.curCompBuilder.pattern||"",new tt.a("",1,1),!1);return null!==this.lastPrefix?(this.curCompBuilder.showDesignator=this.displayLastPrefix,this.curCompBuilder.designator=this.lastPrefix,b.a.remove(this.curCompBuilder.shapes,this.lastPrefix)):(this.curCompBuilder.showDesignator=!1,this.curCompBuilder.designator=n),null!==this.lastComment?(this.curCompBuilder.showComment=this.displayLastComment,this.curCompBuilder.comment=this.lastComment,b.a.remove(this.curCompBuilder.shapes,this.lastComment)):(this.curCompBuilder.showComment=!1,this.curCompBuilder.comment=n),[this.curCompBuilder.build()]}return[]}finally{this.curCompBuilder=null}},e.prototype.initComponentBuilder=function(t){var e=new bt.b;e.showComment=!1;var r=new D(t,"~");r.nextDecoded(),e.location=T(r.nextDecoded(),r.nextDecoded());for(var n=new st.a,i=null,o=r.nextDecoded();;){var a=Ot.exec(o);if(null===a)break;var s=a[1];null===s&&(s=a[2]),null===i?i=s:(n.put(i,s),i=null)}return e.orientation=_(r.nextDecoded("0")),r.nextDecoded(),r.nextDecoded(),e.layer=this.lh.encode(E(r.nextDecoded("1"))),e.pattern=n.get("package")||"",e},e.prototype.parsePadOutline=function(t){if(v.a.nullOrEmpty(t))return[];for(var e=new D(t," "),r=new Array,n=NaN;;){var i=e.nextDecoded();if(v.a.nullOrEmpty(i))break;var o=_(i);isNaN(n)?n=o:(r.push(new w.a(n,-o)),n=NaN)}return r.length>=2&&!r[0].equals(r[r.length-1])&&r.push(r[0]),r},e.prototype.parsePad=function(t){var e=new D(t,"~");e.nextDecoded();var r,n=e.nextDecoded();switch(n){case"ELLIPSE":case"OVAL":r=et.d.ROUND;break;case"POLYGON":r=et.d.POLYGON;break;case"RECT":r=et.d.RECTANGLE;break;default:this.logger.warning3("unkonw Pad out shape %s",n),r=et.d.ROUND}var i,o=T(e.nextDecoded(),e.nextDecoded()),a=_(e.nextDecoded()),s=_(e.nextDecoded()),u=this.lh.encode(E(e.nextDecoded())),l=e.nextDecoded(),h=e.nextDecoded(),c=2*_(e.nextDecoded()),f=e.nextDecoded(""),p=_(e.nextDecoded()),d=e.nextDecoded(""),y=_(e.nextDecoded("0"));y<c&&(y=c),i=a<s?90:0;var b=y===c?et.b.ROUND:et.b.SLOT,w=e.nextDecoded(),g="N"!==e.nextDecoded("N");e.nextDecoded();var x=_(e.nextDecoded("0.4")),O=_(e.nextDecoded("0.4")),N=e.nextDecoded().split(","),A=N[0],S=N[1];v.a.nullOrEmpty(A)||v.a.nullOrEmpty(S)||(o=T(A,S));var R=this.parsePadOutline(w),I=(new m.b).ext3(R);I.valid()&&(o=I.build().center());var P=null;if(r===et.d.POLYGON){var C=this.parsePadOutline(f),L=(new m.b).ext3(C);L.valid()&&L.build().area()>0?P=U.a.build4(C):r=et.d.ROUND}var k=new et.c(r,a,s,0,r===et.d.POLYGON?P:null),B=null,F=null,Y=null;u.type===M.a.MULTI?(F=k,B=k,Y=k):u.type===M.a.TOP_COPPER?F=k:u.type===M.a.BOT_COPPER&&(Y=k);var G=new et.e(u,0,0,F,B,Y),z=new et.a(b,c,y,i);return[new et.f(d,l,u,o,p,G,z,x,O,h,g)]},e.prototype.parseVia=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=_(e.nextDecoded()),i=e.nextDecoded(),o=2*_(e.nextDecoded()),a=e.nextDecoded("");return[new nt.a(a,i,r,o,n,n,n,!0)]},e.prototype.parseHole=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=2*_(e.nextDecoded()),i=new et.c(et.d.ROUND,n,n,0,null),o=new et.e(M.c.MULTI,0,0,i,i,i),a=new et.a(et.b.ROUND,n,n,0);return[new et.f("","",M.c.MULTI,r,0,o,a,0,0,"",!1)]},e.prototype.parseArc=function(t){var e=new D(t,"~");e.nextDecoded();var r=_(e.nextDecoded()),n=this.lh.encode(E(e.nextDecoded())),i=e.nextDecoded(),o=e.nextDecoded(),a=new Array;return new j((function(t){var e,o;try{for(var s=wt(t.primitives),u=s.next();!u.done;u=s.next()){var l=u.value;l instanceof z.a&&a.push(new it.a(i,n,l,r,n.type===M.a.OUTLINE))}}catch(t){e={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(e)throw e.error}}return!0})).parse(o),a},e.prototype.parseCircle=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=_(e.nextDecoded()),i=_(e.nextDecoded()),o=this.lh.encode(E(e.nextDecoded()));e.nextDecoded("");e.next();var a=e.nextDecoded("");return[new it.a(a,o,z.a.build3(r,0,360,n,n),i,o.type===M.a.OUTLINE)]},e.prototype.parseCopperArea=function(t){var e,r,n=new D(t,"~");n.nextDecoded(),n.nextDecoded();var i=this.lh.encode(E(n.nextDecoded())),o=n.nextDecoded(),a=this.parseOutline(n.nextDecoded("")),s=_(n.nextDecoded()),u=n.nextDecoded(""),l=n.nextDecoded(),h="spoke"===n.nextDecoded(),c="yes"===n.nextDecoded(),f=null;if(this.setting.pourOnly)n.next();else try{f=JSON.parse(n.nextDecoded(""))}catch(t){}n.next(),n.next();var p,d=E(n.nextDecoded("0")),y=_(n.nextDecoded("0")),b=_(n.nextDecoded("0")),v=_(n.nextDecoded("0")),m="yes"===n.nextDecoded("yes")?.8:0,w=_(n.nextDecoded("0"));switch(this.doc.rules.push(new L.f(new L.c(l),w)),u){case"solid":p=new ot.c(m);break;case"grid":p=new ot.a(y,b);break;case"none":p=null;break;default:this.logger.warning3("unsupported fill style %s",u),p=new ot.c(m)}var g=new Array;if(!this.setting.pourOnly&&null!==f){var x=function(t){var e,r,n=new Array;try{for(var i=(e=void 0,wt(t)),o=i.next();!o.done;o=i.next()){var a=o.value;new j((function(t){var e,r;if(p instanceof ot.a)try{for(var i=(e=void 0,wt(t.primitives)),o=i.next();!o.done;o=i.next()){var a=o.value;n.push(a.stroke(y,rt.a.ROUND,F.a.CW))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}else n.push(t);return!0})).parse(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}n.length>0&&g.push(new Q.a(n))};try{for(var O=wt(f),N=O.next();!N.done;N=O.next()){x(N.value)}}catch(t){e={error:t}}finally{try{N&&!N.done&&(r=O.return)&&r.call(O)}finally{if(e)throw e.error}}}return[new ot.b(l,o,i,p,v,s,h,c,d,a,g)]},e.prototype.parseRectangle=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=_(e.nextDecoded()),i=_(e.nextDecoded()),o=this.lh.encode(E(e.nextDecoded()));e.nextDecoded(),e.nextDecoded();var a=_(e.nextDecoded("0"));e.nextDecoded(),e.nextDecoded();var s=e.nextDecoded();if(a>0){var u=r,l=u.add1(n,0),h=l.add1(0,-i),c=h.add1(-n,0);return[new $.a(s,o,u,l,a,!1),new $.a(s,o,l,h,a,!1),new $.a(s,o,h,c,a,!1),new $.a(s,o,c,u,a,!1)]}return[new at.a(s,o,r,r.add1(n,-i),0,!1)]},e.prototype.parseSolidRegion=function(t){var e=new D(t,"~");e.nextDecoded();var r=this.lh.encode(E(e.nextDecoded())),n=e.nextDecoded(),i=this.parseOutline(e.nextDecoded(""));if(i.length>0){var o=void 0;switch(e.nextDecoded()){case"npth":o=H.b.BOARD_CUTOUT;break;case"cutout":o=H.b.POLYGON_CUTOUT;break;default:o=H.b.SOLID}return[new H.a(n,r,o,U.a.build2(i))]}return this.logger.warning2("ignore empty SOLIDREGION"),[]},e.prototype.parseOutline=function(t){var e=new Array;if("M"===(t=t.trim())[0])new j((function(t){return b.a.addAll(e,t.primitives),!0})).parse(t);else{var r=p.a.split(g,t);if(r.length>=2){for(var n=null,i=null,o=0;o<r.length-1;o+=2){var a=T(r[o],r[o+1]);null===i?(i=a,n=a):(e.push(new Y.a(i,a)),i=a)}null===i||null===n||i.equals(n)||e.push(new Y.a(i,n))}}return e},e.prototype.needByPour=function(t){if(!this.setting.pourOnly)return!0;switch(t.type){case M.a.BOT_COPPER:case M.a.INNER:case M.a.MULTI:case M.a.OUTLINE:case M.a.PLANE:case M.a.TOP_COPPER:return!0;default:return!1}},e}(I),_t=r(3),Nt=r(37),At=r(92),Tt=r(68),St=r(42),Rt=r(65),It=r(77),Pt=r(78),Ct=r(31),Lt=r(46),Dt=r(79),Mt=r(13),kt=r(85),Ut=r(80),Bt=r(81),Ft=r(82),Yt=r(16),Gt=r(34),zt=r(23),Wt=r(86),Xt=r(87),jt=r(88),Ht=r(89),Vt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Kt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Zt=/^(.*?)(?:\.(\d+))?$/,qt=new tt.a("Verdana",9,1,!1,!1),Qt=new _t.a(_t.b.LEFT,_t.c.BOTTOM),Jt=function(t){function e(e,r,n){var i=t.call(this,e,r.sourceName,n)||this;return i.shapes=new Array,i.curAnnoType=null,i.curAnnoVisible=null,i.setting=r,i}return Vt(e,t),e.prototype.watcher=function(t,e){if("shape"===t[0]&&e instanceof s.d){var r=e.asString();b.a.addAll(this.shapes,this.dispatcher(r))}return!0},e.prototype.finish=function(){var t,e,r,n;if(this.setting.exportAsLib){var i=new m.b;try{for(var o=Kt(this.shapes),a=o.next();!a.done;a=o.next()){var s=a.value;i.ext1(s.bbox())}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}if(i.valid()){var u=i.build(),l=new Tt.b,h=this.decoder.c_para;l.footprint=h.getOrDefault("package",""),l.location=u.center(),l.orientation=0,l.mirrored=!1,l.partId="1",l.name=h.getOrDefault("name",this.sourceName);var c=h.getOrDefault("pre","");l.prefix=new Rt.a("Designator",c,u.UR(),0,!1,!0,qt,y.a.BLUE,_t.a.LB);var f=h.getOrDefault("Value","");l.value=new Rt.a("Value",f,u.UR().add(u.UL()).mul(.5),0,!1,!0,qt,y.a.BLUE,_t.a.LC);try{for(var p=Kt(this.shapes),b=p.next();!b.done;b=p.next()){s=b.value;l.addShape(l.footprint,"1",s)}}catch(t){r={error:t}}finally{try{b&&!b.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}this.shapes.length=0,this.shapes.push(l.build())}}var v=new At.a(this.sourceName,"EasyEDA",d.a.PX100,this.shapes,[]);this.decoder.on(v)},e.prototype.dispatcher=function(t){var e,r=t.indexOf("~");e=r>=0?t.substring(0,r):t;try{switch(e){case"LIB":return this.parseLib(t);case"W":return this.parseWire(t);case"J":return this.parseJunction(t);case"T":return this.parseAnnotation(t);case"PL":return this.parsePolyline(t);case"R":return this.parseRectangle(t);case"P":return this.parsePin(t);case"PT":return this.parsePath(t);case"PG":return this.parsePolygon(t);case"A":return this.parsePath(t);case"E":return this.parseEllipse(t);case"F":return this.parseNetFlag(t);case"N":return this.parseNetLabel(t);case"B":return this.parseBus(t);case"BE":return this.parseBusEntry(t);case"O":return this.parseNoERC(t);default:return this.logger.warning1("unknow command "+e),[]}}catch(t){return this.logger.error2(t),[]}},e.prototype.strokeVal=function(t){var e,r=v.a.notnull(N(t.nextDecoded())),n=_(t.nextDecoded()),i=E(t.nextDecoded());switch(i){case 0:e=Nt.b.SOLID;break;case 1:e=Nt.b.DASHED;break;case 2:e=Nt.b.DOTTED;break;default:this.logger.warning3("unknow stroke style code %d, use 1(Solid) instead",i),e=Nt.b.SOLID}return new Nt.a(r,n,e)},e.prototype.pointsVal=function(t){for(var e=p.a.split(g,t),r=new Array,n=0;n<e.length-1;n+=2)r.push(T(e[n],e[n+1]));return r},e.prototype.parseLib=function(t){var e,r,n,i,o=new Tt.b;o.partId="1";for(var a=null,s=new D(t,"#@$");;){var u=s.next();if(v.a.nullOrEmpty(u))break;if(u.startsWith("LIB"))a=u;else try{for(var l=(e=void 0,Kt(this.dispatcher(u))),h=l.next();!h.done;h=l.next()){var c=h.value;if(c instanceof St.a&&null!==this.curAnnoType&&null!==this.curAnnoVisible)switch(this.curAnnoType){case"N":o.value=new Rt.a("Value",c.text,c.location,c.orientation,!1,this.curAnnoVisible,c.font,c.color,c.aligment),o.name=c.text;break;case"P":var f=Zt.exec(c.text),p=void 0;p=null!==f?f[1]:c.text,o.abbreviation=p,o.prefix=new Rt.a("Designator",p,c.location,c.orientation,!1,this.curAnnoVisible,c.font,c.color,c.aligment);break;default:o.addShape("0","1",c)}else o.addShape("0","1",c)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}}if(null===a)return this.logger.warning1("incorrect LIB format"),[];var d=new D(a,"~");d.nextDecoded();var b=T(d.nextDecoded(),d.nextDecoded()),m=d.nextDecoded().split("`"),w=_(d.nextDecoded("0"));d.nextDecoded();var g=d.nextDecoded("");if(g.startsWith("frame_lib_"))return this.logger.info3("ignore %s",g),[];o.location=b,o.orientation=w,o.mirrored=!1;var x="",O=null;try{for(var E=Kt(m),N=E.next();!N.done;N=E.next()){var A=N.value;if(null==O)O=A;else{if("package"===O)x=A;else{var S=new Rt.a(O,A,b,0,!1,!1,qt,y.a.BLACK,Qt);o.props.push(S)}O=null}}}catch(t){n={error:t}}finally{try{N&&!N.done&&(i=E.return)&&i.call(E)}finally{if(n)throw n.error}}var R=v.a.notNullOrUndef(o.shapes.del("0"));o.footprint=x,o.shapes.put(x,R);try{return[o.build()]}catch(t){return this.logger.error2(t),[]}},e.prototype.parseWire=function(t){var e=new D(t,"~");e.nextDecoded();var r=this.pointsVal(e.nextDecoded()),n=this.strokeVal(e);return[new It.a(r,n)]},e.prototype.parseJunction=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=_(e.nextDecoded()),i=v.a.notnull(N(e.nextDecoded()));return[new Pt.a(r,n,i)]},e.prototype.parseAnnotation=function(t){var e=new D(t,"~");e.nextDecoded(),this.curAnnoType=e.nextDecoded().toUpperCase();var r=T(e.nextDecoded(),e.nextDecoded()),n=Z.a.regularD(-_(e.nextDecoded()));180===n&&(n=0);var i,o=v.a.notnull(N(e.nextDecoded())),a=e.nextDecoded("Verdana"),s=A(e.nextDecoded("7pt")),u=this.fontWeightVal(e.nextDecoded("normal")),l="italic"===e.nextDecoded("").toLowerCase(),h=e.nextDecoded("").toLowerCase();switch(h){case"":case"baseline":i=_t.c.BOTTOM;var c=new w.a(0,.3*-s).multiply3(K.a.rotateD(n));r=r.add1(c.x,c.y);break;case"text-before-edge":i=_t.c.TOP;break;case"middle":i=_t.c.CENTER;break;case"text-after-edge":i=_t.c.BOTTOM;break;default:v.a.nullOrEmpty(h)||this.logger.warning1("unsupported vertical "+h),i=_t.c.BOTTOM}e.nextDecoded();var f=e.nextDecoded().replace(/\\n/g,"\n");this.curAnnoVisible="1"===e.nextDecoded();var p,d=e.nextDecoded().toLowerCase();switch(d){case"start":p=_t.b.LEFT;break;case"middle":p=_t.b.CENTER;break;case"end":p=_t.b.RIGHT;break;default:this.logger.warning1("unknow horizontal "+d),p=_t.b.LEFT}var y=new tt.a(a,s,u,l,!1),b=new _t.a(p,i);return[new St.a(r,y,b,_t.c.TOP,f,n,o,!1)]},e.prototype.parsePolyline=function(t){var e=new D(t,"~");e.nextDecoded();var r=this.pointsVal(e.nextDecoded()),n=this.strokeVal(e);return[new Ct.a(U.a.build4(r),new Lt.a(n,null))]},e.prototype.parseRectangle=function(t){var e=new D(t,"~");e.nextDecoded();var r,n=T(e.nextDecoded(),e.nextDecoded()),i=_(e.nextDecoded("0")),o=_(e.nextDecoded("0")),a=_(e.nextDecoded()),s=_(e.nextDecoded()),u=this.strokeVal(e),l=e.nextDecoded("none");return r="none"===l.toLowerCase()?null:N(l),[new Dt.a(n,n.add1(a,-s),i,o,new Lt.a(u,r))]},e.prototype.parsePin=function(t){var e,r=new D(t,"^^"),n=new Array;(e=new D(r.next(),"~")).nextDecoded(),e.nextDecoded();var i,o=E(e.nextDecoded("0"));switch(o){case 0:i=Mt.b.PASSIVE;break;case 1:i=Mt.b.INPUT;break;case 2:i=Mt.b.OUTPUT;break;case 3:i=Mt.b.IO;break;case 4:i=Mt.b.POWER;break;default:this.logger.warning3("unknow pin electrical code %d",o),i=Mt.b.PASSIVE}i=Mt.b.PASSIVE,e.nextDecoded(),e.nextDecoded(),e.nextDecoded();var a=_(e.nextDecoded("0"));e.nextDecoded();var s,u=T((e=new D(r.next(),"~")).nextDecoded(),e.nextDecoded()),l=(e=new D(r.next(),"~")).nextDecoded(""),h=Array();new j((function(t){return b.a.addAll(h,t.primitives),!0})).parse(l);var c=h[0];1==h.length&&c instanceof Y.a?(s=c.length(),a=c.start().distance2(u)>c.end().distance2(u)?Z.a.regularD(Math.round(u.angleD(c.start()))):Z.a.regularD(Math.round(u.angleD(c.end())))):(this.logger.warning1("invalid pin polyline "+l),s=20);var f,p=v.a.notnull(N(e.nextDecoded())),d="1"===(e=new D(r.next(),"~")).nextDecoded(),m=T(e.nextDecoded(),e.nextDecoded()),w=_(e.nextDecoded()),g=e.nextDecoded(),x=e.nextDecoded("").toUpperCase();switch(x.toUpperCase()){case"START":f=_t.b.LEFT;break;case"END":f=_t.b.RIGHT;break;default:this.logger.warning3("unknown pin name anchor %s",x),f=_t.b.LEFT}var O=e.nextDecoded("Verdana"),S=A(e.nextDecoded("7pt")),R="1"===(e=new D(r.next(),"~")).nextDecoded(),I=T(e.nextDecoded(),e.nextDecoded()),P=_(e.nextDecoded()),C=e.nextDecoded(),L=e.nextDecoded();switch(L){case"START":_t.b.LEFT;break;case"END":_t.b.RIGHT;break;default:this.logger.warning3("unknown pin number anchor %s",L),_t.b.LEFT}e.nextDecoded("Verdana"),A(e.nextDecoded("7pt"));"1"===(e=new D(r.next(),"~")).nextDecoded()&&(s+=6,n.push(Mt.c.DOT)),e.nextDecoded(),"1"===(e=new D(r.next(),"~")).nextDecoded()&&n.push(Mt.c.CLOCK),e.nextDecoded();var M=new tt.a(O,S,1,!1,!1),k=new _t.a(f,_t.c.BOTTOM),U=new St.a(m,M,k,_t.c.TOP,g,w,y.a.BLUE,!1),B=new St.a(I,M,k,_t.c.TOP,C,P,y.a.BLUE,!1),F=u.add1(-s,0).multiply3(K.a.rotateD(a).setOrigin1(u));return[new Mt.a(F,a,p,s,!0,U,d,B,R,i,n)]},e.prototype.parsePath=function(t){var e,r,n,i,o=new D(t,"~"),a=o.nextDecoded(),s=new Array,u=new Array;new j((function(t){return u.push(t),!0})).parse(o.nextDecoded()),"A"===a&&o.nextDecoded();var l=this.strokeVal(o),h=N(o.nextDecoded()),c=new Lt.a(l,h);try{for(var f=Kt(u),p=f.next();!p.done;p=f.next()){var d=p.value,y=d.primitives.length;if(0==y);else{for(var b=!1,v=0;v<y;v++){(T=d.primitives[v])instanceof B.a&&(b=!0)}var m=d.primitives[0],w=d.primitives[1],g=d.primitives[2];if(3==y&&m instanceof Y.a&&w instanceof z.a&&g instanceof Y.a){var x=m.length(),O=g.length();m.start().equals(g.end())&&Math.abs(x-O)<.01?s.push(new kt.a(w,c)):s.push(new Ct.a(d,c))}else if(b||1==y){var E=!0;try{for(var _=(n=void 0,Kt(d.primitives)),A=_.next();!A.done;A=_.next()){var T;(T=A.value)instanceof z.a?(s.push(new Ut.a(T,c)),E=!1):T instanceof B.a&&(s.push(new Bt.a(T,c)),E=!1),E&&s.push(new Ct.a(d,c))}}catch(t){n={error:t}}finally{try{A&&!A.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}}else s.push(new Ct.a(d,c))}}}catch(t){e={error:t}}finally{try{p&&!p.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}return s},e.prototype.parsePolygon=function(t){var e=new D(t,"~");e.nextDecoded();var r=this.pointsVal(e.nextDecoded()),n=this.strokeVal(e),i=N(e.nextDecoded()),o=new Lt.a(n,i);return[new Ct.a(U.a.build4(r).asClosed(),o)]},e.prototype.parseEllipse=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=_(e.nextDecoded()),i=_(e.nextDecoded()),o=this.strokeVal(e),a=N(e.nextDecoded()),s=new Lt.a(o,a);return[new Ft.a(r,n,i,s)]},e.prototype.parseNetFlag=function(t){var e,r,n,i,o,a,s,u,l,h,c,f=new D(t,"^^");(c=new D(f.next(),"~")).nextDecoded();c.nextDecoded();var d=T(c.nextDecoded(),c.nextDecoded()),b=_(c.nextDecoded());c=new D(f.next(),"~");var w=(c=new D(f.next(),"~")).nextDecoded(),g=v.a.notnull(N(c.nextDecoded())),x=T(c.nextDecoded(),c.nextDecoded());_(c.nextDecoded()),c.nextDecoded();for(var O="1"===c.nextDecoded(),E=c.nextDecoded("Verdana"),S=A(c.nextDecoded("7pt")),R=new tt.a(E,S,1,!1,!1),I=new Array,P=!1;;){var C=f.next();if(v.a.nullOrEmpty(C))break;try{for(var L=(e=void 0,Kt(this.dispatcher(C))),M=L.next();!M.done;M=L.next()){var k=M.value;if(k instanceof Ct.a)try{for(var U=(n=void 0,Kt(k.pl.primitives)),B=U.next();!B.done;B=U.next()){var F=B.value;if(F instanceof Y.a)I.push(F);else{var G=null;try{for(var z=(o=void 0,Kt(F.points(.2))),W=z.next();!W.done;W=z.next()){var X=W.value;null!==G?(I.push(new Y.a(G,X)),G=null):G=X}}catch(t){o={error:t}}finally{try{W&&!W.done&&(a=z.return)&&a.call(z)}finally{if(o)throw o.error}}}}}catch(t){n={error:t}}finally{try{B&&!B.done&&(i=U.return)&&i.call(U)}finally{if(n)throw n.error}}else k instanceof Dt.a?I.push(new Y.a(k.location1,k.location2)):k instanceof Ft.a?(I.push(new Y.a(k.center.add1(-k.rx,-k.ry),k.center.add1(k.rx,k.ry))),P=!0):this.logger.warning3("unanalyzed shape %s in Netflag",k)}}catch(t){e={error:t}}finally{try{M&&!M.done&&(r=L.return)&&r.call(L)}finally{if(e)throw e.error}}}var j=new Array,H=new m.b,V=d,q=0;try{for(var Q=Kt(I),J=Q.next();!J.done;J=Q.next()){var $=(yt=J.value).bbox();H.ext1($);var et=$.center(),rt=yt.start().distance2(yt.end()),nt=et.y-V.y,it=et.x-V.x,ot=rt/(rt+q);V=V.add1(it*ot,nt*ot),q+=rt}}catch(t){s={error:t}}finally{try{J&&!J.done&&(u=Q.return)&&u.call(Q)}finally{if(s)throw s.error}}if(H.valid()){et=H.build().center();b=Z.a.toDegrees(V.angle(et)),b=90*Math.floor((b+45)/90),b=Z.a.regularD(b);var at=K.a.rotateD(b),st=K.a.rotateD(-b).setOrigin1(et),ut=0,lt=0,ht=0,ct=0,ft=et;try{for(var pt=Kt(I),dt=pt.next();!dt.done;dt=pt.next()){var yt;(yt=(yt=dt.value).multiply3(st)).start().x<ft.x&&(ft=yt.start()),yt.end().x<ft.x&&(ft=yt.end());var bt=Z.a.regularD(yt.end().angleD(yt.start()));0==(bt=45*Math.floor((bt+22.5)/45))||180==bt?ut++:90==bt||270==bt?lt++:bt>0&&bt<90||bt>180&&bt<270?ht++:ct++}}catch(t){l={error:t}}finally{try{dt&&!dt.done&&(h=pt.return)&&h.call(pt)}finally{if(l)throw l.error}}ft=ft.multiply3(at.setOrigin1(et)),at=at.setOrigin1(ft);var vt=p.a.format("h%dv%ds%db%d",ut,lt,ht,ct);if("h2v1s1b1"===vt){var mt=void 0,wt=void 0,gt=void 0;x=ft.add1(Yt.b,.7*-S).multiply3(at),180==b?(gt=0,mt=_t.b.RIGHT,wt=_t.c.TOP):(gt=b,mt=_t.b.LEFT,wt=_t.c.BOTTOM);var xt=new _t.a(mt,wt);x=ft.add1(Yt.b,.7*-S).multiply3(at),180==b?(gt=0,mt=_t.b.RIGHT,wt=_t.c.TOP):(gt=b,mt=_t.b.LEFT,wt=_t.c.BOTTOM);var Ot=new St.a(x,R,xt,_t.c.TOP,w,gt,g,!1),Et=new Gt.a(Ot,y.a.WHITE,g,8*w.length,!0,!1,ft,b,Gt.b.INPUT);j.push(Et)}else{mt=void 0,wt=void 0,gt=void 0;x=ft.add1(Yt.d,0).multiply3(at),0==b?(gt=90,x=x.add1(S/2+Yt.g,0)):90==b?gt=0:180==b?gt=90:(gt=0,x=x.add1(0,-S/2-Yt.g)),mt=_t.b.CENTER,wt=_t.c.BOTTOM;xt=new _t.a(mt,wt),Ot=new St.a(x,R,xt,_t.c.TOP,w,gt,g,!1);var Nt=void 0;switch(vt){case"h1v1s1b1":Nt=zt.b.SIGNAL_GROUND;break;case"h1v4s0b0":Nt=zt.b.POWER_GROUND;break;case"h1v2s0b3":Nt=zt.b.EARTH;break;case"h1v1s0b0":Nt=zt.b.BAR;break;default:Nt=P?zt.b.CIRCLE:zt.b.BAR}var At=new zt.a(Ot,Nt,O,ft,g,b);j.push(At)}}return j},e.prototype.parseNetLabel=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded()),n=-_(e.nextDecoded()),i=v.a.notnull(N(e.nextDecoded())),o=e.nextDecoded();e.nextDecoded(),"end"===e.nextDecoded()&&(n+=180),T(e.nextDecoded(),e.nextDecoded());var a=e.nextDecoded("Verdana"),s=A(e.nextDecoded("7pt")),u=new tt.a(a,s,1,!1,!1);return[new Wt.a(r,n,o,u,i)]},e.prototype.parseBus=function(t){var e=new D(t,"~");e.nextDecoded();var r=this.pointsVal(e.nextDecoded()),n=this.strokeVal(e);return[new Xt.a(r,n)]},e.prototype.parseBusEntry=function(t){var e=new D(t,"~");e.nextDecoded(),_(e.nextDecoded());var r=T(e.nextDecoded(),e.nextDecoded()),n=T(e.nextDecoded(),e.nextDecoded());return[new jt.a(r,n,new Nt.a(y.a.GREEN,2))]},e.prototype.parseNoERC=function(t){var e=new D(t,"~");e.nextDecoded();var r=T(e.nextDecoded(),e.nextDecoded());e.nextDecoded(),e.nextDecoded();var n=v.a.notnull(b.a.NVL(N(e.nextDecoded()),y.a.RED));return[new Ht.a(r,n)]},e}(I),$t=r(91),te=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ee=function(t){function e(e,r,n){var i=t.call(this,e,r.sourceName,n)||this;return i.title=null,i.schDec=null,i.prevId=null,i}return te(e,t),e.prototype.watcher=function(t,e){var r=t[1],n=t[2];if("schematics"===t[0]&&"number"==typeof r&&"string"==typeof n)if(r!==this.prevId&&(null!==this.schDec&&this.schDec.finish(),this.schDec=null,this.title=null,this.prevId=r),"dataStr"===n){if(null===this.schDec){var i=v.a.notnull(b.a.NVL(this.title,this.sourceName)),o=new $t.a(i,this.logger);this.schDec=new Jt(this.decoder,o,this.logger)}var a=this.schDec;3===t.length&&e instanceof s.d?new f((function(t,e){return null===e||a.watcher(t,e)})).parse(e.asString()):this.schDec.watcher(t.slice(3),e)}else"title"===n&&(this.title=e.asString());return!0},e.prototype.finish=function(){null!==this.schDec&&(this.schDec.finish(),this.schDec=null)},e}(I);r.d(e,"a",(function(){return ne}));var re=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ne=function(t){function e(e){var r=t.call(this)||this;return r.docs=[],r.jsonPath="",r.decoder=null,r.c_para=new st.a,r.walker=new f(r.watcher.bind(r)),r.setting=e,r.logger=e.logger.wrap((function(t,e){return p.a.format("%s %s",r.jsonPath,e)})),r}return re(e,t),e.prototype.watcher=function(t,e){this.jsonPath=t.join("|");try{if(null!==e){if("c_para"===t[1]&&"head"===t[0]){var r=t[2];"string"==typeof r&&this.c_para.put(r,e.asString())}if(null!==this.decoder)return this.decoder.watcher(t,e);if("head"===t[0]&&"docType"===t[1]||"docType"===t[0]){var n=void 0;if(e instanceof s.d)n=parseInt(e.asString());else{if(!(e instanceof s.b))throw new Error(p.a.format("docType %d is not valid",e.toJson()));n=e.asNumber()}switch(n){case 3:case 14:this.decoder=new Et(this,this.setting,this.logger);break;case 4:this.setting.exportAsLib=!0,this.decoder=new Et(this,this.setting,this.logger);break;case 1:case 13:this.decoder=new Jt(this,this.setting,this.logger);break;case 2:case 6:case 7:this.setting.exportAsLib=!0,this.decoder=new Jt(this,this.setting,this.logger);break;case 5:this.decoder=new ee(this,this.setting,this.logger);break;default:throw new Error(p.a.format("docType %d is not supported",n))}}}return!0}catch(t){throw this.logger.error2(t.stack),t}},e.prototype.finish=function(){this.jsonPath="",null!==this.decoder&&this.decoder.finish()},e.prototype.feed=function(t){return this.walker.feed(t)},e.prototype.on=function(t){return this.docs.push(t),!0},e.prototype.getDocs=function(){return this.docs},e}(o.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(2),i=r(9),o=r(24),a=r(5),s=function(){function t(t,e){this.minDistance=Number.MAX_VALUE,this.p=t,this.p1=e,this.intersection()?(this.minDistance=0,this.minline=new n.a(a.a.ORIGIN,a.a.ORIGIN)):this.minline=this.minLine()}return t.prototype.getDistance=function(){return this.minDistance},t.prototype.getLine=function(){return this.minline},t.prototype.intersection=function(){return Object(o.d)(this.p,this.p1)>0},t.prototype.minLine=function(){if(this.p instanceof n.a&&this.p1 instanceof n.a){var t=this.p,e=this.p1;return this.minDistanceForLines(t,e,this.minline)}if(this.p instanceof i.a&&this.p1 instanceof n.a){var r=this.p,o=this.p1;return this.minDistanceForLineAndArc(r,o,this.minline)}if(this.p instanceof n.a&&this.p1 instanceof i.a){r=this.p1,o=this.p;return this.minDistanceForLineAndArc(r,o,this.minline)}if(this.p instanceof i.a&&this.p1 instanceof i.a){var a=this.p,s=this.p1;return this.minDistanceForArcs(a,s,this.minline)}return this.minline},t.prototype.minDistanceForLines=function(t,e,r){for(var n=[t.start(),t.end(),e.start(),e.end()],i=0;i<n.length;i++)r=i<2?this.point2LineMinLine(r,e,n[i]):this.point2LineMinLine(r,t,n[i]);return r},t.prototype.minDistanceForLineAndArc=function(e,r,n){n=this.point2LineMinLine(n,r,e.start()),n=this.point2LineMinLine(n,r,e.svgEnd);var i=t.foot(r,e.center);return r.bbox().isContains(i)&&(n=this.point2ArcMinLine(n,e,i)),n=this.point2ArcMinLine(n,e,r.start()),n=this.point2ArcMinLine(n,e,r.end())},t.prototype.minDistanceForArcs=function(t,e,r){return r=this.concentricArc(t,e,r),Object(o.e)(t,e.center)&&Object(o.e)(e,t.center)?r=this.shortestLineForArcs(t,e,r):(r=this.point2ArcMinDistance(e.start(),t,r),r=this.point2ArcMinDistance(e.svgEnd,t,r),r=this.point2ArcMinDistance(t.start(),e,r),r=this.point2ArcMinDistance(t.svgEnd,e,r)),r},t.prototype.minLineForArcAndLine=function(t,e,r){var n=t.pointOn(r.angleD(t.center)),i=t.pointOn(t.center.angleD(r));return e=this.arcShortestLine(t,e,r,n),e=this.arcShortestLine(t,e,r,i)},t.prototype.arcInnerLineFootSegment=function(t,e,r){var i=r.distance1(t.center);if(0!==i){var o=t.rx*(r.y-t.center.y)/i+t.center.y,s=t.rx*(r.x-t.center.x)/i+t.center.x,u=new n.a(new a.a(s,o),r);(i=t.rx-i)<this.minDistance&&(this.minDistance=i,e=u)}else{u=new n.a(t.start(),r);(i=t.rx-i)<this.minDistance&&(this.minDistance=i,e=u)}return e},t.prototype.shortestLineForArcs=function(t,e,r){var n=t.center.angleD(e.center),i=e.center.angleD(t.center),a=t.pointOn(n),s=t.pointOn(i),u=e.pointOn(n),l=e.pointOn(i);return Object(o.e)(t,a)&&(r=this.arcShortestLine(e,r,a,u),r=this.arcShortestLine(e,r,a,l)),Object(o.e)(t,s)&&(r=this.arcShortestLine(e,r,s,u),r=this.arcShortestLine(e,r,s,l)),r},t.prototype.concentricArc=function(t,e,r){if(t.center.distance1(e.center)<1e-5&&t.rx===e.rx&&t.ry===e.ry){var i=new n.a(t.start(),e.svgEnd);i.length()<this.minDistance&&(this.minDistance=i.length(),r=i),(i=new n.a(e.start(),t.svgEnd)).length()<this.minDistance&&(this.minDistance=i.length(),r=i)}return r},t.prototype.point2ArcMinDistance=function(t,e,r){if(Object(o.e)(e,t)){var n=e.pointOn(t.angleD(e.center)),i=e.pointOn(e.center.angleD(t));r=this.arcShortestLine(e,r,t,n),r=this.arcShortestLine(e,r,t,i)}else r=this.minLineSegment(r,e.start(),t),r=this.minLineSegment(r,e.svgEnd,t);return r},t.prototype.point2ArcMinLine=function(t,e,r){if(Object(o.e)(e,r)){var n=r.distance1(e.center);t=n>e.rx||n>e.ry?this.minLineForArcAndLine(e,t,r):this.arcInnerLineFootSegment(e,t,r)}return t},t.prototype.point2LineMinLine=function(e,r,n){var i=t.foot(r,n);return r.bbox().isContains(i)?e=this.minLineSegment(e,i,n):(e=this.minLineSegment(e,r.start(),n),e=this.minLineSegment(e,r.end(),n)),e},t.prototype.minLineSegment=function(t,e,r){var i=e.distance1(r);return i<this.minDistance&&(this.minDistance=i,t=new n.a(e,r)),t},t.prototype.arcShortestLine=function(t,e,r,i){if(Object(o.e)(t,i)){var a=new n.a(r,i),s=a.length();s<this.minDistance&&(this.minDistance=s,e=a)}return e},t.foot=function(t,e){if(t.isPoint())return t.start();if(0!==t.b&&0!==t.a){var r=(t.b*t.b*e.x-t.a*t.b*e.y-t.a*t.c)/(t.b*t.b+t.a*t.a),n=(-t.a*t.b*e.x+t.a*t.a*e.y-t.b*t.c)/(t.b*t.b+t.a*t.a);return new a.a(r,n)}return 0===t.b&&0!==t.a?new a.a(t.start().x,e.y):0!==t.b&&0===t.a?new a.a(e.x,t.start().y):e},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(t,e,r){this.sourceName=t,this.contributor=e,this.scale=r}},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r(5);var n=function(){function t(){}return t.prototype.onRTreeBBox=function(t){},t.prototype.onResultSide=function(t){},t.prototype.onOriginSide=function(t){},t.prototype.onSplitedSide=function(t){},t.prototype.onDebugSide=function(t){},t.prototype.onSweep=function(t,e,r,n,i,o){},t.prototype.onIntersect=function(t,e,r){},t.prototype.onSegment=function(t,e,r,n,i,o){},t.prototype.onSegment1=function(t,e,r){this.onSegment(t.start,t.weight,t,e.end,e.weight,e)},t.prototype.onSweep1=function(t,e,r){this.onSweep(t.start,t.weight,t,e.end,e.weight,e)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n=r(14),i=r(9),o=r(2),a=r(17),s=r(24),u=r(5),l=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},h=function(){function t(){}return t.zoomCorner=function(t,e){var r=new Array,i=new Array,o=new Array;return this.getPanPrimitive(t,r,o,e),this.rearrange(r,o),this.processStart(r,o),this.getResult(r,o,i,e),i.length>0?n.a.build2(i):null},t.getPanPrimitive=function(t,e,r,n){var i,o,a=t.primitives;try{for(var s=l(a),u=s.next();!u.done;u=s.next()){var h=u.value,c=this.panDistance(h,n);void 0!==c&&(e.push(c),r.push(h))}}catch(t){i={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},t.rearrange=function(t,e){for(var r=t.length,n=0,o=0;o<r;o++){var a=e[o],u=t[o],l=o==r-1?t[0]:t[o+1];if(u instanceof i.a&&l instanceof i.a||this.isCW(u.end(),l.start(),a.end())){n=o;break}if(0!=Object(s.d)(u,l)){n=o==r-1?0:o+1;break}}var h=this.start4Index(e,n),c=this.start4Index(t,n);e.length=0,t.length=0,h.forEach((function(t){e.push(t)})),c.forEach((function(e){t.push(e)}))},t.processStart=function(t,e){var r=t.length;if(r>2){var n=t[r-1],o=t[0],a=e[r-1];if(!(n instanceof i.a&&o instanceof i.a||this.isCW(n.end(),o.start(),a.end())))for(var l=Object(s.d)(n,o),h=0;h<l;h+=2){var c=new u.a(s.a[h],s.a[h+1]);t[r-1]=this.generatePrimitive(n,n.start(),c),t[0]=this.generatePrimitive(o,c,o.end())}}},t.getResult=function(t,e,r,n){for(var o=t.length,a=0;a<o;a++){var s=e[a],u=a===o-1?e[0]:e[a+1],l=a==o-1?0:a+1,h=l==o-1?e[0]:e[l+1],c=t[a],f=a==o-1?t[0]:t[a+1],p=l==o-1?t[0]:t[l+1];if(!(c instanceof i.a&&f instanceof i.a||this.isCW(c.end(),f.start(),s.end()))){var d=this.add(t,r,a,c,f,0);d=this.update(t,r,a,f,d);var y=this.generateArc(u,h,f,p,n);if(d=this.add(t,r,a,c,y,d),(d=this.update(t,r,a,y,d))>0)continue}r.push(c);var b=this.generateArc(s,u,c,f,n);void 0!==b&&r.push(b)}},t.generateArc=function(t,e,r,n,o){if(o>0){var s=t.end(),u=e.start(),l=r.end(),h=n.start();if(l.distance2(h)>1e-8){if(s.equals(u)){var c=l.angleD(s),f=h.angleD(s);return i.a.build2(s,c,f,o,o,a.a.CW)}var p=l.angleD(s),d=h.angleD(s),y=l.angleD(u),b=h.angleD(u),v=i.a.build2(s,p,d,o,o,a.a.CW),m=i.a.build2(u,y,b,o,o,a.a.CW);return v.pointOn(v.endAngle()).equals1(h)?v:m.pointOn(m.endAngle()).equals1(h)?m:v}}},t.updateNews=function(t,e,r,n){t[e==t.length-1?0:e+1]=this.generatePrimitive(r,n,r.end())},t.add=function(t,e,r,n,i,o){if(o>0)return o;if(null!=n&&null!=i){for(var a=Object(s.d)(n,i),l=0;l<a;l+=2){var h=new u.a(s.a[l],s.a[l+1]);e.push(this.generatePrimitive(n,n.start(),h)),this.updateNews(t,r,i,h);break}return a}return 0},t.update=function(t,e,r,n,i){if(i>0)return i;var o=e.length;if(o>0&&null!=n){for(var a=e[o-1],l=Object(s.d)(a,n),h=0;h<l;h+=2){var c=new u.a(s.a[h],s.a[h+1]);e[o-1]=this.generatePrimitive(a,a.start(),c),this.updateNews(t,r,n,c)}return l}return 0},t.generatePrimitive=function(t,e,r){if(t instanceof o.a)return new o.a(e,r);if(t instanceof i.a){var n=t,a=e.angleD(n.center),s=r.angleD(n.center);return i.a.build2(n.center,a,s,n.rx,n.ry,n.sweep())}throw new Error("not supported operation")},t.start4Index=function(t,e){for(var r=t.length,n=new Array,i=e;i<r;i++)n.push(t[i]);for(i=0;i<e;i++)n.push(t[i]);return n},t.isCW=function(t,e,r){var n=new o.a(r,t),i=new o.a(r,e),a=n.end().x-n.start().x,s=n.end().y-n.start().y,u=i.end().x-i.start().x;return!(a*(i.end().y-i.start().y)-s*u>0)},t.panDistance=function(t,e){if(t instanceof o.a){if(t.isPoint())return;var r=t.panDistance(e);return r.length()>1e-5?r:void 0}if(t instanceof i.a){var n=t;if(n.sweepAngle>0){if(n.rx-e<=0||n.ry-e<=0)return}else if(n.sweepAngle<0&&(n.rx+e<=0||n.ry+e<=0))return;return(n=n.panDistance(e)).start().distance1(n.end())>1e-5?n:void 0}throw new Error("not supported operation")},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return O}));var n,i=r(61),o=r(74),a=r(73),s=r(1),u=r(9),l=r(2),h=r(106),c=r(14),f=r(60),p=r(64),d=r(26),y=r(17),b=r(6),v=r(52),m=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),w=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},g=function(t,e){return e.bbox().area()-t.bbox().area()},x=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return m(e,t),e.prototype.decide1=function(t){return!t[0]&&t[1]},e}(o.a))(2),O=function(){function t(t,e,r,n,i){var o,u;this.rtree=new a.a(20),this.cache=new Array(30),this.bbox=t,this.autoConnectDistance=s.a.positive(e),this.cutWidth=s.a.positive(r),this.logger=n;try{for(var l=w(i),h=l.next();!h.done;h=l.next()){var c=h.value;this.rtree.add(c)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(u=l.return)&&u.call(l)}finally{if(o)throw o.error}}}return t.prototype.connect=function(){var t,e,r,n,i,o,a,s,c=new Array,f=new Array;try{for(var p=w(this.rtree.items()),d=p.next();!d.done;d=p.next()){var y=d.value;if(c.push(y),y instanceof u.a&&y.end().distance1(y.start())<=this.autoConnectDistance)c.push(new l.a(y.start(),y.end()));else{var b=0,m=0;try{for(var g=(r=void 0,w(this.rtree.search(y.bbox()))),x=g.next();!x.done;x=g.next()){if(y!=(T=x.value)&&((y.start().equals(T.start())||y.start().equals(T.end()))&&b++,(y.end().equals(T.start())||y.end().equals(T.end()))&&m++),b>0&&m>0)break}}catch(t){r={error:t}}finally{try{x&&!x.done&&(n=g.return)&&n.call(g)}finally{if(r)throw r.error}}0!=b&&0!=m||f.push(y)}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(e=p.return)&&e.call(p)}finally{if(t)throw t.error}}var O=new v.a;try{for(var E=w(f),_=E.next();!_.done;_=E.next()){y=_.value;try{for(var N=(a=void 0,w(this.rtree.search(y.bbox().extendOfSize(this.autoConnectDistance)))),A=N.next();!A.done;A=N.next()){var T;if(y!=(T=A.value)){var S=new h.a(y,T),R=S.getDistance();if(this.cutWidth/10<R&&R<=this.autoConnectDistance){var I=S.getLine();O.contains(I)||(c.push(I),O.add(I))}}}}catch(t){a={error:t}}finally{try{A&&!A.done&&(s=N.return)&&s.call(N)}finally{if(a)throw a.error}}}}catch(t){i={error:t}}finally{try{_&&!_.done&&(o=E.return)&&o.call(E)}finally{if(i)throw i.error}}return c},t.prototype.bboxOutline=function(){return new i.a([c.a.build5([this.bbox.minX,this.bbox.minY,this.bbox.minX,this.bbox.maxY,this.bbox.maxX,this.bbox.maxY,this.bbox.maxX,this.bbox.minY])])},t.prototype.detect=function(){var t,e;if(0==this.rtree.size())return this.bboxOutline();var r=this.connect();if(0==r.length)return this.bboxOutline();var n=new f.a(!1),o=new p.a(x.rule,this.logger,n);try{for(var a=w(r),s=a.next();!s.done;s=a.next()){var u=s.value;o.addPolyline(u.stroke(this.cutWidth,d.a.ROUND,y.a.CW).asClosed(),x.weight(0))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}var l=this.bbox.extendOfSize(Math.max(this.bbox.width(),this.bbox.height()));o.addPolyline(c.a.build5([l.minX,l.minY,l.minX,l.maxY,l.maxX,l.maxY,l.maxX,l.minY,l.minX,l.minY]),x.weight(1)),o.simplify(),n.debug&&n.display();var h=n.plGrps;if(h.length<2)return this.bboxOutline();Object(b.c)(h,g,0,h.length);for(var v=new Array,m=1;m<h.length;m++)b.a.addAll(v,h[m].items);return new i.a(v)},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(0),i=r(8),o=function(){function t(t,e,r){this.next=null,this.id=t,this.layer=e,this.name=r}return t.prototype.toString=function(){return i.a.format("LayerNode%d %s alias %s next %d",this.id,this.layer,this.name,null==this.next?-1:this.next.id)},t}(),a=function(){function t(){this._layers=[];var t=1;this.add(n.c.TOP_COPPER,"Top Layer",t++);for(var e=1;e<=30;e++)this.add(new n.c(n.a.INNER,e),i.a.format("Mid-Layer %d",e),t++);this.add(n.c.BOT_COPPER,"Bottom Layer",t++),this.add(n.c.TOP_SILK,"Top Overlay",t++),this.add(n.c.BOT_SILK,"Bottom Overlay",t++),this.add(n.c.TOP_PASTE,"Top Paste",t++),this.add(n.c.BOT_PASTE,"Bottom Paste",t++),this.add(n.c.TOP_SOLDER_MASK,"Top Solder",t++),this.add(n.c.BOT_SOLDER_MASK,"Bottom Solder",t++);for(e=1;e<=16;e++)this.add(new n.c(n.a.PLANE,e),i.a.format("Internal Plane %d",e),t++);this.add(n.c.OTHER,"Drill Guide",t++),this.add(n.c.OUTLINE,"Keep-Out Layer",t++);for(e=1;e<=16;e++)15===e?this.add(n.c.DOCUMENT,"Document",t++):16===e?this.add(n.c.OTHER,"Other",t++):this.add(new n.c(n.a.MECHANICAL,e),i.a.format("Mechanical %d",e),t++);this.add(n.c.OTHER,"Drill Drawing",t++),this.add(n.c.MULTI,"Multi-Layer",t++),this.add(n.c.OTHER,"Connections",t++),this.add(n.c.OTHER,"Background",t++),this.add(n.c.OTHER,"DRC Error Markers",t++),this.add(n.c.OTHER,"Selections",t++),this.add(n.c.OTHER,"Visible Grid 1",t++),this.add(n.c.OTHER,"Visible Grid 2",t++),this.add(n.c.OTHER,"Pad Holes",t++),this.add(n.c.OTHER,"Via Holes",t++)}return t.prototype.layers=function(){return this._layers},t.prototype.add=function(t,e,r){this._layers.push(new o(r,t,e))},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){this.buffer=new Array}return t.prototype.toBlob=function(){return new Blob(this.buffer)},t.prototype.toString=function(){return this.buffer.join("")},t.prototype.isEOF=function(){return!1},t.prototype.write=function(t){return t.length>0&&this.buffer.push(t),t.length},t.prototype.writen1=function(t){return this.writen2(t,0,t.length)},t.prototype.writen2=function(t,e,r){for(var n=0,i=Math.min(e+r,t.length),o=e;o<i;o++){var a=t[o];a.length>0&&(this.buffer.push(a),n+=a.length)}return n},t.prototype.writeAsync=function(t,e){e(this.write(t))},t.prototype.writenAsync1=function(t,e){e(this.writen1(t))},t.prototype.writenAsync2=function(t,e,r,n){n(this.writen2(t,e,r))},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n,i=r(35),o=r(7),a=r(1),s=r(10),u=r(12),l=r(11),h=r(5),c=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),f=function(t){function e(e,r,n,i,o,s,u,l){var h=t.call(this,"","",a.a.notnull(e))||this;return h.origin=r,h.orientation=n,h.position=a.a.notnull(i),h.rotation=a.a.notnull(o),h.width=a.a.positive(s),h.height=a.a.positive(u),h.uri=a.a.notEmpty(l),h._bbox=h.__bbox(),h}return c(e,t),e.prototype.multiply3=function(t){var r=t.iScale,n=this.position,i=new l.a(n.x*r,n.y*r,n.z*r),o=this.origin.multiply3(t),a=u.a.transformD(this.orientation,t);return new e(this.layer,o,a,i,this.rotation,this.width*r,this.height*r,this.uri)},e.prototype.bbox=function(){return this._bbox},e.prototype.shape=function(t,e){throw new Error("unspported")},e.prototype.__bbox=function(){var t=this.width/2,e=this.height/2,r=s.a.rotateD(this.rotation.z);return r=(r=(r=r.translate(this.position.x,this.position.y)).rotateD(this.orientation)).translate(this.origin.x,this.origin.y),(new o.b).ext2(new h.a(-t,-e).multiply3(r)).ext2(new h.a(t,e).multiply3(r)).build()},e}(i.a)},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(72),i=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},o=function(){function t(t){this.vertexsGroup=[],this.buffer=null,this.count=0,this._bbox=void 0,this.vertexsGroup=t}return t.prototype.initBuffer=function(t){var e,r;if(null===this.buffer){var n=new Array;try{for(var o=i(this.vertexsGroup),a=o.next();!a.done;a=o.next()){var s=a.value;this.fillCache(s,n)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}this.count=n.length/6,this.count>0&&(this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(n),t.STATIC_DRAW))}},t.prototype.fillCache=function(t,e){for(var r=0;r<t.length-2;r+=2){var n=t[r],i=t[r+1],o=t[r+2];e.push(n.x,n.y,0),e.push(0,0,1),e.push(i.x,i.y,0),e.push(0,0,1),e.push(o.x,o.y,0),e.push(0,0,1),t.push(n)}t.length=0},t.prototype.isEmpty=function(t){return this.initBuffer(t),0===this.count},t.prototype.bindBuffer=function(t,e,r){return this.initBuffer(t),this.count>0&&(t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.vertexAttribPointer(e,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(r,3,t.FLOAT,!1,24,12)),this.count},t.prototype.bbox=function(){var t,e,r,o;if(void 0===this._bbox){var a=new n.a;try{for(var s=i(this.vertexsGroup),u=s.next();!u.done;u=s.next()){var l=u.value;try{for(var h=(r=void 0,i(l)),c=h.next();!c.done;c=h.next()){var f=c.value;a.ext5(f.x,f.y)}}catch(t){r={error:t}}finally{try{c&&!c.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=s.return)&&e.call(s)}finally{if(t)throw t.error}}a.isValid()?this._bbox=a.build():this._bbox=null}return this._bbox},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(1),i=function(){function t(t,e){void 0===e&&(e={}),this.frameBufferStack=new Array,this.canvas=t,this.attributes=Object.assign({depth:!1,antialias:!1,stencil:!1,alpha:!1,premultipliedAlpha:!1},e);var r=t.getContext("webgl",this.attributes);if(null===r)throw new Error("faild to initial webgl");this.gl=r,this.autoResize()}return t.prototype.getAttrLoc=function(t,e){var r=this.gl.getAttribLocation(t,e);if(r<0)throw new Error("faild to get attribute "+e+" location");return r},t.prototype.getUniformLoc=function(t,e){var r=this.gl.getUniformLocation(t,e);if(null===r)throw new Error("faild to get uniform "+e+" location");return r},t.prototype.createShader=function(t,e){var r=this.gl.createShader(t);if(null===r)throw new Error("invalid shader type");if(this.gl.shaderSource(r,e),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){var n=this.gl.getShaderInfoLog(r);throw new Error(n||"faild to compile shader")}return r},t.prototype.linkProgram=function(t,e){var r=this.gl.createProgram();if(null===r)throw new Error("faild to create program");if(this.gl.attachShader(r,t),this.gl.attachShader(r,e),this.gl.linkProgram(r),!this.gl.getProgramParameter(r,this.gl.LINK_STATUS))throw new Error("faild to link shaders");return r},t.prototype.createProgram=function(t,e){var r=this.createShader(this.gl.VERTEX_SHADER,t),n=this.createShader(this.gl.FRAGMENT_SHADER,e);return this.linkProgram(r,n)},t.prototype.createBuffer=function(){return n.a.notnull(this.gl.createBuffer())},t.prototype.createInitializedEmptyBuffer=function(t,e){var r=this.gl,n=this.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,n),r.bufferData(r.ARRAY_BUFFER,t,e),r.bindBuffer(r.ARRAY_BUFFER,null),n},t.prototype.createElementEmptyBuffer=function(t,e){var r=this.gl,n=this.createBuffer();return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t,e),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),n},t.prototype.createInitializedBuffer=function(t,e){var r=this.gl,n=this.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,n),r.bufferData(r.ARRAY_BUFFER,t,e),r.bindBuffer(r.ARRAY_BUFFER,null),n},t.prototype.bufferSubData=function(t,e,r){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferSubData(n.ARRAY_BUFFER,e,r),n.bindBuffer(n.ARRAY_BUFFER,null)},t.prototype.bufferSubElementData=function(t,e,r){var n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,e,r),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)},t.prototype.setClearColor=function(t,e){void 0===e&&(e=1),this.gl.clearColor(t.x,t.y,t.z,e)},t.prototype.getInstancedArrays=function(){var t=this.gl.getExtension("ANGLE_instanced_arrays");if(null===t)throw new Error("faild to initial webgl");return t},t.prototype.width=function(){return this.canvas.width},t.prototype.height=function(){return this.canvas.height},t.prototype.autoResize=function(t){void 0===t&&(t=window.devicePixelRatio);var e=this.canvas.offsetWidth*t,r=this.canvas.offsetHeight*t;this.canvas.width=e,this.canvas.height=r,this.gl.viewport(0,0,e,r)},t.prototype.enterfb=function(t){this.frameBufferStack.push(t),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t)},t.prototype.leavefb=function(){var t;this.frameBufferStack.pop(),t=this.frameBufferStack.length>0?this.frameBufferStack[this.frameBufferStack.length-1]:null,this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,t)},t.prototype.createUninitializedRGBATexture=function(t,e,r,i,o,a){var s=this.gl,u=n.a.notnull(s.createTexture());return s.bindTexture(s.TEXTURE_2D,u),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,t,e,0,s.RGBA,s.UNSIGNED_BYTE,null),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,i),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,a),u},t.prototype.createRGBATexture=function(t,e,r,i,o){var a=this.gl,s=n.a.notnull(a.createTexture());return a.bindTexture(a.TEXTURE_2D,s),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,i),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,o),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t),a.bindTexture(a.TEXTURE_2D,null),s},t.prototype.createFrameBuffer2Texture=function(t,e,r,i){var o=this.gl,a=n.a.notnull(o.createFramebuffer());if(this.enterfb(a),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),i){var s=n.a.notnull(o.createRenderbuffer());o.bindRenderbuffer(o.RENDERBUFFER,s),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,e,r),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,s)}return this.leavefb(),a},t}()},function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(38),i=r(11),o=new i.a(0,1,0),a=function(){function t(t,e,r,a,s,u,l){void 0===u&&(u=i.a.ORIGIN),void 0===l&&(l=o),this._projectionMatrix=new n.a,this._viewMatrix=new n.a,this.needUpdate=!1,this.fov=t,this.aspect=e,this.near=r,this.far=a,this.position=s,this.target=u,this.up=l,this.offset=i.a.ORIGIN,this.scale=1,this.needUpdate=!0,this.updateMatrix()}return t.prototype.projectionMatrix=function(){return this.updateMatrix(),this._projectionMatrix},t.prototype.getFov=function(){return this.fov},t.prototype.setFov=function(t){this.fov=t,this.needUpdate=!0},t.prototype.getAspect=function(){return this.aspect},t.prototype.setAspect=function(t){this.aspect=t,this.needUpdate=!0},t.prototype.viewMatrix=function(){return this.updateMatrix(),this._viewMatrix},t.prototype.getPosition=function(){return this.position},t.prototype.setPosition=function(t){this.position=t,this.needUpdate=!0},t.prototype.getTarget=function(){return this.target},t.prototype.setTarget=function(t){this.target=t,this.needUpdate=!0},t.prototype.getOffset=function(){return this.offset},t.prototype.setOffset=function(t){this.offset=t},t.prototype.getScale=function(){return this.scale},t.prototype.setScale=function(t){this.scale=t},t.prototype.updateMatrix=function(){this.needUpdate&&(this.lookAt(),this.project(),this.needUpdate=!1)},t.prototype.lookAt=function(){var t=this.position.sub(this.target).normalize(),e=this.up.cross(t).normalize(),r=t.cross(e).normalize();this._viewMatrix=new n.a([e.x,e.y,e.z,0,r.x,r.y,r.z,0,t.x,t.y,t.z,0,this.position.x,this.position.y,this.position.z,1])},t.prototype.project=function(){var t=Math.tan(.5*Math.PI-.5*this.fov),e=1/(this.near-this.far);this._projectionMatrix=new n.a([t/this.aspect,0,0,0,0,t,0,0,0,0,(this.near+this.far)*e,-1,0,0,this.near*this.far*e*2,0])},t}()},function(t,e,r){"use strict";var n=r(48),i=r(38),o=r(57),a=r(114),s=r(90),u=r(102),l=r(103),h=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=2e4,f=new Float32Array([-c,-c,0,0,0,1,c,-c,0,0,0,1,c,c,0,0,0,1,c,c,0,0,0,1,-c,c,0,0,0,1,-c,-c,0,0,0,1]);function p(t){return[t.x,t.y,t.z]}var d=function(){function t(t){this.renderer=t,this.program=t.createProgram("\n    attribute vec4 a_position;\n    attribute vec3 a_normal;\n\n    uniform mediump int u_state; // 0 normal 1 no lighting\n    uniform mat4 u_MVmatrix;\n    uniform mat4 u_MVPmatrix;\n    uniform vec3 u_eyePosition;\n\n    varying vec3 v_normal;\n    varying vec3 v_eyeToSurface; \n\n    void main(){\n        if (u_state == 1) {\n            gl_Position = u_MVPmatrix * a_position;\n        } else {\n            gl_Position = u_MVPmatrix * a_position;\n            v_normal = mat3(u_MVmatrix) * a_normal;\n            vec3 position = vec3(u_MVmatrix * a_position);\n            v_eyeToSurface = u_eyePosition - position;\n        }\n    }\n","\n    precision mediump float;\n\n    uniform int u_state; // 0 normal 1 no lighting\n    uniform vec3 u_ambientColor;\n    uniform vec3 u_diffuseColor;\n    uniform vec3 u_specularColor;\n    uniform float u_shininess;\n    uniform float u_alpha;\n\n    uniform vec3 u_ambientLight;\n    uniform vec3 u_directLight;\n    uniform vec3 u_lightToSurface;\n\n    varying vec3 v_normal;\n    varying vec3 v_eyeToSurface;\n    \n    void main() {\n        if (u_state == 1) {\n            gl_FragColor = vec4(1,1,1,1);\n        } else {\n            vec3 normal = normalize(v_normal);\n            vec3 lightToSurface = normalize(u_lightToSurface);\n            vec3 eyeToSurface = normalize(v_eyeToSurface);\n            float diffuse = abs(dot(normal , lightToSurface));\n            float specular = pow(abs(dot(normal, eyeToSurface)), 300.0) * u_shininess;\n            vec3 diff = vec3(u_diffuseColor * u_directLight) * diffuse;\n            vec3 ambient = vec3(u_ambientColor * u_ambientLight);\n            gl_FragColor.rgb = diff + ambient +  specular * u_specularColor;\n            gl_FragColor.a = u_alpha;\n        }\n    }\n"),this.a_positionLoc=t.getAttrLoc(this.program,"a_position"),this.a_normalLoc=t.getAttrLoc(this.program,"a_normal"),this.u_state=t.getUniformLoc(this.program,"u_state"),this.u_MVmatrixLoc=t.getUniformLoc(this.program,"u_MVmatrix"),this.u_MVPmatrixLoc=t.getUniformLoc(this.program,"u_MVPmatrix"),this.u_eyePositionLoc=t.getUniformLoc(this.program,"u_eyePosition"),this.u_ambientColorLoc=t.getUniformLoc(this.program,"u_ambientColor"),this.u_diffuseColorLoc=t.getUniformLoc(this.program,"u_diffuseColor"),this.u_specularColorLoc=t.getUniformLoc(this.program,"u_specularColor"),this.u_shininessLoc=t.getUniformLoc(this.program,"u_shininess"),this.u_alpha=t.getUniformLoc(this.program,"u_alpha"),this.u_ambientLightLoc=t.getUniformLoc(this.program,"u_ambientLight"),this.u_directLightLoc=t.getUniformLoc(this.program,"u_directLight"),this.u_lightToSurfaceLoc=t.getUniformLoc(this.program,"u_lightToSurface");var e=t.gl;this.polygonFinalBuffer=t.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.polygonFinalBuffer),e.bufferData(e.ARRAY_BUFFER,f,e.STATIC_DRAW)}return t.prototype.render=function(t,e,r,n,i){var h=this.renderer.gl,c=t.camera;h.enableVertexAttribArray(this.a_positionLoc),h.enableVertexAttribArray(this.a_normalLoc);var f=e.multiply4(c.viewMatrix().inverse()).translate(c.getOffset()).scale(c.getScale(),c.getScale(),1),d=f.multiply4(t.camera.projectionMatrix());h.uniformMatrix4fv(this.u_MVmatrixLoc,!1,new Float32Array(f.data)),h.uniformMatrix4fv(this.u_MVPmatrixLoc,!1,new Float32Array(d.data)),h.uniform3fv(this.u_ambientColorLoc,p(n.ambient)),h.uniform3fv(this.u_diffuseColorLoc,p(n.diffuse)),h.uniform3fv(this.u_specularColorLoc,p(n.specular)),h.uniform1f(this.u_shininessLoc,n.shininess),h.uniform1f(this.u_alpha,n.opacity),r instanceof o.a?(h.uniform1i(this.u_state,0),r.bindVertexesBuffer(h,this.a_positionLoc),r.bindNormalsBuffer(h,this.a_normalLoc),h.drawArrays(h.TRIANGLES,0,r.vertexs.length)):r instanceof a.a?this.renderPolygon(r,i):r instanceof s.a?this.renderAnd2(r.geo1,r.geo2,i):r instanceof l.a?this.renderAnd4(r.geo1,r.geo2,r.geo3,r.geo4,i):r instanceof u.a&&this.renderSub(r.geo1,r.geo2,i)},t.prototype.debug=function(){for(var t,e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=this.renderer.gl;try{for(var o=h(r),a=o.next();!a.done;a=o.next()){var s=a.value,u=s.bindBuffer(i,this.a_positionLoc,this.a_normalLoc);i.drawArrays(i.LINE_STRIP,0,u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.renderPolygon=function(t,e){var r=this.renderer.gl,n=t.bindBuffer(r,this.a_positionLoc,this.a_normalLoc);n>0&&(r.enable(r.STENCIL_TEST),r.uniform1i(this.u_state,1),r.clearStencil(0),r.stencilMask(255),r.clear(r.STENCIL_BUFFER_BIT),r.disable(r.DEPTH_TEST),e&&r.depthMask(!1),r.stencilFunc(r.ALWAYS,0,255),r.colorMask(!1,!1,!1,!1),r.stencilOpSeparate(r.FRONT,r.INCR_WRAP,r.INCR_WRAP,r.INCR_WRAP),r.stencilOpSeparate(r.BACK,r.DECR_WRAP,r.DECR_WRAP,r.DECR_WRAP),r.drawArrays(r.TRIANGLES,0,n),r.enable(r.DEPTH_TEST),e&&r.depthMask(!0),r.stencilFunc(r.NOTEQUAL,0,255),r.colorMask(!0,!0,!0,!0),this.bindFinalBuffer(),r.uniform1i(this.u_state,0),r.drawArrays(r.TRIANGLES,0,6),r.disable(r.STENCIL_TEST),r.stencilMask(0))},t.prototype.renderAnd2=function(t,e,r){var n=this.renderer.gl;if(!t.isEmpty(n)&&!e.isEmpty(n)){n.enable(n.STENCIL_TEST),n.stencilMask(255),n.uniform1i(this.u_state,1),n.clearStencil(127),n.clear(n.STENCIL_BUFFER_BIT),n.disable(n.DEPTH_TEST),r&&n.depthMask(!1),n.colorMask(!1,!1,!1,!1);var i=t.bindBuffer(n,this.a_positionLoc,this.a_normalLoc);n.stencilFunc(n.ALWAYS,0,255),n.stencilOpSeparate(n.FRONT,n.INCR_WRAP,n.INCR_WRAP,n.INCR_WRAP),n.stencilOpSeparate(n.BACK,n.DECR_WRAP,n.DECR_WRAP,n.DECR_WRAP),n.drawArrays(n.TRIANGLES,0,i),this.bindFinalBuffer(),n.stencilFunc(n.NOTEQUAL,127,255),n.stencilOp(n.ZERO,n.REPLACE,n.REPLACE),n.drawArrays(n.TRIANGLES,0,6);var o=e.bindBuffer(n,this.a_positionLoc,this.a_normalLoc);n.stencilFunc(n.NOTEQUAL,0,255),n.stencilOpSeparate(n.FRONT,n.KEEP,n.INCR_WRAP,n.INCR_WRAP),n.stencilOpSeparate(n.BACK,n.KEEP,n.DECR_WRAP,n.DECR_WRAP),n.drawArrays(n.TRIANGLES,0,o),this.bindFinalBuffer(),n.stencilFunc(n.EQUAL,127,255),n.stencilOp(n.KEEP,n.ZERO,n.ZERO),n.drawArrays(n.TRIANGLES,0,6),n.uniform1i(this.u_state,0),n.enable(n.DEPTH_TEST),r&&n.depthMask(!0),n.stencilFunc(n.NOTEQUAL,0,255),n.colorMask(!0,!0,!0,!0),this.bindFinalBuffer(),n.drawArrays(n.TRIANGLES,0,6),n.stencilMask(0),n.disable(n.STENCIL_TEST)}},t.prototype.renderAnd4=function(t,e,r,n,i){var o=this.renderer.gl;if(!(t.isEmpty(o)||e.isEmpty(o)||r.isEmpty(o)||n.isEmpty(o))){o.enable(o.STENCIL_TEST),o.stencilMask(255),o.uniform1i(this.u_state,1),o.clearStencil(127),o.clear(o.STENCIL_BUFFER_BIT),o.disable(o.DEPTH_TEST),i&&o.depthMask(!1),o.colorMask(!1,!1,!1,!1);var a=t.bindBuffer(o,this.a_positionLoc,this.a_normalLoc);o.stencilFunc(o.NOTEQUAL,0,255),o.stencilOpSeparate(o.FRONT,o.KEEP,o.INCR_WRAP,o.INCR_WRAP),o.stencilOpSeparate(o.BACK,o.KEEP,o.DECR_WRAP,o.DECR_WRAP),o.drawArrays(o.TRIANGLES,0,a),this.bindFinalBuffer(),o.stencilFunc(o.EQUAL,127,255),o.stencilOp(o.REPLACE,o.ZERO,o.ZERO),o.drawArrays(o.TRIANGLES,0,6);var s=e.bindBuffer(o,this.a_positionLoc,this.a_normalLoc);o.stencilFunc(o.NOTEQUAL,0,255),o.stencilOpSeparate(o.FRONT,o.KEEP,o.INCR_WRAP,o.INCR_WRAP),o.stencilOpSeparate(o.BACK,o.KEEP,o.DECR_WRAP,o.DECR_WRAP),o.drawArrays(o.TRIANGLES,0,s),this.resetStencilBuffer();var u=r.bindBuffer(o,this.a_positionLoc,this.a_normalLoc);o.stencilFunc(o.NOTEQUAL,0,255),o.stencilOpSeparate(o.FRONT,o.KEEP,o.INCR_WRAP,o.INCR_WRAP),o.stencilOpSeparate(o.BACK,o.KEEP,o.DECR_WRAP,o.DECR_WRAP),o.drawArrays(o.TRIANGLES,0,u),this.resetStencilBuffer();var l=n.bindBuffer(o,this.a_positionLoc,this.a_normalLoc);o.stencilFunc(o.NOTEQUAL,0,255),o.stencilOpSeparate(o.FRONT,o.KEEP,o.INCR_WRAP,o.INCR_WRAP),o.stencilOpSeparate(o.BACK,o.KEEP,o.DECR_WRAP,o.DECR_WRAP),o.drawArrays(o.TRIANGLES,0,l),this.bindFinalBuffer(),o.stencilFunc(o.EQUAL,127,255),o.stencilOp(o.KEEP,o.ZERO,o.ZERO),o.drawArrays(o.TRIANGLES,0,6),o.uniform1i(this.u_state,0),o.enable(o.DEPTH_TEST),i&&o.depthMask(!0),o.stencilFunc(o.NOTEQUAL,0,255),o.colorMask(!0,!0,!0,!0),this.bindFinalBuffer(),o.drawArrays(o.TRIANGLES,0,6),o.stencilMask(0),o.disable(o.STENCIL_TEST)}},t.prototype.resetStencilBuffer=function(){var t=this.renderer.gl;this.bindFinalBuffer(),t.stencilFunc(t.EQUAL,127,255),t.stencilOp(t.KEEP,t.ZERO,t.ZERO),t.drawArrays(t.TRIANGLES,0,6),t.stencilFunc(t.LEQUAL,1,255),t.stencilOp(t.INVERT,t.REPLACE,t.REPLACE),t.drawArrays(t.TRIANGLES,0,6),t.stencilFunc(t.GREATER,127,255),t.stencilOp(t.ZERO,t.REPLACE,t.REPLACE),t.drawArrays(t.TRIANGLES,0,6)},t.prototype.renderSub=function(t,e,r){var n=this.renderer.gl;if(!t.isEmpty(n)){n.enable(n.STENCIL_TEST),n.stencilMask(255),n.uniform1i(this.u_state,1),n.clearStencil(127),n.clear(n.STENCIL_BUFFER_BIT),n.disable(n.DEPTH_TEST),r&&n.depthMask(!1),n.colorMask(!1,!1,!1,!1);var i=t.bindBuffer(n,this.a_positionLoc,this.a_normalLoc);n.stencilFunc(n.ALWAYS,0,255),n.stencilOpSeparate(n.FRONT,n.INCR_WRAP,n.INCR_WRAP,n.INCR_WRAP),n.stencilOpSeparate(n.BACK,n.DECR_WRAP,n.DECR_WRAP,n.DECR_WRAP),n.drawArrays(n.TRIANGLES,0,i),this.bindFinalBuffer(),n.stencilFunc(n.NOTEQUAL,127,255),n.stencilOp(n.KEEP,n.ZERO,n.ZERO),n.drawArrays(n.TRIANGLES,0,6);var o=e.bindBuffer(n,this.a_positionLoc,this.a_normalLoc);o>0&&(n.stencilFunc(n.NOTEQUAL,127,255),n.stencilOpSeparate(n.FRONT,n.KEEP,n.INCR_WRAP,n.INCR_WRAP),n.stencilOpSeparate(n.BACK,n.KEEP,n.DECR_WRAP,n.DECR_WRAP),n.drawArrays(n.TRIANGLES,0,o)),n.uniform1i(this.u_state,0),n.enable(n.DEPTH_TEST),r&&n.depthMask(!0),n.stencilFunc(n.EQUAL,0,255),n.colorMask(!0,!0,!0,!0),this.bindFinalBuffer(),n.drawArrays(n.TRIANGLES,0,6),n.stencilMask(0),n.disable(n.STENCIL_TEST)}},t.prototype.bindFinalBuffer=function(){var t=this.renderer.gl;t.bindBuffer(t.ARRAY_BUFFER,this.polygonFinalBuffer),t.vertexAttribPointer(this.a_positionLoc,3,t.FLOAT,!1,24,0),t.vertexAttribPointer(this.a_normalLoc,3,t.FLOAT,!1,24,12)},t}(),y=r(1),b=new Float32Array([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),v=function(){function t(t,e){this.sampling=y.a.positive(e),this.width=t.width(),this.height=t.height(),this.renderer=t,this.program=t.createProgram("\n    attribute vec2 a_position;\n\n    varying vec2 v_uv;\n\n    void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        v_uv = (a_position+1.0)*0.5;\n    }\n","\n    precision mediump float;\n\n    uniform sampler2D u_texture;\n\n    varying vec2 v_uv;\n    \n    void main() {\n        gl_FragColor = texture2D(u_texture, v_uv);\n    }\n"),this.a_position=t.getAttrLoc(this.program,"a_position"),this.u_texture=t.getUniformLoc(this.program,"u_texture");var r=t.gl,n=this.width*e,i=this.height*e;this.texture=t.createUninitializedRGBATexture(n,i,r.LINEAR,r.LINEAR,r.CLAMP_TO_EDGE,r.CLAMP_TO_EDGE),this.fb=t.createFrameBuffer2Texture(this.texture,n,i,!0);var o=t.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,o),r.bufferData(r.ARRAY_BUFFER,b,r.STATIC_DRAW),this.positionBuffer=o}return t.prototype.enable=function(){var t=this.renderer.gl;this.renderer.enterfb(this.fb),t.viewport(0,0,this.width*this.sampling,this.height*this.sampling)},t.prototype.pass=function(){var t=this.renderer.gl;t.viewport(0,0,this.width,this.height),this.renderer.leavefb(),t.disable(t.DEPTH_TEST),t.useProgram(this.program),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.vertexAttribPointer(this.a_position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.a_position),t.uniform1i(this.u_texture,0),t.drawArrays(t.TRIANGLES,0,6)},t}();r.d(e,"a",(function(){return w}));var m=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},w=function(){function t(t,e,r,i){this.group=new n.a,this.blendTasks=new Array,this.antialias=!1,this.renderer=t,this.camera=e,this.ambientLight=r,this.directionalLigth=i,this.program=new d(t),this.ssaa=new v(t,2)}return t.prototype.reset=function(){this.renderer.autoResize(),this.ssaa=new v(this.renderer,2),this.camera.setAspect(this.renderer.width()/this.renderer.height())},t.prototype.render=function(){var t,e,r=this.renderer.gl,n=this.program,o=this.camera,a=this.directionalLigth,s=this.ambientLight,u=o.getPosition(),l=a.direction();this.antialias&&this.ssaa.enable(),r.useProgram(n.program),r.uniform3fv(n.u_eyePositionLoc,[u.x,u.y,u.z]),r.uniform3fv(n.u_ambientLightLoc,[s.color.x,s.color.y,s.color.z]),r.uniform3fv(n.u_directLightLoc,[a.color.x,a.color.y,a.color.z]),r.uniform3fv(n.u_lightToSurfaceLoc,[l.x,l.y,l.z]),r.depthMask(!0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT|r.STENCIL_BUFFER_BIT),r.enable(r.DEPTH_TEST),r.disable(r.BLEND),this.group.draw(this,new i.a),r.enable(r.BLEND),r.depthMask(!1),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);try{for(var h=m(this.blendTasks),c=h.next();!c.done;c=h.next()){var f=c.value;f.mesh.draw1(this,f.mMatrix,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}this.blendTasks.length=0,this.antialias&&this.ssaa.pass()},t}()},function(t,e,r){"use strict";var n=r(38),i=r(11),o=function(){function t(){this.position=i.a.ORIGIN,this.scale=new i.a(1,1,1),this.rotation=i.a.ORIGIN,this.addiMatrix=new n.a,this.updateFlag=!1,this.matrix=new n.a}return t.prototype.getPosition=function(){return this.position},t.prototype.setPosition=function(t){return this.position=t,this.updateFlag=!0,this},t.prototype.getScale=function(){return this.scale},t.prototype.setScale=function(t){return this.scale=t,this.updateFlag=!0,this},t.prototype.getRotation=function(){return this.rotation},t.prototype.setRotation=function(t){return this.rotation=t,this.updateFlag=!0,this},t.prototype.getAddiMatrix=function(){return this.addiMatrix},t.prototype.setAddiMatrix=function(t){return this.addiMatrix=t,this.updateFlag=!0,this},t.prototype.getMatrix=function(){return this.updateFlag&&(this.matrix=(new n.a).rotateX(this.rotation.x).rotateY(this.rotation.y).rotateZ(this.rotation.z).scale(this.scale.x,this.scale.y,this.scale.z).translate(this.position).multiply4(this.addiMatrix),this.updateFlag=!1),this.matrix},t}();r.d(e,"a",(function(){return u}));var a,s=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(o)},function(t,e,r){"use strict";var n=r(28),i=r(66),o=r(95),a=function(){function t(t){this.s=t}return t.prototype.equals=function(e){return!(e instanceof t)||this.s===e.s},t}(),s=function(){function t(t){this.pourOnly=new o.a,this.logger=t}return t.prototype.pours=function(){return this.pourOnly.array()},t.prototype.addPourOnly=function(t){this.pourOnly.add(new a(t))},t.prototype.contains=function(t){return this.pourOnly.isEmpty()||this.pourOnly.contains(new a(t))},t}(),u=r(96),l=r(20),h=r(53),c=r(14),f=r(60),p=r(64),d=r(6),y=r(26),b=r(17),v=r(73),m=r(0),w=r(74),g=r(32),x=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function O(t){return{}}var E,_=function(){function t(t){this.points=new Array,this.centerPlIds=new g.a,this.plIndex=new Array,this.net=t}return t.prototype.add=function(t,e){var r,n,i=this.plIndex.length;try{for(var o=x(e),a=o.next();!a.done;a=o.next()){var s=a.value;this.points.push(s),this.centerPlIds.computeIfAbsent(s,O)[i]=!0}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.plIndex.push(t)},t}(),N=r(43),A=r(54),T=r(18),S=r(7),R=r(30),I=r(2),P=r(36),C=r(61),L=r(108),D=r(83),M=r(67),k=r(84),U=r(24),B=(E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),F=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Y=new Error,G=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.decide1=function(t){return t[0]&&t[1]},e}(w.a))(2),z=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.onPolylineGroup=function(t,e){throw Y},e.prototype.onSegment=function(t,e,r,n,i,o){throw Y},e}(L.a)),W=function(t,e){this.rtree=t,this.level=e},X=function(t){function e(e){return t.call(this,new D.a(!1),G.rule,e,z)||this}return B(e,t),e.isIntersect=function(t,r,i){void 0===i&&(i=n.c.DUMMY);var o=new e(i),a=o.createGroup1(t.items),s=o.createGroup2(r.items);return o.isIntersect(a,s)},e.prototype.createGroup1=function(t){return this.createGroup(t,0)},e.prototype.createGroup2=function(t){return this.createGroup(t,1)},e.prototype.createGroup=function(t,e){var r,n,i=G.weight(e);try{for(var o=F(t),a=o.next();!a.done;a=o.next()){var s=a.value;this.addPolyline(s,i)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}var u=this.buildRTree();return this.sides.length=0,new W(u,e)},e.prototype.isIntersect=function(t,e){if(t.level!==e.level){var r=t.rtree.bbox().intersection1(e.rtree.bbox());if(null!==r){try{this.inters(t,e);var n=(r.minY+r.maxY)/2;this.sweep(t,e,n)}catch(t){if(t===Y)return!0;throw t}return!1}return!1}throw new Error("inersection detection should not in same group")},e.prototype.inters=function(t,e){var r,n,i,o;if(t.rtree.size()>e.rtree.size()){var a=t;t=e,e=a}try{for(var s=F(t.rtree.items()),u=s.next();!u.done;u=s.next()){var l=u.value;l.trans=NaN;var h=l.bbox().extendOfSize(1e-5);try{for(var c=(i=void 0,F(e.rtree.search(h))),f=c.next();!f.done;f=c.next()){var p=f.value;if(p.trans=NaN,Object(U.d)(l.shape,p.shape)>0)throw Y}}catch(t){i={error:t}}finally{try{f&&!f.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}},e.prototype.sweep=function(t,e,r){var n,i,o=S.a.extend2(t.rtree.bbox(),e.rtree.bbox()).extendOfSize(1e-5),a=new Array;this.fillValidSides(a,t.rtree.search(o),r),this.fillValidSides(a,e.rtree.search(o),r),Object(d.c)(a,(function(t,e){return t.getX(r)-e.getX(r)}),0,a.length);var s=new k.a(this.rule,this,r);try{for(var u=F(a),l=u.next();!l.done;l=u.next()){var h=l.value;s.onEp(h)}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}},e}(M.a),j=function(){function t(t){this.connected=new Array,this.plg=t,this.pi=new X(n.c.DUMMY),this.pig1=this.pi.createGroup1(t.items)}return t.prototype.intersected=function(t){var e=this.pi.createGroup2([t]);return this.pi.isIntersect(this.pig1,e)},t}(),H=r(10),V=r(22),K=r(109),Z=r(47),q=r(15),Q=r(55),J=r(1),$=r(110),tt=r(49),et=r(97),rt=r(5),nt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),it=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ot=function(t){function e(e){var r=t.call(this,e)||this;return r.segments=new Array,r.y=NaN,r}return nt(e,t),e.prototype.onSegment=function(e,r,n,i,o,a){e=new rt.a(n.getX(this.y),this.y),i=new rt.a(a.getX(this.y),this.y),t.prototype.onSegment.call(this,e,r,n,i,o,a),this.segments.push(new I.a(e,i))},e}(et.a),at=function(t){function e(e){var r=t.call(this,new D.a(!0),h.b,e,new ot(!1))||this;return r.rtree=null,r.collector=r.event,r}return nt(e,t),e.prototype.addPolyline=function(e,r){void 0===r&&(r=1),t.prototype.addPolyline.call(this,e,r)},e.prototype.scan=function(t,e){var r,n;null===this.rtree&&(this.rtree=this.buildRTree()),this.collector.y=t;var i=e.bbox().extendOfSize(1e-5),o=new Array;this.fillValidSides(o,this.rtree.search(i),t),Object(d.c)(o,(function(e,r){return e.getX(t)-r.getX(t)}),0,o.length);var a=new k.a(this.rule,this,t);try{for(var s=it(o),u=s.next();!u.done;u=s.next()){var l=u.value;a.onEp(l)}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}var h=new Array;return d.a.addAll(h,this.collector.segments),this.collector.segments.length=0,h},e}(M.a),st=r(101),ut=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function ht(t){var e,r;if(1===t.length)return t[0].items;var n=new Array;try{for(var i=lt(t),o=i.next();!o.done;o=i.next()){var a=o.value;d.a.addAll(n,a.items)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function ct(t,e){return ht(Object(p.b)(t,e))}function ft(t,e){return t.pourIndex-e.pourIndex}function pt(t){return new v.a(10)}var dt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.decide1=function(t){return t[0]&&t[1]},e}(w.a))(2),yt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.decide1=function(t){return t[0]&&t[1]&&!t[2]},e}(w.a))(3),bt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ut(e,t),e.prototype.decide1=function(t){return t[0]&&!t[1]&&(t[2]||!t[3])},e}(w.a))(4),vt=function(){function t(t,e,r){this.pours=[],this.pourClearance=[],this.thermalClearance=[],this.thermalConnector=[],this.outlineCache=[],this.pcbLayerRTreeMap=new g.a,this.shapeRTree=new v.a(20),this.cache=new Array(100),this.box2d=new S.b,this.netPolylineIndex={},this.productWidth=NaN,this.minStrokeWidth=NaN,this.baseClearance=NaN,this.thermalWidth=NaN,this.logger=e.logger,this.document=t,this.ev=r,this.setting=e}return t.prototype.outputDebug=function(t){if(t.debug){var e=t.display(),r=new st.a(e,n.c.DUMMY).export();null!==r&&d.a.downloadFile("debug.pcbdoc",new Blob(r))}},t.prototype.merge1=function(t,e,r){var n=new f.a(t);return this.merge2(n,e,r),n},t.prototype.merge2=function(t,e,r){var n,i;if(null!==r){for(var o=new p.a(e.rule,this.logger,t),a=0;a<r.length;a++){var s=e.weight(a),u=r[a];if(null!==u)try{for(var l=(n=void 0,lt(u)),h=l.next();!h.done;h=l.next()){var c=h.value;o.addPolyline(c.asClosed(),s)}}catch(t){n={error:t}}finally{try{h&&!h.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}o.simplify(),this.outputDebug(t)}},t.prototype.merge3=function(t,e,r){var n=new f.a(t);return this.merge4(n,e,r),n},t.prototype.merge4=function(t,e,r){var n,i;if(null!==r){for(var o=new p.a(e,this.logger,t),a=0;a<r.length;a++){var s=r[a];if(null!==s)try{for(var u=(n=void 0,lt(s)),l=u.next();!l.done;l=u.next()){var h=l.value;o.addPolyline(h.asClosed())}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}o.simplify(),this.outputDebug(t)}},t.prototype.fillArea=function(){this.addDocShapes2RTree(),this.addPolygonPour2Doc()},t.prototype.addDocShapes2RTree=function(){var t,e,r,n;try{for(var i=lt(this.document.shapes),o=i.next();!o.done;o=i.next()){var a=o.value;if(a instanceof N.a)try{for(var s=(r=void 0,lt(a.shapes)),u=s.next();!u.done;u=s.next()){var l=u.value;this.addShape2RTree(l)}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}else this.addShape2RTree(a);this.box2d.ext1(a.bbox())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}},t.prototype.addPolygonPour2Doc=function(){var t,e;Object(d.c)(this.pours,ft,0,this.pours.length);var r=this.buildOutline();try{for(var n=lt(this.pours),i=n.next();!i.done;i=n.next()){var o=i.value;if(null!==o.method&&this.setting.contains(o.id)){var a=this.getPour(o,r);this.ev.onShape(a)}else this.ev.onShape(o);this.addNode2RTree(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}},t.prototype.addShape2RTree=function(t){if(t instanceof l.b)this.pours.push(t);else if(t instanceof A.a){var e=t.bbox(),r=c.a.build4([e.UL(),e.UR(),e.LR(),e.LL(),e.UL()]),n=new T.a(t.net,t.layer,T.b.SOLID,r);this.addNode2RTree(n),this.ev.onShape(t)}else this.addNode2RTree(t),this.ev.onShape(t)},t.prototype.addNode2RTree=function(t){switch(t.layer.type){case m.a.TOP_COPPER:case m.a.BOT_COPPER:case m.a.INNER:case m.a.MULTI:this.pcbLayerRTreeMap.computeIfAbsent(t.layer,pt).add(t);break;case m.a.OUTLINE:t instanceof R.a?this.outlineCache.push(new I.a(t.start,t.end)):t instanceof P.a&&this.outlineCache.push(t.arc)}},t.prototype.getPour=function(t,e){var r,n,i,o,a,s;this.shapeRTree.clear(),this.pourClearance.length=0,this.thermalClearance.length=0,this.thermalConnector.length=0,this.netPolylineIndex={},this.minStrokeWidth=Number.POSITIVE_INFINITY,this.baseClearance=0,this.productWidth=0,this.thermalWidth=this.getThermalWidth(t),this.logger.info3("pp %s step 1",t.id),this.baseClearance=t.clearance,t.method instanceof l.c?this.productWidth=t.method.neckThickness:t.method instanceof l.a?this.productWidth=this._getClearance(Math.max(.8,t.method.gridWidth)):this.productWidth=.8,this.getSinglePourLayerPolyline(t,this.baseClearance);var u=this.combindOutlines(t,e);this.logger.info3("pp %s step 2",t.id),this.mergeSameNet(this.baseClearance),this.logger.info3("pp %s step 3",t.id);var c=this.merge1(!1,bt,[u,this.pourClearance,this.thermalConnector,this.thermalClearance]);this.logger.info3("pp %s step 4",t.id);var f=[],p=[];if(t.method instanceof l.c){var y=new Array,b=void 0;if(t.method.neckThickness>0){try{for(var v=lt(c.plGrps),m=v.next();!m.done;m=v.next()){var w=m.value;null!==(A=this.zoom(w))&&d.a.addAll(y,A.items)}}catch(t){r={error:t}}finally{try{m&&!m.done&&(n=v.return)&&n.call(v)}finally{if(r)throw r.error}}b=this.merge3(!1,h.b,[y]).plGrps}else b=c.plGrps;try{for(var g=lt(b),x=g.next();!x.done;x=g.next()){w=x.value;var O=this.buildConnection(t,w);(t.keepIsland||0!==O.connected.length)&&(f.push(w),p.push(O))}}catch(t){i={error:t}}finally{try{x&&!x.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}}else if(t.method instanceof l.a){var E=t.method.gridWidth+t.method.gridClearance;0==E?E=2*this.productWidth:this.productWidth+=.01;try{for(var _=lt(c.plGrps),N=_.next();!N.done;N=_.next()){var A;w=N.value;if(null!==(A=this.zoom(w))){O=this.buildConnection(t,A);(t.keepIsland||0!==O.connected.length)&&(this.gnrGrids(f,E,w),p.push(O))}}}catch(t){a={error:t}}finally{try{N&&!N.done&&(s=_.return)&&s.call(_)}finally{if(a)throw a.error}}}return this.logger.info3("pp %s step 5",t.id),this.ev.onPourConnection(t.id,p),new l.b(t.id,t.net,t.layer,t.method,this.productWidth-.01,t.clearance,t.thermal,t.keepIsland,t.pourIndex,t.outlines,f)},t.prototype.combindOutlines=function(t,e){var r,n,i,o,a,s,u,l,h=this._getClearance(t.outlineClearance)-.05,f=new Array,v=new Array,m=new Array,w=new Array;d.a.addAll(v,ht(Object(p.b)(c.a.build2(t.outlines),-this.productWidth/2)));try{for(var g=lt(e.search(t.bbox().extendOfSize(.01))),x=g.next();!x.done;x=g.next()){var O=x.value;if(m.push(O),h>0)try{for(var E=(i=void 0,lt(O.primitives)),_=E.next();!_.done;_=E.next()){var N=_.value;w.push(N.stroke(2*h,y.a.ROUND,b.a.CCW))}}catch(t){i={error:t}}finally{try{_&&!_.done&&(o=E.return)&&o.call(E)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{x&&!x.done&&(n=g.return)&&n.call(g)}finally{if(r)throw r.error}}try{for(var A=lt(this.merge1(!1,yt,[v,m,w]).plGrps),T=A.next();!T.done;T=A.next()){var S=T.value;try{for(var R=(u=void 0,lt(S.items)),I=R.next();!I.done;I=R.next()){O=I.value;f.push(O)}}catch(t){u={error:t}}finally{try{I&&!I.done&&(l=R.return)&&l.call(R)}finally{if(u)throw u.error}}}}catch(t){a={error:t}}finally{try{T&&!T.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}return f},t.prototype.mergeSameNet=function(t){var e,r,n=t+t+Math.min(this.minStrokeWidth/2,t);for(var i in n*=n,this.netPolylineIndex){for(var o=this.netPolylineIndex[i],a={},s=0;s<o.points.length;s++){for(var u=o.points[s],l=!1,c=s+1;c<o.points.length;c++){var f=o.points[c];u.distance2(f)<n&&(this.addAllPlIds(a,o,f),l=!0)}l&&this.addAllPlIds(a,o,u)}var p=new Array;for(var y in a)p.push(o.plIndex[y]);if(p.length>2)try{for(var b=(e=void 0,lt(this.merge3(!1,h.b,[p]).plGrps)),v=b.next();!v.done;v=b.next()){var m=v.value;d.a.addAll(this.pourClearance,m.items)}}catch(t){e={error:t}}finally{try{v&&!v.done&&(r=b.return)&&r.call(b)}finally{if(e)throw e.error}}else d.a.addAll(this.pourClearance,p);for(s=0;s<o.plIndex.length;s++)s in a||this.pourClearance.push(o.plIndex[s])}},t.prototype.addAllPlIds=function(t,e,r){var n=e.centerPlIds.get(r);if(null!==n)for(var i in n)t[i]=!0},t.prototype.gnrGrids=function(t,e,r){var n,i,o=new Array;try{for(var a=lt(r.items),s=a.next();!s.done;s=a.next()){var u=s.value;o.push(u)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}this.fillGrids(e,o,r,0),this.fillGrids(e,o,r,Math.PI/2),t.push(new C.a(o))},t.prototype.fillGrids=function(t,e,r,n){var i,o,a,s,u=new at(this.logger),l=H.a.rotate(-n),h=H.a.rotate(n);try{for(var f=lt(r.items),p=f.next();!p.done;p=f.next()){var y=p.value;u.addPolyline(y.multiply3(l))}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}for(var b=this.box2d.build().transform(l),v=new Array,m=b.minY;m<=b.maxY;m+=t){var w=new I.a(new rt.a(b.minX,m),new rt.a(b.maxX,m));d.a.addAll(v,u.scan(m,w))}try{for(var g=lt(v),x=g.next();!x.done;x=g.next()){w=x.value;var O=new Array;O.push(w.multiply3(h)),e.push(c.a.build1(Object(V.a)(O)))}}catch(t){a={error:t}}finally{try{x&&!x.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}},t.prototype.zoom=function(t){var e,r,n=new Array;try{for(var i=lt(t.items),o=i.next();!o.done;o=i.next()){var a=o.value,s=K.a.zoomCorner(a,this.productWidth/2);null!==s&&n.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n.length>0?new C.a(n):null},t.prototype.buildConnection=function(t,e){var r,n,i=new j(e);try{for(var o=lt(this.shapeRTree.search(e.bbox())),a=o.next();!a.done;a=o.next()){var s=a.value,u=!1,h=null;if(s instanceof q.f){var f=s.shape(t.layer,0);f instanceof c.a&&(h=f)}else s instanceof Z.a||s instanceof R.a||s instanceof P.a||s instanceof Q.a?h=s.shape(t.layer,0):s instanceof T.a?s.kind!==T.b.POLYGON_CUTOUT&&(h=s.shape(t.layer,0)):s instanceof l.b&&s!==t&&(s.net,t.net);null!==h&&(u=i.intersected(h.asClosed())),u&&i.connected.push(s)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},t.prototype.getSinglePourLayerPolyline=function(t,e){var r,n,i,o,a=t.bbox().extendOfSize(e),s=this.pcbLayerRTreeMap.get(t.layer);if(null!==s)try{for(var u=lt(s.search(a)),l=u.next();!l.done;l=u.next()){var h=l.value;this.dispatcher(h,t)}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}var c=this.pcbLayerRTreeMap.get(m.c.MULTI);if(null!==c)try{for(var f=lt(c.search(a)),p=f.next();!p.done;p=f.next()){if((h=p.value)instanceof R.a||h instanceof P.a){var d=h.shape(h.layer,0);null!==d&&this.pourClearance.push(d)}else this.dispatcher(h,t)}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}},t.prototype.dispatcher=function(t,e){var r=!J.a.nullOrEmpty(t.net)&&t.net===e.net;if(r&&this.shapeRTree.add(t),t instanceof R.a&&!r&&this.generatePcbTrack(t,e),t instanceof P.a&&!r&&this.generatePcbArc(t,e),t instanceof T.a&&!r&&this.generatePcbRegion(t,e),t instanceof Z.a){var n=t;r||this.generatePcbVia1(n,e)}if(t instanceof q.f){var i=t;r||this.generatePcbPad1(i,e),r&&e.method instanceof l.c&&e.thermal&&this.generatePcbPad2(i,e)}if(t instanceof Q.a&&!r&&this.generatePcbFill(t,e),t instanceof l.b){var o=t,a=o.shape(o.layer,0);if(null!==a)if(r&&e.method instanceof l.c&&o.method instanceof l.c);else if(r)d.a.addAll(this.pourClearance,ct(a,this.productWidth/2));else{var s=this.getClearance(o,0);d.a.addAll(this.pourClearance,ct(a,s))}}},t.prototype.generatePcbTrack=function(t,e){var r=this.getClearance(t,0),n=t.shape(e.layer,r);null!==n&&this.updateIndex(t.net,t.width,n,[t.start,t.end])},t.prototype.generatePcbArc=function(t,e){var r=this.getClearance(t,0),n=t.shape(e.layer,r);null!==n&&this.updateIndex(t.net,t.width,n,[t.arc.start(),t.arc.end()])},t.prototype.buildOutline=function(){var t,e,r=new $.a(this.box2d.build(),2,.1,this.logger,this.outlineCache),n=new v.a(20);try{for(var i=lt(r.detect().items),o=i.next();!o.done;o=i.next()){var a=o.value;n.add(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t.prototype.generatePcbRegion=function(t,e){var r=t.shape(e.layer,0);null!==r&&(t.kind===T.b.POLYGON_CUTOUT?d.a.addAll(this.pourClearance,ct(r,this.productWidth/2)):d.a.addAll(this.pourClearance,ct(r,this.getClearance(t,0))))},t.prototype.generatePcbFill=function(t,e){var r,n,i=this.getClearance(t,0),o=t.shape(e.layer,0);if(null!==o)try{for(var a=lt(ct(o,i)),s=a.next();!s.done;s=a.next()){var u=s.value;this.updateIndex(t.net,u.bbox().width(),u,[t.bbox().center()])}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.getThermalWidth=function(t){var e,r;try{for(var n=lt(this.matchRules(t)),i=n.next();!i.done;i=n.next()){var o=i.value;if(o instanceof tt.f)return o.width}}catch(t){e={error:t}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return 0},t.prototype.getClearance=function(t,e){var r,n,i=-1;try{for(var o=lt(this.matchRules(t)),a=o.next();!a.done;a=o.next()){var s=a.value;if(s instanceof tt.b){i=s.clearance;break}}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this._getClearance(Math.max(Math.max(i,e),this.baseClearance))},t.prototype._getClearance=function(t){return t+.01+this.productWidth/2},t.prototype.matchRules=function(t){var e,r,n=new Array;try{for(var i=lt(this.document.rules),o=i.next();!o.done;o=i.next()){var a=o.value;this.isMatch(t,a.selector)&&n.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n},t.prototype.isMatch=function(t,e){var r,n;if(e instanceof tt.d)return e.net===t.net;if(e instanceof tt.c)return t.id===e.id;if(e instanceof tt.a)return!0;if(e instanceof tt.e){try{for(var i=lt(e.selectors),o=i.next();!o.done;o=i.next()){var a=o.value;if(this.isMatch(t,a))return!0}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!1}return!1},t.prototype.generatePcbVia1=function(t,e){var r=this.getClearance(t,0),n=t.shape(e.layer,r);null!==n&&this.updateIndex(t.net,n.bbox().width(),n,[t.center])},t.prototype.generatePcbPad2=function(t,e){var r,n,i=this.getClearance(t,0);i=i>.6+this.productWidth/2?i:.601+this.productWidth/2;var o=t.shape(e.layer,i),a=new Array;if(Array.isArray(o))try{for(var s=lt(o),u=s.next();!u.done;u=s.next()){var l=u.value;d.a.addAll(a,l.items)}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}else o instanceof c.a&&a.push(o);if(a.length>0){var h=null;null!==t.shapes.top&&e.layer.equals(m.c.TOP_COPPER)&&(h=t.shapes.top),null!==t.shapes.bot&&e.layer.equals(m.c.BOT_COPPER)&&(h=t.shapes.bot),null!==t.shapes.top&&null!==t.shapes.bot&&null!==t.shapes.inner&&e.layer.type===m.a.INNER&&(h=t.shapes.inner),null!==h&&this.genThermal(t,i,a,h.xSize,h.ySize)}},t.prototype.genThermal=function(t,e,r,n,i){var o,a,s,u;try{for(var l=lt(r),h=l.next();!h.done;h=l.next()){var c=h.value;this.thermalClearance.push(c)}}catch(t){o={error:t}}finally{try{h&&!h.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}var f=this.thermal(t,n+1,i+1,e),p=this.merge1(!1,dt,[f,r]);try{for(var y=lt(p.plGrps),b=y.next();!b.done;b=y.next()){var v=b.value;d.a.addAll(this.thermalConnector,v.items)}}catch(t){s={error:t}}finally{try{b&&!b.done&&(u=y.return)&&u.call(y)}finally{if(s)throw s.error}}},t.prototype.thermal=function(t,e,r,n){var i,o,a;if(t instanceof q.f)i=t.location;else{if(!(t instanceof Z.a))throw new Error("not supported operation");i=t.center}0===this.thermalWidth?(o=e/2,a=r/2):(o=this.thermalWidth,a=this.thermalWidth),o=o-this.productWidth>0?o-this.productWidth:.01,a=a-this.productWidth>0?a-this.productWidth:.01;var s=[];if(s.push(new I.a(i.add1(-e/2-n,0),i.add1(e/2+n,0)).stroke(a,y.a.SQUARE,b.a.CW)),s.push(new I.a(i.add1(0,-r/2-n),i.add1(0,r/2+n)).stroke(o,y.a.SQUARE,b.a.CW)),t instanceof q.f)for(var u=H.a.translate(t.shapes.offsetX,t.shapes.offsetY).multiply3(H.a.rotateD(t.rotation).setOrigin1(t.location)),l=0;l<s.length;l++)s[l]=s[l].multiply3(u);return s},t.prototype.generatePcbPad1=function(t,e){var r,n,i,o,a=this.getClearance(t,0),s=t.shape(e.layer,a);if(null!==s)if(s instanceof c.a)this.updateIndex(t.net,s.bbox().width(),s,[t.location]);else try{for(var u=lt(s),l=u.next();!l.done;l=u.next()){var h=l.value;try{for(var f=(i=void 0,lt(h.items)),p=f.next();!p.done;p=f.next()){var d=p.value;this.updateIndex(t.net,d.bbox().width(),d,[t.location])}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}},t.prototype.updateIndex=function(t,e,r,n){t=t.toUpperCase().trim();var i=this.netPolylineIndex[t];void 0===i&&(i=new _(t),this.netPolylineIndex[t]=i),i.add(r,n),this.minStrokeWidth>e&&(this.minStrokeWidth=e)},t}(),mt=r(8),wt=r(99),gt=r(91),xt=r(105);r.d(e,"a",(function(){return Et}));var Ot=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Et(t){var e,r,o,a,h,c,f,p,d=new n.c(n.a.INFO),y={},b={},v={};try{d.info1("start pour");var m=JSON.parse(t),w=function(t,e){var r=new gt.a("inner",e);return r.preferOriginShape=!0,r.pourOnly=!0,new xt.a(r).parse(t).getDocs()}(m.datastr,d)[0];if(d.info1("complete parse"),!(w instanceof i.a))throw new Error("unsupported doc type");var g=new s(d);try{for(var x=Ot(m.ids),O=x.next();!O.done;O=x.next()){var E=O.value;g.addPourOnly(E)}}catch(t){e={error:t}}finally{try{O&&!O.done&&(r=x.return)&&r.call(x)}finally{if(e)throw e.error}}var _=new u.a(d,w.layerStack),N=[],A={};new vt(w,g,new(function(){function t(){}return t.prototype.onShape=function(t){t instanceof l.b&&N.push(t)},t.prototype.onPourConnection=function(t,e){A[t]=e},t}())).fillArea(),d.info2("complete pour");var T=g.pours();if(0===T.length)try{for(var S=Ot(N),R=S.next();!R.done;R=S.next()){var I=R.value;_t(b,v,_,A,I)}}catch(t){o={error:t}}finally{try{R&&!R.done&&(a=S.return)&&a.call(S)}finally{if(o)throw o.error}}else{var P={};try{for(var C=Ot(N),L=C.next();!L.done;L=C.next()){P[(I=L.value).id]=I}}catch(t){h={error:t}}finally{try{L&&!L.done&&(c=C.return)&&c.call(C)}finally{if(h)throw h.error}}try{for(var D=Ot(T),M=D.next();!M.done;M=D.next()){var k=M.value;void 0===(I=P[k.s])?b[k.s]=[]:_t(b,v,_,A,I)}}catch(t){f={error:t}}finally{try{M&&!M.done&&(p=D.return)&&p.call(D)}finally{if(f)throw f.error}}}var U={};for(var B in v){var F=v[B],Y={};for(var G in F)Y[G]=F[G];U[B]=Y}y.pours=b,y.connect=U,d.info2("end pour")}catch(t){d.error2(t)}return JSON.stringify(y)}function _t(t,e,r,n,i){var o=function(t,e,r){var n,i,o,a,s=new Array;if(void 0!==r)try{for(var u=Ot(r),l=u.next();!l.done;l=u.next()){var h=l.value,c=new Array;new Array;try{for(var f=(o=void 0,Ot(h.connected)),p=f.next();!p.done;p=f.next()){var d=p.value,y="",b="",v="",w=rt.a.ORIGIN;d instanceof q.f?(y="PAD",v=e.info2(d.layer).id.toString(),w=d.location,b=d.id):d instanceof Z.a&&(y="VIA",v=e.info2(m.c.MULTI).id.toString(),w=d.center,b=d.id);var g=d.bbox();c.push({cmd:y,fid:t,gid:b,layerId:v,width:g.width(),height:g.height(),x:w.x,y:-w.y})}}catch(t){o={error:t}}finally{try{p&&!p.done&&(a=f.return)&&a.call(f)}finally{if(o)throw o.error}}s.push({connectedPadOrViaArr:c,polygon:[]})}}catch(t){n={error:t}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return s}(i.id,r,n[i.id]),a=mt.a.format("%s_%d",i.net,r.info2(i.layer).id);a in e||(e[a]={}),e[a][i.id]=o,i.method instanceof l.a?t[i.id]={stroke:mt.a.fmtNumber(i.method.gridWidth),paths:Nt(i)}:t[i.id]={paths:Nt(i)}}function Nt(t){var e,r,n,i,o,a,s,u,h=new Array;if(t.method instanceof l.a){if(null!==t.coppered)try{for(var c=Ot(t.coppered),f=c.next();!f.done;f=c.next()){var p=f.value,d=new wt.a;try{for(var y=(n=void 0,Ot(p.items)),b=y.next();!b.done;b=y.next()){var v=b.value;try{for(var m=(o=void 0,Ot(v.primitives)),w=m.next();!w.done;w=m.next()){var g=w.value;g.start().distance2(g.end())>1e-6&&(d.encPt(g),d.close(!1))}}catch(t){o={error:t}}finally{try{w&&!w.done&&(a=m.return)&&a.call(m)}finally{if(o)throw o.error}}}}catch(t){n={error:t}}finally{try{b&&!b.done&&(i=y.return)&&i.call(y)}finally{if(n)throw n.error}}h.push(d.toString())}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}}else if(null!==t.coppered)try{for(var x=Ot(t.coppered),O=x.next();!O.done;O=x.next()){p=O.value;h.push(At(p,!0))}}catch(t){s={error:t}}finally{try{O&&!O.done&&(u=x.return)&&u.call(x)}finally{if(s)throw s.error}}return h}function At(t,e){var r,n,i=new wt.a;try{for(var o=Ot(t.items),a=o.next();!a.done;a=o.next()){var s=a.value;i.encPl(s),i.close(e)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i.toString()}},function(t,e){t.exports='<!DOCTYPE html>\r\n<html lang="en">\r\n\t<head>\r\n\t\t<meta charset="UTF-8" />\r\n\t\t<title></title>\r\n\t\t<style>\r\n\t\t\tbody {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\tfont: 16px/1 sans-serif;\r\n\t\t\t\t-moz-osx-font-smoothing: grayscale;\r\n\t\t\t\t-webkit-font-smoothing: antialiased;\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t}\r\n\r\n\t\t\t#canvas {\r\n\t\t\t\twidth: 100vw;\r\n\t\t\t\theight: 100vh;\r\n\t\t\t\tz-index: 0;\r\n\t\t\t}\r\n\t\t</style>\r\n\t</head>\r\n\r\n\t<body>\r\n\t\t<div id="canvas" tabindex="0"></div>\r\n\t</body>\r\n</html>\r\n'},function(t,e,r){t.exports=function t(e,r,n){function i(a,s){if(!r[a]){if(!e[a]){if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};e[a][0].call(l.exports,(function(t){var r=e[a][1][t];return i(r||t)}),l,l.exports,t,e,r,n)}return r[a].exports}for(var o=!1,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(t,e,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)i(r,n)&&(t[n]=r[n])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var o={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+n),i);else for(var o=0;o<n;o++)t[i+o]=e[r+o]},flattenChunks:function(t){var e,r,n,i,o,a;for(n=0,e=0,r=t.length;e<r;e++)n+=t[e].length;for(a=new Uint8Array(n),i=0,e=0,r=t.length;e<r;e++)o=t[e],a.set(o,i),i+=o.length;return a}},a={arraySet:function(t,e,r,n,i){for(var o=0;o<n;o++)t[i+o]=e[r+o]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,o)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,a))},r.setTyped(n)},{}],2:[function(t,e,r){"use strict";var n=t("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function u(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var r="",a=0;a<e;a++)r+=String.fromCharCode(t[a]);return r}a[254]=a[254]=1,r.string2buf=function(t){var e,r,i,o,a,s=t.length,u=0;for(o=0;o<s;o++)55296==(64512&(r=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=t.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),u+=r<128?1:r<2048?2:r<65536?3:4;for(e=new n.Buf8(u),a=0,o=0;a<u;o++)55296==(64512&(r=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=t.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|63&r):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e},r.buf2binstring=function(t){return u(t,t.length)},r.binstring2buf=function(t){for(var e=new n.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,n,i,o,s=e||t.length,l=new Array(2*s);for(n=0,r=0;r<s;)if((i=t[r++])<128)l[n++]=i;else if((o=a[i])>4)l[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<s;)i=i<<6|63&t[r++],o--;o>1?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return u(l,n)},r.utf8border=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+a[t[r]]>e?r:e}},{"./common":1}],3:[function(t,e,r){"use strict";e.exports=function(t,e,r,n){for(var i=65535&t|0,o=t>>>16&65535|0,a=0;0!==r;){r-=a=r>2e3?2e3:r;do{o=o+(i=i+e[n++]|0)|0}while(--a);i%=65521,o%=65521}return i|o<<16|0}},{}],4:[function(t,e,r){"use strict";var n=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e,r,i){var o=n,a=i+r;t^=-1;for(var s=i;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},{}],5:[function(t,e,r){"use strict";var n,i=t("../utils/common"),o=t("./trees"),a=t("./adler32"),s=t("./crc32"),u=t("./messages");function l(t,e){return t.msg=u[e],e}function h(t){return(t<<1)-(t>4?9:0)}function c(t){for(var e=t.length;--e>=0;)t[e]=0}function f(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(i.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function p(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,f(t.strm)}function d(t,e){t.pending_buf[t.pending++]=e}function y(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function b(t,e){var r,n,i=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,u=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,l=t.window,h=t.w_mask,c=t.prev,f=t.strstart+258,p=l[o+a-1],d=l[o+a];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(l[(r=e)+a]===d&&l[r+a-1]===p&&l[r]===l[o]&&l[++r]===l[o+1]){o+=2,r++;do{}while(l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<f);if(n=258-(f-o),o=f-258,n>a){if(t.match_start=e,a=n,n>=s)break;p=l[o+a-1],d=l[o+a]}}}while((e=c[e&h])>u&&0!=--i);return a<=t.lookahead?a:t.lookahead}function v(t){var e,r,n,o,u,l,h,c,f,p,d=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=d+(d-262)){i.arraySet(t.window,t.window,d,d,0),t.match_start-=d,t.strstart-=d,t.block_start-=d,e=r=t.hash_size;do{n=t.head[--e],t.head[e]=n>=d?n-d:0}while(--r);e=r=d;do{n=t.prev[--e],t.prev[e]=n>=d?n-d:0}while(--r);o+=d}if(0===t.strm.avail_in)break;if(l=t.strm,h=t.window,c=t.strstart+t.lookahead,f=o,p=void 0,(p=l.avail_in)>f&&(p=f),r=0===p?0:(l.avail_in-=p,i.arraySet(h,l.input,l.next_in,p,c),1===l.state.wrap?l.adler=a(l.adler,h,p,c):2===l.state.wrap&&(l.adler=s(l.adler,h,p,c)),l.next_in+=p,l.total_in+=p,p),t.lookahead+=r,t.lookahead+t.insert>=3)for(u=t.strstart-t.insert,t.ins_h=t.window[u],t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+3-1])&t.hash_mask,t.prev[u&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=u,u++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function m(t,e){for(var r,n;;){if(t.lookahead<262){if(v(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-262&&(t.match_length=b(t,r)),t.match_length>=3)if(n=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}function w(t,e){for(var r,n,i;;){if(t.lookahead<262){if(v(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-262&&(t.match_length=b(t,r),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,n=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(p(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=o._tr_tally(t,0,t.window[t.strstart-1]))&&p(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}function g(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function x(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),c(this.dyn_ltree),c(this.dyn_dtree),c(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),c(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),c(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function O(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):l(t,-2)}function E(t){var e,r=O(t);return 0===r&&((e=t.state).window_size=2*e.w_size,c(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),r}function _(t,e,r,n,o,a){if(!t)return-2;var s=1;if(-1===e&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),o<1||o>9||8!==r||n<8||n>15||e<0||e>9||a<0||a>4)return l(t,-2);8===n&&(n=9);var u=new x;return t.state=u,u.strm=t,u.wrap=s,u.gzhead=null,u.w_bits=n,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=a,u.method=r,E(t)}n=[new g(0,0,0,0,(function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(v(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,p(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(p(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(p(t,!1),t.strm.avail_out),1)})),new g(4,4,8,4,m),new g(4,5,16,8,m),new g(4,6,32,32,m),new g(4,4,16,16,w),new g(8,16,32,32,w),new g(8,16,128,128,w),new g(8,32,128,256,w),new g(32,128,258,1024,w),new g(32,258,258,4096,w)],r.deflateInit=function(t,e){return _(t,e,8,15,8,0)},r.deflateInit2=_,r.deflateReset=E,r.deflateResetKeep=O,r.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},r.deflate=function(t,e){var r,i,a,u;if(!t||!t.state||e>5||e<0)return t?l(t,-2):-2;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&4!==e)return l(t,0===t.avail_out?-5:-2);if(i.strm=t,r=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,d(i,31),d(i,139),d(i,8),i.gzhead?(d(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),d(i,255&i.gzhead.time),d(i,i.gzhead.time>>8&255),d(i,i.gzhead.time>>16&255),d(i,i.gzhead.time>>24&255),d(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),d(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(d(i,255&i.gzhead.extra.length),d(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(d(i,0),d(i,0),d(i,0),d(i,0),d(i,0),d(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),d(i,3),i.status=113);else{var b=8+(i.w_bits-8<<4)<<8;b|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(b|=32),b+=31-b%31,i.status=113,y(i,b),0!==i.strstart&&(y(i,t.adler>>>16),y(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),f(t),a=i.pending,i.pending!==i.pending_buf_size));)d(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),f(t),a=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,d(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),f(t),a=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,d(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===u&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&f(t),i.pending+2<=i.pending_buf_size&&(d(i,255&t.adler),d(i,t.adler>>8&255),t.adler=0,i.status=113)):i.status=113),0!==i.pending){if(f(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&h(e)<=h(r)&&4!==e)return l(t,-5);if(666===i.status&&0!==t.avail_in)return l(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&666!==i.status){var m=2===i.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&(v(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,r=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var r,n,i,a,s=t.window;;){if(t.lookahead<=258){if(v(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=s[i=t.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=t.strstart+258;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);t.match_length=258-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(p(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(p(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(p(t,!1),0===t.strm.avail_out)?1:2}(i,e):n[i.level].func(i,e);if(3!==m&&4!==m||(i.status=666),1===m||3===m)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===m&&(1===e?o._tr_align(i):5!==e&&(o._tr_stored_block(i,0,0,!1),3===e&&(c(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),f(t),0===t.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(d(i,255&t.adler),d(i,t.adler>>8&255),d(i,t.adler>>16&255),d(i,t.adler>>24&255),d(i,255&t.total_in),d(i,t.total_in>>8&255),d(i,t.total_in>>16&255),d(i,t.total_in>>24&255)):(y(i,t.adler>>>16),y(i,65535&t.adler)),f(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},r.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?l(t,-2):(t.state=null,113===e?l(t,-3):0):-2},r.deflateSetDictionary=function(t,e){var r,n,o,s,u,l,h,f,p=e.length;if(!t||!t.state)return-2;if(2===(s=(r=t.state).wrap)||1===s&&42!==r.status||r.lookahead)return-2;for(1===s&&(t.adler=a(t.adler,e,p,0)),r.wrap=0,p>=r.w_size&&(0===s&&(c(r.head),r.strstart=0,r.block_start=0,r.insert=0),f=new i.Buf8(r.w_size),i.arraySet(f,e,p-r.w_size,r.w_size,0),e=f,p=r.w_size),u=t.avail_in,l=t.next_in,h=t.input,t.avail_in=p,t.next_in=0,t.input=e,v(r);r.lookahead>=3;){n=r.strstart,o=r.lookahead-2;do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--o);r.strstart=n,r.lookahead=2,v(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=l,t.input=h,t.avail_in=u,r.wrap=s,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":4,"./messages":6,"./trees":7}],6:[function(t,e,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],7:[function(t,e,r){"use strict";var n=t("../utils/common");function i(t){for(var e=t.length;--e>=0;)t[e]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],u=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],l=new Array(576);i(l);var h=new Array(60);i(h);var c=new Array(512);i(c);var f=new Array(256);i(f);var p=new Array(29);i(p);var d,y,b,v=new Array(30);function m(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function g(t){return t<256?c[t]:c[256+(t>>>7)]}function x(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function O(t,e,r){t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,x(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function E(t,e,r){O(t,r[2*e],r[2*e+1])}function _(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}function N(t,e,r){var n,i,o=new Array(16),a=0;for(n=1;n<=15;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=_(o[s]++,s))}}function A(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function T(t){t.bi_valid>8?x(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function S(t,e,r,n){var i=2*e,o=2*r;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]}function R(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&S(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!S(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function I(t,e,r){var n,i,s,u,l=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],i=t.pending_buf[t.l_buf+l],l++,0===n?E(t,i,e):(E(t,(s=f[i])+256+1,e),0!==(u=o[s])&&O(t,i-=p[s],u),E(t,s=g(--n),r),0!==(u=a[s])&&O(t,n-=v[s],u))}while(l<t.last_lit);E(t,256,e)}function P(t,e){var r,n,i,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,u=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<u;r++)0!==o[2*r]?(t.heap[++t.heap_len]=l=r,t.depth[r]=0):o[2*r+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=a[2*i+1]);for(e.max_code=l,r=t.heap_len>>1;r>=1;r--)R(t,o,r);i=u;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],R(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,o[2*i]=o[2*r]+o[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,o[2*r+1]=o[2*n+1]=i,t.heap[1]=i++,R(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,n,i,o,a,s,u=e.dyn_tree,l=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,f=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,d=e.stat_desc.max_length,y=0;for(o=0;o<=15;o++)t.bl_count[o]=0;for(u[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<573;r++)(o=u[2*u[2*(n=t.heap[r])+1]+1]+1)>d&&(o=d,y++),u[2*n+1]=o,n>l||(t.bl_count[o]++,a=0,n>=p&&(a=f[n-p]),s=u[2*n],t.opt_len+=s*(o+a),c&&(t.static_len+=s*(h[2*n+1]+a)));if(0!==y){do{for(o=d-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[d]--,y-=2}while(y>0);for(o=d;0!==o;o--)for(n=t.bl_count[o];0!==n;)(i=t.heap[--r])>l||(u[2*i+1]!==o&&(t.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}(t,e),N(o,l,t.bl_count)}function C(t,e,r){var n,i,o=-1,a=e[1],s=0,u=7,l=4;for(0===a&&(u=138,l=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=e[2*(n+1)+1],++s<u&&i===a||(s<l?t.bl_tree[2*i]+=s:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,o=i,0===a?(u=138,l=3):i===a?(u=6,l=3):(u=7,l=4))}function L(t,e,r){var n,i,o=-1,a=e[1],s=0,u=7,l=4;for(0===a&&(u=138,l=3),n=0;n<=r;n++)if(i=a,a=e[2*(n+1)+1],!(++s<u&&i===a)){if(s<l)do{E(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(E(t,i,t.bl_tree),s--),E(t,16,t.bl_tree),O(t,s-3,2)):s<=10?(E(t,17,t.bl_tree),O(t,s-3,3)):(E(t,18,t.bl_tree),O(t,s-11,7));s=0,o=i,0===a?(u=138,l=3):i===a?(u=6,l=3):(u=7,l=4)}}i(v);var D=!1;function M(t,e,r,i){O(t,0+(i?1:0),3),function(t,e,r,i){T(t),i&&(x(t,r),x(t,~r)),n.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}r._tr_init=function(t){D||(function(){var t,e,r,n,i,u=new Array(16);for(r=0,n=0;n<28;n++)for(p[n]=r,t=0;t<1<<o[n];t++)f[r++]=n;for(f[r-1]=n,i=0,n=0;n<16;n++)for(v[n]=i,t=0;t<1<<a[n];t++)c[i++]=n;for(i>>=7;n<30;n++)for(v[n]=i<<7,t=0;t<1<<a[n]-7;t++)c[256+i++]=n;for(e=0;e<=15;e++)u[e]=0;for(t=0;t<=143;)l[2*t+1]=8,t++,u[8]++;for(;t<=255;)l[2*t+1]=9,t++,u[9]++;for(;t<=279;)l[2*t+1]=7,t++,u[7]++;for(;t<=287;)l[2*t+1]=8,t++,u[8]++;for(N(l,287,u),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=_(t,5);d=new m(l,o,257,286,15),y=new m(h,a,0,30,15),b=new m(new Array(0),s,0,19,7)}(),D=!0),t.l_desc=new w(t.dyn_ltree,d),t.d_desc=new w(t.dyn_dtree,y),t.bl_desc=new w(t.bl_tree,b),t.bi_buf=0,t.bi_valid=0,A(t)},r._tr_stored_block=M,r._tr_flush_block=function(t,e,r,n){var i,o,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),P(t,t.l_desc),P(t,t.d_desc),a=function(t){var e;for(C(t,t.dyn_ltree,t.l_desc.max_code),C(t,t.dyn_dtree,t.d_desc.max_code),P(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*u[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==e?M(t,e,r,n):4===t.strategy||o===i?(O(t,2+(n?1:0),3),I(t,l,h)):(O(t,4+(n?1:0),3),function(t,e,r,n){var i;for(O(t,e-257,5),O(t,r-1,5),O(t,n-4,4),i=0;i<n;i++)O(t,t.bl_tree[2*u[i]+1],3);L(t,t.dyn_ltree,e-1),L(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),I(t,t.dyn_ltree,t.dyn_dtree)),A(t),n&&T(t)},r._tr_tally=function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(f[r]+256+1)]++,t.dyn_dtree[2*g(e)]++),t.last_lit===t.lit_bufsize-1},r._tr_align=function(t){O(t,2,3),E(t,256,l),function(t){16===t.bi_valid?(x(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":1}],8:[function(t,e,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/deflate.js":[function(t,e,r){"use strict";var n=t("./zlib/deflate"),i=t("./utils/common"),o=t("./utils/strings"),a=t("./zlib/messages"),s=t("./zlib/zstream"),u=Object.prototype.toString;function l(t){if(!(this instanceof l))return new l(t);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==r)throw new Error(a[r]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var h;if(h="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(r=n.deflateSetDictionary(this.strm,h)))throw new Error(a[r]);this._dict_set=!0}}function h(t,e){var r=new l(e);if(r.push(t,!0),r.err)throw r.msg||a[r.err];return r.result}l.prototype.push=function(t,e){var r,a,s=this.strm,l=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===u.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(l),s.next_out=0,s.avail_out=l),1!==(r=n.deflate(s,a))&&0!==r)return this.onEnd(r),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==r);return 4===a?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==a||(this.onEnd(0),s.avail_out=0,!0)},l.prototype.onData=function(t){this.chunks.push(t)},l.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=l,r.deflate=h,r.deflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},r.gzip=function(t,e){return(e=e||{}).gzip=!0,h(t,e)}},{"./utils/common":1,"./utils/strings":2,"./zlib/deflate":5,"./zlib/messages":6,"./zlib/zstream":8}]},{},[])("/lib/deflate.js")},function(t,e,r){"use strict";r.r(e);var n,i=function(){function t(t){this.bheap=new Array,this.count=0,this.comp=t}return t.prototype.size=function(){return this.count},t.prototype.add=function(t){this.count>0?this.siftUp(this.count,t):this.bheap[0]=t,this.count++},t.prototype.poll=function(){for(;;){if(this.count>0){this.count--;var t=this.bheap[0];return this.count>0&&this.siftDown(0,this.bheap[this.count]),t}return null}},t.prototype.siftUp=function(t,e){for(;t>0;){var r=t-1>>>1,n=this.bheap[r];if(this.comp(e,n)>=0)break;this.bheap[t]=n,t=r}this.bheap[t]=e},t.prototype.siftDown=function(t,e){for(var r=this.count>>>1;t<r;){var n=1+(t<<1),i=this.bheap[n],o=n+1;if(o<this.count){var a=this.bheap[o];this.comp(i,a)>0&&(n=o,i=a)}if(this.comp(e,i)<=0)break;this.bheap[t]=i,t=n}this.bheap[t]=e},t}(),o=r(32),a=r(52),s=r(2),u=r(19),l=r(6),h=r(24),c=r(5),f=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),p=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};var d=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.F=0,n.G=0,n.H=0,n.parent=null,n.modCount=0,n}return f(e,t),e.prototype.calcF=function(){this.F=this.G+this.H},e}(c.a),y=function(){function t(t){this.node=t,this.modCount=t.modCount}return t.prototype.notChanged=function(){return this.modCount===this.node.modCount},t}();function b(t,e){return t.node.F-e.node.F}var v,m=function(){function t(t,e,r,n){this.queue=new i(b),this.openSet=new o.a,this.closeSet=new a.a,this.lines=new Array,this.timeout=performance.now()+t,this.canReach=n,this.clearance=Math.max(e.distance1(r)/50,1),this.step1=1*this.clearance,this.step2=1.414*this.clearance,this.findPath(e,r)}return t.prototype.findPath=function(t,e){var r=new d(t.x,t.y),n=new d(e.x,e.y),i=this._findPath(r,n);this.connect(i,r),this.optimization(n),this.optimization1(n)},t.prototype.optimization=function(t){var e,r,n=new Array,i=new Array;n.push(new s.a(t,new c.a(t.x+1e4,t.y))),n.push(new s.a(t,new c.a(t.x+1e4,t.y+1e4))),n.push(new s.a(t,new c.a(t.x,t.y+1e4))),n.push(new s.a(t,new c.a(t.x-1e4,t.y+1e4))),n.push(new s.a(t,new c.a(t.x-1e4,t.y))),n.push(new s.a(t,new c.a(t.x-1e4,t.y-1e4))),n.push(new s.a(t,new c.a(t.x,t.y-1e4))),n.push(new s.a(t,new c.a(t.x+1e4,t.y-1e4)));var o=!0;if(this.lines.length>1)for(var a=this.lines[0],f=1;f<this.lines.length;f++){var y=this.lines[f];if(o)try{for(var b=(e=void 0,p(n)),v=b.next();!v.done;v=b.next()){for(var m=v.value,w=Object(h.d)(y,m),g=0;g<w;g+=2){var x=new d(h.a[g],h.a[g+1]);if(this.canReach(t,x)&&!x.equals1(a.start())){var O=t.x-x.x,E=t.y-x.y,_=y.start().x-x.x,N=y.start().y-x.y;if(u.a.greatereq(O*_+E*N,0))continue;i.push(new s.a(x,t)),i.push(new s.a(y.start(),x)),o=!1;break}}if(!o)break}}catch(t){e={error:t}}finally{try{v&&!v.done&&(r=b.return)&&r.call(b)}finally{if(e)throw e.error}}else i.push(y)}i.length>0&&(this.lines.length=0,l.a.addAll(this.lines,i))},t.prototype.optimization1=function(t){var e=new Array;if(this.lines.length>=4){for(var r=new Array(4),n=0;n<4;n++)r[n]=this.getLineVector(this.lines[n]);var i=new d(this.lines[3].start().x,this.lines[3].start().y),o=r[0].x*r[2].y-r[0].y*r[2].x,a=r[1].x*r[3].y-r[1].y*r[3].x;if(u.a.eq(o,0)&&u.a.eq(a,0)){var h=new d(t.x-r[0].x-r[2].x,t.y-r[0].y-r[2].y),c=new d(t.x-r[1].x-r[3].x,t.y-r[1].y-r[3].y);this.canReach(h,t)&&this.canReach(i,h)?(e.push(new s.a(h,t)),e.push(new s.a(i,h))):this.canReach(c,t)&&this.canReach(i,c)&&(e.push(new s.a(c,t)),e.push(new s.a(i,c)))}if(e.length>0)for(n=4;n<this.lines.length;n++)e.push(this.lines[n])}e.length>0&&(this.lines.length=0,l.a.addAll(this.lines,e))},t.prototype.connect=function(t,e){var r=0,n=0;if(null!=t){for(var i=t,o=e;null!=t.parent;){if(o=t,t=t.parent,n=this.getDirection(t,o),0==r)r=n;else if(r!=n)new s.a(o,i).isPoint()||this.lines.push(new s.a(o,i)),i=o,r=n}if(!(o=t).equals(e))if(n=this.getDirection(e,o),0==r)r=n;else if(r!=n)new s.a(o,i).isPoint()||this.lines.push(new s.a(o,i)),i=o,r=n;new s.a(o,i).isPoint()||this.lines.push(new s.a(o,i))}},t.prototype._findPath=function(t,e){var r,n,i=null,o=Number.MAX_VALUE;for(this.openSet.put(t,t),this.queue.add(new y(t));;){var a=this.findMinFNodeInOpneList();if(null!=a&&!a.equals(t)&&a.F+a.H<=o&&(o=a.F+a.H,i=a),!(null!==a&&performance.now()<this.timeout))return i;this.openSet.remove(a),this.closeSet.add(a),a.modCount++;var s=this.findNeighborNodes(a,this.clearance);try{for(var u=(r=void 0,p(s)),l=u.next();!l.done;l=u.next()){var h=l.value,c=this.openSet.get(h);null!==c?(h=c,this.foundPoint(a,c,e)):h=this.notFoundPoint(a,e,h);var f=Math.abs(h.x-e.x),d=Math.abs(h.y-e.y);if(f<this.clearance&&d<this.clearance){var b=Math.min(f,d),v=this.findNeighborNodes(e,b),m=this.findNeighbor(v,h);return null!=m?(m.parent=h,e.parent=m):(b=Math.max(f,d)-b)>0?(v=this.findNeighborNodes(h,b),null!=(m=this.findNeighbor(v,e))?(m.parent=h,e=m):e=h):e=h,e}}}catch(t){r={error:t}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}},t.prototype.findNeighbor=function(t,e){var r,n,i=Number.MAX_VALUE,o=null;try{for(var a=p(t),s=a.next();!s.done;s=a.next()){var u=s.value,l=u.distance2(e);l<i&&this.canReach(u,e)&&(i=l,o=u)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},t.prototype.calcG=function(t,e){var r=0,n=0;if(null!=t.parent){var i=this.getDirection(t.parent,t),o=this.getDirection(t,e);if(i!=o){var a=this.getLineVector(new s.a(t.parent,t)),u=this.getLineVector(new s.a(t,e)),l=a.x*u.x+a.y*u.y;r=l>0?1:0==l?10:4}n=1==o||2==o?this.step1:this.step2}return t.G+n+r},t.prototype.calcH=function(t,e){var r=e.x,n=e.y;return Math.max(Math.abs(r-t.x),Math.abs(n-t.y))+.414*Math.min(Math.abs(r-t.x),Math.abs(n-t.y))},t.prototype.findMinFNodeInOpneList=function(){for(;;){var t=this.queue.poll();if(null===t)return null;if(t.notChanged())return t.node}},t.prototype.notFoundPoint=function(t,e,r){return r.parent=t,r.G=this.calcG(t,r),r.H=this.calcH(e,r),r.calcF(),r.modCount++,this.openSet.put(r,r),this.queue.add(new y(r)),r},t.prototype.foundPoint=function(t,e,r){var n=this.calcG(t,e);n<e.G&&(e.parent=t,e.G=n,e.calcF(),e.modCount++,this.queue.add(new y(e)))},t.prototype.getDirection=function(t,e){var r=e.x-t.x,n=e.y-t.y;return 0==n?1:0==r?2:r*n>0?3:4},t.prototype.findNeighborNodes=function(t,e){var r=new Array,n=t.x,i=t.y-e,o=new d(n,i);this.checkNextNode(t,r,o);var a=t.x+e,s=t.y+e;o=new d(a,s),this.checkNextNode(t,r,o);var u=t.x+e,l=t.y;o=new d(u,l),this.checkNextNode(t,r,o);var h=t.x+e,c=t.y-e;o=new d(h,c),this.checkNextNode(t,r,o);var f=t.x,p=t.y+e;o=new d(f,p),this.checkNextNode(t,r,o);var y=t.x-e,b=t.y-e;o=new d(y,b),this.checkNextNode(t,r,o);var v=t.x-e,m=t.y;o=new d(v,m),this.checkNextNode(t,r,o);var w=t.x-e,g=t.y+e;return o=new d(w,g),this.checkNextNode(t,r,o),r},t.prototype.checkNextNode=function(t,e,r){this.canReach(t,r)&&!this.closeSet.contains(r)&&e.push(r)},t.prototype.getLineVector=function(t){var e=t.end().x-t.start().x,r=t.end().y-t.start().y;return new c.a(e,r)},t}(),w=r(119),g=r(75),x=r(93),O=r(51),E=r(115),_=r(116),N=r(100),A=r(29),T=r(117),S=r(11),R=r(57),I=r(21),P=r(41),C=r(120),L=r.n(C);var D=function(){function t(){var t,e,r,n,i,o,a,s;this.settings={"attr-pcbcanvas-unit":"mm","attr-layer-distance":"0","attr-board-thickness":"6.299","attr-pcbcanvas-bgcolor":"#808080","attr-border-color":"blue","attr-surface-finish-color":"gold"},this.modelSettings={uuid:"",width:"0",height:"0",originX:"0",originY:"0",x:"0",y:"0",z:"0",rotateX:"0",rotateY:"0",rotateZ:"0"},this.handlers={"attr-layer-distance":this.attrLayerDistance.bind(this),"attr-board-thickness":this.attrBoardThickness.bind(this),"attr-border-color":this.attrTransformer("boardColor"),"attr-surface-finish-color":this.attrTransformer("solderColor"),"attr-pcbcanvas-bgcolor":this.attrTransformer("fogColor")},this.updateHandlers=new Array,document.write(L.a),v=window,t=new E.a(document.createElement("canvas")),e=new _.a(50,1,1,1e3,new S.a(1,1,1)),r=new N.a(new A.a(.1,.1,.1)),n=new N.b(new A.a(1,1,1),S.a.ORIGIN),i=new T.a(t,e,r,n),o=new R.a([new S.a(50,-50,40),new S.a(50,50,40),new S.a(-50,-50,40)],[new S.a(0,0,1),new S.a(0,0,1),new S.a(0,0,1)]),a=new A.a(0,0,0),s=new I.a(a,a,a,1,1),i.group.add(new P.a(o,s)),i.render(),this.canvas=document.createElement("canvas");var u=document.getElementById("canvas");null!==u&&(u.appendChild(this.canvas),this.canvas.style.width="100%",this.canvas.style.height="100%"),v.attrpanel_apply=this.attrPanelApply.bind(this),v.attrpanel_data=this.attrPanelData.bind(this),v.mouseEvent=this.mouseEvent.bind(this),v.focusIframe=this.focusIframe.bind(this),v.reset=this.onReset.bind(this),document.addEventListener("mousedown",this.onMouseDown.bind(this));var h=l.a.getUrlVars().url;if("string"==typeof h&&h.length>0){var c=/\/3dmodel\/([^/]+)/.exec(h);if(null===c)throw new Error;var f=c[1],p=document.getElementById("canvas");if(null===p)throw new Error;var d=[{name:"Top",material:"3dmodel",data:[{width:p.offsetWidth,height:p.offsetHeight,id:f,isTop:!0,originX:0,originY:0,originRotation:0,rx:0,ry:0,rz:0,x:0,y:0,z:0,zIndex:0}]}];this.pcb=new x.a(d,this.canvas,this.settings,this.updateHandlers),v.attrpanel_apply(null,{"attr-pcbcanvas-bgcolor":this.settings["attr-pcbcanvas-bgcolor"]})}else{d=v.parent.exportFunction.attrFn.get3DData();var y=Object(g.c)(d);this.pcb=new x.a(y,this.canvas,this.settings,this.updateHandlers),v.attrpanel_apply(null,{"attr-board-thickness":this.settings["attr-board-thickness"]}),v.attrpanel_apply(null,{"attr-pcbcanvas-bgcolor":this.settings["attr-pcbcanvas-bgcolor"]}),v.parent.exportFunction.attrFn.pickData(),null!==v._initData&&v.attrpanel_apply(null,v._initData)}}return t.prototype.onTask=function(t){this.updateHandlers.forEach((function(e){e(t)}))},t.prototype.mouseEvent=function(t){if("wheel"===t.type||"mousewheel"===t.type||"DOMMouseScroll"===t.type){"DOMMouseScroll"===t.type&&(t.deltaY=t.detail);var e=new WheelEvent("wheel",t);this.canvas.dispatchEvent(e)}else{e=new MouseEvent(t.type,t);this.canvas.dispatchEvent(e)}},t.prototype.focusIframe=function(){this.onTask(new O.c)},t.prototype.attrPanelApply=function(t,e){var r=!1;for(var n in e){var i=e[n];n in this.handlers?(this.settings[n]=i,this.onTask(this.handlers[n](i))):n in x.b?(this.settings[n]=i,this.onTask(new O.d(x.b[n],"visible"==i))):n in this.modelSettings&&(this.modelSettings[n]=i,r=!0)}if(r){var o=new O.b(this.modelSettings.uuid,parseFloat(this.modelSettings.width),parseFloat(this.modelSettings.height),parseFloat(this.modelSettings.originX),parseFloat(this.modelSettings.originY),parseFloat(this.modelSettings.rotateX),parseFloat(this.modelSettings.rotateY),parseFloat(this.modelSettings.rotateZ),parseFloat(this.modelSettings.x),-parseFloat(this.modelSettings.y),parseFloat(this.modelSettings.z));this.onTask(o)}},t.prototype.attrPanelData=function(){return JSON.parse(JSON.stringify(this.settings))},t.prototype.onReset=function(){v.attrpanel_apply(null,{"attr-layer-distance":0}),v.attrpanel_apply(null,{"attr-board-thickness":6.299}),this.pcb.control.reset(),v.parent.exportFunction.attrFn.pickData()},t.prototype.onMouseDown=function(){v.parent.exportFunction.attrFn.checkActiveChange(),document.querySelector("#canvas").focus()},t.prototype.attrLayerDistance=function(t){return this.settings["attr-layer-distance"]=t,new O.e(parseInt(t),parseInt(this.settings["attr-board-thickness"]))},t.prototype.attrBoardThickness=function(t){return this.settings["attr-board-thickness"]=t,new O.e(parseInt(this.settings["attr-layer-distance"]),parseInt(t))},t.prototype.attrTransformer=function(t){return function(e){return new O.a(t,e)}},t}(),M=r(121),k=r.n(M),U=r(48),B=r(97),F=r(67),Y=r(53),G=r(83),z=r(84),W=r(7),X=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),j=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H=function(t){function e(e,r){var n=t.call(this,e)||this;return n.cb=r,n}return X(e,t),e.prototype.onSegment=function(t,e,r,n,i,o){try{var a=new c.a(r.getX(this.curY),this.curY),s=new c.a(r.getX(this.prevY),this.prevY),u=new c.a(o.getX(this.curY),this.curY),l=new c.a(o.getX(this.prevY),this.prevY);this.cb(a,u,l),this.cb(l,s,a)}catch(t){}},e}(B.a),V=function(t){function e(e,r){var n=t.call(this,new G.a(!0),Y.b,e,new H(!1,r))||this;return n.rtree=null,n.collector=n.event,n}return X(e,t),e.prototype.addPolyline=function(e){t.prototype.addPolyline.call(this,e,1)},e.prototype.triangulation=function(){var t,e;null===this.rtree&&(this.rtree=this.buildRTree());var r=new Array;this.sides.forEach((function(t){var e=t.bbox();r.push(e.minY,e.maxY)})),r.sort((function(t,e){return t-e}));var n=r[0],i=function(t){if(t>n){var e=(t+n)/2;o.collector.prevY=n,o.collector.curY=t;var r=new W.a(-1e10,1e10,e-1e-5,e+1e-5),i=new Array;o.fillValidSides(i,o.rtree.search(r),e),i.sort((function(t,r){return t.getX(e)-r.getX(e)}));var a=new z.a(o.rule,o,e);i.forEach((function(t){return a.onEp(t)})),n=t}},o=this;try{for(var a=j(r),s=a.next();!s.done;s=a.next()){i(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}},e}(F.a),K=r(28),Z=r(14),q=r(104),Q=r(38),J=r(12),$=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};var tt,et=r(72),rt=r(58),nt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function it(t,e,r){var n=new ut(t,e);if(!r.vertexNodePairMap.containsKey(n)&&t!==e){var i=new lt(n.node1,n.node2,r);r.vertexNodePairMap.put(n,i),t.addAdjaNode(e),e.addAdjaNode(t),r.vertexNodePairPriorityQueue.add(i)}}function ot(t,e){var r=e.get(t);return r||(r=new st(t),e.put(t,r)),r}function at(t,e){if(t.m===e.m&&t.n===e.n){for(var r=new Array(t.m*t.n),n=0;n<r.length;n++)r[n]=t.data[n]+e.data[n];return new rt.a(t.m,e.n,r)}throw new Error("Two matrices have different dimensions!")}!function(t){t[t.MAX_COST=0]="MAX_COST",t[t.NODE_PAIR_RATE=1]="NODE_PAIR_RATE",t[t.NODE_RATE=2]="NODE_RATE"}(tt||(tt={}));var st=function(){function t(t){this.vertex=t,this.costMatrix=new rt.a(4,4,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.adjaNodeSet=new Set,this.planeNum=0,this.indexs=[]}return t.prototype.addPlaneNum=function(){this.planeNum++},t.prototype.subPlaneNum=function(){this.planeNum--},t.prototype.getPlaneNum=function(){return this.planeNum},t.prototype.isBorder=function(){return this.planeNum<this.adjaNodeSet.size},t.prototype.getCostMatrix=function(){return this.costMatrix},t.prototype.addCostMatrix=function(t){this.costMatrix=at(this.costMatrix,t)},t.prototype.getAdjaNodeSet=function(){return this.adjaNodeSet},t.prototype.removeAdjaNode=function(t){this.adjaNodeSet.delete(t)},t.prototype.addAdjaNode=function(t){this.adjaNodeSet.add(t)},t.prototype.addIndex=function(t){this.indexs.push(t)},t.prototype.getIndexs=function(){return this.indexs},t.prototype.setIndexs=function(t){this.indexs=t},t}(),ut=function(){function t(t,e){this.node1=t,this.node2=e}return t.prototype.hashCode=function(){return Math.ceil(8192*(this.node1.vertex.x+this.node1.vertex.y+this.node1.vertex.z))+Math.ceil(8192*(this.node2.vertex.x+this.node2.vertex.y+this.node2.vertex.z))},t.prototype.equals=function(t){return this.node1===t.node1&&this.node2===t.node2||this.node1===t.node2&&this.node2===t.node1},t}(),lt=function(){function t(t,e,r){this.node1=t,this.node2=e,this.globalData=r,this.contractResult=this.calContractResult(),this.discarded=!1}return t.prototype.calCost=function(t,e){var r=[e.x,e.y,e.z,1];return new rt.a(1,4,r).mul(t).mul(new rt.a(4,1,r)).data[0]},t.prototype.calContractResult=function(){for(var t=at(this.node1.getCostMatrix(),this.node2.getCostMatrix()),e=[t.data.slice(0,4),t.data.slice(4,8),t.data.slice(8,12)],r=0;r<3;r++){for(var n=r;n<3;n++)if(0!==e[n][r]){var i=e[n];e[n]=e[r],e[r]=i}if(0!==e[r][r])for(n=r+1;n<3;n++)for(var o=e[n][r]/e[r][r],a=r;a<4;a++)e[n][a]-=e[r][a]*o}var s=new Array(3);for(r=2;r>=0;r--)if(0===e[r][r])s[r]=0;else{var u=-e[r][3];for(n=2;n>r;n--)u-=s[n]*e[r][n];s[r]=u/e[r][r]}var l=new S.a(s[0],s[1],s[2]),h=this.calCost(t,l);return this.globalData.originalBBox.isContains(l)||(h=Number.MAX_VALUE),{newVertex:l,cost:Math.max(0,h)}},t.prototype.contract=function(){var t,e,r,n,i,o,a,s;this.globalData.vertexNodeMap.remove(this.node1.vertex),this.globalData.vertexNodeMap.remove(this.node2.vertex),this.globalData.vertexNodePairMap.remove(new ut(this.node1,this.node2)).discard(),this.node1.removeAdjaNode(this.node2),this.node2.removeAdjaNode(this.node1);var u=ot(this.contractResult.newVertex,this.globalData.vertexNodeMap);u.addCostMatrix(at(this.node1.getCostMatrix(),this.node2.getCostMatrix())),u.setIndexs(this.node1.getIndexs().concat(this.node2.getIndexs()));try{for(var l=nt(this.node1.getAdjaNodeSet()),h=l.next();!h.done;h=l.next()){it(u,y=h.value,this.globalData)}}catch(e){t={error:e}}finally{try{h&&!h.done&&(e=l.return)&&e.call(l)}finally{if(t)throw t.error}}try{for(var c=nt(this.node2.getAdjaNodeSet()),f=c.next();!f.done;f=c.next()){it(u,y=f.value,this.globalData)}}catch(t){r={error:t}}finally{try{f&&!f.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}try{for(var p=nt(this.node1.getAdjaNodeSet()),d=p.next();!d.done;d=p.next()){var y=d.value,b=new ut(this.node1,y);this.globalData.vertexNodePairMap.remove(b).discard(),y.removeAdjaNode(this.node1)}}catch(t){i={error:t}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}try{for(var v=nt(this.node2.getAdjaNodeSet()),m=v.next();!m.done;m=v.next()){y=m.value,b=new ut(this.node2,y);this.globalData.vertexNodePairMap.remove(b).discard(),y.removeAdjaNode(this.node2)}}catch(t){a={error:t}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(a)throw a.error}}},t.prototype.getDiscarded=function(){return this.discarded},t.prototype.discard=function(){this.discarded=!0},t}();function ht(t){for(var e=new Array,r=0;r<t.length;r+=3)0!==S.a.normal(t[r],t[r+1],t[r+2]).length()&&(e.push(t[r]),e.push(t[r+1]),e.push(t[r+2]));return e}function ct(t,e,r){if(void 0===e&&(e=tt.MAX_COST),void 0===r&&(r=.5),t.length%3!=0)throw new Error("The length of vertexs is not a multiple of 3!");var n=ht(t),a=function(t){var e,r,n=function(t){for(var e=new Array(t.length/3),r=0;r<e.length;r++){var n=S.a.normal(t[3*r],t[3*r+1],t[3*r+2]).normalize(),i=[n.x,n.y,n.z,-t[3*r].x*n.x-t[3*r].y*n.y-t[3*r].z*n.z];e[r]=new rt.a(4,1,i).mul(new rt.a(1,4,i))}return e}(t),i=function(t){for(var e=new o.a,r=0;r<t.length;r++)e.containsKey(t[r])?e.get(t[r]).add(r):e.put(t[r],new Set([r]));return e}(t),a=new o.a,s=i.entries();for(;s.hasNext();){var u=s.next(),l=new rt.a(4,4,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);try{for(var h=(e=void 0,nt(u.value)),c=h.next();!c.done;c=h.next()){var f=c.value;l=at(l,n[Math.floor(f/3)])}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(e)throw e.error}}a.put(u.key,l)}return a}(n),s=new o.a;!function(t,e,r){for(var n=0;n<t.length;n+=3)for(var i=new Array(3),o=0;o<3;o++)i[o]=ot(t[n+o],e),i[o].addCostMatrix(r.get(t[n+o])),i[o].addIndex(n+o),i[o].addPlaneNum()}(n,s,a),function(t,e){for(var r=0;r<t.length;r+=3){var n=[ot(t[r],e),ot(t[r+1],e),ot(t[r+2],e)];n[0].addAdjaNode(n[1]),n[0].addAdjaNode(n[2]),n[1].addAdjaNode(n[0]),n[1].addAdjaNode(n[2]),n[2].addAdjaNode(n[0]),n[2].addAdjaNode(n[1])}}(n,s);var u=new o.a,l=new i((function(t,e){return t.contractResult.cost-e.contractResult.cost})),h=function(t,e,r){var n,i,o,a,s={vertexNodeMap:t,vertexNodePairMap:e,vertexNodePairPriorityQueue:r,originalBBox:ft(t)},u=t.size(),l=t.values();for(;l.hasNext();){var h=l.next();if(h.isBorder()){u--;try{for(var c=(n=void 0,nt(h.getAdjaNodeSet())),f=c.next();!f.done;f=c.next()){var p=f.value;h.removeAdjaNode(p),p.removeAdjaNode(h),p.subPlaneNum()}}catch(t){n={error:t}}finally{try{f&&!f.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}else try{for(var d=(o=void 0,nt(h.getAdjaNodeSet())),y=d.next();!y.done;y=d.next()){(p=y.value).isBorder()||it(h,p,s)}}catch(t){o={error:t}}finally{try{y&&!y.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}}return u}(s,u,l);return function(t,e,r,n,i,o){var a=t.size()-o,s=e.size(),u=r.poll();for(;null!==u;){if(n===tt.MAX_COST){if(u.contractResult.cost>=i)break}else if(n===tt.NODE_PAIR_RATE){if(1-e.size()/s>=i)break}else if(n===tt.NODE_RATE&&1-(t.size()-a)/o>=i)break;u.getDiscarded()||u.contract(),u=r.poll()}}(s,u,l,e,r,h),function(t,e){var r,n,i=t.values();for(;i.hasNext();){var o=i.next();try{for(var a=(r=void 0,nt(o.getIndexs())),s=a.next();!s.done;s=a.next()){var u=s.value;e[u]=o.vertex}}catch(t){r={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}}(s,n),ht(n)}function ft(t){for(var e=t.values(),r=new et.a;e.hasNext();){var n=e.next().vertex;r.ext3(n)}return r.build()}var pt=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},dt=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},yt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},bt=new I.a(A.a.of1(10329437),A.a.of1(10329437),A.a.BLACK,.1,1);function vt(t){return pt(this,void 0,void 0,(function(){var e,r,n,i,a,s,u,l,h,c,f,p,d,y,b,v,m=this;return dt(this,(function(w){switch(w.label){case 0:if(!(e=Object(g.c)(t,.1,!0)))return[3,2];r=new U.a,n={},i=!1,a=new Array;try{for(s=yt(e),u=s.next();!u.done;u=s.next())if("substrate"===(l=u.value).material)i||(xt(l,r),i=!0);else if("3dmodel"===l.material){h=function(t){a.push(pt(m,void 0,void 0,(function(){var e;return dt(this,(function(i){switch(i.label){case 0:return[4,wt(n,t)];case 1:return(e=i.sent())&&gt(t,e,r),[2]}}))})))};try{for(b=void 0,c=yt(l.data),f=c.next();!f.done;f=c.next())p=f.value,h(p)}catch(t){b={error:t}}finally{try{f&&!f.done&&(v=c.return)&&v.call(c)}finally{if(b)throw b.error}}}}catch(t){d={error:t}}finally{try{u&&!u.done&&(y=s.return)&&y.call(s)}finally{if(d)throw d.error}}return[4,Promise.all(a)];case 1:return w.sent(),[2,function(t,e){void 0===e&&(e=!1);var r=new Array,n=1,i=1,a=new o.a;return function t(e,i){var o,u;i=e.getMatrix().multiply4(i);try{for(var l=$(e.childrens),h=l.next();!h.done;h=l.next()){var c=h.value;if(c instanceof U.a)t(c,i);else if(c instanceof P.a&&c.geometry instanceof R.a){var f=c.material;r.push("newmtl mtl"+n),r.push("Ka "+f.ambient.x.toFixed(2)+" "+f.ambient.y.toFixed(2)+" "+f.ambient.z.toFixed(2)),r.push("Kd "+f.diffuse.x.toFixed(2)+" "+f.diffuse.y.toFixed(2)+" "+f.diffuse.z.toFixed(2)),r.push("Ks "+f.specular.x.toFixed(2)+" "+f.specular.y.toFixed(2)+" "+f.specular.z.toFixed(2)),r.push("endmtl"),r.push("usemtl mtl"+n),n++;for(var p=c.geometry.vertexs,d=0;d<p.length;d+=3){var y=p[d].multiply4(i),b=p[d+1].multiply4(i),v=p[d+2].multiply4(i),m=b.sub(y).length(),w=v.sub(b).length(),g=y.sub(v).length(),x=(m+w+g)/2;if(x*(x-1)*(x-w)*(x-g)>.01){var O=a.computeIfAbsent(y,s),E=a.computeIfAbsent(b,s),_=a.computeIfAbsent(v,s);r.push("f "+O+"// "+E+"// "+_+"//")}}}}}catch(t){o={error:t}}finally{try{h&&!h.done&&(u=l.return)&&u.call(l)}finally{if(o)throw o.error}}}(t,new Q.a),r.join("\n");function s(t){return r.push("v "+t.x.toFixed(2)+" "+t.y.toFixed(2)+" "+t.z.toFixed(2)),i++}}(r)];case 2:return[2,null]}}))}))}function mt(t){return pt(this,void 0,void 0,(function(){var e,r;return dt(this,(function(n){switch(n.label){case 0:return[4,vt(t)];case 1:return(e=n.sent())?[4,fetch("/occapi/api/convert/obj2step",{method:"POST",cache:"no-cache",credentials:"same-origin",body:k.a.gzip(e)})]:[3,5];case 2:return(r=n.sent()).ok?[4,r.text()]:[3,4];case 3:return[2,n.sent()];case 4:throw r;case 5:return[2,null]}}))}))}function wt(t,e){var r=this;return new Promise((function(n){if(e.id in t){var i=t[e.id];if(!Array.isArray(i))return i;i.push(n)}else{var o=[];t[e.id]=o,pt(r,void 0,void 0,(function(){var r,i,a;return dt(this,(function(s){switch(s.label){case 0:r=null,s.label=1;case 1:return s.trys.push([1,6,7,8]),[4,Object(l.b)(l.a.prefix()+"/api/3dmodel/"+e.id,{cache:"no-cache",credentials:"same-origin"},2e4)];case 2:return(i=s.sent()).ok?(a=q.a,[4,i.text()]):[3,4];case 3:return(r=a.apply(void 0,[s.sent()]))&&(r=function t(e){var r,n,i=new U.a;try{for(var o=yt(e.childrens),a=o.next();!a.done;a=o.next()){var s=a.value;s instanceof U.a?i.add(t(s)):s instanceof P.a&&i.add(Ot(s))}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i.setAddiMatrix(e.getMatrix()),i}(r)),[3,5];case 4:throw i;case 5:return[3,8];case 6:return s.sent(),[3,8];case 7:return t[e.id]=r||null,o.forEach((function(t){return t(r)})),n(r),[7];case 8:return[2]}}))}))}}))}function gt(t,e,r){var n=new Q.a,i=e.bbox();if(null!==i){var o=(i.maxX+i.minX)/2,a=(i.maxY+i.minY)/2,s=i.minZ;n=n.translate(new S.a(-o,-a,-s));var u=J.a.toRadians(t.rx),l=J.a.toRadians(t.ry),h=J.a.toRadians(t.rz);n=n.rotateZ(h).rotateX(u).rotateY(l);var c=t.width/(i.maxX-i.minX),f=t.height/(i.maxY-i.minY),p=Math.min(c,f);n=(n=n.scale(p)).translate(new S.a(t.x,t.y,t.z)),t.isTop||(n=n.rotateY(Math.PI));var d=J.a.toRadians(t.originRotation);n=(n=n.rotateZ(d)).translate(new S.a(t.originX,t.originY,0)),t.isTop&&(n=n.translate1(0,0,10));var y=new U.a;y.add(e),y.setAddiMatrix(n),r.add(y)}}function xt(t,e){var r,n,i=t.data,o=new Array,a=new V(K.c.DUMMY,(function(t,e,r){o.push(new S.a(t.x,t.y,0),new S.a(e.x,e.y,0),new S.a(r.x,r.y,0)),o.push(new S.a(t.x,t.y,10),new S.a(e.x,e.y,10),new S.a(r.x,r.y,10))}));try{for(var s=yt(i.vertexsGroup),u=s.next();!u.done;u=s.next()){var l=u.value;a.addPolyline(Z.a.build4(l));for(var h=1;h<l.length;h++){var c=l[h-1],f=l[h];o.push(new S.a(c.x,c.y,0),new S.a(f.x,f.y,0),new S.a(f.x,f.y,10)),o.push(new S.a(f.x,f.y,10),new S.a(c.x,c.y,10),new S.a(c.x,c.y,0))}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}a.triangulation();var p=ct(o,tt.NODE_RATE,.5),d=new P.a(new R.a(p),bt);e.add(d)}function Ot(t){if(t.geometry instanceof R.a){var e=new P.a((r=t.geometry,n=ct(r.vertexs,tt.NODE_RATE,.5),new R.a(n)),t.material);return e.setAddiMatrix(t.getMatrix()),e}return t;var r,n}var Et=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},_t=function(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};self.JSAPI={easyeda2pour:w.a,easyeda2altium:g.b,altium2easyeda:g.a,findPath:function(t,e,r,n){var i=new m(t,e,r,n).lines,o=new Array;if(i.length>0){for(var a=i.length-1;a>=0;a--){var s=i[a];o.push(s.start())}o.push(i[0].end())}return o},Point2D:c.a,unionCopperAreaPolygons:g.d,easyeda2step:function(t){return Et(void 0,void 0,void 0,(function(){var e;return _t(this,(function(r){switch(r.label){case 0:return[4,mt(t)];case 1:return(e=r.sent())?[2,new Blob([e],{type:"application/step"})]:[2]}}))}))},easyeda2obj:function(t){return Et(void 0,void 0,void 0,(function(){var e;return _t(this,(function(r){switch(r.label){case 0:return[4,vt(t)];case 1:return(e=r.sent())?[2,new Blob([e],{type:"application/obj"})]:[2]}}))}))},"page/3dviewer":function(){return new D}}}]);